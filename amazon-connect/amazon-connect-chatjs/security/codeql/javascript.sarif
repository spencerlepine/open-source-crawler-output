{
  "$schema" : "https://json.schemastore.org/sarif-2.1.0.json",
  "version" : "2.1.0",
  "runs" : [ {
    "tool" : {
      "driver" : {
        "name" : "CodeQL",
        "organization" : "GitHub",
        "semanticVersion" : "2.11.2",
        "rules" : [ ]
      },
      "extensions" : [ {
        "name" : "codeql/java-all",
        "semanticVersion" : "0.4.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/java-all/0.4.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/java-all/0.4.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/csharp-queries",
        "semanticVersion" : "0.4.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/csharp-queries/0.4.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/csharp-queries/0.4.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/java-examples",
        "semanticVersion" : "0.0.0+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/java-examples/0.0.0/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/java-examples/0.0.0/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/ruby-all",
        "semanticVersion" : "0.4.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/ruby-all/0.4.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/ruby-all/0.4.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/javascript-queries",
        "semanticVersion" : "0.4.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "notifications" : [ {
          "id" : "js/diagnostics/extraction-errors",
          "name" : "js/diagnostics/extraction-errors",
          "shortDescription" : {
            "text" : "Extraction errors"
          },
          "fullDescription" : {
            "text" : "List all extraction errors for files in the source code directory."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "description" : "List all extraction errors for files in the source code directory.",
            "id" : "js/diagnostics/extraction-errors",
            "kind" : "diagnostic",
            "name" : "Extraction errors"
          }
        }, {
          "id" : "js/diagnostics/successfully-extracted-files",
          "name" : "js/diagnostics/successfully-extracted-files",
          "shortDescription" : {
            "text" : "Successfully extracted files"
          },
          "fullDescription" : {
            "text" : "Lists all files in the source code directory that were extracted without encountering an error in the file."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "successfully-extracted-files" ],
            "description" : "Lists all files in the source code directory that were extracted without encountering an error in the file.",
            "id" : "js/diagnostics/successfully-extracted-files",
            "kind" : "diagnostic",
            "name" : "Successfully extracted files"
          }
        } ],
        "rules" : [ {
          "id" : "js/angular/disabling-sce",
          "name" : "js/angular/disabling-sce",
          "shortDescription" : {
            "text" : "Disabling SCE"
          },
          "fullDescription" : {
            "text" : "Disabling strict contextual escaping (SCE) can cause security vulnerabilities."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Disabling SCE\nAngularJS is secure by default through automated sanitization and filtering of untrusted values that could cause vulnerabilities such as XSS. Strict Contextual Escaping (SCE) is an execution mode in AngularJS that provides this security mechanism.\n\nDisabling SCE in an AngularJS application is strongly discouraged. It is even more discouraged to disable SCE in a library, since it is an application-wide setting.\n\n\n## Recommendation\nDo not disable SCE.\n\n\n## Example\nThe following example shows an AngularJS application that disables SCE in order to dynamically construct an HTML fragment, which is later inserted into the DOM through `$scope.html`.\n\n\n```javascript\nangular.module('app', [])\n    .config(function($sceProvider) {\n        $sceProvider.enabled(false); // BAD\n    }).controller('controller', function($scope) {\n        // ...\n        $scope.html = '<ul><li>' + item.toString() + '</li></ul>';\n    });\n\n```\nThis is problematic, since it disables SCE for the entire AngularJS application.\n\nInstead, just mark the dynamically constructed HTML fragment as safe using `$sce.trustAsHtml`, before assigning it to `$scope.html`:\n\n\n```javascript\nangular.module('app', [])\n    .controller('controller', function($scope, $sce) {\n        // ...\n        // GOOD (but should use the templating system instead)\n        $scope.html = $sce.trustAsHtml('<ul><li>' + item.toString() + '</li></ul>'); \n    });\n\n```\nPlease note that this example is for illustrative purposes only; use the AngularJS templating system to dynamically construct HTML when possible.\n\n\n## References\n* AngularJS Developer Guide: [Strict Contextual Escaping](https://docs.angularjs.org/api/ng/service/$sce)\n* AngularJS Developer Guide: [Can I disable SCE completely?](https://docs.angularjs.org/api/ng/service/$sce#can-i-disable-sce-completely-).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Disabling SCE\nAngularJS is secure by default through automated sanitization and filtering of untrusted values that could cause vulnerabilities such as XSS. Strict Contextual Escaping (SCE) is an execution mode in AngularJS that provides this security mechanism.\n\nDisabling SCE in an AngularJS application is strongly discouraged. It is even more discouraged to disable SCE in a library, since it is an application-wide setting.\n\n\n## Recommendation\nDo not disable SCE.\n\n\n## Example\nThe following example shows an AngularJS application that disables SCE in order to dynamically construct an HTML fragment, which is later inserted into the DOM through `$scope.html`.\n\n\n```javascript\nangular.module('app', [])\n    .config(function($sceProvider) {\n        $sceProvider.enabled(false); // BAD\n    }).controller('controller', function($scope) {\n        // ...\n        $scope.html = '<ul><li>' + item.toString() + '</li></ul>';\n    });\n\n```\nThis is problematic, since it disables SCE for the entire AngularJS application.\n\nInstead, just mark the dynamically constructed HTML fragment as safe using `$sce.trustAsHtml`, before assigning it to `$scope.html`:\n\n\n```javascript\nangular.module('app', [])\n    .controller('controller', function($scope, $sce) {\n        // ...\n        // GOOD (but should use the templating system instead)\n        $scope.html = $sce.trustAsHtml('<ul><li>' + item.toString() + '</li></ul>'); \n    });\n\n```\nPlease note that this example is for illustrative purposes only; use the AngularJS templating system to dynamically construct HTML when possible.\n\n\n## References\n* AngularJS Developer Guide: [Strict Contextual Escaping](https://docs.angularjs.org/api/ng/service/$sce)\n* AngularJS Developer Guide: [Can I disable SCE completely?](https://docs.angularjs.org/api/ng/service/$sce#can-i-disable-sce-completely-).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "maintainability", "frameworks/angularjs", "external/cwe/cwe-116" ],
            "description" : "Disabling strict contextual escaping (SCE) can cause security vulnerabilities.",
            "id" : "js/angular/disabling-sce",
            "kind" : "problem",
            "name" : "Disabling SCE",
            "precision" : "very-high",
            "problem.severity" : "warning",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/angular/double-compilation",
          "name" : "js/angular/double-compilation",
          "shortDescription" : {
            "text" : "Double compilation"
          },
          "fullDescription" : {
            "text" : "Recompiling an already compiled part of the DOM can lead to unexpected behavior of directives, performance problems, and memory leaks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Double compilation\nThe AngularJS compiler processes (parts of) the DOM, determining which directives match which DOM elements, and then applies the directives to the elements. Each DOM element should only be compiled once, otherwise unexpected behavior may result.\n\n\n## Recommendation\nOnly compile new DOM elements.\n\n\n## Example\nThe following example (adapted from the AngularJS developer guide) shows a directive that adds a tooltip to a DOM element, and then compiles the entire element to apply nested directives.\n\n\n```javascript\nangular.module('myapp')\n       .directive('addToolTip', function($compile) {\n  return {\n    link: function(scope, element, attrs) {\n      var tooltip = angular.element('<span ng-show=\"showToolTip\">A tooltip</span>');\n      tooltip.on('mouseenter mouseleave', function() {\n        scope.$apply('showToolTip = !showToolTip');\n      });\n      element.append(tooltip);\n      $compile(element)(scope); // NOT OK\n    }\n  };\n});\n\n```\nThis is problematic, since it will recompile all of `element`, including parts that have already been compiled.\n\nInstead, only the new element should be compiled:\n\n\n```javascript\nangular.module('myapp')\n       .directive('addToolTip', function($compile) {\n  return {\n    link: function(scope, element, attrs) {\n      var tooltip = angular.element('<span ng-show=\"showToolTip\">A tooltip</span>');\n      tooltip.on('mouseenter mouseleave', function() {\n        scope.$apply('showToolTip = !showToolTip');\n      });\n      element.append(tooltip);\n      $compile(tooltip)(scope); // OK\n    }\n  };\n});\n\n```\n\n## References\n* AngularJS Developer Guide: [Double Compilation, and how to avoid it](https://docs.angularjs.org/guide/compiler#double-compilation-and-how-to-avoid-it).\n* Common Weakness Enumeration: [CWE-1176](https://cwe.mitre.org/data/definitions/1176.html).\n",
            "markdown" : "# Double compilation\nThe AngularJS compiler processes (parts of) the DOM, determining which directives match which DOM elements, and then applies the directives to the elements. Each DOM element should only be compiled once, otherwise unexpected behavior may result.\n\n\n## Recommendation\nOnly compile new DOM elements.\n\n\n## Example\nThe following example (adapted from the AngularJS developer guide) shows a directive that adds a tooltip to a DOM element, and then compiles the entire element to apply nested directives.\n\n\n```javascript\nangular.module('myapp')\n       .directive('addToolTip', function($compile) {\n  return {\n    link: function(scope, element, attrs) {\n      var tooltip = angular.element('<span ng-show=\"showToolTip\">A tooltip</span>');\n      tooltip.on('mouseenter mouseleave', function() {\n        scope.$apply('showToolTip = !showToolTip');\n      });\n      element.append(tooltip);\n      $compile(element)(scope); // NOT OK\n    }\n  };\n});\n\n```\nThis is problematic, since it will recompile all of `element`, including parts that have already been compiled.\n\nInstead, only the new element should be compiled:\n\n\n```javascript\nangular.module('myapp')\n       .directive('addToolTip', function($compile) {\n  return {\n    link: function(scope, element, attrs) {\n      var tooltip = angular.element('<span ng-show=\"showToolTip\">A tooltip</span>');\n      tooltip.on('mouseenter mouseleave', function() {\n        scope.$apply('showToolTip = !showToolTip');\n      });\n      element.append(tooltip);\n      $compile(tooltip)(scope); // OK\n    }\n  };\n});\n\n```\n\n## References\n* AngularJS Developer Guide: [Double Compilation, and how to avoid it](https://docs.angularjs.org/guide/compiler#double-compilation-and-how-to-avoid-it).\n* Common Weakness Enumeration: [CWE-1176](https://cwe.mitre.org/data/definitions/1176.html).\n"
          },
          "properties" : {
            "tags" : [ "reliability", "frameworks/angularjs", "security", "external/cwe/cwe-1176" ],
            "description" : "Recompiling an already compiled part of the DOM can lead to\n              unexpected behavior of directives, performance problems, and memory leaks.",
            "id" : "js/angular/double-compilation",
            "kind" : "problem",
            "name" : "Double compilation",
            "precision" : "very-high",
            "problem.severity" : "warning",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "js/angular/insecure-url-whitelist",
          "name" : "js/angular/insecure-url-whitelist",
          "shortDescription" : {
            "text" : "Insecure URL whitelist"
          },
          "fullDescription" : {
            "text" : "URL whitelists that are too permissive can cause security vulnerabilities."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Insecure URL whitelist\nAngularJS uses filters to ensure that the URLs used for sourcing AngularJS templates and other script-running URLs are safe. One such filter is a whitelist of URL patterns to allow.\n\nA URL pattern that is too permissive can cause security vulnerabilities.\n\n\n## Recommendation\nMake the whitelist URL patterns as restrictive as possible.\n\n\n## Example\nThe following example shows an AngularJS application with whitelist URL patterns that all are too permissive.\n\n\n```javascript\nangular.module('myApp', [])\n    .config(function($sceDelegateProvider) {\n        $sceDelegateProvider.resourceUrlWhitelist([\n            \"*://example.org/*\", // BAD\n            \"https://**.example.com/*\", // BAD\n            \"https://example.**\", // BAD\n            \"https://example.*\" // BAD\n        ]);\n    });\n\n```\nThis is problematic, since the four patterns match the following malicious URLs, respectively:\n\n* `javascript://example.org/a%0A%0Dalert(1)` (`%0A%0D` is a linebreak)\n* `https://evil.com/?ignore=://example.com/a`\n* `https://example.evil.com`\n* `https://example.evilTld`\n\n## References\n* OWASP/Google presentation: [Securing AngularJS Applications](https://www.owasp.org/images/6/6e/Benelus_day_20161125_S_Lekies_Securing_AngularJS_Applications.pdf)\n* AngularJS Developer Guide: [Format of items in resourceUrlWhitelist/Blacklist](https://docs.angularjs.org/api/ng/service/$sce#resourceUrlPatternItem).\n* Common Weakness Enumeration: [CWE-183](https://cwe.mitre.org/data/definitions/183.html).\n* Common Weakness Enumeration: [CWE-625](https://cwe.mitre.org/data/definitions/625.html).\n",
            "markdown" : "# Insecure URL whitelist\nAngularJS uses filters to ensure that the URLs used for sourcing AngularJS templates and other script-running URLs are safe. One such filter is a whitelist of URL patterns to allow.\n\nA URL pattern that is too permissive can cause security vulnerabilities.\n\n\n## Recommendation\nMake the whitelist URL patterns as restrictive as possible.\n\n\n## Example\nThe following example shows an AngularJS application with whitelist URL patterns that all are too permissive.\n\n\n```javascript\nangular.module('myApp', [])\n    .config(function($sceDelegateProvider) {\n        $sceDelegateProvider.resourceUrlWhitelist([\n            \"*://example.org/*\", // BAD\n            \"https://**.example.com/*\", // BAD\n            \"https://example.**\", // BAD\n            \"https://example.*\" // BAD\n        ]);\n    });\n\n```\nThis is problematic, since the four patterns match the following malicious URLs, respectively:\n\n* `javascript://example.org/a%0A%0Dalert(1)` (`%0A%0D` is a linebreak)\n* `https://evil.com/?ignore=://example.com/a`\n* `https://example.evil.com`\n* `https://example.evilTld`\n\n## References\n* OWASP/Google presentation: [Securing AngularJS Applications](https://www.owasp.org/images/6/6e/Benelus_day_20161125_S_Lekies_Securing_AngularJS_Applications.pdf)\n* AngularJS Developer Guide: [Format of items in resourceUrlWhitelist/Blacklist](https://docs.angularjs.org/api/ng/service/$sce#resourceUrlPatternItem).\n* Common Weakness Enumeration: [CWE-183](https://cwe.mitre.org/data/definitions/183.html).\n* Common Weakness Enumeration: [CWE-625](https://cwe.mitre.org/data/definitions/625.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "frameworks/angularjs", "external/cwe/cwe-183", "external/cwe/cwe-625" ],
            "description" : "URL whitelists that are too permissive can cause security vulnerabilities.",
            "id" : "js/angular/insecure-url-whitelist",
            "kind" : "problem",
            "name" : "Insecure URL whitelist",
            "precision" : "very-high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/unsafe-external-link",
          "name" : "js/unsafe-external-link",
          "shortDescription" : {
            "text" : "Potentially unsafe external link"
          },
          "fullDescription" : {
            "text" : "External links that open in a new tab or window but do not specify link type 'noopener' or 'noreferrer' are a potential security risk."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Potentially unsafe external link\nHTML links that open in a new tab or window allow the target page to access the DOM of the origin page using `window.opener` unless link type `noopener` or `noreferrer` is specified. This is a potential security risk.\n\n\n## Recommendation\nSpecify the link type by adding an attribute `rel=\"noopener noreferrer\"`.\n\n\n## Example\nIn the following example, a JSX element is created that corresponds to an HTML link opening the URL `http://example.com` in a new tab. Since it does not specify a link type, that page will be able to access the DOM of the origin page.\n\n\n```javascript\nvar link = <a href=\"http://example.com\" target=\"_blank\">Example</a>;\n\n```\nTo fix this vulnerability, add a `rel` attribute:\n\n\n```javascript\nvar link = <a href=\"http://example.com\" target=\"_blank\" rel=\"noopener noreferrer\">Example</a>;\n\n```\n\n## References\n* Mathias Bynens: [About rel=noopener](https://mathiasbynens.github.io/rel-noopener/).\n* Mozilla Developer Network: [HTML Anchor Element](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a).\n* Common Weakness Enumeration: [CWE-200](https://cwe.mitre.org/data/definitions/200.html).\n* Common Weakness Enumeration: [CWE-1022](https://cwe.mitre.org/data/definitions/1022.html).\n",
            "markdown" : "# Potentially unsafe external link\nHTML links that open in a new tab or window allow the target page to access the DOM of the origin page using `window.opener` unless link type `noopener` or `noreferrer` is specified. This is a potential security risk.\n\n\n## Recommendation\nSpecify the link type by adding an attribute `rel=\"noopener noreferrer\"`.\n\n\n## Example\nIn the following example, a JSX element is created that corresponds to an HTML link opening the URL `http://example.com` in a new tab. Since it does not specify a link type, that page will be able to access the DOM of the origin page.\n\n\n```javascript\nvar link = <a href=\"http://example.com\" target=\"_blank\">Example</a>;\n\n```\nTo fix this vulnerability, add a `rel` attribute:\n\n\n```javascript\nvar link = <a href=\"http://example.com\" target=\"_blank\" rel=\"noopener noreferrer\">Example</a>;\n\n```\n\n## References\n* Mathias Bynens: [About rel=noopener](https://mathiasbynens.github.io/rel-noopener/).\n* Mozilla Developer Network: [HTML Anchor Element](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a).\n* Common Weakness Enumeration: [CWE-200](https://cwe.mitre.org/data/definitions/200.html).\n* Common Weakness Enumeration: [CWE-1022](https://cwe.mitre.org/data/definitions/1022.html).\n"
          },
          "properties" : {
            "tags" : [ "maintainability", "security", "external/cwe/cwe-200", "external/cwe/cwe-1022" ],
            "description" : "External links that open in a new tab or window but do not specify\n              link type 'noopener' or 'noreferrer' are a potential security risk.",
            "id" : "js/unsafe-external-link",
            "kind" : "problem",
            "name" : "Potentially unsafe external link",
            "precision" : "very-high",
            "problem.severity" : "warning",
            "security-severity" : "6.5"
          }
        }, {
          "id" : "js/enabling-electron-insecure-content",
          "name" : "js/enabling-electron-insecure-content",
          "shortDescription" : {
            "text" : "Enabling Electron allowRunningInsecureContent"
          },
          "fullDescription" : {
            "text" : "Enabling allowRunningInsecureContent can allow remote code execution."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Enabling Electron allowRunningInsecureContent\nElectron is secure by default through a policy banning the execution of content loaded over HTTP. Setting the `allowRunningInsecureContent` property of a `webPreferences` object to `true` will disable this policy.\n\nEnabling the execution of insecure content is strongly discouraged.\n\n\n## Recommendation\nDo not enable the `allowRunningInsecureContent` property.\n\n\n## Example\nThe following example shows `allowRunningInsecureContent` being enabled.\n\n\n```javascript\nconst mainWindow = new BrowserWindow({\n  webPreferences: {\n    allowRunningInsecureContent: true\n  }\n})\n```\nThis is problematic, since it allows the execution of code from an untrusted origin.\n\n\n## References\n* Electron Documentation: [Security, Native Capabilities, and Your Responsibility](https://electronjs.org/docs/tutorial/security#8-do-not-set-allowrunninginsecurecontent-to-true)\n* Common Weakness Enumeration: [CWE-494](https://cwe.mitre.org/data/definitions/494.html).\n",
            "markdown" : "# Enabling Electron allowRunningInsecureContent\nElectron is secure by default through a policy banning the execution of content loaded over HTTP. Setting the `allowRunningInsecureContent` property of a `webPreferences` object to `true` will disable this policy.\n\nEnabling the execution of insecure content is strongly discouraged.\n\n\n## Recommendation\nDo not enable the `allowRunningInsecureContent` property.\n\n\n## Example\nThe following example shows `allowRunningInsecureContent` being enabled.\n\n\n```javascript\nconst mainWindow = new BrowserWindow({\n  webPreferences: {\n    allowRunningInsecureContent: true\n  }\n})\n```\nThis is problematic, since it allows the execution of code from an untrusted origin.\n\n\n## References\n* Electron Documentation: [Security, Native Capabilities, and Your Responsibility](https://electronjs.org/docs/tutorial/security#8-do-not-set-allowrunninginsecurecontent-to-true)\n* Common Weakness Enumeration: [CWE-494](https://cwe.mitre.org/data/definitions/494.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "frameworks/electron", "external/cwe/cwe-494" ],
            "description" : "Enabling allowRunningInsecureContent can allow remote code execution.",
            "id" : "js/enabling-electron-insecure-content",
            "kind" : "problem",
            "name" : "Enabling Electron allowRunningInsecureContent",
            "precision" : "very-high",
            "problem.severity" : "error",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "js/disabling-electron-websecurity",
          "name" : "js/disabling-electron-websecurity",
          "shortDescription" : {
            "text" : "Disabling Electron webSecurity"
          },
          "fullDescription" : {
            "text" : "Disabling webSecurity can cause critical security vulnerabilities."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Disabling Electron webSecurity\nElectron is secure by default through a same-origin policy requiring all JavaScript and CSS code to originate from the machine running the Electron application. Setting the `webSecurity` property of a `webPreferences` object to `false` will disable the same-origin policy.\n\nDisabling the same-origin policy is strongly discouraged.\n\n\n## Recommendation\nDo not disable `webSecurity`.\n\n\n## Example\nThe following example shows `webSecurity` being disabled.\n\n\n```javascript\nconst mainWindow = new BrowserWindow({\n  webPreferences: {\n    webSecurity: false\n  }\n})\n```\nThis is problematic, since it allows the execution of insecure code from other domains.\n\n\n## References\n* Electron Documentation: [Security, Native Capabilities, and Your Responsibility](https://electronjs.org/docs/tutorial/security#5-do-not-disable-websecurity)\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n",
            "markdown" : "# Disabling Electron webSecurity\nElectron is secure by default through a same-origin policy requiring all JavaScript and CSS code to originate from the machine running the Electron application. Setting the `webSecurity` property of a `webPreferences` object to `false` will disable the same-origin policy.\n\nDisabling the same-origin policy is strongly discouraged.\n\n\n## Recommendation\nDo not disable `webSecurity`.\n\n\n## Example\nThe following example shows `webSecurity` being disabled.\n\n\n```javascript\nconst mainWindow = new BrowserWindow({\n  webPreferences: {\n    webSecurity: false\n  }\n})\n```\nThis is problematic, since it allows the execution of insecure code from other domains.\n\n\n## References\n* Electron Documentation: [Security, Native Capabilities, and Your Responsibility](https://electronjs.org/docs/tutorial/security#5-do-not-disable-websecurity)\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "frameworks/electron", "external/cwe/cwe-79" ],
            "description" : "Disabling webSecurity can cause critical security vulnerabilities.",
            "id" : "js/disabling-electron-websecurity",
            "kind" : "problem",
            "name" : "Disabling Electron webSecurity",
            "precision" : "very-high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/polynomial-redos",
          "name" : "js/polynomial-redos",
          "shortDescription" : {
            "text" : "Polynomial regular expression used on uncontrolled data"
          },
          "fullDescription" : {
            "text" : "A regular expression that can require polynomial time to match may be vulnerable to denial-of-service attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Polynomial regular expression used on uncontrolled data\nSome regular expressions take a long time to match certain input strings to the point where the time it takes to match a string of length *n* is proportional to *n<sup>k</sup>* or even *2<sup>n</sup>*. Such regular expressions can negatively affect performance, or even allow a malicious user to perform a Denial of Service (\"DoS\") attack by crafting an expensive input string for the regular expression to match.\n\nThe regular expression engines provided by many popular JavaScript platforms use backtracking non-deterministic finite automata to implement regular expression matching. While this approach is space-efficient and allows supporting advanced features like capture groups, it is not time-efficient in general. The worst-case time complexity of such an automaton can be polynomial or even exponential, meaning that for strings of a certain shape, increasing the input length by ten characters may make the automaton about 1000 times slower.\n\nTypically, a regular expression is affected by this problem if it contains a repetition of the form `r*` or `r+` where the sub-expression `r` is ambiguous in the sense that it can match some string in multiple ways. More information about the precise circumstances can be found in the references.\n\n\n## Recommendation\nModify the regular expression to remove the ambiguity, or ensure that the strings matched with the regular expression are short enough that the time-complexity does not matter.\n\n\n## Example\nConsider this use of a regular expression, which removes all leading and trailing whitespace in a string:\n\n```javascript\n\n\t\t\ttext.replace(/^\\s+|\\s+$/g, ''); // BAD\n\t\t\n```\nThe sub-expression `\"\\s+$\"` will match the whitespace characters in `text` from left to right, but it can start matching anywhere within a whitespace sequence. This is problematic for strings that do **not** end with a whitespace character. Such a string will force the regular expression engine to process each whitespace sequence once per whitespace character in the sequence.\n\nThis ultimately means that the time cost of trimming a string is quadratic in the length of the string. So a string like `\"a b\"` will take milliseconds to process, but a similar string with a million spaces instead of just one will take several minutes.\n\nAvoid this problem by rewriting the regular expression to not contain the ambiguity about when to start matching whitespace sequences. For instance, by using a negative look-behind (`/^\\s+|(?<!\\s)\\s+$/g`), or just by using the built-in trim method (`text.trim()`).\n\nNote that the sub-expression `\"^\\s+\"` is **not** problematic as the `^` anchor restricts when that sub-expression can start matching, and as the regular expression engine matches from left to right.\n\n\n## Example\nAs a similar, but slightly subtler problem, consider the regular expression that matches lines with numbers, possibly written using scientific notation:\n\n```javascript\n\n\t\t\t/^0\\.\\d+E?\\d+$/.test(str) // BAD\n\t\t\n```\nThe problem with this regular expression is in the sub-expression `\\d+E?\\d+` because the second `\\d+` can start matching digits anywhere after the first match of the first `\\d+` if there is no `E` in the input string.\n\nThis is problematic for strings that do **not** end with a digit. Such a string will force the regular expression engine to process each digit sequence once per digit in the sequence, again leading to a quadratic time complexity.\n\nTo make the processing faster, the regular expression should be rewritten such that the two `\\d+` sub-expressions do not have overlapping matches: `^0\\.\\d+(E\\d+)?$`.\n\n\n## References\n* OWASP: [Regular expression Denial of Service - ReDoS](https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS).\n* Wikipedia: [ReDoS](https://en.wikipedia.org/wiki/ReDoS).\n* Wikipedia: [Time complexity](https://en.wikipedia.org/wiki/Time_complexity).\n* James Kirrage, Asiri Rathnayake, Hayo Thielecke: [Static Analysis for Regular Expression Denial-of-Service Attack](http://www.cs.bham.ac.uk/~hxt/research/reg-exp-sec.pdf).\n* Common Weakness Enumeration: [CWE-1333](https://cwe.mitre.org/data/definitions/1333.html).\n* Common Weakness Enumeration: [CWE-730](https://cwe.mitre.org/data/definitions/730.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n",
            "markdown" : "# Polynomial regular expression used on uncontrolled data\nSome regular expressions take a long time to match certain input strings to the point where the time it takes to match a string of length *n* is proportional to *n<sup>k</sup>* or even *2<sup>n</sup>*. Such regular expressions can negatively affect performance, or even allow a malicious user to perform a Denial of Service (\"DoS\") attack by crafting an expensive input string for the regular expression to match.\n\nThe regular expression engines provided by many popular JavaScript platforms use backtracking non-deterministic finite automata to implement regular expression matching. While this approach is space-efficient and allows supporting advanced features like capture groups, it is not time-efficient in general. The worst-case time complexity of such an automaton can be polynomial or even exponential, meaning that for strings of a certain shape, increasing the input length by ten characters may make the automaton about 1000 times slower.\n\nTypically, a regular expression is affected by this problem if it contains a repetition of the form `r*` or `r+` where the sub-expression `r` is ambiguous in the sense that it can match some string in multiple ways. More information about the precise circumstances can be found in the references.\n\n\n## Recommendation\nModify the regular expression to remove the ambiguity, or ensure that the strings matched with the regular expression are short enough that the time-complexity does not matter.\n\n\n## Example\nConsider this use of a regular expression, which removes all leading and trailing whitespace in a string:\n\n```javascript\n\n\t\t\ttext.replace(/^\\s+|\\s+$/g, ''); // BAD\n\t\t\n```\nThe sub-expression `\"\\s+$\"` will match the whitespace characters in `text` from left to right, but it can start matching anywhere within a whitespace sequence. This is problematic for strings that do **not** end with a whitespace character. Such a string will force the regular expression engine to process each whitespace sequence once per whitespace character in the sequence.\n\nThis ultimately means that the time cost of trimming a string is quadratic in the length of the string. So a string like `\"a b\"` will take milliseconds to process, but a similar string with a million spaces instead of just one will take several minutes.\n\nAvoid this problem by rewriting the regular expression to not contain the ambiguity about when to start matching whitespace sequences. For instance, by using a negative look-behind (`/^\\s+|(?<!\\s)\\s+$/g`), or just by using the built-in trim method (`text.trim()`).\n\nNote that the sub-expression `\"^\\s+\"` is **not** problematic as the `^` anchor restricts when that sub-expression can start matching, and as the regular expression engine matches from left to right.\n\n\n## Example\nAs a similar, but slightly subtler problem, consider the regular expression that matches lines with numbers, possibly written using scientific notation:\n\n```javascript\n\n\t\t\t/^0\\.\\d+E?\\d+$/.test(str) // BAD\n\t\t\n```\nThe problem with this regular expression is in the sub-expression `\\d+E?\\d+` because the second `\\d+` can start matching digits anywhere after the first match of the first `\\d+` if there is no `E` in the input string.\n\nThis is problematic for strings that do **not** end with a digit. Such a string will force the regular expression engine to process each digit sequence once per digit in the sequence, again leading to a quadratic time complexity.\n\nTo make the processing faster, the regular expression should be rewritten such that the two `\\d+` sub-expressions do not have overlapping matches: `^0\\.\\d+(E\\d+)?$`.\n\n\n## References\n* OWASP: [Regular expression Denial of Service - ReDoS](https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS).\n* Wikipedia: [ReDoS](https://en.wikipedia.org/wiki/ReDoS).\n* Wikipedia: [Time complexity](https://en.wikipedia.org/wiki/Time_complexity).\n* James Kirrage, Asiri Rathnayake, Hayo Thielecke: [Static Analysis for Regular Expression Denial-of-Service Attack](http://www.cs.bham.ac.uk/~hxt/research/reg-exp-sec.pdf).\n* Common Weakness Enumeration: [CWE-1333](https://cwe.mitre.org/data/definitions/1333.html).\n* Common Weakness Enumeration: [CWE-730](https://cwe.mitre.org/data/definitions/730.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-1333", "external/cwe/cwe-730", "external/cwe/cwe-400" ],
            "description" : "A regular expression that can require polynomial time\n              to match may be vulnerable to denial-of-service attacks.",
            "id" : "js/polynomial-redos",
            "kind" : "path-problem",
            "name" : "Polynomial regular expression used on uncontrolled data",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/redos",
          "name" : "js/redos",
          "shortDescription" : {
            "text" : "Inefficient regular expression"
          },
          "fullDescription" : {
            "text" : "A regular expression that requires exponential time to match certain inputs can be a performance bottleneck, and may be vulnerable to denial-of-service attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Inefficient regular expression\nSome regular expressions take a long time to match certain input strings to the point where the time it takes to match a string of length *n* is proportional to *n<sup>k</sup>* or even *2<sup>n</sup>*. Such regular expressions can negatively affect performance, or even allow a malicious user to perform a Denial of Service (\"DoS\") attack by crafting an expensive input string for the regular expression to match.\n\nThe regular expression engines provided by many popular JavaScript platforms use backtracking non-deterministic finite automata to implement regular expression matching. While this approach is space-efficient and allows supporting advanced features like capture groups, it is not time-efficient in general. The worst-case time complexity of such an automaton can be polynomial or even exponential, meaning that for strings of a certain shape, increasing the input length by ten characters may make the automaton about 1000 times slower.\n\nTypically, a regular expression is affected by this problem if it contains a repetition of the form `r*` or `r+` where the sub-expression `r` is ambiguous in the sense that it can match some string in multiple ways. More information about the precise circumstances can be found in the references.\n\n\n## Recommendation\nModify the regular expression to remove the ambiguity, or ensure that the strings matched with the regular expression are short enough that the time-complexity does not matter.\n\n\n## Example\nConsider this regular expression:\n\n```javascript\n\n\t\t\t/^_(__|.)+_$/\n\t\t\n```\nIts sub-expression `\"(__|.)+?\"` can match the string `\"__\"` either by the first alternative `\"__\"` to the left of the `\"|\"` operator, or by two repetitions of the second alternative `\".\"` to the right. Thus, a string consisting of an odd number of underscores followed by some other character will cause the regular expression engine to run for an exponential amount of time before rejecting the input.\n\nThis problem can be avoided by rewriting the regular expression to remove the ambiguity between the two branches of the alternative inside the repetition:\n\n```javascript\n\n\t\t\t/^_(__|[^_])+_$/\n\t\t\n```\n\n## References\n* OWASP: [Regular expression Denial of Service - ReDoS](https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS).\n* Wikipedia: [ReDoS](https://en.wikipedia.org/wiki/ReDoS).\n* Wikipedia: [Time complexity](https://en.wikipedia.org/wiki/Time_complexity).\n* James Kirrage, Asiri Rathnayake, Hayo Thielecke: [Static Analysis for Regular Expression Denial-of-Service Attack](http://www.cs.bham.ac.uk/~hxt/research/reg-exp-sec.pdf).\n* Common Weakness Enumeration: [CWE-1333](https://cwe.mitre.org/data/definitions/1333.html).\n* Common Weakness Enumeration: [CWE-730](https://cwe.mitre.org/data/definitions/730.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n",
            "markdown" : "# Inefficient regular expression\nSome regular expressions take a long time to match certain input strings to the point where the time it takes to match a string of length *n* is proportional to *n<sup>k</sup>* or even *2<sup>n</sup>*. Such regular expressions can negatively affect performance, or even allow a malicious user to perform a Denial of Service (\"DoS\") attack by crafting an expensive input string for the regular expression to match.\n\nThe regular expression engines provided by many popular JavaScript platforms use backtracking non-deterministic finite automata to implement regular expression matching. While this approach is space-efficient and allows supporting advanced features like capture groups, it is not time-efficient in general. The worst-case time complexity of such an automaton can be polynomial or even exponential, meaning that for strings of a certain shape, increasing the input length by ten characters may make the automaton about 1000 times slower.\n\nTypically, a regular expression is affected by this problem if it contains a repetition of the form `r*` or `r+` where the sub-expression `r` is ambiguous in the sense that it can match some string in multiple ways. More information about the precise circumstances can be found in the references.\n\n\n## Recommendation\nModify the regular expression to remove the ambiguity, or ensure that the strings matched with the regular expression are short enough that the time-complexity does not matter.\n\n\n## Example\nConsider this regular expression:\n\n```javascript\n\n\t\t\t/^_(__|.)+_$/\n\t\t\n```\nIts sub-expression `\"(__|.)+?\"` can match the string `\"__\"` either by the first alternative `\"__\"` to the left of the `\"|\"` operator, or by two repetitions of the second alternative `\".\"` to the right. Thus, a string consisting of an odd number of underscores followed by some other character will cause the regular expression engine to run for an exponential amount of time before rejecting the input.\n\nThis problem can be avoided by rewriting the regular expression to remove the ambiguity between the two branches of the alternative inside the repetition:\n\n```javascript\n\n\t\t\t/^_(__|[^_])+_$/\n\t\t\n```\n\n## References\n* OWASP: [Regular expression Denial of Service - ReDoS](https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS).\n* Wikipedia: [ReDoS](https://en.wikipedia.org/wiki/ReDoS).\n* Wikipedia: [Time complexity](https://en.wikipedia.org/wiki/Time_complexity).\n* James Kirrage, Asiri Rathnayake, Hayo Thielecke: [Static Analysis for Regular Expression Denial-of-Service Attack](http://www.cs.bham.ac.uk/~hxt/research/reg-exp-sec.pdf).\n* Common Weakness Enumeration: [CWE-1333](https://cwe.mitre.org/data/definitions/1333.html).\n* Common Weakness Enumeration: [CWE-730](https://cwe.mitre.org/data/definitions/730.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-1333", "external/cwe/cwe-730", "external/cwe/cwe-400" ],
            "description" : "A regular expression that requires exponential time to match certain inputs\n              can be a performance bottleneck, and may be vulnerable to denial-of-service\n              attacks.",
            "id" : "js/redos",
            "kind" : "problem",
            "name" : "Inefficient regular expression",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/identity-replacement",
          "name" : "js/identity-replacement",
          "shortDescription" : {
            "text" : "Replacement of a substring with itself"
          },
          "fullDescription" : {
            "text" : "Replacing a substring with itself has no effect and may indicate a mistake."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Replacement of a substring with itself\nReplacing a substring with itself has no effect and usually indicates a mistake, such as misspelling a backslash escape.\n\n\n## Recommendation\nExamine the string replacement to find and correct any typos.\n\n\n## Example\nThe following code snippet attempts to backslash-escape all double quotes in `raw` by replacing all instances of `\"` with `\\\"`:\n\n\n```javascript\nvar escaped = raw.replace(/\"/g, '\\\"');\n\n```\nHowever, the replacement string `'\\\"'` is actually the same as `'\"'`, with `\\\"` interpreted as an identity escape, so the replacement does nothing. Instead, the replacement string should be `'\\\\\"'`:\n\n\n```javascript\nvar escaped = raw.replace(/\"/g, '\\\\\"');\n\n```\n\n## References\n* Mozilla Developer Network: [String escape notation](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#Escape_notation).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Replacement of a substring with itself\nReplacing a substring with itself has no effect and usually indicates a mistake, such as misspelling a backslash escape.\n\n\n## Recommendation\nExamine the string replacement to find and correct any typos.\n\n\n## Example\nThe following code snippet attempts to backslash-escape all double quotes in `raw` by replacing all instances of `\"` with `\\\"`:\n\n\n```javascript\nvar escaped = raw.replace(/\"/g, '\\\"');\n\n```\nHowever, the replacement string `'\\\"'` is actually the same as `'\"'`, with `\\\"` interpreted as an identity escape, so the replacement does nothing. Instead, the replacement string should be `'\\\\\"'`:\n\n\n```javascript\nvar escaped = raw.replace(/\"/g, '\\\\\"');\n\n```\n\n## References\n* Mozilla Developer Network: [String escape notation](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#Escape_notation).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-116" ],
            "description" : "Replacing a substring with itself has no effect and may indicate a mistake.",
            "id" : "js/identity-replacement",
            "kind" : "problem",
            "name" : "Replacement of a substring with itself",
            "precision" : "very-high",
            "problem.severity" : "warning",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/incomplete-hostname-regexp",
          "name" : "js/incomplete-hostname-regexp",
          "shortDescription" : {
            "text" : "Incomplete regular expression for hostnames"
          },
          "fullDescription" : {
            "text" : "Matching a URL or hostname against a regular expression that contains an unescaped dot as part of the hostname might match more hostnames than expected."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Incomplete regular expression for hostnames\nSanitizing untrusted URLs is an important technique for preventing attacks such as request forgeries and malicious redirections. Often, this is done by checking that the host of a URL is in a set of allowed hosts.\n\nIf a regular expression implements such a check, it is easy to accidentally make the check too permissive by not escaping the `.` meta-characters appropriately. Even if the check is not used in a security-critical context, the incomplete check may still cause undesirable behaviors when it accidentally succeeds.\n\n\n## Recommendation\nEscape all meta-characters appropriately when constructing regular expressions for security checks, and pay special attention to the `.` meta-character.\n\n\n## Example\nThe following example code checks that a URL redirection will reach the `example.com` domain, or one of its subdomains.\n\n\n```javascript\napp.get('/some/path', function(req, res) {\n    let url = req.param('url'),\n        host = urlLib.parse(url).host;\n    // BAD: the host of `url` may be controlled by an attacker\n    let regex = /^((www|beta).)?example.com/;\n    if (host.match(regex)) {\n        res.redirect(url);\n    }\n});\n\n```\nThe check is however easy to bypass because the unescaped `.` allows for any character before `example.com`, effectively allowing the redirect to go to an attacker-controlled domain such as `wwwXexample.com`.\n\nAddress this vulnerability by escaping `.` appropriately: `let regex = /^((www|beta)\\.)?example\\.com/`.\n\n\n## References\n* MDN: [Regular Expressions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions)\n* OWASP: [SSRF](https://www.owasp.org/index.php/Server_Side_Request_Forgery)\n* OWASP: [XSS Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n",
            "markdown" : "# Incomplete regular expression for hostnames\nSanitizing untrusted URLs is an important technique for preventing attacks such as request forgeries and malicious redirections. Often, this is done by checking that the host of a URL is in a set of allowed hosts.\n\nIf a regular expression implements such a check, it is easy to accidentally make the check too permissive by not escaping the `.` meta-characters appropriately. Even if the check is not used in a security-critical context, the incomplete check may still cause undesirable behaviors when it accidentally succeeds.\n\n\n## Recommendation\nEscape all meta-characters appropriately when constructing regular expressions for security checks, and pay special attention to the `.` meta-character.\n\n\n## Example\nThe following example code checks that a URL redirection will reach the `example.com` domain, or one of its subdomains.\n\n\n```javascript\napp.get('/some/path', function(req, res) {\n    let url = req.param('url'),\n        host = urlLib.parse(url).host;\n    // BAD: the host of `url` may be controlled by an attacker\n    let regex = /^((www|beta).)?example.com/;\n    if (host.match(regex)) {\n        res.redirect(url);\n    }\n});\n\n```\nThe check is however easy to bypass because the unescaped `.` allows for any character before `example.com`, effectively allowing the redirect to go to an attacker-controlled domain such as `wwwXexample.com`.\n\nAddress this vulnerability by escaping `.` appropriately: `let regex = /^((www|beta)\\.)?example\\.com/`.\n\n\n## References\n* MDN: [Regular Expressions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions)\n* OWASP: [SSRF](https://www.owasp.org/index.php/Server_Side_Request_Forgery)\n* OWASP: [XSS Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-020" ],
            "description" : "Matching a URL or hostname against a regular expression that contains an unescaped dot as part of the hostname might match more hostnames than expected.",
            "id" : "js/incomplete-hostname-regexp",
            "kind" : "problem",
            "name" : "Incomplete regular expression for hostnames",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/incomplete-url-scheme-check",
          "name" : "js/incomplete-url-scheme-check",
          "shortDescription" : {
            "text" : "Incomplete URL scheme check"
          },
          "fullDescription" : {
            "text" : "Checking for the \"javascript:\" URL scheme without also checking for \"vbscript:\" and \"data:\" suggests a logic error or even a security vulnerability."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Incomplete URL scheme check\nURLs starting with `javascript:` can be used to encode JavaScript code to be executed when the URL is visited. While this is a powerful mechanism for creating feature-rich and responsive web applications, it is also a potential security risk: if the URL comes from an untrusted source, it might contain harmful JavaScript code. For this reason, many frameworks and libraries first check the URL scheme of any untrusted URL, and reject URLs with the `javascript:` scheme.\n\nHowever, the `data:` and `vbscript:` schemes can be used to represent executable code in a very similar way, so any validation logic that checks against `javascript:`, but not against `data:` and `vbscript:`, is likely to be insufficient.\n\n\n## Recommendation\nAdd checks covering both `data:` and `vbscript:`.\n\n\n## Example\nThe following function validates a (presumably untrusted) URL `url`. If it starts with `javascript:` (case-insensitive and potentially preceded by whitespace), the harmless placeholder URL `about:blank` is returned to prevent code injection; otherwise `url` itself is returned.\n\n\n```javascript\nfunction sanitizeUrl(url) {\n    let u = decodeURI(url).trim().toLowerCase();\n    if (u.startsWith(\"javascript:\"))\n        return \"about:blank\";\n    return url;\n}\n\n```\nWhile this check provides partial projection, it should be extended to cover `data:` and `vbscript:` as well:\n\n\n```javascript\nfunction sanitizeUrl(url) {\n    let u = decodeURI(url).trim().toLowerCase();\n    if (u.startsWith(\"javascript:\") || u.startsWith(\"data:\") || u.startsWith(\"vbscript:\"))\n        return \"about:blank\";\n    return url;\n}\n\n```\n\n## References\n* WHATWG: [URL schemes](https://wiki.whatwg.org/wiki/URL_schemes).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n* Common Weakness Enumeration: [CWE-184](https://cwe.mitre.org/data/definitions/184.html).\n",
            "markdown" : "# Incomplete URL scheme check\nURLs starting with `javascript:` can be used to encode JavaScript code to be executed when the URL is visited. While this is a powerful mechanism for creating feature-rich and responsive web applications, it is also a potential security risk: if the URL comes from an untrusted source, it might contain harmful JavaScript code. For this reason, many frameworks and libraries first check the URL scheme of any untrusted URL, and reject URLs with the `javascript:` scheme.\n\nHowever, the `data:` and `vbscript:` schemes can be used to represent executable code in a very similar way, so any validation logic that checks against `javascript:`, but not against `data:` and `vbscript:`, is likely to be insufficient.\n\n\n## Recommendation\nAdd checks covering both `data:` and `vbscript:`.\n\n\n## Example\nThe following function validates a (presumably untrusted) URL `url`. If it starts with `javascript:` (case-insensitive and potentially preceded by whitespace), the harmless placeholder URL `about:blank` is returned to prevent code injection; otherwise `url` itself is returned.\n\n\n```javascript\nfunction sanitizeUrl(url) {\n    let u = decodeURI(url).trim().toLowerCase();\n    if (u.startsWith(\"javascript:\"))\n        return \"about:blank\";\n    return url;\n}\n\n```\nWhile this check provides partial projection, it should be extended to cover `data:` and `vbscript:` as well:\n\n\n```javascript\nfunction sanitizeUrl(url) {\n    let u = decodeURI(url).trim().toLowerCase();\n    if (u.startsWith(\"javascript:\") || u.startsWith(\"data:\") || u.startsWith(\"vbscript:\"))\n        return \"about:blank\";\n    return url;\n}\n\n```\n\n## References\n* WHATWG: [URL schemes](https://wiki.whatwg.org/wiki/URL_schemes).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n* Common Weakness Enumeration: [CWE-184](https://cwe.mitre.org/data/definitions/184.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "correctness", "external/cwe/cwe-020", "external/cwe/cwe-184" ],
            "description" : "Checking for the \"javascript:\" URL scheme without also checking for \"vbscript:\"\n              and \"data:\" suggests a logic error or even a security vulnerability.",
            "id" : "js/incomplete-url-scheme-check",
            "kind" : "problem",
            "name" : "Incomplete URL scheme check",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/incomplete-url-substring-sanitization",
          "name" : "js/incomplete-url-substring-sanitization",
          "shortDescription" : {
            "text" : "Incomplete URL substring sanitization"
          },
          "fullDescription" : {
            "text" : "Security checks on the substrings of an unparsed URL are often vulnerable to bypassing."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Incomplete URL substring sanitization\nSanitizing untrusted URLs is an important technique for preventing attacks such as request forgeries and malicious redirections. Usually, this is done by checking that the host of a URL is in a set of allowed hosts.\n\nHowever, treating the URL as a string and checking if one of the allowed hosts is a substring of the URL is very prone to errors. Malicious URLs can bypass such security checks by embedding one of the allowed hosts in an unexpected location.\n\nEven if the substring check is not used in a security-critical context, the incomplete check may still cause undesirable behaviors when the check succeeds accidentally.\n\n\n## Recommendation\nParse a URL before performing a check on its host value, and ensure that the check handles arbitrary subdomain sequences correctly.\n\n\n## Example\nThe following example code checks that a URL redirection will reach the `example.com` domain, or one of its subdomains, and not some malicious site.\n\n\n```javascript\napp.get('/some/path', function(req, res) {\n    let url = req.param(\"url\");\n    // BAD: the host of `url` may be controlled by an attacker\n    if (url.includes(\"example.com\")) {\n        res.redirect(url);\n    }\n});\n\n```\nThe substring check is, however, easy to bypass. For example by embedding `example.com` in the path component: `http://evil-example.net/example.com`, or in the query string component: `http://evil-example.net/?x=example.com`. Address these shortcomings by checking the host of the parsed URL instead:\n\n\n```javascript\napp.get('/some/path', function(req, res) {\n    let url = req.param(\"url\"),\n        host = urlLib.parse(url).host;\n    // BAD: the host of `url` may be controlled by an attacker\n    if (host.includes(\"example.com\")) {\n        res.redirect(url);\n    }\n});\n\n```\nThis is still not a sufficient check as the following URLs bypass it: `http://evil-example.com` `http://example.com.evil-example.net`. Instead, use an explicit whitelist of allowed hosts to make the redirect secure:\n\n\n```javascript\napp.get('/some/path', function(req, res) {\n    let url = req.param('url'),\n        host = urlLib.parse(url).host;\n    // GOOD: the host of `url` can not be controlled by an attacker\n    let allowedHosts = [\n        'example.com',\n        'beta.example.com',\n        'www.example.com'\n    ];\n    if (allowedHosts.includes(host)) {\n        res.redirect(url);\n    }\n});\n\n```\n\n## References\n* OWASP: [SSRF](https://www.owasp.org/index.php/Server_Side_Request_Forgery)\n* OWASP: [XSS Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n",
            "markdown" : "# Incomplete URL substring sanitization\nSanitizing untrusted URLs is an important technique for preventing attacks such as request forgeries and malicious redirections. Usually, this is done by checking that the host of a URL is in a set of allowed hosts.\n\nHowever, treating the URL as a string and checking if one of the allowed hosts is a substring of the URL is very prone to errors. Malicious URLs can bypass such security checks by embedding one of the allowed hosts in an unexpected location.\n\nEven if the substring check is not used in a security-critical context, the incomplete check may still cause undesirable behaviors when the check succeeds accidentally.\n\n\n## Recommendation\nParse a URL before performing a check on its host value, and ensure that the check handles arbitrary subdomain sequences correctly.\n\n\n## Example\nThe following example code checks that a URL redirection will reach the `example.com` domain, or one of its subdomains, and not some malicious site.\n\n\n```javascript\napp.get('/some/path', function(req, res) {\n    let url = req.param(\"url\");\n    // BAD: the host of `url` may be controlled by an attacker\n    if (url.includes(\"example.com\")) {\n        res.redirect(url);\n    }\n});\n\n```\nThe substring check is, however, easy to bypass. For example by embedding `example.com` in the path component: `http://evil-example.net/example.com`, or in the query string component: `http://evil-example.net/?x=example.com`. Address these shortcomings by checking the host of the parsed URL instead:\n\n\n```javascript\napp.get('/some/path', function(req, res) {\n    let url = req.param(\"url\"),\n        host = urlLib.parse(url).host;\n    // BAD: the host of `url` may be controlled by an attacker\n    if (host.includes(\"example.com\")) {\n        res.redirect(url);\n    }\n});\n\n```\nThis is still not a sufficient check as the following URLs bypass it: `http://evil-example.com` `http://example.com.evil-example.net`. Instead, use an explicit whitelist of allowed hosts to make the redirect secure:\n\n\n```javascript\napp.get('/some/path', function(req, res) {\n    let url = req.param('url'),\n        host = urlLib.parse(url).host;\n    // GOOD: the host of `url` can not be controlled by an attacker\n    let allowedHosts = [\n        'example.com',\n        'beta.example.com',\n        'www.example.com'\n    ];\n    if (allowedHosts.includes(host)) {\n        res.redirect(url);\n    }\n});\n\n```\n\n## References\n* OWASP: [SSRF](https://www.owasp.org/index.php/Server_Side_Request_Forgery)\n* OWASP: [XSS Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-020" ],
            "description" : "Security checks on the substrings of an unparsed URL are often vulnerable to bypassing.",
            "id" : "js/incomplete-url-substring-sanitization",
            "kind" : "problem",
            "name" : "Incomplete URL substring sanitization",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/incorrect-suffix-check",
          "name" : "js/incorrect-suffix-check",
          "shortDescription" : {
            "text" : "Incorrect suffix check"
          },
          "fullDescription" : {
            "text" : "Using indexOf to implement endsWith functionality is error-prone if the -1 case is not explicitly handled."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Incorrect suffix check\nThe `indexOf` and `lastIndexOf` methods are sometimes used to check if a substring occurs at a certain position in a string. However, if the returned index is compared to an expression that might evaluate to -1, the check may pass in some cases where the substring was not found at all.\n\nSpecifically, this can easily happen when implementing `endsWith` using `indexOf`.\n\n\n## Recommendation\nUse `String.prototype.endsWith` if it is available. Otherwise, explicitly handle the -1 case, either by checking the relative lengths of the strings, or by checking if the returned index is -1.\n\n\n## Example\nThe following example uses `lastIndexOf` to determine if the string `x` ends with the string `y`:\n\n\n```javascript\nfunction endsWith(x, y) {\n  return x.lastIndexOf(y) === x.length - y.length;\n}\n\n```\nHowever, if `y` is one character longer than `x`, the right-hand side `x.length - y.length` becomes -1, which then equals the return value of `lastIndexOf`. This will make the test pass, even though `x` does not end with `y`.\n\nTo avoid this, explicitly check for the -1 case:\n\n\n```javascript\nfunction endsWith(x, y) {\n  let index = x.lastIndexOf(y);\n  return index !== -1 && index === x.length - y.length;\n}\n\n```\n\n## References\n* MDN: [String.prototype.endsWith](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith)\n* MDN: [String.prototype.indexOf](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/indexOf)\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n",
            "markdown" : "# Incorrect suffix check\nThe `indexOf` and `lastIndexOf` methods are sometimes used to check if a substring occurs at a certain position in a string. However, if the returned index is compared to an expression that might evaluate to -1, the check may pass in some cases where the substring was not found at all.\n\nSpecifically, this can easily happen when implementing `endsWith` using `indexOf`.\n\n\n## Recommendation\nUse `String.prototype.endsWith` if it is available. Otherwise, explicitly handle the -1 case, either by checking the relative lengths of the strings, or by checking if the returned index is -1.\n\n\n## Example\nThe following example uses `lastIndexOf` to determine if the string `x` ends with the string `y`:\n\n\n```javascript\nfunction endsWith(x, y) {\n  return x.lastIndexOf(y) === x.length - y.length;\n}\n\n```\nHowever, if `y` is one character longer than `x`, the right-hand side `x.length - y.length` becomes -1, which then equals the return value of `lastIndexOf`. This will make the test pass, even though `x` does not end with `y`.\n\nTo avoid this, explicitly check for the -1 case:\n\n\n```javascript\nfunction endsWith(x, y) {\n  let index = x.lastIndexOf(y);\n  return index !== -1 && index === x.length - y.length;\n}\n\n```\n\n## References\n* MDN: [String.prototype.endsWith](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith)\n* MDN: [String.prototype.indexOf](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/indexOf)\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "correctness", "external/cwe/cwe-020" ],
            "description" : "Using indexOf to implement endsWith functionality is error-prone if the -1 case is not explicitly handled.",
            "id" : "js/incorrect-suffix-check",
            "kind" : "problem",
            "name" : "Incorrect suffix check",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/overly-large-range",
          "name" : "js/overly-large-range",
          "shortDescription" : {
            "text" : "Overly permissive regular expression range"
          },
          "fullDescription" : {
            "text" : "Overly permissive regular expression ranges match a wider range of characters than intended. This may allow an attacker to bypass a filter or sanitizer."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Overly permissive regular expression range\nIt's easy to write a regular expression range that matches a wider range of characters than you intended. For example, `/[a-zA-z]/` matches all lowercase and all uppercase letters, as you would expect, but it also matches the characters: `` [ \\ ] ^ _ ` ``.\n\nAnother common problem is failing to escape the dash character in a regular expression. An unescaped dash is interpreted as part of a range. For example, in the character class `[a-zA-Z0-9%=.,-_]` the last character range matches the 55 characters between `,` and `_` (both included), which overlaps with the range `[0-9]` and is clearly not intended by the writer.\n\n\n## Recommendation\nAvoid any confusion about which characters are included in the range by writing unambiguous regular expressions. Always check that character ranges match only the expected characters.\n\n\n## Example\nThe following example code is intended to check whether a string is a valid 6 digit hex color.\n\n```javascript\n\nfunction isValidHexColor(color) {\n    return /^#[0-9a-fA-f]{6}$/i.test(color);\n}\n\n```\nHowever, the `A-f` range is overly large and matches every uppercase character. It would parse a \"color\" like `#XXYYZZ` as valid.\n\nThe fix is to use an uppercase `A-F` range instead.\n\n```javascript\n\nfunction isValidHexColor(color) {\n    return /^#[0-9A-F]{6}$/i.test(color);\n}\n\n```\n\n## References\n* GitHub Advisory Database: [CVE-2021-42740: Improper Neutralization of Special Elements used in a Command in Shell-quote](https://github.com/advisories/GHSA-g4rg-993r-mgx7)\n* wh0.github.io: [Exploiting CVE-2021-42740](https://wh0.github.io/2021/10/28/shell-quote-rce-exploiting.html)\n* Yosuke Ota: [no-obscure-range](https://ota-meshi.github.io/eslint-plugin-regexp/rules/no-obscure-range.html)\n* Paul Boyd: [The regex \\[,-.\\]](https://pboyd.io/posts/comma-dash-dot/)\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n",
            "markdown" : "# Overly permissive regular expression range\nIt's easy to write a regular expression range that matches a wider range of characters than you intended. For example, `/[a-zA-z]/` matches all lowercase and all uppercase letters, as you would expect, but it also matches the characters: `` [ \\ ] ^ _ ` ``.\n\nAnother common problem is failing to escape the dash character in a regular expression. An unescaped dash is interpreted as part of a range. For example, in the character class `[a-zA-Z0-9%=.,-_]` the last character range matches the 55 characters between `,` and `_` (both included), which overlaps with the range `[0-9]` and is clearly not intended by the writer.\n\n\n## Recommendation\nAvoid any confusion about which characters are included in the range by writing unambiguous regular expressions. Always check that character ranges match only the expected characters.\n\n\n## Example\nThe following example code is intended to check whether a string is a valid 6 digit hex color.\n\n```javascript\n\nfunction isValidHexColor(color) {\n    return /^#[0-9a-fA-f]{6}$/i.test(color);\n}\n\n```\nHowever, the `A-f` range is overly large and matches every uppercase character. It would parse a \"color\" like `#XXYYZZ` as valid.\n\nThe fix is to use an uppercase `A-F` range instead.\n\n```javascript\n\nfunction isValidHexColor(color) {\n    return /^#[0-9A-F]{6}$/i.test(color);\n}\n\n```\n\n## References\n* GitHub Advisory Database: [CVE-2021-42740: Improper Neutralization of Special Elements used in a Command in Shell-quote](https://github.com/advisories/GHSA-g4rg-993r-mgx7)\n* wh0.github.io: [Exploiting CVE-2021-42740](https://wh0.github.io/2021/10/28/shell-quote-rce-exploiting.html)\n* Yosuke Ota: [no-obscure-range](https://ota-meshi.github.io/eslint-plugin-regexp/rules/no-obscure-range.html)\n* Paul Boyd: [The regex \\[,-.\\]](https://pboyd.io/posts/comma-dash-dot/)\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-020" ],
            "description" : "Overly permissive regular expression ranges match a wider range of characters than intended.\n              This may allow an attacker to bypass a filter or sanitizer.",
            "id" : "js/overly-large-range",
            "kind" : "problem",
            "name" : "Overly permissive regular expression range",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "5.0"
          }
        }, {
          "id" : "js/useless-regexp-character-escape",
          "name" : "js/useless-regexp-character-escape",
          "shortDescription" : {
            "text" : "Useless regular-expression character escape"
          },
          "fullDescription" : {
            "text" : "Prepending a backslash to an ordinary character in a string does not have any effect, and may make regular expressions constructed from this string behave unexpectedly."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Useless regular-expression character escape\nWhen a character in a string literal or regular expression literal is preceded by a backslash, it is interpreted as part of an escape sequence. For example, the escape sequence `\\n` in a string literal corresponds to a single `newline` character, and not the `\\` and `n` characters. However, not all characters change meaning when used in an escape sequence. In this case, the backslash just makes the character appear to mean something else, and the backslash actually has no effect. For example, the escape sequence `\\k` in a string literal just means `k`. Such superfluous escape sequences are usually benign, and do not change the behavior of the program.\n\nThe set of characters that change meaning when in escape sequences is different for regular expression literals and string literals. This can be problematic when a regular expression literal is turned into a regular expression that is built from one or more string literals. The problem occurs when a regular expression escape sequence loses its special meaning in a string literal.\n\n\n## Recommendation\nEnsure that the right amount of backslashes is used when escaping characters in strings, template literals and regular expressions. Pay special attention to the number of backslashes when rewriting a regular expression as a string literal.\n\n\n## Example\nThe following example code checks that a string is `\"my-marker\"`, possibly surrounded by white space:\n\n\n```javascript\nlet regex = new RegExp('(^\\s*)my-marker(\\s*$)'),\n    isMyMarkerText = regex.test(text);\n\n```\nHowever, the check does not work properly for white space as the two `\\s` occurrences are semantically equivalent to just `s`, meaning that the check will succeed for strings like `\"smy-markers\"` instead of `\" my-marker \"`. Address these shortcomings by either using a regular expression literal (`/(^\\s*)my-marker(\\s*$)/`), or by adding extra backslashes (`'(^\\\\s*)my-marker(\\\\s*$)'`).\n\n\n## References\n* MDN: [Regular expression escape notation](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#Escaping)\n* MDN: [String escape notation](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#Escape_notation)\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n",
            "markdown" : "# Useless regular-expression character escape\nWhen a character in a string literal or regular expression literal is preceded by a backslash, it is interpreted as part of an escape sequence. For example, the escape sequence `\\n` in a string literal corresponds to a single `newline` character, and not the `\\` and `n` characters. However, not all characters change meaning when used in an escape sequence. In this case, the backslash just makes the character appear to mean something else, and the backslash actually has no effect. For example, the escape sequence `\\k` in a string literal just means `k`. Such superfluous escape sequences are usually benign, and do not change the behavior of the program.\n\nThe set of characters that change meaning when in escape sequences is different for regular expression literals and string literals. This can be problematic when a regular expression literal is turned into a regular expression that is built from one or more string literals. The problem occurs when a regular expression escape sequence loses its special meaning in a string literal.\n\n\n## Recommendation\nEnsure that the right amount of backslashes is used when escaping characters in strings, template literals and regular expressions. Pay special attention to the number of backslashes when rewriting a regular expression as a string literal.\n\n\n## Example\nThe following example code checks that a string is `\"my-marker\"`, possibly surrounded by white space:\n\n\n```javascript\nlet regex = new RegExp('(^\\s*)my-marker(\\s*$)'),\n    isMyMarkerText = regex.test(text);\n\n```\nHowever, the check does not work properly for white space as the two `\\s` occurrences are semantically equivalent to just `s`, meaning that the check will succeed for strings like `\"smy-markers\"` instead of `\" my-marker \"`. Address these shortcomings by either using a regular expression literal (`/(^\\s*)my-marker(\\s*$)/`), or by adding extra backslashes (`'(^\\\\s*)my-marker(\\\\s*$)'`).\n\n\n## References\n* MDN: [Regular expression escape notation](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#Escaping)\n* MDN: [String escape notation](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#Escape_notation)\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-020" ],
            "description" : "Prepending a backslash to an ordinary character in a string\n              does not have any effect, and may make regular expressions constructed from this string\n              behave unexpectedly.",
            "id" : "js/useless-regexp-character-escape",
            "kind" : "problem",
            "name" : "Useless regular-expression character escape",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/path-injection",
          "name" : "js/path-injection",
          "shortDescription" : {
            "text" : "Uncontrolled data used in path expression"
          },
          "fullDescription" : {
            "text" : "Accessing paths influenced by users can allow an attacker to access unexpected resources."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library like the `sanitize-filename` npm package, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use a whitelist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name which is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../etc/passwd\"` will result in the code reading the file located at `\"/home/user/../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords.\n\n\n```javascript\nvar fs = require('fs'),\n    http = require('http'),\n    url = require('url');\n\nvar server = http.createServer(function(req, res) {\n  let path = url.parse(req.url, true).query.path;\n\n  // BAD: This could read any file on the file system\n  res.write(fs.readFileSync(path));\n\n  // BAD: This could still read any file on the file system\n  res.write(fs.readFileSync(\"/home/user/\" + path));\n});\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [sanitize-filename](https://www.npmjs.com/package/sanitize-filename) package.\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n",
            "markdown" : "# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library like the `sanitize-filename` npm package, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use a whitelist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name which is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../etc/passwd\"` will result in the code reading the file located at `\"/home/user/../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords.\n\n\n```javascript\nvar fs = require('fs'),\n    http = require('http'),\n    url = require('url');\n\nvar server = http.createServer(function(req, res) {\n  let path = url.parse(req.url, true).query.path;\n\n  // BAD: This could read any file on the file system\n  res.write(fs.readFileSync(path));\n\n  // BAD: This could still read any file on the file system\n  res.write(fs.readFileSync(\"/home/user/\" + path));\n});\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [sanitize-filename](https://www.npmjs.com/package/sanitize-filename) package.\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-022", "external/cwe/cwe-023", "external/cwe/cwe-036", "external/cwe/cwe-073", "external/cwe/cwe-099" ],
            "description" : "Accessing paths influenced by users can allow an attacker to access\n              unexpected resources.",
            "id" : "js/path-injection",
            "kind" : "path-problem",
            "name" : "Uncontrolled data used in path expression",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/zipslip",
          "name" : "js/zipslip",
          "shortDescription" : {
            "text" : "Arbitrary file write during zip extraction (\"Zip Slip\")"
          },
          "fullDescription" : {
            "text" : "Extracting files from a malicious zip archive without validating that the destination file path is within the destination directory can cause files outside the destination directory to be overwritten."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Arbitrary file write during zip extraction (\"Zip Slip\")\nExtracting files from a malicious zip archive without validating that the destination file path is within the destination directory can cause files outside the destination directory to be overwritten, due to the possible presence of directory traversal elements (`..`) in archive paths.\n\nZip archives contain archive entries representing each file in the archive. These entries include a file path for the entry, but these file paths are not restricted and may contain unexpected special elements such as the directory traversal element (`..`). If these file paths are used to determine an output file to write the contents of the archive item to, then the file may be written to an unexpected location. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\nFor example, if a zip file contains a file entry `..\\sneaky-file`, and the zip file is extracted to the directory `c:\\output`, then naively combining the paths would result in an output file path of `c:\\output\\..\\sneaky-file`, which would cause the file to be written to `c:\\sneaky-file`.\n\n\n## Recommendation\nEnsure that output paths constructed from zip archive entries are validated to prevent writing files to unexpected locations.\n\nThe recommended way of writing an output file from a zip archive entry is to check that `\"..\"` does not occur in the path.\n\n\n## Example\nIn this example an archive is extracted without validating file paths. If `archive.zip` contained relative paths (for instance, if it were created by something like `zip archive.zip ../file.txt`) then executing this code could write to locations outside the destination directory.\n\n\n```javascript\nconst fs = require('fs');\nconst unzip = require('unzip');\n\nfs.createReadStream('archive.zip')\n  .pipe(unzip.Parse())\n  .on('entry', entry => {\n    const fileName = entry.path;\n    // BAD: This could write any file on the filesystem.\n    entry.pipe(fs.createWriteStream(fileName));\n  });\n\n```\nTo fix this vulnerability, we need to check that the path does not contain any `\"..\"` elements in it.\n\n\n```javascript\nconst fs = require('fs');\nconst unzip = require('unzip');\n\nfs.createReadStream('archive.zip')\n  .pipe(unzip.Parse())\n  .on('entry', entry => {\n    const fileName = entry.path;\n    // GOOD: ensures the path is safe to write to.\n    if (fileName.indexOf('..') == -1) {\n      entry.pipe(fs.createWriteStream(fileName));\n    }\n    else {\n      console.log('skipping bad path', fileName);\n    }\n  });\n\n```\n\n## References\n* Snyk: [Zip Slip Vulnerability](https://snyk.io/research/zip-slip-vulnerability).\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n",
            "markdown" : "# Arbitrary file write during zip extraction (\"Zip Slip\")\nExtracting files from a malicious zip archive without validating that the destination file path is within the destination directory can cause files outside the destination directory to be overwritten, due to the possible presence of directory traversal elements (`..`) in archive paths.\n\nZip archives contain archive entries representing each file in the archive. These entries include a file path for the entry, but these file paths are not restricted and may contain unexpected special elements such as the directory traversal element (`..`). If these file paths are used to determine an output file to write the contents of the archive item to, then the file may be written to an unexpected location. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\nFor example, if a zip file contains a file entry `..\\sneaky-file`, and the zip file is extracted to the directory `c:\\output`, then naively combining the paths would result in an output file path of `c:\\output\\..\\sneaky-file`, which would cause the file to be written to `c:\\sneaky-file`.\n\n\n## Recommendation\nEnsure that output paths constructed from zip archive entries are validated to prevent writing files to unexpected locations.\n\nThe recommended way of writing an output file from a zip archive entry is to check that `\"..\"` does not occur in the path.\n\n\n## Example\nIn this example an archive is extracted without validating file paths. If `archive.zip` contained relative paths (for instance, if it were created by something like `zip archive.zip ../file.txt`) then executing this code could write to locations outside the destination directory.\n\n\n```javascript\nconst fs = require('fs');\nconst unzip = require('unzip');\n\nfs.createReadStream('archive.zip')\n  .pipe(unzip.Parse())\n  .on('entry', entry => {\n    const fileName = entry.path;\n    // BAD: This could write any file on the filesystem.\n    entry.pipe(fs.createWriteStream(fileName));\n  });\n\n```\nTo fix this vulnerability, we need to check that the path does not contain any `\"..\"` elements in it.\n\n\n```javascript\nconst fs = require('fs');\nconst unzip = require('unzip');\n\nfs.createReadStream('archive.zip')\n  .pipe(unzip.Parse())\n  .on('entry', entry => {\n    const fileName = entry.path;\n    // GOOD: ensures the path is safe to write to.\n    if (fileName.indexOf('..') == -1) {\n      entry.pipe(fs.createWriteStream(fileName));\n    }\n    else {\n      console.log('skipping bad path', fileName);\n    }\n  });\n\n```\n\n## References\n* Snyk: [Zip Slip Vulnerability](https://snyk.io/research/zip-slip-vulnerability).\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-022" ],
            "description" : "Extracting files from a malicious zip archive without validating that the\n              destination file path is within the destination directory can cause files outside\n              the destination directory to be overwritten.",
            "id" : "js/zipslip",
            "kind" : "path-problem",
            "name" : "Arbitrary file write during zip extraction (\"Zip Slip\")",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/template-object-injection",
          "name" : "js/template-object-injection",
          "shortDescription" : {
            "text" : "Template Object Injection"
          },
          "fullDescription" : {
            "text" : "Instantiating a template using a user-controlled object is vulnerable to local file read and potential remote code execution."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Template Object Injection\nDirectly using user-controlled objects as arguments to template engines might allow an attacker to do local file reads or even remote code execution.\n\n\n## Recommendation\nAvoid using user-controlled objects as arguments to a template engine. Instead, construct the object explicitly with the specific properties needed by the template.\n\n\n## Example\nIn the example below a server uses the user-controlled `profile` object to render the `index` template.\n\n\n```javascript\nvar app = require('express')();\napp.set('view engine', 'hbs');\n\napp.post('/', function (req, res, next) {\n    var profile = req.body.profile;\n    res.render('index', profile);\n});\n```\nHowever, if an attacker adds a `layout` property to the `profile` object then the server will load the file specified by the `layout` property, thereby allowing an attacker to do local file reads.\n\nThe fix is to have the server construct the object, and only add the properties that are needed by the template.\n\n\n```javascript\nvar app = require('express')();\napp.set('view engine', 'hbs');\n\napp.post('/', function (req, res, next) {\n    var profile = req.body.profile;\n    res.render('index', {\n        name: profile.name,\n        location: profile.location\n    });\n});\n```\n\n## References\n* blog.shoebpatel.com: [The Secret Parameter, LFR, and Potential RCE in NodeJS Apps](https://blog.shoebpatel.com/2021/01/23/The-Secret-Parameter-LFR-and-Potential-RCE-in-NodeJS-Apps/).\n* cwe.mitre.org: [CWE-73: External Control of File Name or Path](https://cwe.mitre.org/data/definitions/73.html)\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n",
            "markdown" : "# Template Object Injection\nDirectly using user-controlled objects as arguments to template engines might allow an attacker to do local file reads or even remote code execution.\n\n\n## Recommendation\nAvoid using user-controlled objects as arguments to a template engine. Instead, construct the object explicitly with the specific properties needed by the template.\n\n\n## Example\nIn the example below a server uses the user-controlled `profile` object to render the `index` template.\n\n\n```javascript\nvar app = require('express')();\napp.set('view engine', 'hbs');\n\napp.post('/', function (req, res, next) {\n    var profile = req.body.profile;\n    res.render('index', profile);\n});\n```\nHowever, if an attacker adds a `layout` property to the `profile` object then the server will load the file specified by the `layout` property, thereby allowing an attacker to do local file reads.\n\nThe fix is to have the server construct the object, and only add the properties that are needed by the template.\n\n\n```javascript\nvar app = require('express')();\napp.set('view engine', 'hbs');\n\napp.post('/', function (req, res, next) {\n    var profile = req.body.profile;\n    res.render('index', {\n        name: profile.name,\n        location: profile.location\n    });\n});\n```\n\n## References\n* blog.shoebpatel.com: [The Secret Parameter, LFR, and Potential RCE in NodeJS Apps](https://blog.shoebpatel.com/2021/01/23/The-Secret-Parameter-LFR-and-Potential-RCE-in-NodeJS-Apps/).\n* cwe.mitre.org: [CWE-73: External Control of File Name or Path](https://cwe.mitre.org/data/definitions/73.html)\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-073", "external/cwe/cwe-094" ],
            "description" : "Instantiating a template using a user-controlled object is vulnerable to local file read and potential remote code execution.",
            "id" : "js/template-object-injection",
            "kind" : "path-problem",
            "name" : "Template Object Injection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "js/command-line-injection",
          "name" : "js/command-line-injection",
          "shortDescription" : {
            "text" : "Uncontrolled command line"
          },
          "fullDescription" : {
            "text" : "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Uncontrolled command line\nCode that passes user input directly to `require('child_process').exec`, or some other library routine that executes a command, allows the user to execute malicious code.\n\n\n## Recommendation\nIf possible, use hard-coded string literals to specify the command to run or library to load. Instead of passing the user input directly to the process or library function, examine the user input and then choose among hard-coded string literals.\n\nIf the applicable libraries or commands cannot be determined at compile time, then add code to verify that the user input string is safe before using it.\n\n\n## Example\nThe following example shows code that takes a shell script that can be changed maliciously by a user, and passes it straight to `child_process.exec` without examining it first.\n\n\n```javascript\nvar cp = require(\"child_process\"),\n    http = require('http'),\n    url = require('url');\n\nvar server = http.createServer(function(req, res) {\n    let cmd = url.parse(req.url, true).query.path;\n\n    cp.exec(cmd); // BAD\n});\n\n```\n\n## References\n* OWASP: [Command Injection](https://www.owasp.org/index.php/Command_Injection).\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-88](https://cwe.mitre.org/data/definitions/88.html).\n",
            "markdown" : "# Uncontrolled command line\nCode that passes user input directly to `require('child_process').exec`, or some other library routine that executes a command, allows the user to execute malicious code.\n\n\n## Recommendation\nIf possible, use hard-coded string literals to specify the command to run or library to load. Instead of passing the user input directly to the process or library function, examine the user input and then choose among hard-coded string literals.\n\nIf the applicable libraries or commands cannot be determined at compile time, then add code to verify that the user input string is safe before using it.\n\n\n## Example\nThe following example shows code that takes a shell script that can be changed maliciously by a user, and passes it straight to `child_process.exec` without examining it first.\n\n\n```javascript\nvar cp = require(\"child_process\"),\n    http = require('http'),\n    url = require('url');\n\nvar server = http.createServer(function(req, res) {\n    let cmd = url.parse(req.url, true).query.path;\n\n    cp.exec(cmd); // BAD\n});\n\n```\n\n## References\n* OWASP: [Command Injection](https://www.owasp.org/index.php/Command_Injection).\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-88](https://cwe.mitre.org/data/definitions/88.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-078", "external/cwe/cwe-088" ],
            "description" : "Using externally controlled strings in a command line may allow a malicious\n              user to change the meaning of the command.",
            "id" : "js/command-line-injection",
            "kind" : "path-problem",
            "name" : "Uncontrolled command line",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "js/shell-command-injection-from-environment",
          "name" : "js/shell-command-injection-from-environment",
          "shortDescription" : {
            "text" : "Shell command built from environment values"
          },
          "fullDescription" : {
            "text" : "Building a shell command string with values from the enclosing environment may cause subtle bugs or vulnerabilities."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Shell command built from environment values\nDynamically constructing a shell command with values from the local environment, such as file paths, may inadvertently change the meaning of the shell command. Such changes can occur when an environment value contains characters that the shell interprets in a special way, for instance quotes and spaces. This can result in the shell command misbehaving, or even allowing a malicious user to execute arbitrary commands on the system.\n\n\n## Recommendation\nIf possible, use hard-coded string literals to specify the shell command to run, and provide the dynamic arguments to the shell command separately to avoid interpretation by the shell.\n\nAlternatively, if the shell command must be constructed dynamically, then add code to ensure that special characters in environment values do not alter the shell command unexpectedly.\n\n\n## Example\nThe following example shows a dynamically constructed shell command that recursively removes a temporary directory that is located next to the currently executing JavaScript file. Such utilities are often found in custom build scripts.\n\n\n```javascript\nvar cp = require(\"child_process\"),\n  path = require(\"path\");\nfunction cleanupTemp() {\n  let cmd = \"rm -rf \" + path.join(__dirname, \"temp\");\n  cp.execSync(cmd); // BAD\n}\n\n```\nThe shell command will, however, fail to work as intended if the absolute path of the script's directory contains spaces. In that case, the shell command will interpret the absolute path as multiple paths, instead of a single path.\n\nFor instance, if the absolute path of the temporary directory is `/home/username/important project/temp`, then the shell command will recursively delete `/home/username/important` and `project/temp`, where the latter path gets resolved relative to the working directory of the JavaScript process.\n\nEven worse, although less likely, a malicious user could provide the path `/home/username/; cat /etc/passwd #/important project/temp` in order to execute the command `cat /etc/passwd`.\n\nTo avoid such potentially catastrophic behaviors, provide the directory as an argument that does not get interpreted by a shell:\n\n\n```javascript\nvar cp = require(\"child_process\"),\n  path = require(\"path\");\nfunction cleanupTemp() {\n  let cmd = \"rm\",\n    args = [\"-rf\", path.join(__dirname, \"temp\")];\n  cp.execFileSync(cmd, args); // GOOD\n}\n\n```\n\n## References\n* OWASP: [Command Injection](https://www.owasp.org/index.php/Command_Injection).\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-88](https://cwe.mitre.org/data/definitions/88.html).\n",
            "markdown" : "# Shell command built from environment values\nDynamically constructing a shell command with values from the local environment, such as file paths, may inadvertently change the meaning of the shell command. Such changes can occur when an environment value contains characters that the shell interprets in a special way, for instance quotes and spaces. This can result in the shell command misbehaving, or even allowing a malicious user to execute arbitrary commands on the system.\n\n\n## Recommendation\nIf possible, use hard-coded string literals to specify the shell command to run, and provide the dynamic arguments to the shell command separately to avoid interpretation by the shell.\n\nAlternatively, if the shell command must be constructed dynamically, then add code to ensure that special characters in environment values do not alter the shell command unexpectedly.\n\n\n## Example\nThe following example shows a dynamically constructed shell command that recursively removes a temporary directory that is located next to the currently executing JavaScript file. Such utilities are often found in custom build scripts.\n\n\n```javascript\nvar cp = require(\"child_process\"),\n  path = require(\"path\");\nfunction cleanupTemp() {\n  let cmd = \"rm -rf \" + path.join(__dirname, \"temp\");\n  cp.execSync(cmd); // BAD\n}\n\n```\nThe shell command will, however, fail to work as intended if the absolute path of the script's directory contains spaces. In that case, the shell command will interpret the absolute path as multiple paths, instead of a single path.\n\nFor instance, if the absolute path of the temporary directory is `/home/username/important project/temp`, then the shell command will recursively delete `/home/username/important` and `project/temp`, where the latter path gets resolved relative to the working directory of the JavaScript process.\n\nEven worse, although less likely, a malicious user could provide the path `/home/username/; cat /etc/passwd #/important project/temp` in order to execute the command `cat /etc/passwd`.\n\nTo avoid such potentially catastrophic behaviors, provide the directory as an argument that does not get interpreted by a shell:\n\n\n```javascript\nvar cp = require(\"child_process\"),\n  path = require(\"path\");\nfunction cleanupTemp() {\n  let cmd = \"rm\",\n    args = [\"-rf\", path.join(__dirname, \"temp\")];\n  cp.execFileSync(cmd, args); // GOOD\n}\n\n```\n\n## References\n* OWASP: [Command Injection](https://www.owasp.org/index.php/Command_Injection).\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-88](https://cwe.mitre.org/data/definitions/88.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-078", "external/cwe/cwe-088" ],
            "description" : "Building a shell command string with values from the enclosing\n              environment may cause subtle bugs or vulnerabilities.",
            "id" : "js/shell-command-injection-from-environment",
            "kind" : "path-problem",
            "name" : "Shell command built from environment values",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "6.3"
          }
        }, {
          "id" : "js/shell-command-constructed-from-input",
          "name" : "js/shell-command-constructed-from-input",
          "shortDescription" : {
            "text" : "Unsafe shell command constructed from library input"
          },
          "fullDescription" : {
            "text" : "Using externally controlled strings in a command line may allow a malicious user to change the meaning of the command."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Unsafe shell command constructed from library input\nDynamically constructing a shell command with inputs from exported functions may inadvertently change the meaning of the shell command. Clients using the exported function may use inputs containing characters that the shell interprets in a special way, for instance quotes and spaces. This can result in the shell command misbehaving, or even allowing a malicious user to execute arbitrary commands on the system.\n\n\n## Recommendation\nIf possible, provide the dynamic arguments to the shell as an array using a safe API such as `child_process.execFile` to avoid interpretation by the shell.\n\nAlternatively, if the shell command must be constructed dynamically, then add code to ensure that special characters do not alter the shell command unexpectedly.\n\n\n## Example\nThe following example shows a dynamically constructed shell command that downloads a file from a remote URL.\n\n\n```javascript\nvar cp = require(\"child_process\");\n\nmodule.exports = function download(path, callback) {\n  cp.exec(\"wget \" + path, callback);\n}\n\n```\nThe shell command will, however, fail to work as intended if the input contains spaces or other special characters interpreted in a special way by the shell.\n\nEven worse, a client might pass in user-controlled data, not knowing that the input is interpreted as a shell command. This could allow a malicious user to provide the input `http://example.org; cat /etc/passwd` in order to execute the command `cat /etc/passwd`.\n\nTo avoid such potentially catastrophic behaviors, provide the inputs from exported functions as an argument that does not get interpreted by a shell:\n\n\n```javascript\nvar cp = require(\"child_process\");\n\nmodule.exports = function download(path, callback) {\n  cp.execFile(\"wget\", [path], callback);\n}\n\n```\n\n## References\n* OWASP: [Command Injection](https://www.owasp.org/index.php/Command_Injection).\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-88](https://cwe.mitre.org/data/definitions/88.html).\n",
            "markdown" : "# Unsafe shell command constructed from library input\nDynamically constructing a shell command with inputs from exported functions may inadvertently change the meaning of the shell command. Clients using the exported function may use inputs containing characters that the shell interprets in a special way, for instance quotes and spaces. This can result in the shell command misbehaving, or even allowing a malicious user to execute arbitrary commands on the system.\n\n\n## Recommendation\nIf possible, provide the dynamic arguments to the shell as an array using a safe API such as `child_process.execFile` to avoid interpretation by the shell.\n\nAlternatively, if the shell command must be constructed dynamically, then add code to ensure that special characters do not alter the shell command unexpectedly.\n\n\n## Example\nThe following example shows a dynamically constructed shell command that downloads a file from a remote URL.\n\n\n```javascript\nvar cp = require(\"child_process\");\n\nmodule.exports = function download(path, callback) {\n  cp.exec(\"wget \" + path, callback);\n}\n\n```\nThe shell command will, however, fail to work as intended if the input contains spaces or other special characters interpreted in a special way by the shell.\n\nEven worse, a client might pass in user-controlled data, not knowing that the input is interpreted as a shell command. This could allow a malicious user to provide the input `http://example.org; cat /etc/passwd` in order to execute the command `cat /etc/passwd`.\n\nTo avoid such potentially catastrophic behaviors, provide the inputs from exported functions as an argument that does not get interpreted by a shell:\n\n\n```javascript\nvar cp = require(\"child_process\");\n\nmodule.exports = function download(path, callback) {\n  cp.execFile(\"wget\", [path], callback);\n}\n\n```\n\n## References\n* OWASP: [Command Injection](https://www.owasp.org/index.php/Command_Injection).\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-88](https://cwe.mitre.org/data/definitions/88.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-078", "external/cwe/cwe-088" ],
            "description" : "Using externally controlled strings in a command line may allow a malicious\n              user to change the meaning of the command.",
            "id" : "js/shell-command-constructed-from-input",
            "kind" : "path-problem",
            "name" : "Unsafe shell command constructed from library input",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.3"
          }
        }, {
          "id" : "js/unnecessary-use-of-cat",
          "name" : "js/unnecessary-use-of-cat",
          "shortDescription" : {
            "text" : "Unnecessary use of `cat` process"
          },
          "fullDescription" : {
            "text" : "Using the `cat` process to read a file is unnecessarily complex, inefficient, unportable, and can lead to subtle bugs, or even security vulnerabilities."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Unnecessary use of `cat` process\nUsing the unix command `cat` only to read a file is an unnecessarily complex way to achieve something that can be done in a simpler and safer manner using the Node.js `fs.readFile` API.\n\nThe use of `cat` for simple file reads leads to code that is unportable, inefficient, complex, and can lead to subtle bugs or even security vulnerabilities.\n\n\n## Recommendation\nUse `fs.readFile` or `fs.readFileSync` to read files from the file system.\n\n\n## Example\nThe following example shows code that reads a file using `cat`:\n\n\n```javascript\nvar child_process = require('child_process');\n\nmodule.exports = function (name) {\n    return child_process.execSync(\"cat \" + name).toString();\n};\n\n```\nThe code in the example will break if the input `name` contains special characters (including space). Additionally, it does not work on Windows and if the input is user-controlled, a command injection attack can happen.\n\nThe `fs.readFile` API should be used to avoid these potential issues:\n\n\n```javascript\nvar fs = require('fs');\n\nmodule.exports = function (name) {\n    return fs.readFileSync(name).toString();\n};\n\n```\n\n## References\n* OWASP: [Command Injection](https://www.owasp.org/index.php/Command_Injection).\n* Node.js: [File System API](https://nodejs.org/api/fs.html).\n* [The Useless Use of Cat Award](http://porkmail.org/era/unix/award.html#cat).\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n",
            "markdown" : "# Unnecessary use of `cat` process\nUsing the unix command `cat` only to read a file is an unnecessarily complex way to achieve something that can be done in a simpler and safer manner using the Node.js `fs.readFile` API.\n\nThe use of `cat` for simple file reads leads to code that is unportable, inefficient, complex, and can lead to subtle bugs or even security vulnerabilities.\n\n\n## Recommendation\nUse `fs.readFile` or `fs.readFileSync` to read files from the file system.\n\n\n## Example\nThe following example shows code that reads a file using `cat`:\n\n\n```javascript\nvar child_process = require('child_process');\n\nmodule.exports = function (name) {\n    return child_process.execSync(\"cat \" + name).toString();\n};\n\n```\nThe code in the example will break if the input `name` contains special characters (including space). Additionally, it does not work on Windows and if the input is user-controlled, a command injection attack can happen.\n\nThe `fs.readFile` API should be used to avoid these potential issues:\n\n\n```javascript\nvar fs = require('fs');\n\nmodule.exports = function (name) {\n    return fs.readFileSync(name).toString();\n};\n\n```\n\n## References\n* OWASP: [Command Injection](https://www.owasp.org/index.php/Command_Injection).\n* Node.js: [File System API](https://nodejs.org/api/fs.html).\n* [The Useless Use of Cat Award](http://porkmail.org/era/unix/award.html#cat).\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "maintainability", "external/cwe/cwe-078" ],
            "description" : "Using the  `cat` process to read a file is unnecessarily complex, inefficient, unportable, and can lead to subtle bugs, or even security vulnerabilities.",
            "id" : "js/unnecessary-use-of-cat",
            "kind" : "problem",
            "name" : "Unnecessary use of `cat` process",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.3"
          }
        }, {
          "id" : "js/xss-through-exception",
          "name" : "js/xss-through-exception",
          "shortDescription" : {
            "text" : "Exception text reinterpreted as HTML"
          },
          "fullDescription" : {
            "text" : "Reinterpreting text from an exception as HTML can lead to a cross-site scripting vulnerability."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Exception text reinterpreted as HTML\nDirectly writing error messages to a webpage without sanitization allows for a cross-site scripting vulnerability if parts of the error message can be influenced by a user.\n\n\n## Recommendation\nTo guard against cross-site scripting, consider using contextual output encoding/escaping before writing user input to the page, or one of the other solutions that are mentioned in the references.\n\n\n## Example\nThe following example shows an exception being written directly to the document, and this exception can potentially be influenced by the page URL, leaving the website vulnerable to cross-site scripting.\n\n\n```javascript\nfunction setLanguageOptions() {\n    var href = document.location.href,\n        deflt = href.substring(href.indexOf(\"default=\")+8);\n    \n    try {\n        var parsed = unknownParseFunction(deflt); \n    } catch(e) {\n        document.write(\"Had an error: \" + e + \".\");\n    }\n}\n\n```\n\n## Example\nThis second example shows an input being validated using the JSON schema validator `ajv`, and in case of an error, the error message is sent directly back in the response.\n\n\n```javascript\nimport express from 'express';\nimport Ajv from 'ajv';\n\nlet app = express();\nlet ajv = new Ajv();\n\najv.addSchema({type: 'object', additionalProperties: {type: 'number'}}, 'pollData');\n\napp.post('/polldata', (req, res) => {\n    if (!ajv.validate('pollData', req.body)) {\n        res.send(ajv.errorsText());\n    }\n});\n\n```\nThis is unsafe, because the error message can contain parts of the input. For example, the input `{'<img src=x onerror=alert(1)>': 'foo'}` will generate the error `data/<img src=x onerror=alert(1)> should be number`, causing reflected XSS.\n\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [DOM Based XSS](https://www.owasp.org/index.php/DOM_Based_XSS).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Exception text reinterpreted as HTML\nDirectly writing error messages to a webpage without sanitization allows for a cross-site scripting vulnerability if parts of the error message can be influenced by a user.\n\n\n## Recommendation\nTo guard against cross-site scripting, consider using contextual output encoding/escaping before writing user input to the page, or one of the other solutions that are mentioned in the references.\n\n\n## Example\nThe following example shows an exception being written directly to the document, and this exception can potentially be influenced by the page URL, leaving the website vulnerable to cross-site scripting.\n\n\n```javascript\nfunction setLanguageOptions() {\n    var href = document.location.href,\n        deflt = href.substring(href.indexOf(\"default=\")+8);\n    \n    try {\n        var parsed = unknownParseFunction(deflt); \n    } catch(e) {\n        document.write(\"Had an error: \" + e + \".\");\n    }\n}\n\n```\n\n## Example\nThis second example shows an input being validated using the JSON schema validator `ajv`, and in case of an error, the error message is sent directly back in the response.\n\n\n```javascript\nimport express from 'express';\nimport Ajv from 'ajv';\n\nlet app = express();\nlet ajv = new Ajv();\n\najv.addSchema({type: 'object', additionalProperties: {type: 'number'}}, 'pollData');\n\napp.post('/polldata', (req, res) => {\n    if (!ajv.validate('pollData', req.body)) {\n        res.send(ajv.errorsText());\n    }\n});\n\n```\nThis is unsafe, because the error message can contain parts of the input. For example, the input `{'<img src=x onerror=alert(1)>': 'foo'}` will generate the error `data/<img src=x onerror=alert(1)> should be number`, causing reflected XSS.\n\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [DOM Based XSS](https://www.owasp.org/index.php/DOM_Based_XSS).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079", "external/cwe/cwe-116" ],
            "description" : "Reinterpreting text from an exception as HTML\n              can lead to a cross-site scripting vulnerability.",
            "id" : "js/xss-through-exception",
            "kind" : "path-problem",
            "name" : "Exception text reinterpreted as HTML",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/reflected-xss",
          "name" : "js/reflected-xss",
          "shortDescription" : {
            "text" : "Reflected cross-site scripting"
          },
          "fullDescription" : {
            "text" : "Writing user input directly to an HTTP response allows for a cross-site scripting vulnerability."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Reflected cross-site scripting\nDirectly writing user input (for example, an HTTP request parameter) to an HTTP response without properly sanitizing the input first, allows for a cross-site scripting vulnerability.\n\nThis kind of vulnerability is also called *reflected* cross-site scripting, to distinguish it from other types of cross-site scripting.\n\n\n## Recommendation\nTo guard against cross-site scripting, consider using contextual output encoding/escaping before writing user input to the response, or one of the other solutions that are mentioned in the references.\n\n\n## Example\nThe following example code writes part of an HTTP request (which is controlled by the user) directly to the response. This leaves the website vulnerable to cross-site scripting.\n\n\n```javascript\nvar app = require('express')();\n\napp.get('/user/:id', function(req, res) {\n  if (!isValidUserId(req.params.id))\n    // BAD: a request parameter is incorporated without validation into the response\n    res.send(\"Unknown user: \" + req.params.id);\n  else\n    // TODO: do something exciting\n    ;\n});\n\n```\nSanitizing the user-controlled data prevents the vulnerability:\n\n\n```javascript\nvar escape = require('escape-html');\n\nvar app = require('express')();\n\napp.get('/user/:id', function(req, res) {\n  if (!isValidUserId(req.params.id))\n    // GOOD: request parameter is sanitized before incorporating it into the response\n    res.send(\"Unknown user: \" + escape(req.params.id));\n  else\n    // TODO: do something exciting\n    ;\n});\n\n```\n\n## References\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Reflected cross-site scripting\nDirectly writing user input (for example, an HTTP request parameter) to an HTTP response without properly sanitizing the input first, allows for a cross-site scripting vulnerability.\n\nThis kind of vulnerability is also called *reflected* cross-site scripting, to distinguish it from other types of cross-site scripting.\n\n\n## Recommendation\nTo guard against cross-site scripting, consider using contextual output encoding/escaping before writing user input to the response, or one of the other solutions that are mentioned in the references.\n\n\n## Example\nThe following example code writes part of an HTTP request (which is controlled by the user) directly to the response. This leaves the website vulnerable to cross-site scripting.\n\n\n```javascript\nvar app = require('express')();\n\napp.get('/user/:id', function(req, res) {\n  if (!isValidUserId(req.params.id))\n    // BAD: a request parameter is incorporated without validation into the response\n    res.send(\"Unknown user: \" + req.params.id);\n  else\n    // TODO: do something exciting\n    ;\n});\n\n```\nSanitizing the user-controlled data prevents the vulnerability:\n\n\n```javascript\nvar escape = require('escape-html');\n\nvar app = require('express')();\n\napp.get('/user/:id', function(req, res) {\n  if (!isValidUserId(req.params.id))\n    // GOOD: request parameter is sanitized before incorporating it into the response\n    res.send(\"Unknown user: \" + escape(req.params.id));\n  else\n    // TODO: do something exciting\n    ;\n});\n\n```\n\n## References\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079", "external/cwe/cwe-116" ],
            "description" : "Writing user input directly to an HTTP response allows for\n              a cross-site scripting vulnerability.",
            "id" : "js/reflected-xss",
            "kind" : "path-problem",
            "name" : "Reflected cross-site scripting",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/stored-xss",
          "name" : "js/stored-xss",
          "shortDescription" : {
            "text" : "Stored cross-site scripting"
          },
          "fullDescription" : {
            "text" : "Using uncontrolled stored values in HTML allows for a stored cross-site scripting vulnerability."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Stored cross-site scripting\nDirectly using uncontrolled stored value (for example, file names) to create HTML content without properly sanitizing the input first, allows for a cross-site scripting vulnerability.\n\nThis kind of vulnerability is also called *stored* cross-site scripting, to distinguish it from other types of cross-site scripting.\n\n\n## Recommendation\nTo guard against cross-site scripting, consider using contextual output encoding/escaping before using uncontrolled stored values to create HTML content, or one of the other solutions that are mentioned in the references.\n\n\n## Example\nThe following example code writes file names directly to a HTTP response. This leaves the website vulnerable to cross-site scripting, if an attacker can choose the file names on the disk.\n\n\n```javascript\nvar express = require('express'),\n    fs = require('fs');\n\nexpress().get('/list-directory', function(req, res) {\n    fs.readdir('/public', function (error, fileNames) {\n        var list = '<ul>';\n        fileNames.forEach(fileName => {\n            // BAD: `fileName` can contain HTML elements\n            list += '<li>' + fileName + '</li>';\n        });\n        list += '</ul>'\n        res.send(list);\n    });\n});\n\n```\nSanitizing the file names prevents the vulnerability:\n\n\n```javascript\nvar express = require('express'),\n    fs = require('fs'),\n    escape = require('escape-html');\n\nexpress().get('/list-directory', function(req, res) {\n    fs.readdir('/public', function (error, fileNames) {\n        var list = '<ul>';\n        fileNames.forEach(fileName => {\n            // GOOD: escaped `fileName` can not contain HTML elements\n            list += '<li>' + escape(fileName) + '</li>';\n        });\n        list += '</ul>'\n        res.send(list);\n    });\n});\n\n```\n\n## References\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Stored cross-site scripting\nDirectly using uncontrolled stored value (for example, file names) to create HTML content without properly sanitizing the input first, allows for a cross-site scripting vulnerability.\n\nThis kind of vulnerability is also called *stored* cross-site scripting, to distinguish it from other types of cross-site scripting.\n\n\n## Recommendation\nTo guard against cross-site scripting, consider using contextual output encoding/escaping before using uncontrolled stored values to create HTML content, or one of the other solutions that are mentioned in the references.\n\n\n## Example\nThe following example code writes file names directly to a HTTP response. This leaves the website vulnerable to cross-site scripting, if an attacker can choose the file names on the disk.\n\n\n```javascript\nvar express = require('express'),\n    fs = require('fs');\n\nexpress().get('/list-directory', function(req, res) {\n    fs.readdir('/public', function (error, fileNames) {\n        var list = '<ul>';\n        fileNames.forEach(fileName => {\n            // BAD: `fileName` can contain HTML elements\n            list += '<li>' + fileName + '</li>';\n        });\n        list += '</ul>'\n        res.send(list);\n    });\n});\n\n```\nSanitizing the file names prevents the vulnerability:\n\n\n```javascript\nvar express = require('express'),\n    fs = require('fs'),\n    escape = require('escape-html');\n\nexpress().get('/list-directory', function(req, res) {\n    fs.readdir('/public', function (error, fileNames) {\n        var list = '<ul>';\n        fileNames.forEach(fileName => {\n            // GOOD: escaped `fileName` can not contain HTML elements\n            list += '<li>' + escape(fileName) + '</li>';\n        });\n        list += '</ul>'\n        res.send(list);\n    });\n});\n\n```\n\n## References\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079", "external/cwe/cwe-116" ],
            "description" : "Using uncontrolled stored values in HTML allows for\n              a stored cross-site scripting vulnerability.",
            "id" : "js/stored-xss",
            "kind" : "path-problem",
            "name" : "Stored cross-site scripting",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/html-constructed-from-input",
          "name" : "js/html-constructed-from-input",
          "shortDescription" : {
            "text" : "Unsafe HTML constructed from library input"
          },
          "fullDescription" : {
            "text" : "Using externally controlled strings to construct HTML might allow a malicious user to perform a cross-site scripting attack."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Unsafe HTML constructed from library input\nWhen a library function dynamically constructs HTML in a potentially unsafe way, then it's important to document to clients of the library that the function should only be used with trusted inputs. If the function is not documented as being potentially unsafe, then a client may inadvertently use inputs containing unsafe HTML fragments, and thereby leave the client vulnerable to cross-site scripting attacks.\n\n\n## Recommendation\nDocument all library functions that can lead to cross-site scripting attacks, and guard against unsafe inputs where dynamic HTML construction is not intended.\n\n\n## Example\nThe following example has a library function that renders a boldface name by writing to the `innerHTML` property of an element.\n\n\n```javascript\nmodule.exports = function showBoldName(name) {\n  document.getElementById('name').innerHTML = \"<b>\" + name + \"</b>\";\n}\n\n```\nThis library function, however, does not escape unsafe HTML, and a client that calls the function with user-supplied input may be vulnerable to cross-site scripting attacks.\n\nThe library could either document that this function should not be used with unsafe inputs, or use safe APIs such as `innerText`.\n\n\n```javascript\nmodule.exports = function showBoldName(name) {\n  const bold = document.createElement('b');\n  bold.innerText = name;\n  document.getElementById('name').appendChild(bold);\n}\n\n```\nAlternatively, an HTML sanitizer can be used to remove unsafe content.\n\n\n```javascript\n\nconst striptags = require('striptags');\nmodule.exports = function showBoldName(name) {\n  document.getElementById('name').innerHTML = \"<b>\" + striptags(name) + \"</b>\";\n}\n\n```\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet).\n* OWASP [DOM Based XSS](https://www.owasp.org/index.php/DOM_Based_XSS).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Unsafe HTML constructed from library input\nWhen a library function dynamically constructs HTML in a potentially unsafe way, then it's important to document to clients of the library that the function should only be used with trusted inputs. If the function is not documented as being potentially unsafe, then a client may inadvertently use inputs containing unsafe HTML fragments, and thereby leave the client vulnerable to cross-site scripting attacks.\n\n\n## Recommendation\nDocument all library functions that can lead to cross-site scripting attacks, and guard against unsafe inputs where dynamic HTML construction is not intended.\n\n\n## Example\nThe following example has a library function that renders a boldface name by writing to the `innerHTML` property of an element.\n\n\n```javascript\nmodule.exports = function showBoldName(name) {\n  document.getElementById('name').innerHTML = \"<b>\" + name + \"</b>\";\n}\n\n```\nThis library function, however, does not escape unsafe HTML, and a client that calls the function with user-supplied input may be vulnerable to cross-site scripting attacks.\n\nThe library could either document that this function should not be used with unsafe inputs, or use safe APIs such as `innerText`.\n\n\n```javascript\nmodule.exports = function showBoldName(name) {\n  const bold = document.createElement('b');\n  bold.innerText = name;\n  document.getElementById('name').appendChild(bold);\n}\n\n```\nAlternatively, an HTML sanitizer can be used to remove unsafe content.\n\n\n```javascript\n\nconst striptags = require('striptags');\nmodule.exports = function showBoldName(name) {\n  document.getElementById('name').innerHTML = \"<b>\" + striptags(name) + \"</b>\";\n}\n\n```\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet).\n* OWASP [DOM Based XSS](https://www.owasp.org/index.php/DOM_Based_XSS).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079", "external/cwe/cwe-116" ],
            "description" : "Using externally controlled strings to construct HTML might allow a malicious\n              user to perform a cross-site scripting attack.",
            "id" : "js/html-constructed-from-input",
            "kind" : "path-problem",
            "name" : "Unsafe HTML constructed from library input",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/unsafe-jquery-plugin",
          "name" : "js/unsafe-jquery-plugin",
          "shortDescription" : {
            "text" : "Unsafe jQuery plugin"
          },
          "fullDescription" : {
            "text" : "A jQuery plugin that unintentionally constructs HTML from some of its options may be unsafe to use for clients."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Unsafe jQuery plugin\nLibrary plugins, such as those for the jQuery library, are often configurable through options provided by the clients of the plugin. Clients, however, do not know the implementation details of the plugin, so it is important to document the capabilities of each option. The documentation for the plugin options that the client is responsible for sanitizing is of particular importance. Otherwise, the plugin may write user input (for example, a URL query parameter) to a web page without properly sanitizing it first, which allows for a cross-site scripting vulnerability in the client application through dynamic HTML construction.\n\n\n## Recommendation\nDocument all options that can lead to cross-site scripting attacks, and guard against unsafe inputs where dynamic HTML construction is not intended.\n\n\n## Example\nThe following example shows a jQuery plugin that selects a DOM element, and copies its text content to another DOM element. The selection is performed by using the plugin option `sourceSelector` as a CSS selector.\n\n\n```javascript\njQuery.fn.copyText = function(options) {\n\t// BAD may evaluate `options.sourceSelector` as HTML\n\tvar source = jQuery(options.sourceSelector),\n\t    text = source.text();\n\tjQuery(this).text(text);\n}\n\n```\nThis is, however, not a safe plugin, since the call to `jQuery` interprets `sourceSelector` as HTML if it is a string that starts with `<`.\n\nInstead of documenting that the client is responsible for sanitizing `sourceSelector`, the plugin can use `jQuery.find` to always interpret `sourceSelector` as a CSS selector:\n\n\n```javascript\njQuery.fn.copyText = function(options) {\n\t// GOOD may not evaluate `options.sourceSelector` as HTML\n\tvar source = jQuery.find(options.sourceSelector),\n\t    text = source.text();\n\tjQuery(this).text(text);\n}\n\n```\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [DOM Based XSS](https://www.owasp.org/index.php/DOM_Based_XSS).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* jQuery: [Plugin creation](https://learn.jquery.com/plugins/basic-plugin-creation/).\n* Bootstrap: [XSS vulnerable bootstrap plugins](https://github.com/twbs/bootstrap/pull/27047).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Unsafe jQuery plugin\nLibrary plugins, such as those for the jQuery library, are often configurable through options provided by the clients of the plugin. Clients, however, do not know the implementation details of the plugin, so it is important to document the capabilities of each option. The documentation for the plugin options that the client is responsible for sanitizing is of particular importance. Otherwise, the plugin may write user input (for example, a URL query parameter) to a web page without properly sanitizing it first, which allows for a cross-site scripting vulnerability in the client application through dynamic HTML construction.\n\n\n## Recommendation\nDocument all options that can lead to cross-site scripting attacks, and guard against unsafe inputs where dynamic HTML construction is not intended.\n\n\n## Example\nThe following example shows a jQuery plugin that selects a DOM element, and copies its text content to another DOM element. The selection is performed by using the plugin option `sourceSelector` as a CSS selector.\n\n\n```javascript\njQuery.fn.copyText = function(options) {\n\t// BAD may evaluate `options.sourceSelector` as HTML\n\tvar source = jQuery(options.sourceSelector),\n\t    text = source.text();\n\tjQuery(this).text(text);\n}\n\n```\nThis is, however, not a safe plugin, since the call to `jQuery` interprets `sourceSelector` as HTML if it is a string that starts with `<`.\n\nInstead of documenting that the client is responsible for sanitizing `sourceSelector`, the plugin can use `jQuery.find` to always interpret `sourceSelector` as a CSS selector:\n\n\n```javascript\njQuery.fn.copyText = function(options) {\n\t// GOOD may not evaluate `options.sourceSelector` as HTML\n\tvar source = jQuery.find(options.sourceSelector),\n\t    text = source.text();\n\tjQuery(this).text(text);\n}\n\n```\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [DOM Based XSS](https://www.owasp.org/index.php/DOM_Based_XSS).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* jQuery: [Plugin creation](https://learn.jquery.com/plugins/basic-plugin-creation/).\n* Bootstrap: [XSS vulnerable bootstrap plugins](https://github.com/twbs/bootstrap/pull/27047).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079", "external/cwe/cwe-116", "frameworks/jquery" ],
            "description" : "A jQuery plugin that unintentionally constructs HTML from some of its options may be unsafe to use for clients.",
            "id" : "js/unsafe-jquery-plugin",
            "kind" : "path-problem",
            "name" : "Unsafe jQuery plugin",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/xss",
          "name" : "js/xss",
          "shortDescription" : {
            "text" : "Client-side cross-site scripting"
          },
          "fullDescription" : {
            "text" : "Writing user input directly to the DOM allows for a cross-site scripting vulnerability."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Client-side cross-site scripting\nDirectly writing user input (for example, a URL query parameter) to a webpage without properly sanitizing the input first, allows for a cross-site scripting vulnerability.\n\nThis kind of vulnerability is also called *DOM-based* cross-site scripting, to distinguish it from other types of cross-site scripting.\n\n\n## Recommendation\nTo guard against cross-site scripting, consider using contextual output encoding/escaping before writing user input to the page, or one of the other solutions that are mentioned in the references.\n\n\n## Example\nThe following example shows part of the page URL being written directly to the document, leaving the website vulnerable to cross-site scripting.\n\n\n```javascript\nfunction setLanguageOptions() {\n    var href = document.location.href,\n        deflt = href.substring(href.indexOf(\"default=\")+8);\n    document.write(\"<OPTION value=1>\"+deflt+\"</OPTION>\");\n    document.write(\"<OPTION value=2>English</OPTION>\");\n}\n\n```\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [DOM Based XSS](https://www.owasp.org/index.php/DOM_Based_XSS).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Client-side cross-site scripting\nDirectly writing user input (for example, a URL query parameter) to a webpage without properly sanitizing the input first, allows for a cross-site scripting vulnerability.\n\nThis kind of vulnerability is also called *DOM-based* cross-site scripting, to distinguish it from other types of cross-site scripting.\n\n\n## Recommendation\nTo guard against cross-site scripting, consider using contextual output encoding/escaping before writing user input to the page, or one of the other solutions that are mentioned in the references.\n\n\n## Example\nThe following example shows part of the page URL being written directly to the document, leaving the website vulnerable to cross-site scripting.\n\n\n```javascript\nfunction setLanguageOptions() {\n    var href = document.location.href,\n        deflt = href.substring(href.indexOf(\"default=\")+8);\n    document.write(\"<OPTION value=1>\"+deflt+\"</OPTION>\");\n    document.write(\"<OPTION value=2>English</OPTION>\");\n}\n\n```\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [DOM Based XSS](https://www.owasp.org/index.php/DOM_Based_XSS).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079", "external/cwe/cwe-116" ],
            "description" : "Writing user input directly to the DOM allows for\n              a cross-site scripting vulnerability.",
            "id" : "js/xss",
            "kind" : "path-problem",
            "name" : "Client-side cross-site scripting",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/xss-through-dom",
          "name" : "js/xss-through-dom",
          "shortDescription" : {
            "text" : "DOM text reinterpreted as HTML"
          },
          "fullDescription" : {
            "text" : "Reinterpreting text from the DOM as HTML can lead to a cross-site scripting vulnerability."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# DOM text reinterpreted as HTML\nExtracting text from a DOM node and interpreting it as HTML can lead to a cross-site scripting vulnerability.\n\nA webpage with this vulnerability reads text from the DOM, and afterwards adds the text as HTML to the DOM. Using text from the DOM as HTML effectively unescapes the text, and thereby invalidates any escaping done on the text. If an attacker is able to control the safe sanitized text, then this vulnerability can be exploited to perform a cross-site scripting attack.\n\n\n## Recommendation\nTo guard against cross-site scripting, consider using contextual output encoding/escaping before writing text to the page, or one of the other solutions that are mentioned in the References section below.\n\n\n## Example\nThe following example shows a webpage using a `data-target` attribute to select and manipulate a DOM element using the JQuery library. In the example, the `data-target` attribute is read into the `target` variable, and the `$` function is then supposed to use the `target` variable as a CSS selector to determine which element should be manipulated.\n\n\n```javascript\n$(\"button\").click(function () {\n    var target = $(this).attr(\"data-target\");\n    $(target).hide();\n});\n\n```\nHowever, if an attacker can control the `data-target` attribute, then the value of `target` can be used to cause the `$` function to execute arbitrary JavaScript.\n\nThe above vulnerability can be fixed by using `$.find` instead of `$`. The `$.find` function will only interpret `target` as a CSS selector and never as HTML, thereby preventing an XSS attack.\n\n\n```javascript\n$(\"button\").click(function () {\n    var target = $(this).attr(\"data-target\");\n\t$.find(target).hide();\n});\n\n```\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [DOM Based XSS](https://owasp.org/www-community/attacks/DOM_Based_XSS).\n* OWASP [Types of Cross-Site Scripting](https://owasp.org/www-community/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# DOM text reinterpreted as HTML\nExtracting text from a DOM node and interpreting it as HTML can lead to a cross-site scripting vulnerability.\n\nA webpage with this vulnerability reads text from the DOM, and afterwards adds the text as HTML to the DOM. Using text from the DOM as HTML effectively unescapes the text, and thereby invalidates any escaping done on the text. If an attacker is able to control the safe sanitized text, then this vulnerability can be exploited to perform a cross-site scripting attack.\n\n\n## Recommendation\nTo guard against cross-site scripting, consider using contextual output encoding/escaping before writing text to the page, or one of the other solutions that are mentioned in the References section below.\n\n\n## Example\nThe following example shows a webpage using a `data-target` attribute to select and manipulate a DOM element using the JQuery library. In the example, the `data-target` attribute is read into the `target` variable, and the `$` function is then supposed to use the `target` variable as a CSS selector to determine which element should be manipulated.\n\n\n```javascript\n$(\"button\").click(function () {\n    var target = $(this).attr(\"data-target\");\n    $(target).hide();\n});\n\n```\nHowever, if an attacker can control the `data-target` attribute, then the value of `target` can be used to cause the `$` function to execute arbitrary JavaScript.\n\nThe above vulnerability can be fixed by using `$.find` instead of `$`. The `$.find` function will only interpret `target` as a CSS selector and never as HTML, thereby preventing an XSS attack.\n\n\n```javascript\n$(\"button\").click(function () {\n    var target = $(this).attr(\"data-target\");\n\t$.find(target).hide();\n});\n\n```\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [DOM Based XSS](https://owasp.org/www-community/attacks/DOM_Based_XSS).\n* OWASP [Types of Cross-Site Scripting](https://owasp.org/www-community/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079", "external/cwe/cwe-116" ],
            "description" : "Reinterpreting text from the DOM as HTML\n              can lead to a cross-site scripting vulnerability.",
            "id" : "js/xss-through-dom",
            "kind" : "path-problem",
            "name" : "DOM text reinterpreted as HTML",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/sql-injection",
          "name" : "js/sql-injection",
          "shortDescription" : {
            "text" : "Database query built from user-controlled sources"
          },
          "fullDescription" : {
            "text" : "Building a database query from user-controlled sources is vulnerable to insertion of malicious code by the user."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Database query built from user-controlled sources\nIf a database query (such as a SQL or NoSQL query) is built from user-provided data without sufficient sanitization, a malicious user may be able to run malicious database queries.\n\n\n## Recommendation\nMost database connector libraries offer a way of safely embedding untrusted data into a query by means of query parameters or prepared statements.\n\nFor NoSQL queries, make use of an operator like MongoDB's `$eq` to ensure that untrusted data is interpreted as a literal value and not as a query object.\n\n\n## Example\nIn the following example, assume the function `handler` is an HTTP request handler in a web application, whose parameter `req` contains the request object.\n\nThe handler constructs two copies of the same SQL query involving user input taken from the request object, once unsafely using string concatenation, and once safely using query parameters.\n\nIn the first case, the query string `query1` is built by directly concatenating a user-supplied request parameter with some string literals. The parameter may include quote characters, so this code is vulnerable to a SQL injection attack.\n\nIn the second case, the parameter is embedded into the query string `query2` using query parameters. In this example, we use the API offered by the `pg` Postgres database connector library, but other libraries offer similar features. This version is immune to injection attacks.\n\n\n```javascript\nconst app = require(\"express\")(),\n      pg = require(\"pg\"),\n      pool = new pg.Pool(config);\n\napp.get(\"search\", function handler(req, res) {\n  // BAD: the category might have SQL special characters in it\n  var query1 =\n    \"SELECT ITEM,PRICE FROM PRODUCT WHERE ITEM_CATEGORY='\" +\n    req.params.category +\n    \"' ORDER BY PRICE\";\n  pool.query(query1, [], function(err, results) {\n    // process results\n  });\n\n  // GOOD: use parameters\n  var query2 =\n    \"SELECT ITEM,PRICE FROM PRODUCT WHERE ITEM_CATEGORY=$1\" + \" ORDER BY PRICE\";\n  pool.query(query2, [req.params.category], function(err, results) {\n    // process results\n  });\n});\n\n```\n\n## References\n* Wikipedia: [SQL injection](https://en.wikipedia.org/wiki/SQL_injection).\n* MongoDB: [$eq operator](https://docs.mongodb.com/manual/reference/operator/query/eq).\n* Common Weakness Enumeration: [CWE-89](https://cwe.mitre.org/data/definitions/89.html).\n* Common Weakness Enumeration: [CWE-90](https://cwe.mitre.org/data/definitions/90.html).\n* Common Weakness Enumeration: [CWE-943](https://cwe.mitre.org/data/definitions/943.html).\n",
            "markdown" : "# Database query built from user-controlled sources\nIf a database query (such as a SQL or NoSQL query) is built from user-provided data without sufficient sanitization, a malicious user may be able to run malicious database queries.\n\n\n## Recommendation\nMost database connector libraries offer a way of safely embedding untrusted data into a query by means of query parameters or prepared statements.\n\nFor NoSQL queries, make use of an operator like MongoDB's `$eq` to ensure that untrusted data is interpreted as a literal value and not as a query object.\n\n\n## Example\nIn the following example, assume the function `handler` is an HTTP request handler in a web application, whose parameter `req` contains the request object.\n\nThe handler constructs two copies of the same SQL query involving user input taken from the request object, once unsafely using string concatenation, and once safely using query parameters.\n\nIn the first case, the query string `query1` is built by directly concatenating a user-supplied request parameter with some string literals. The parameter may include quote characters, so this code is vulnerable to a SQL injection attack.\n\nIn the second case, the parameter is embedded into the query string `query2` using query parameters. In this example, we use the API offered by the `pg` Postgres database connector library, but other libraries offer similar features. This version is immune to injection attacks.\n\n\n```javascript\nconst app = require(\"express\")(),\n      pg = require(\"pg\"),\n      pool = new pg.Pool(config);\n\napp.get(\"search\", function handler(req, res) {\n  // BAD: the category might have SQL special characters in it\n  var query1 =\n    \"SELECT ITEM,PRICE FROM PRODUCT WHERE ITEM_CATEGORY='\" +\n    req.params.category +\n    \"' ORDER BY PRICE\";\n  pool.query(query1, [], function(err, results) {\n    // process results\n  });\n\n  // GOOD: use parameters\n  var query2 =\n    \"SELECT ITEM,PRICE FROM PRODUCT WHERE ITEM_CATEGORY=$1\" + \" ORDER BY PRICE\";\n  pool.query(query2, [req.params.category], function(err, results) {\n    // process results\n  });\n});\n\n```\n\n## References\n* Wikipedia: [SQL injection](https://en.wikipedia.org/wiki/SQL_injection).\n* MongoDB: [$eq operator](https://docs.mongodb.com/manual/reference/operator/query/eq).\n* Common Weakness Enumeration: [CWE-89](https://cwe.mitre.org/data/definitions/89.html).\n* Common Weakness Enumeration: [CWE-90](https://cwe.mitre.org/data/definitions/90.html).\n* Common Weakness Enumeration: [CWE-943](https://cwe.mitre.org/data/definitions/943.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-089", "external/cwe/cwe-090", "external/cwe/cwe-943" ],
            "description" : "Building a database query from user-controlled sources is vulnerable to insertion of\n              malicious code by the user.",
            "id" : "js/sql-injection",
            "kind" : "path-problem",
            "name" : "Database query built from user-controlled sources",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "js/code-injection",
          "name" : "js/code-injection",
          "shortDescription" : {
            "text" : "Code injection"
          },
          "fullDescription" : {
            "text" : "Interpreting unsanitized user input as code allows a malicious user arbitrary code execution."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Code injection\nDirectly evaluating user input (for example, an HTTP request parameter) as code without properly sanitizing the input first allows an attacker arbitrary code execution. This can occur when user input is treated as JavaScript, or passed to a framework which interprets it as an expression to be evaluated. Examples include AngularJS expressions or JQuery selectors.\n\n\n## Recommendation\nAvoid including user input in any expression which may be dynamically evaluated. If user input must be included, use context-specific escaping before including it. It is important that the correct escaping is used for the type of evaluation that will occur.\n\n\n## Example\nThe following example shows part of the page URL being evaluated as JavaScript code. This allows an attacker to provide JavaScript within the URL. If an attacker can persuade a user to click on a link to such a URL, the attacker can evaluate arbitrary JavaScript in the browser of the user to, for example, steal cookies containing session information.\n\n\n```javascript\neval(document.location.href.substring(document.location.href.indexOf(\"default=\")+8))\n\n```\nThe following example shows a Pug template being constructed from user input, allowing attackers to run arbitrary code via a payload such as `#{global.process.exit(1)}`.\n\n\n```javascript\nconst express = require('express')\nvar pug = require('pug');\nconst app = express()\n\napp.post('/', (req, res) => {\n    var input = req.query.username;\n    var template = `\ndoctype\nhtml\nhead\n    title= 'Hello world'\nbody\n    form(action='/' method='post')\n        input#name.form-control(type='text)\n        button.btn.btn-primary(type='submit') Submit\n    p Hello `+ input\n    var fn = pug.compile(template);\n    var html = fn();\n    res.send(html);\n})\n\n```\nBelow is an example of how to use a template engine without any risk of template injection. The user input is included via an interpolation expression `#{username}` whose value is provided as an option to the template, instead of being part of the template string itself:\n\n\n```javascript\nconst express = require('express')\nvar pug = require('pug');\nconst app = express()\n\napp.post('/', (req, res) => {\n    var input = req.query.username;\n    var template = `\ndoctype\nhtml\nhead\n    title= 'Hello world'\nbody\n    form(action='/' method='post')\n        input#name.form-control(type='text)\n        button.btn.btn-primary(type='submit') Submit\n    p Hello #{username}`\n    var fn = pug.compile(template);\n    var html = fn({username: input});\n    res.send(html);\n})\n\n```\n\n## References\n* OWASP: [Code Injection](https://www.owasp.org/index.php/Code_Injection).\n* Wikipedia: [Code Injection](https://en.wikipedia.org/wiki/Code_injection).\n* PortSwigger Research Blog: [Server-Side Template Injection](https://portswigger.net/research/server-side-template-injection).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n* Common Weakness Enumeration: [CWE-95](https://cwe.mitre.org/data/definitions/95.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Code injection\nDirectly evaluating user input (for example, an HTTP request parameter) as code without properly sanitizing the input first allows an attacker arbitrary code execution. This can occur when user input is treated as JavaScript, or passed to a framework which interprets it as an expression to be evaluated. Examples include AngularJS expressions or JQuery selectors.\n\n\n## Recommendation\nAvoid including user input in any expression which may be dynamically evaluated. If user input must be included, use context-specific escaping before including it. It is important that the correct escaping is used for the type of evaluation that will occur.\n\n\n## Example\nThe following example shows part of the page URL being evaluated as JavaScript code. This allows an attacker to provide JavaScript within the URL. If an attacker can persuade a user to click on a link to such a URL, the attacker can evaluate arbitrary JavaScript in the browser of the user to, for example, steal cookies containing session information.\n\n\n```javascript\neval(document.location.href.substring(document.location.href.indexOf(\"default=\")+8))\n\n```\nThe following example shows a Pug template being constructed from user input, allowing attackers to run arbitrary code via a payload such as `#{global.process.exit(1)}`.\n\n\n```javascript\nconst express = require('express')\nvar pug = require('pug');\nconst app = express()\n\napp.post('/', (req, res) => {\n    var input = req.query.username;\n    var template = `\ndoctype\nhtml\nhead\n    title= 'Hello world'\nbody\n    form(action='/' method='post')\n        input#name.form-control(type='text)\n        button.btn.btn-primary(type='submit') Submit\n    p Hello `+ input\n    var fn = pug.compile(template);\n    var html = fn();\n    res.send(html);\n})\n\n```\nBelow is an example of how to use a template engine without any risk of template injection. The user input is included via an interpolation expression `#{username}` whose value is provided as an option to the template, instead of being part of the template string itself:\n\n\n```javascript\nconst express = require('express')\nvar pug = require('pug');\nconst app = express()\n\napp.post('/', (req, res) => {\n    var input = req.query.username;\n    var template = `\ndoctype\nhtml\nhead\n    title= 'Hello world'\nbody\n    form(action='/' method='post')\n        input#name.form-control(type='text)\n        button.btn.btn-primary(type='submit') Submit\n    p Hello #{username}`\n    var fn = pug.compile(template);\n    var html = fn({username: input});\n    res.send(html);\n})\n\n```\n\n## References\n* OWASP: [Code Injection](https://www.owasp.org/index.php/Code_Injection).\n* Wikipedia: [Code Injection](https://en.wikipedia.org/wiki/Code_injection).\n* PortSwigger Research Blog: [Server-Side Template Injection](https://portswigger.net/research/server-side-template-injection).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n* Common Weakness Enumeration: [CWE-95](https://cwe.mitre.org/data/definitions/95.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-094", "external/cwe/cwe-095", "external/cwe/cwe-079", "external/cwe/cwe-116" ],
            "description" : "Interpreting unsanitized user input as code allows a malicious user arbitrary\n              code execution.",
            "id" : "js/code-injection",
            "kind" : "path-problem",
            "name" : "Code injection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "js/actions/command-injection",
          "name" : "js/actions/command-injection",
          "shortDescription" : {
            "text" : "Expression injection in Actions"
          },
          "fullDescription" : {
            "text" : "Using user-controlled GitHub Actions contexts like `run:` or `script:` may allow a malicious user to inject code into the GitHub action."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Expression injection in Actions\nUsing user-controlled input in GitHub Actions may lead to code injection in contexts like *run:* or *script:*.\n\nCode injection in GitHub Actions may allow an attacker to exfiltrate the temporary GitHub repository authorization token. The token might have write access to the repository, allowing an attacker to use the token to make changes to the repository.\n\n\n## Recommendation\nThe best practice to avoid code injection vulnerabilities in GitHub workflows is to set the untrusted input value of the expression to an intermediate environment variable.\n\nIt is also recommended to limit the permissions of any tokens used by a workflow such as the GITHUB_TOKEN.\n\n\n## Example\nThe following example lets a user inject an arbitrary shell command:\n\n\n```yaml\non: issue_comment\n\njobs:\n  echo-body:\n    runs-on: ubuntu-latest\n    steps:\n    - run: |\n        echo '${{ github.event.comment.body }}'\n```\nThe following example uses shell syntax to read the environment variable and will prevent the attack:\n\n\n```yaml\non: issue_comment\n\njobs:\n  echo-body:\n    runs-on: ubuntu-latest\n    steps:\n    - env:\n        BODY: ${{ github.event.issue.body }}\n      run: |\n        echo '$BODY'\n```\n\n## References\n* GitHub Security Lab Research: [Keeping your GitHub Actions and workflows secure: Untrusted input](https://securitylab.github.com/research/github-actions-untrusted-input).\n* GitHub Docs: [Security hardening for GitHub Actions](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions).\n* GitHub Docs: [Permissions for the GITHUB_TOKEN](https://docs.github.com/en/actions/security-guides/automatic-token-authentication#permissions-for-the-github_token).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n",
            "markdown" : "# Expression injection in Actions\nUsing user-controlled input in GitHub Actions may lead to code injection in contexts like *run:* or *script:*.\n\nCode injection in GitHub Actions may allow an attacker to exfiltrate the temporary GitHub repository authorization token. The token might have write access to the repository, allowing an attacker to use the token to make changes to the repository.\n\n\n## Recommendation\nThe best practice to avoid code injection vulnerabilities in GitHub workflows is to set the untrusted input value of the expression to an intermediate environment variable.\n\nIt is also recommended to limit the permissions of any tokens used by a workflow such as the GITHUB_TOKEN.\n\n\n## Example\nThe following example lets a user inject an arbitrary shell command:\n\n\n```yaml\non: issue_comment\n\njobs:\n  echo-body:\n    runs-on: ubuntu-latest\n    steps:\n    - run: |\n        echo '${{ github.event.comment.body }}'\n```\nThe following example uses shell syntax to read the environment variable and will prevent the attack:\n\n\n```yaml\non: issue_comment\n\njobs:\n  echo-body:\n    runs-on: ubuntu-latest\n    steps:\n    - env:\n        BODY: ${{ github.event.issue.body }}\n      run: |\n        echo '$BODY'\n```\n\n## References\n* GitHub Security Lab Research: [Keeping your GitHub Actions and workflows secure: Untrusted input](https://securitylab.github.com/research/github-actions-untrusted-input).\n* GitHub Docs: [Security hardening for GitHub Actions](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions).\n* GitHub Docs: [Permissions for the GITHUB_TOKEN](https://docs.github.com/en/actions/security-guides/automatic-token-authentication#permissions-for-the-github_token).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n"
          },
          "properties" : {
            "tags" : [ "actions", "security", "external/cwe/cwe-094" ],
            "description" : "Using user-controlled GitHub Actions contexts like `run:` or `script:` may allow a malicious\n              user to inject code into the GitHub action.",
            "id" : "js/actions/command-injection",
            "kind" : "problem",
            "name" : "Expression injection in Actions",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "js/bad-code-sanitization",
          "name" : "js/bad-code-sanitization",
          "shortDescription" : {
            "text" : "Improper code sanitization"
          },
          "fullDescription" : {
            "text" : "Escaping code as HTML does not provide protection against code injection."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Improper code sanitization\nUsing string concatenation to construct JavaScript code can be error-prone, or in the worst case, enable code injection if an input is constructed by an attacker.\n\n\n## Recommendation\nIf using `JSON.stringify` or an HTML sanitizer to sanitize a string inserted into JavaScript code, then make sure to perform additional sanitization or remove potentially dangerous characters.\n\n\n## Example\nThe example below constructs a function that assigns the number 42 to the property `key` on an object `obj`. However, if `key` contains `</script>`, then the generated code will break out of a `</script>` if inserted into a `</script>` tag.\n\n\n```javascript\nfunction createObjectWrite() {\n    const assignment = `obj[${JSON.stringify(key)}]=42`;\n    return `(function(){${assignment}})` // NOT OK\n}\n```\nThe issue has been fixed by escaping potentially dangerous characters, as shown below.\n\n\n```javascript\nconst charMap = {\n    '<': '\\\\u003C',\n    '>' : '\\\\u003E',\n    '/': '\\\\u002F',\n    '\\\\': '\\\\\\\\',\n    '\\b': '\\\\b',\n    '\\f': '\\\\f',\n    '\\n': '\\\\n',\n    '\\r': '\\\\r',\n    '\\t': '\\\\t',\n    '\\0': '\\\\0',\n    '\\u2028': '\\\\u2028',\n    '\\u2029': '\\\\u2029'\n};\n\nfunction escapeUnsafeChars(str) {\n    return str.replace(/[<>\\b\\f\\n\\r\\t\\0\\u2028\\u2029]/g, x => charMap[x])\n}\n\nfunction createObjectWrite() {\n    const assignment = `obj[${escapeUnsafeChars(JSON.stringify(key))}]=42`;\n    return `(function(){${assignment}})` // OK\n}\n```\n\n## References\n* OWASP: [Code Injection](https://www.owasp.org/index.php/Code_Injection).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Improper code sanitization\nUsing string concatenation to construct JavaScript code can be error-prone, or in the worst case, enable code injection if an input is constructed by an attacker.\n\n\n## Recommendation\nIf using `JSON.stringify` or an HTML sanitizer to sanitize a string inserted into JavaScript code, then make sure to perform additional sanitization or remove potentially dangerous characters.\n\n\n## Example\nThe example below constructs a function that assigns the number 42 to the property `key` on an object `obj`. However, if `key` contains `</script>`, then the generated code will break out of a `</script>` if inserted into a `</script>` tag.\n\n\n```javascript\nfunction createObjectWrite() {\n    const assignment = `obj[${JSON.stringify(key)}]=42`;\n    return `(function(){${assignment}})` // NOT OK\n}\n```\nThe issue has been fixed by escaping potentially dangerous characters, as shown below.\n\n\n```javascript\nconst charMap = {\n    '<': '\\\\u003C',\n    '>' : '\\\\u003E',\n    '/': '\\\\u002F',\n    '\\\\': '\\\\\\\\',\n    '\\b': '\\\\b',\n    '\\f': '\\\\f',\n    '\\n': '\\\\n',\n    '\\r': '\\\\r',\n    '\\t': '\\\\t',\n    '\\0': '\\\\0',\n    '\\u2028': '\\\\u2028',\n    '\\u2029': '\\\\u2029'\n};\n\nfunction escapeUnsafeChars(str) {\n    return str.replace(/[<>\\b\\f\\n\\r\\t\\0\\u2028\\u2029]/g, x => charMap[x])\n}\n\nfunction createObjectWrite() {\n    const assignment = `obj[${escapeUnsafeChars(JSON.stringify(key))}]=42`;\n    return `(function(){${assignment}})` // OK\n}\n```\n\n## References\n* OWASP: [Code Injection](https://www.owasp.org/index.php/Code_Injection).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-094", "external/cwe/cwe-079", "external/cwe/cwe-116" ],
            "description" : "Escaping code as HTML does not provide protection against code injection.",
            "id" : "js/bad-code-sanitization",
            "kind" : "path-problem",
            "name" : "Improper code sanitization",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/unsafe-dynamic-method-access",
          "name" : "js/unsafe-dynamic-method-access",
          "shortDescription" : {
            "text" : "Unsafe dynamic method access"
          },
          "fullDescription" : {
            "text" : "Invoking user-controlled methods on certain objects can lead to remote code execution."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Unsafe dynamic method access\nCalling a user-controlled method on certain objects can lead to invocation of unsafe functions, such as `eval` or the `Function` constructor. In particular, the global object contains the `eval` function, and any function object contains the `Function` constructor in its `constructor` property.\n\n\n## Recommendation\nAvoid invoking user-controlled methods on the global object or on any function object. Whitelist the permitted method names or change the type of object the methods are stored on.\n\n\n## Example\nIn the following example, a message from the document's parent frame can invoke the `play` or `pause` method. However, it can also invoke `eval`. A malicious website could embed the page in an iframe and execute arbitrary code by sending a message with the name `eval`.\n\n\n```javascript\n// API methods\nfunction play(data) {\n  // ...\n}\nfunction pause(data) {\n  // ...\n}\n\nwindow.addEventListener(\"message\", (ev) => {\n    let message = JSON.parse(ev.data);\n\n    // Let the parent frame call the 'play' or 'pause' function \n    window[message.name](message.payload);\n});\n\n```\nInstead of storing the API methods in the global scope, put them in an API object or Map. It is also good practice to prevent invocation of inherited methods like `toString` and `valueOf`.\n\n\n```javascript\n// API methods\nlet api = {\n  play: function(data) {\n    // ...\n  },\n  pause: function(data) {\n    // ...\n  }\n};\n\nwindow.addEventListener(\"message\", (ev) => {\n    let message = JSON.parse(ev.data);\n\n    // Let the parent frame call the 'play' or 'pause' function\n    if (!api.hasOwnProperty(message.name)) {\n      return;\n    }\n    api[message.name](message.payload);\n});\n\n```\n\n## References\n* OWASP: [Code Injection](https://www.owasp.org/index.php/Code_Injection).\n* MDN: [Global functions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects#Function_properties).\n* MDN: [Function constructor](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n",
            "markdown" : "# Unsafe dynamic method access\nCalling a user-controlled method on certain objects can lead to invocation of unsafe functions, such as `eval` or the `Function` constructor. In particular, the global object contains the `eval` function, and any function object contains the `Function` constructor in its `constructor` property.\n\n\n## Recommendation\nAvoid invoking user-controlled methods on the global object or on any function object. Whitelist the permitted method names or change the type of object the methods are stored on.\n\n\n## Example\nIn the following example, a message from the document's parent frame can invoke the `play` or `pause` method. However, it can also invoke `eval`. A malicious website could embed the page in an iframe and execute arbitrary code by sending a message with the name `eval`.\n\n\n```javascript\n// API methods\nfunction play(data) {\n  // ...\n}\nfunction pause(data) {\n  // ...\n}\n\nwindow.addEventListener(\"message\", (ev) => {\n    let message = JSON.parse(ev.data);\n\n    // Let the parent frame call the 'play' or 'pause' function \n    window[message.name](message.payload);\n});\n\n```\nInstead of storing the API methods in the global scope, put them in an API object or Map. It is also good practice to prevent invocation of inherited methods like `toString` and `valueOf`.\n\n\n```javascript\n// API methods\nlet api = {\n  play: function(data) {\n    // ...\n  },\n  pause: function(data) {\n    // ...\n  }\n};\n\nwindow.addEventListener(\"message\", (ev) => {\n    let message = JSON.parse(ev.data);\n\n    // Let the parent frame call the 'play' or 'pause' function\n    if (!api.hasOwnProperty(message.name)) {\n      return;\n    }\n    api[message.name](message.payload);\n});\n\n```\n\n## References\n* OWASP: [Code Injection](https://www.owasp.org/index.php/Code_Injection).\n* MDN: [Global functions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects#Function_properties).\n* MDN: [Function constructor](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-094" ],
            "description" : "Invoking user-controlled methods on certain objects can lead to remote code execution.",
            "id" : "js/unsafe-dynamic-method-access",
            "kind" : "path-problem",
            "name" : "Unsafe dynamic method access",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "js/client-exposed-cookie",
          "name" : "js/client-exposed-cookie",
          "shortDescription" : {
            "text" : "Sensitive server cookie exposed to the client"
          },
          "fullDescription" : {
            "text" : "Sensitive cookies set by a server can be read by the client if the `httpOnly` flag is not set."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Sensitive server cookie exposed to the client\nAuthentication cookies stored by a server can be accessed by a client if the `httpOnly` flag is not set.\n\nAn attacker that manages a cross-site scripting (XSS) attack can read the cookie and hijack the session.\n\n\n## Recommendation\nSet the `httpOnly` flag on all cookies that are not needed by the client.\n\n\n## Example\nThe following example stores an authentication token in a cookie that can be viewed by the client.\n\n\n```javascript\nconst http = require('http');\n\nconst server = http.createServer((req, res) => {\n    res.setHeader(\"Set-Cookie\", `authKey=${makeAuthkey()}`);\n    res.writeHead(200, { 'Content-Type': 'text/html' });\n    res.end('<h2>Hello world</h2>');\n});\n```\nTo force the cookie to be transmitted using SSL, set the `secure` attribute on the cookie.\n\n\n```javascript\nconst http = require('http');\n\nconst server = http.createServer((req, res) => {\n    res.setHeader(\"Set-Cookie\", `authKey=${makeAuthkey()}; secure; httpOnly`);\n    res.writeHead(200, { 'Content-Type': 'text/html' });\n    res.end('<h2>Hello world</h2>');\n});\n```\n\n## References\n* ExpressJS: [Use cookies securely](https://expressjs.com/en/advanced/best-practice-security.html#use-cookies-securely).\n* OWASP: [Set cookie flags appropriately](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#set-cookie-flags-appropriately).\n* Mozilla: [Set-Cookie](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie).\n* Common Weakness Enumeration: [CWE-1004](https://cwe.mitre.org/data/definitions/1004.html).\n",
            "markdown" : "# Sensitive server cookie exposed to the client\nAuthentication cookies stored by a server can be accessed by a client if the `httpOnly` flag is not set.\n\nAn attacker that manages a cross-site scripting (XSS) attack can read the cookie and hijack the session.\n\n\n## Recommendation\nSet the `httpOnly` flag on all cookies that are not needed by the client.\n\n\n## Example\nThe following example stores an authentication token in a cookie that can be viewed by the client.\n\n\n```javascript\nconst http = require('http');\n\nconst server = http.createServer((req, res) => {\n    res.setHeader(\"Set-Cookie\", `authKey=${makeAuthkey()}`);\n    res.writeHead(200, { 'Content-Type': 'text/html' });\n    res.end('<h2>Hello world</h2>');\n});\n```\nTo force the cookie to be transmitted using SSL, set the `secure` attribute on the cookie.\n\n\n```javascript\nconst http = require('http');\n\nconst server = http.createServer((req, res) => {\n    res.setHeader(\"Set-Cookie\", `authKey=${makeAuthkey()}; secure; httpOnly`);\n    res.writeHead(200, { 'Content-Type': 'text/html' });\n    res.end('<h2>Hello world</h2>');\n});\n```\n\n## References\n* ExpressJS: [Use cookies securely](https://expressjs.com/en/advanced/best-practice-security.html#use-cookies-securely).\n* OWASP: [Set cookie flags appropriately](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#set-cookie-flags-appropriately).\n* Mozilla: [Set-Cookie](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie).\n* Common Weakness Enumeration: [CWE-1004](https://cwe.mitre.org/data/definitions/1004.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-1004" ],
            "description" : "Sensitive cookies set by a server can be read by the client if the `httpOnly` flag is not set.",
            "id" : "js/client-exposed-cookie",
            "kind" : "problem",
            "name" : "Sensitive server cookie exposed to the client",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "5.0"
          }
        }, {
          "id" : "js/bad-tag-filter",
          "name" : "js/bad-tag-filter",
          "shortDescription" : {
            "text" : "Bad HTML filtering regexp"
          },
          "fullDescription" : {
            "text" : "Matching HTML tags using regular expressions is hard to do right, and can easily lead to security issues."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Bad HTML filtering regexp\nIt is possible to match some single HTML tags using regular expressions (parsing general HTML using regular expressions is impossible). However, if the regular expression is not written well it might be possible to circumvent it, which can lead to cross-site scripting or other security issues.\n\nSome of these mistakes are caused by browsers having very forgiving HTML parsers, and will often render invalid HTML containing syntax errors. Regular expressions that attempt to match HTML should also recognize tags containing such syntax errors.\n\n\n## Recommendation\nUse a well-tested sanitization or parser library if at all possible. These libraries are much more likely to handle corner cases correctly than a custom implementation.\n\n\n## Example\nThe following example attempts to filters out all `<script>` tags.\n\n\n```javascript\nfunction filterScript(html) {\n    var scriptRegex = /<script\\b[^>]*>([\\s\\S]*?)<\\/script>/gi;\n    var match;\n    while ((match = scriptRegex.exec(html)) !== null) {\n        html = html.replace(match[0], match[1]);\n    }\n    return html;\n}\n\n```\nThe above sanitizer does not filter out all `<script>` tags. Browsers will not only accept `</script>` as script end tags, but also tags such as `</script foo=\"bar\">` even though it is a parser error. This means that an attack string such as `<script>alert(1)</script foo=\"bar\">` will not be filtered by the function, and `alert(1)` will be executed by a browser if the string is rendered as HTML.\n\nOther corner cases include that HTML comments can end with `--!>`, and that HTML tag names can contain upper case characters.\n\n\n## References\n* Securitum: [The Curious Case of Copy &amp; Paste](https://research.securitum.com/the-curious-case-of-copy-paste/).\n* stackoverflow.com: [You can't parse \\[X\\]HTML with regex](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags#answer-1732454).\n* HTML Standard: [Comment end bang state](https://html.spec.whatwg.org/multipage/parsing.html#comment-end-bang-state).\n* stackoverflow.com: [Why aren't browsers strict about HTML?](https://stackoverflow.com/questions/25559999/why-arent-browsers-strict-about-html).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n* Common Weakness Enumeration: [CWE-80](https://cwe.mitre.org/data/definitions/80.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n* Common Weakness Enumeration: [CWE-184](https://cwe.mitre.org/data/definitions/184.html).\n* Common Weakness Enumeration: [CWE-185](https://cwe.mitre.org/data/definitions/185.html).\n* Common Weakness Enumeration: [CWE-186](https://cwe.mitre.org/data/definitions/186.html).\n",
            "markdown" : "# Bad HTML filtering regexp\nIt is possible to match some single HTML tags using regular expressions (parsing general HTML using regular expressions is impossible). However, if the regular expression is not written well it might be possible to circumvent it, which can lead to cross-site scripting or other security issues.\n\nSome of these mistakes are caused by browsers having very forgiving HTML parsers, and will often render invalid HTML containing syntax errors. Regular expressions that attempt to match HTML should also recognize tags containing such syntax errors.\n\n\n## Recommendation\nUse a well-tested sanitization or parser library if at all possible. These libraries are much more likely to handle corner cases correctly than a custom implementation.\n\n\n## Example\nThe following example attempts to filters out all `<script>` tags.\n\n\n```javascript\nfunction filterScript(html) {\n    var scriptRegex = /<script\\b[^>]*>([\\s\\S]*?)<\\/script>/gi;\n    var match;\n    while ((match = scriptRegex.exec(html)) !== null) {\n        html = html.replace(match[0], match[1]);\n    }\n    return html;\n}\n\n```\nThe above sanitizer does not filter out all `<script>` tags. Browsers will not only accept `</script>` as script end tags, but also tags such as `</script foo=\"bar\">` even though it is a parser error. This means that an attack string such as `<script>alert(1)</script foo=\"bar\">` will not be filtered by the function, and `alert(1)` will be executed by a browser if the string is rendered as HTML.\n\nOther corner cases include that HTML comments can end with `--!>`, and that HTML tag names can contain upper case characters.\n\n\n## References\n* Securitum: [The Curious Case of Copy &amp; Paste](https://research.securitum.com/the-curious-case-of-copy-paste/).\n* stackoverflow.com: [You can't parse \\[X\\]HTML with regex](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags#answer-1732454).\n* HTML Standard: [Comment end bang state](https://html.spec.whatwg.org/multipage/parsing.html#comment-end-bang-state).\n* stackoverflow.com: [Why aren't browsers strict about HTML?](https://stackoverflow.com/questions/25559999/why-arent-browsers-strict-about-html).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n* Common Weakness Enumeration: [CWE-80](https://cwe.mitre.org/data/definitions/80.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n* Common Weakness Enumeration: [CWE-184](https://cwe.mitre.org/data/definitions/184.html).\n* Common Weakness Enumeration: [CWE-185](https://cwe.mitre.org/data/definitions/185.html).\n* Common Weakness Enumeration: [CWE-186](https://cwe.mitre.org/data/definitions/186.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-020", "external/cwe/cwe-080", "external/cwe/cwe-116", "external/cwe/cwe-184", "external/cwe/cwe-185", "external/cwe/cwe-186" ],
            "description" : "Matching HTML tags using regular expressions is hard to do right, and can easily lead to security issues.",
            "id" : "js/bad-tag-filter",
            "kind" : "problem",
            "name" : "Bad HTML filtering regexp",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/double-escaping",
          "name" : "js/double-escaping",
          "shortDescription" : {
            "text" : "Double escaping or unescaping"
          },
          "fullDescription" : {
            "text" : "When escaping special characters using a meta-character like backslash or ampersand, the meta-character has to be escaped first to avoid double-escaping, and conversely it has to be unescaped last to avoid double-unescaping."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Double escaping or unescaping\nEscaping meta-characters in untrusted input is an important technique for preventing injection attacks such as cross-site scripting. One particular example of this is HTML entity encoding, where HTML special characters are replaced by HTML character entities to prevent them from being interpreted as HTML markup. For example, the less-than character is encoded as `&lt;` and the double-quote character as `&quot;`. Other examples include backslash-escaping for including untrusted data in string literals and percent-encoding for URI components.\n\nThe reverse process of replacing escape sequences with the characters they represent is known as unescaping.\n\nNote that the escape characters themselves (such as ampersand in the case of HTML encoding) play a special role during escaping and unescaping: they are themselves escaped, but also form part of the escaped representations of other characters. Hence care must be taken to avoid double escaping and unescaping: when escaping, the escape character must be escaped first, when unescaping it has to be unescaped last.\n\nIf used in the context of sanitization, double unescaping may render the sanitization ineffective. Even if it is not used in a security-critical context, it may still result in confusing or garbled output.\n\n\n## Recommendation\nUse a (well-tested) sanitization library if at all possible. These libraries are much more likely to handle corner cases correctly than a custom implementation. For URI encoding, you can use the standard `encodeURIComponent` and `decodeURIComponent` functions.\n\nOtherwise, make sure to always escape the escape character first, and unescape it last.\n\n\n## Example\nThe following example shows a pair of hand-written HTML encoding and decoding functions:\n\n\n```javascript\nmodule.exports.encode = function(s) {\n  return s.replace(/&/g, \"&amp;\")\n          .replace(/\"/g, \"&quot;\")\n          .replace(/'/g, \"&apos;\");\n};\n\nmodule.exports.decode = function(s) {\n  return s.replace(/&amp;/g, \"&\")\n          .replace(/&quot;/g, \"\\\"\")\n          .replace(/&apos;/g, \"'\");\n};\n\n```\nThe encoding function correctly handles ampersand before the other characters. For example, the string `me & \"you\"` is encoded as `me &amp; &quot;you&quot;`, and the string `&quot;` is encoded as `&amp;quot;`.\n\nThe decoding function, however, incorrectly decodes `&amp;` into `&` before handling the other characters. So while it correctly decodes the first example above, it decodes the second example (`&amp;quot;`) to `\"` (a single double quote), which is not correct.\n\nInstead, the decoding function should decode the ampersand last:\n\n\n```javascript\nmodule.exports.encode = function(s) {\n  return s.replace(/&/g, \"&amp;\")\n          .replace(/\"/g, \"&quot;\")\n          .replace(/'/g, \"&apos;\");\n};\n\nmodule.exports.decode = function(s) {\n  return s.replace(/&quot;/g, \"\\\"\")\n          .replace(/&apos;/g, \"'\")\n          .replace(/&amp;/g, \"&\");\n};\n\n```\n\n## References\n* OWASP Top 10: [A1 Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection).\n* npm: [html-entities](https://www.npmjs.com/package/html-entities) package.\n* npm: [js-string-escape](https://www.npmjs.com/package/js-string-escape) package.\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n",
            "markdown" : "# Double escaping or unescaping\nEscaping meta-characters in untrusted input is an important technique for preventing injection attacks such as cross-site scripting. One particular example of this is HTML entity encoding, where HTML special characters are replaced by HTML character entities to prevent them from being interpreted as HTML markup. For example, the less-than character is encoded as `&lt;` and the double-quote character as `&quot;`. Other examples include backslash-escaping for including untrusted data in string literals and percent-encoding for URI components.\n\nThe reverse process of replacing escape sequences with the characters they represent is known as unescaping.\n\nNote that the escape characters themselves (such as ampersand in the case of HTML encoding) play a special role during escaping and unescaping: they are themselves escaped, but also form part of the escaped representations of other characters. Hence care must be taken to avoid double escaping and unescaping: when escaping, the escape character must be escaped first, when unescaping it has to be unescaped last.\n\nIf used in the context of sanitization, double unescaping may render the sanitization ineffective. Even if it is not used in a security-critical context, it may still result in confusing or garbled output.\n\n\n## Recommendation\nUse a (well-tested) sanitization library if at all possible. These libraries are much more likely to handle corner cases correctly than a custom implementation. For URI encoding, you can use the standard `encodeURIComponent` and `decodeURIComponent` functions.\n\nOtherwise, make sure to always escape the escape character first, and unescape it last.\n\n\n## Example\nThe following example shows a pair of hand-written HTML encoding and decoding functions:\n\n\n```javascript\nmodule.exports.encode = function(s) {\n  return s.replace(/&/g, \"&amp;\")\n          .replace(/\"/g, \"&quot;\")\n          .replace(/'/g, \"&apos;\");\n};\n\nmodule.exports.decode = function(s) {\n  return s.replace(/&amp;/g, \"&\")\n          .replace(/&quot;/g, \"\\\"\")\n          .replace(/&apos;/g, \"'\");\n};\n\n```\nThe encoding function correctly handles ampersand before the other characters. For example, the string `me & \"you\"` is encoded as `me &amp; &quot;you&quot;`, and the string `&quot;` is encoded as `&amp;quot;`.\n\nThe decoding function, however, incorrectly decodes `&amp;` into `&` before handling the other characters. So while it correctly decodes the first example above, it decodes the second example (`&amp;quot;`) to `\"` (a single double quote), which is not correct.\n\nInstead, the decoding function should decode the ampersand last:\n\n\n```javascript\nmodule.exports.encode = function(s) {\n  return s.replace(/&/g, \"&amp;\")\n          .replace(/\"/g, \"&quot;\")\n          .replace(/'/g, \"&apos;\");\n};\n\nmodule.exports.decode = function(s) {\n  return s.replace(/&quot;/g, \"\\\"\")\n          .replace(/&apos;/g, \"'\")\n          .replace(/&amp;/g, \"&\");\n};\n\n```\n\n## References\n* OWASP Top 10: [A1 Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection).\n* npm: [html-entities](https://www.npmjs.com/package/html-entities) package.\n* npm: [js-string-escape](https://www.npmjs.com/package/js-string-escape) package.\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-116", "external/cwe/cwe-020" ],
            "description" : "When escaping special characters using a meta-character like backslash or\n              ampersand, the meta-character has to be escaped first to avoid double-escaping,\n              and conversely it has to be unescaped last to avoid double-unescaping.",
            "id" : "js/double-escaping",
            "kind" : "problem",
            "name" : "Double escaping or unescaping",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/incomplete-html-attribute-sanitization",
          "name" : "js/incomplete-html-attribute-sanitization",
          "shortDescription" : {
            "text" : "Incomplete HTML attribute sanitization"
          },
          "fullDescription" : {
            "text" : "Writing incompletely sanitized values to HTML attribute strings can lead to a cross-site scripting vulnerability."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Incomplete HTML attribute sanitization\nSanitizing untrusted input for HTML meta-characters is a common technique for preventing cross-site scripting attacks. Usually, this is done by escaping `<`, `>`, `&` and `\"`. However, the context in which the sanitized value is used decides the characters that need to be sanitized.\n\nAs a consequence, some programs only sanitize `<` and `>` since those are the most common dangerous characters. The lack of sanitization for `\"` is problematic when an incompletely sanitized value is used as an HTML attribute in a string that later is parsed as HTML.\n\n\n## Recommendation\nSanitize all relevant HTML meta-characters when constructing HTML dynamically, and pay special attention to where the sanitized value is used.\n\nAn even safer alternative is to design the application so that sanitization is not needed, for instance by using HTML templates that are explicit about the values they treat as HTML.\n\n\n## Example\nThe following example code writes part of an HTTP request (which is controlled by the user) to an HTML attribute of the server response. The user-controlled value is, however, not sanitized for `\"`. This leaves the website vulnerable to cross-site scripting since an attacker can use a string like `\" onclick=\"alert(42)` to inject JavaScript code into the response.\n\n\n```javascript\nvar app = require('express')();\n\napp.get('/user/:id', function(req, res) {\n\tlet id = req.params.id;\n\tid = id.replace(/<|>/g, \"\"); // BAD\n\tlet userHtml = `<div data-id=\"${id}\">${getUserName(id) || \"Unknown name\"}</div>`;\n\t// ...\n\tres.send(prefix + userHtml + suffix);\n});\n\n```\nSanitizing the user-controlled data for `\"` helps prevent the vulnerability:\n\n\n```javascript\nvar app = require('express')();\n\napp.get('/user/:id', function(req, res) {\n\tlet id = req.params.id;\n\tid = id.replace(/<|>|&|\"/g, \"\"); // GOOD\n\tlet userHtml = `<div data-id=\"${id}\">${getUserName(id) || \"Unknown name\"}</div>`;\n\t// ...\n\tres.send(prefix + userHtml + suffix);\n});\n\n```\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [Types of Cross-Site](https://owasp.org/www-community/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n",
            "markdown" : "# Incomplete HTML attribute sanitization\nSanitizing untrusted input for HTML meta-characters is a common technique for preventing cross-site scripting attacks. Usually, this is done by escaping `<`, `>`, `&` and `\"`. However, the context in which the sanitized value is used decides the characters that need to be sanitized.\n\nAs a consequence, some programs only sanitize `<` and `>` since those are the most common dangerous characters. The lack of sanitization for `\"` is problematic when an incompletely sanitized value is used as an HTML attribute in a string that later is parsed as HTML.\n\n\n## Recommendation\nSanitize all relevant HTML meta-characters when constructing HTML dynamically, and pay special attention to where the sanitized value is used.\n\nAn even safer alternative is to design the application so that sanitization is not needed, for instance by using HTML templates that are explicit about the values they treat as HTML.\n\n\n## Example\nThe following example code writes part of an HTTP request (which is controlled by the user) to an HTML attribute of the server response. The user-controlled value is, however, not sanitized for `\"`. This leaves the website vulnerable to cross-site scripting since an attacker can use a string like `\" onclick=\"alert(42)` to inject JavaScript code into the response.\n\n\n```javascript\nvar app = require('express')();\n\napp.get('/user/:id', function(req, res) {\n\tlet id = req.params.id;\n\tid = id.replace(/<|>/g, \"\"); // BAD\n\tlet userHtml = `<div data-id=\"${id}\">${getUserName(id) || \"Unknown name\"}</div>`;\n\t// ...\n\tres.send(prefix + userHtml + suffix);\n});\n\n```\nSanitizing the user-controlled data for `\"` helps prevent the vulnerability:\n\n\n```javascript\nvar app = require('express')();\n\napp.get('/user/:id', function(req, res) {\n\tlet id = req.params.id;\n\tid = id.replace(/<|>|&|\"/g, \"\"); // GOOD\n\tlet userHtml = `<div data-id=\"${id}\">${getUserName(id) || \"Unknown name\"}</div>`;\n\t// ...\n\tres.send(prefix + userHtml + suffix);\n});\n\n```\n\n## References\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [Types of Cross-Site](https://owasp.org/www-community/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079", "external/cwe/cwe-116", "external/cwe/cwe-020" ],
            "description" : "Writing incompletely sanitized values to HTML\n              attribute strings can lead to a cross-site\n              scripting vulnerability.",
            "id" : "js/incomplete-html-attribute-sanitization",
            "kind" : "path-problem",
            "name" : "Incomplete HTML attribute sanitization",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/incomplete-multi-character-sanitization",
          "name" : "js/incomplete-multi-character-sanitization",
          "shortDescription" : {
            "text" : "Incomplete multi-character sanitization"
          },
          "fullDescription" : {
            "text" : "A sanitizer that removes a sequence of characters may reintroduce the dangerous sequence."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Incomplete multi-character sanitization\nSanitizing untrusted input is a common technique for preventing injection attacks such as SQL injection or cross-site scripting. Usually, this is done by escaping meta-characters such as quotes in a domain-specific way so that they are treated as normal characters.\n\nHowever, directly using the string `replace` method to perform escaping is notoriously error-prone. Common mistakes include only replacing the first occurrence of a meta-character, or backslash-escaping various meta-characters but not the backslash itself.\n\nIn the former case, later meta-characters are left undisturbed and can be used to subvert the sanitization. In the latter case, preceding a meta-character with a backslash leads to the backslash being escaped, but the meta-character appearing un-escaped, which again makes the sanitization ineffective.\n\nEven if the escaped string is not used in a security-critical context, incomplete escaping may still have undesirable effects, such as badly rendered or confusing output.\n\n\n## Recommendation\nUse a (well-tested) sanitization library if at all possible. These libraries are much more likely to handle corner cases correctly than a custom implementation.\n\nAn even safer alternative is to design the application so that sanitization is not needed, for instance by using prepared statements for SQL queries.\n\nOtherwise, make sure to use a regular expression with the `g` flag to ensure that all occurrences are replaced, and remember to escape backslashes if applicable.\n\nNote, however, that this is generally *not* sufficient for replacing multi-character strings: the `String.prototype.replace` method only performs one pass over the input string, and will not replace further instances of the string that result from earlier replacements.\n\nFor example, consider the code snippet `s.replace(/\\/\\.\\.\\//g, \"\")`, which attempts to strip out all occurences of `/../` from `s`. This will not work as expected: for the string `/./.././`, for example, it will remove the single occurrence of `/../` in the middle, but the remainder of the string then becomes `/../`, which is another instance of the substring we were trying to remove.\n\n\n## Example\nFor example, assume that we want to embed a user-controlled string `accountNumber` into a SQL query as part of a string literal. To avoid SQL injection, we need to ensure that the string does not contain un-escaped single-quote characters. The following function attempts to ensure this by doubling single quotes, and thereby escaping them:\n\n\n```javascript\nfunction escapeQuotes(s) {\n  return s.replace(\"'\", \"''\");\n}\n\n```\nAs written, this sanitizer is ineffective: if the first argument to `replace` is a string literal (as in this case), only the *first* occurrence of that string is replaced.\n\nAs mentioned above, the function `escapeQuotes` should be replaced with a purpose-built sanitization library, such as the npm module `sqlstring`. Many other sanitization libraries are available from npm and other sources.\n\nIf this is not an option, `escapeQuotes` should be rewritten to use a regular expression with the `g` (\"global\") flag instead:\n\n\n```javascript\nfunction escapeQuotes(s) {\n  return s.replace(/'/g, \"''\");\n}\n\n```\nNote that it is very important to include the global flag: `s.replace(/'/, \"''\")` *without* the global flag is equivalent to the first example above and only replaces the first quote.\n\n\n## References\n* OWASP Top 10: [A1 Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection).\n* npm: [sqlstring](https://www.npmjs.com/package/sqlstring) package.\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n* Common Weakness Enumeration: [CWE-80](https://cwe.mitre.org/data/definitions/80.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Incomplete multi-character sanitization\nSanitizing untrusted input is a common technique for preventing injection attacks such as SQL injection or cross-site scripting. Usually, this is done by escaping meta-characters such as quotes in a domain-specific way so that they are treated as normal characters.\n\nHowever, directly using the string `replace` method to perform escaping is notoriously error-prone. Common mistakes include only replacing the first occurrence of a meta-character, or backslash-escaping various meta-characters but not the backslash itself.\n\nIn the former case, later meta-characters are left undisturbed and can be used to subvert the sanitization. In the latter case, preceding a meta-character with a backslash leads to the backslash being escaped, but the meta-character appearing un-escaped, which again makes the sanitization ineffective.\n\nEven if the escaped string is not used in a security-critical context, incomplete escaping may still have undesirable effects, such as badly rendered or confusing output.\n\n\n## Recommendation\nUse a (well-tested) sanitization library if at all possible. These libraries are much more likely to handle corner cases correctly than a custom implementation.\n\nAn even safer alternative is to design the application so that sanitization is not needed, for instance by using prepared statements for SQL queries.\n\nOtherwise, make sure to use a regular expression with the `g` flag to ensure that all occurrences are replaced, and remember to escape backslashes if applicable.\n\nNote, however, that this is generally *not* sufficient for replacing multi-character strings: the `String.prototype.replace` method only performs one pass over the input string, and will not replace further instances of the string that result from earlier replacements.\n\nFor example, consider the code snippet `s.replace(/\\/\\.\\.\\//g, \"\")`, which attempts to strip out all occurences of `/../` from `s`. This will not work as expected: for the string `/./.././`, for example, it will remove the single occurrence of `/../` in the middle, but the remainder of the string then becomes `/../`, which is another instance of the substring we were trying to remove.\n\n\n## Example\nFor example, assume that we want to embed a user-controlled string `accountNumber` into a SQL query as part of a string literal. To avoid SQL injection, we need to ensure that the string does not contain un-escaped single-quote characters. The following function attempts to ensure this by doubling single quotes, and thereby escaping them:\n\n\n```javascript\nfunction escapeQuotes(s) {\n  return s.replace(\"'\", \"''\");\n}\n\n```\nAs written, this sanitizer is ineffective: if the first argument to `replace` is a string literal (as in this case), only the *first* occurrence of that string is replaced.\n\nAs mentioned above, the function `escapeQuotes` should be replaced with a purpose-built sanitization library, such as the npm module `sqlstring`. Many other sanitization libraries are available from npm and other sources.\n\nIf this is not an option, `escapeQuotes` should be rewritten to use a regular expression with the `g` (\"global\") flag instead:\n\n\n```javascript\nfunction escapeQuotes(s) {\n  return s.replace(/'/g, \"''\");\n}\n\n```\nNote that it is very important to include the global flag: `s.replace(/'/, \"''\")` *without* the global flag is equivalent to the first example above and only replaces the first quote.\n\n\n## References\n* OWASP Top 10: [A1 Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection).\n* npm: [sqlstring](https://www.npmjs.com/package/sqlstring) package.\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n* Common Weakness Enumeration: [CWE-80](https://cwe.mitre.org/data/definitions/80.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-020", "external/cwe/cwe-080", "external/cwe/cwe-116" ],
            "description" : "A sanitizer that removes a sequence of characters may reintroduce the dangerous sequence.",
            "id" : "js/incomplete-multi-character-sanitization",
            "kind" : "problem",
            "name" : "Incomplete multi-character sanitization",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/incomplete-sanitization",
          "name" : "js/incomplete-sanitization",
          "shortDescription" : {
            "text" : "Incomplete string escaping or encoding"
          },
          "fullDescription" : {
            "text" : "A string transformer that does not replace or escape all occurrences of a meta-character may be ineffective."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Incomplete string escaping or encoding\nSanitizing untrusted input is a common technique for preventing injection attacks such as SQL injection or cross-site scripting. Usually, this is done by escaping meta-characters such as quotes in a domain-specific way so that they are treated as normal characters.\n\nHowever, directly using the string `replace` method to perform escaping is notoriously error-prone. Common mistakes include only replacing the first occurrence of a meta-character, or backslash-escaping various meta-characters but not the backslash itself.\n\nIn the former case, later meta-characters are left undisturbed and can be used to subvert the sanitization. In the latter case, preceding a meta-character with a backslash leads to the backslash being escaped, but the meta-character appearing un-escaped, which again makes the sanitization ineffective.\n\nEven if the escaped string is not used in a security-critical context, incomplete escaping may still have undesirable effects, such as badly rendered or confusing output.\n\n\n## Recommendation\nUse a (well-tested) sanitization library if at all possible. These libraries are much more likely to handle corner cases correctly than a custom implementation.\n\nAn even safer alternative is to design the application so that sanitization is not needed, for instance by using prepared statements for SQL queries.\n\nOtherwise, make sure to use a regular expression with the `g` flag to ensure that all occurrences are replaced, and remember to escape backslashes if applicable.\n\nNote, however, that this is generally *not* sufficient for replacing multi-character strings: the `String.prototype.replace` method only performs one pass over the input string, and will not replace further instances of the string that result from earlier replacements.\n\nFor example, consider the code snippet `s.replace(/\\/\\.\\.\\//g, \"\")`, which attempts to strip out all occurences of `/../` from `s`. This will not work as expected: for the string `/./.././`, for example, it will remove the single occurrence of `/../` in the middle, but the remainder of the string then becomes `/../`, which is another instance of the substring we were trying to remove.\n\n\n## Example\nFor example, assume that we want to embed a user-controlled string `accountNumber` into a SQL query as part of a string literal. To avoid SQL injection, we need to ensure that the string does not contain un-escaped single-quote characters. The following function attempts to ensure this by doubling single quotes, and thereby escaping them:\n\n\n```javascript\nfunction escapeQuotes(s) {\n  return s.replace(\"'\", \"''\");\n}\n\n```\nAs written, this sanitizer is ineffective: if the first argument to `replace` is a string literal (as in this case), only the *first* occurrence of that string is replaced.\n\nAs mentioned above, the function `escapeQuotes` should be replaced with a purpose-built sanitization library, such as the npm module `sqlstring`. Many other sanitization libraries are available from npm and other sources.\n\nIf this is not an option, `escapeQuotes` should be rewritten to use a regular expression with the `g` (\"global\") flag instead:\n\n\n```javascript\nfunction escapeQuotes(s) {\n  return s.replace(/'/g, \"''\");\n}\n\n```\nNote that it is very important to include the global flag: `s.replace(/'/, \"''\")` *without* the global flag is equivalent to the first example above and only replaces the first quote.\n\n\n## References\n* OWASP Top 10: [A1 Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection).\n* npm: [sqlstring](https://www.npmjs.com/package/sqlstring) package.\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n* Common Weakness Enumeration: [CWE-80](https://cwe.mitre.org/data/definitions/80.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Incomplete string escaping or encoding\nSanitizing untrusted input is a common technique for preventing injection attacks such as SQL injection or cross-site scripting. Usually, this is done by escaping meta-characters such as quotes in a domain-specific way so that they are treated as normal characters.\n\nHowever, directly using the string `replace` method to perform escaping is notoriously error-prone. Common mistakes include only replacing the first occurrence of a meta-character, or backslash-escaping various meta-characters but not the backslash itself.\n\nIn the former case, later meta-characters are left undisturbed and can be used to subvert the sanitization. In the latter case, preceding a meta-character with a backslash leads to the backslash being escaped, but the meta-character appearing un-escaped, which again makes the sanitization ineffective.\n\nEven if the escaped string is not used in a security-critical context, incomplete escaping may still have undesirable effects, such as badly rendered or confusing output.\n\n\n## Recommendation\nUse a (well-tested) sanitization library if at all possible. These libraries are much more likely to handle corner cases correctly than a custom implementation.\n\nAn even safer alternative is to design the application so that sanitization is not needed, for instance by using prepared statements for SQL queries.\n\nOtherwise, make sure to use a regular expression with the `g` flag to ensure that all occurrences are replaced, and remember to escape backslashes if applicable.\n\nNote, however, that this is generally *not* sufficient for replacing multi-character strings: the `String.prototype.replace` method only performs one pass over the input string, and will not replace further instances of the string that result from earlier replacements.\n\nFor example, consider the code snippet `s.replace(/\\/\\.\\.\\//g, \"\")`, which attempts to strip out all occurences of `/../` from `s`. This will not work as expected: for the string `/./.././`, for example, it will remove the single occurrence of `/../` in the middle, but the remainder of the string then becomes `/../`, which is another instance of the substring we were trying to remove.\n\n\n## Example\nFor example, assume that we want to embed a user-controlled string `accountNumber` into a SQL query as part of a string literal. To avoid SQL injection, we need to ensure that the string does not contain un-escaped single-quote characters. The following function attempts to ensure this by doubling single quotes, and thereby escaping them:\n\n\n```javascript\nfunction escapeQuotes(s) {\n  return s.replace(\"'\", \"''\");\n}\n\n```\nAs written, this sanitizer is ineffective: if the first argument to `replace` is a string literal (as in this case), only the *first* occurrence of that string is replaced.\n\nAs mentioned above, the function `escapeQuotes` should be replaced with a purpose-built sanitization library, such as the npm module `sqlstring`. Many other sanitization libraries are available from npm and other sources.\n\nIf this is not an option, `escapeQuotes` should be rewritten to use a regular expression with the `g` (\"global\") flag instead:\n\n\n```javascript\nfunction escapeQuotes(s) {\n  return s.replace(/'/g, \"''\");\n}\n\n```\nNote that it is very important to include the global flag: `s.replace(/'/, \"''\")` *without* the global flag is equivalent to the first example above and only replaces the first quote.\n\n\n## References\n* OWASP Top 10: [A1 Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection).\n* npm: [sqlstring](https://www.npmjs.com/package/sqlstring) package.\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n* Common Weakness Enumeration: [CWE-80](https://cwe.mitre.org/data/definitions/80.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-020", "external/cwe/cwe-080", "external/cwe/cwe-116" ],
            "description" : "A string transformer that does not replace or escape all occurrences of a\n              meta-character may be ineffective.",
            "id" : "js/incomplete-sanitization",
            "kind" : "problem",
            "name" : "Incomplete string escaping or encoding",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/unsafe-html-expansion",
          "name" : "js/unsafe-html-expansion",
          "shortDescription" : {
            "text" : "Unsafe expansion of self-closing HTML tag"
          },
          "fullDescription" : {
            "text" : "Using regular expressions to expand self-closing HTML tags may lead to cross-site scripting vulnerabilities."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Unsafe expansion of self-closing HTML tag\nSanitizing untrusted input for HTML meta-characters is a common technique for preventing cross-site scripting attacks. But even a sanitized input can be dangerous to use if it is modified further before a browser treats it as HTML. A seemingly innocent transformation that expands a self-closing HTML tag from `<div attr=\"{sanitized}\"/>` to `<div attr=\"{sanitized}\"></div>` may in fact cause cross-site scripting vulnerabilities.\n\n\n## Recommendation\nUse a well-tested sanitization library if at all possible, and avoid modifying sanitized values further before treating them as HTML.\n\nAn even safer alternative is to design the application so that sanitization is not needed, for instance by using HTML templates that are explicit about the values they treat as HTML.\n\n\n## Example\nThe following function transforms a self-closing HTML tag to a pair of open/close tags. It does so for all non-`img` and non-`area` tags, by using a regular expression with two capture groups. The first capture group corresponds to the name of the tag, and the second capture group to the content of the tag.\n\n\n```javascript\nfunction expandSelfClosingTags(html) {\n\tvar rxhtmlTag = /<(?!img|area)(([a-z][^\\w\\/>]*)[^>]*)\\/>/gi;\n\treturn html.replace(rxhtmlTag, \"<$1></$2>\"); // BAD\n}\n\n```\nWhile it is generally known regular expressions are ill-suited for parsing HTML, variants of this particular transformation pattern have long been considered safe.\n\nHowever, the function is not safe. As an example, consider the following string:\n\n\n```html\n<div alt=\"\n<x\" title=\"/>\n<img src=url404 onerror=alert(1)>\"/>\n\n```\nWhen the above function transforms the string, it becomes a string that results in an alert when a browser treats it as HTML.\n\n\n```html\n<div alt=\"\n<x\" title=\"></x\" >\n<img src=url404 onerror=alert(1)>\"/>\n\n```\n\n## References\n* jQuery: [Security fixes in jQuery 3.5.0](https://blog.jquery.com/2020/04/10/jquery-3-5-0-released/)\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [Types of Cross-Site](https://owasp.org/www-community/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
            "markdown" : "# Unsafe expansion of self-closing HTML tag\nSanitizing untrusted input for HTML meta-characters is a common technique for preventing cross-site scripting attacks. But even a sanitized input can be dangerous to use if it is modified further before a browser treats it as HTML. A seemingly innocent transformation that expands a self-closing HTML tag from `<div attr=\"{sanitized}\"/>` to `<div attr=\"{sanitized}\"></div>` may in fact cause cross-site scripting vulnerabilities.\n\n\n## Recommendation\nUse a well-tested sanitization library if at all possible, and avoid modifying sanitized values further before treating them as HTML.\n\nAn even safer alternative is to design the application so that sanitization is not needed, for instance by using HTML templates that are explicit about the values they treat as HTML.\n\n\n## Example\nThe following function transforms a self-closing HTML tag to a pair of open/close tags. It does so for all non-`img` and non-`area` tags, by using a regular expression with two capture groups. The first capture group corresponds to the name of the tag, and the second capture group to the content of the tag.\n\n\n```javascript\nfunction expandSelfClosingTags(html) {\n\tvar rxhtmlTag = /<(?!img|area)(([a-z][^\\w\\/>]*)[^>]*)\\/>/gi;\n\treturn html.replace(rxhtmlTag, \"<$1></$2>\"); // BAD\n}\n\n```\nWhile it is generally known regular expressions are ill-suited for parsing HTML, variants of this particular transformation pattern have long been considered safe.\n\nHowever, the function is not safe. As an example, consider the following string:\n\n\n```html\n<div alt=\"\n<x\" title=\"/>\n<img src=url404 onerror=alert(1)>\"/>\n\n```\nWhen the above function transforms the string, it becomes a string that results in an alert when a browser treats it as HTML.\n\n\n```html\n<div alt=\"\n<x\" title=\"></x\" >\n<img src=url404 onerror=alert(1)>\"/>\n\n```\n\n## References\n* jQuery: [Security fixes in jQuery 3.5.0](https://blog.jquery.com/2020/04/10/jquery-3-5-0-released/)\n* OWASP: [DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html).\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [Types of Cross-Site](https://owasp.org/www-community/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-079", "external/cwe/cwe-116" ],
            "description" : "Using regular expressions to expand self-closing HTML\n              tags may lead to cross-site scripting vulnerabilities.",
            "id" : "js/unsafe-html-expansion",
            "kind" : "problem",
            "name" : "Unsafe expansion of self-closing HTML tag",
            "precision" : "very-high",
            "problem.severity" : "warning",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/tainted-format-string",
          "name" : "js/tainted-format-string",
          "shortDescription" : {
            "text" : "Use of externally-controlled format string"
          },
          "fullDescription" : {
            "text" : "Using external input in format strings can lead to garbled output."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
            "markdown" : "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-134" ],
            "description" : "Using external input in format strings can lead to garbled output.",
            "id" : "js/tainted-format-string",
            "kind" : "path-problem",
            "name" : "Use of externally-controlled format string",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.3"
          }
        }, {
          "id" : "js/case-sensitive-middleware-path",
          "name" : "js/case-sensitive-middleware-path",
          "shortDescription" : {
            "text" : "Case-sensitive middleware path"
          },
          "fullDescription" : {
            "text" : "Middleware with case-sensitive paths do not protect endpoints with case-insensitive paths."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Case-sensitive middleware path\nUsing a case-sensitive regular expression path in a middleware route enables an attacker to bypass that middleware when accessing an endpoint with a case-insensitive path. Paths specified using a string are case-insensitive, whereas regular expressions are case-sensitive by default.\n\n\n## Recommendation\nWhen using a regular expression as a middleware path, make sure the regular expression is case-insensitive by adding the `i` flag.\n\n\n## Example\nThe following example restricts access to paths in the `/admin` path to users logged in as administrators:\n\n\n```javascript\nconst app = require('express')();\n\napp.use(/\\/admin\\/.*/, (req, res, next) => {\n    if (!req.user.isAdmin) {\n        res.status(401).send('Unauthorized');\n    } else {\n        next();\n    }\n});\n\napp.get('/admin/users/:id', (req, res) => {\n    res.send(app.database.users[req.params.id]);\n});\n\n```\nA path such as `/admin/users/45` can only be accessed by an administrator. However, the path `/ADMIN/USERS/45` can be accessed by anyone because the upper-case path doesn't match the case-sensitive regular expression, whereas Express considers it to match the path string `/admin/users`.\n\nThe issue can be fixed by adding the `i` flag to the regular expression:\n\n\n```javascript\nconst app = require('express')();\n\napp.use(/\\/admin\\/.*/i, (req, res, next) => {\n    if (!req.user.isAdmin) {\n        res.status(401).send('Unauthorized');\n    } else {\n        next();\n    }\n});\n\napp.get('/admin/users/:id', (req, res) => {\n    res.send(app.database.users[req.params.id]);\n});\n\n```\n\n## References\n* MDN [Regular Expression Flags](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#advanced_searching_with_flags).\n* Common Weakness Enumeration: [CWE-178](https://cwe.mitre.org/data/definitions/178.html).\n",
            "markdown" : "# Case-sensitive middleware path\nUsing a case-sensitive regular expression path in a middleware route enables an attacker to bypass that middleware when accessing an endpoint with a case-insensitive path. Paths specified using a string are case-insensitive, whereas regular expressions are case-sensitive by default.\n\n\n## Recommendation\nWhen using a regular expression as a middleware path, make sure the regular expression is case-insensitive by adding the `i` flag.\n\n\n## Example\nThe following example restricts access to paths in the `/admin` path to users logged in as administrators:\n\n\n```javascript\nconst app = require('express')();\n\napp.use(/\\/admin\\/.*/, (req, res, next) => {\n    if (!req.user.isAdmin) {\n        res.status(401).send('Unauthorized');\n    } else {\n        next();\n    }\n});\n\napp.get('/admin/users/:id', (req, res) => {\n    res.send(app.database.users[req.params.id]);\n});\n\n```\nA path such as `/admin/users/45` can only be accessed by an administrator. However, the path `/ADMIN/USERS/45` can be accessed by anyone because the upper-case path doesn't match the case-sensitive regular expression, whereas Express considers it to match the path string `/admin/users`.\n\nThe issue can be fixed by adding the `i` flag to the regular expression:\n\n\n```javascript\nconst app = require('express')();\n\napp.use(/\\/admin\\/.*/i, (req, res, next) => {\n    if (!req.user.isAdmin) {\n        res.status(401).send('Unauthorized');\n    } else {\n        next();\n    }\n});\n\napp.get('/admin/users/:id', (req, res) => {\n    res.send(app.database.users[req.params.id]);\n});\n\n```\n\n## References\n* MDN [Regular Expression Flags](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#advanced_searching_with_flags).\n* Common Weakness Enumeration: [CWE-178](https://cwe.mitre.org/data/definitions/178.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-178" ],
            "description" : "Middleware with case-sensitive paths do not protect endpoints with case-insensitive paths.",
            "id" : "js/case-sensitive-middleware-path",
            "kind" : "problem",
            "name" : "Case-sensitive middleware path",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.3"
          }
        }, {
          "id" : "js/exposure-of-private-files",
          "name" : "js/exposure-of-private-files",
          "shortDescription" : {
            "text" : "Exposure of private files"
          },
          "fullDescription" : {
            "text" : "Exposing a node_modules folder, or the project folder to the public, can cause exposure of private information."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Exposure of private files\nLibraries like `express` provide easy methods for serving entire directories of static files from a web server. However, using these can sometimes lead to accidental information exposure. If for example the `node_modules` folder is served, then an attacker can access the `_where` field from a `package.json` file, which gives access to the absolute path of the file.\n\n\n## Recommendation\nLimit which folders of static files are served from a web server.\n\n\n## Example\nIn the example below, all the files from the `node_modules` are served. This allows clients to easily access all the files inside that folder, which includes potentially private information inside `package.json` files.\n\n\n```javascript\n\nvar express = require('express');\n\nvar app = express();\n\napp.use('/node_modules', express.static(path.resolve(__dirname, '../node_modules')));\n```\nThe issue has been fixed below by only serving specific folders within the `node_modules` folder.\n\n\n```javascript\n\nvar express = require('express');\n\nvar app = express();\n\napp.use(\"jquery\", express.static('./node_modules/jquery/dist'));\napp.use(\"bootstrap\", express.static('./node_modules/bootstrap/dist'));\n```\n\n## References\n* OWASP: [Sensitive Data Exposure](https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure).\n* Common Weakness Enumeration: [CWE-200](https://cwe.mitre.org/data/definitions/200.html).\n* Common Weakness Enumeration: [CWE-219](https://cwe.mitre.org/data/definitions/219.html).\n* Common Weakness Enumeration: [CWE-548](https://cwe.mitre.org/data/definitions/548.html).\n",
            "markdown" : "# Exposure of private files\nLibraries like `express` provide easy methods for serving entire directories of static files from a web server. However, using these can sometimes lead to accidental information exposure. If for example the `node_modules` folder is served, then an attacker can access the `_where` field from a `package.json` file, which gives access to the absolute path of the file.\n\n\n## Recommendation\nLimit which folders of static files are served from a web server.\n\n\n## Example\nIn the example below, all the files from the `node_modules` are served. This allows clients to easily access all the files inside that folder, which includes potentially private information inside `package.json` files.\n\n\n```javascript\n\nvar express = require('express');\n\nvar app = express();\n\napp.use('/node_modules', express.static(path.resolve(__dirname, '../node_modules')));\n```\nThe issue has been fixed below by only serving specific folders within the `node_modules` folder.\n\n\n```javascript\n\nvar express = require('express');\n\nvar app = express();\n\napp.use(\"jquery\", express.static('./node_modules/jquery/dist'));\napp.use(\"bootstrap\", express.static('./node_modules/bootstrap/dist'));\n```\n\n## References\n* OWASP: [Sensitive Data Exposure](https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure).\n* Common Weakness Enumeration: [CWE-200](https://cwe.mitre.org/data/definitions/200.html).\n* Common Weakness Enumeration: [CWE-219](https://cwe.mitre.org/data/definitions/219.html).\n* Common Weakness Enumeration: [CWE-548](https://cwe.mitre.org/data/definitions/548.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-200", "external/cwe/cwe-219", "external/cwe/cwe-548" ],
            "description" : "Exposing a node_modules folder, or the project folder to the public, can cause exposure\n              of private information.",
            "id" : "js/exposure-of-private-files",
            "kind" : "problem",
            "name" : "Exposure of private files",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "6.5"
          }
        }, {
          "id" : "js/cross-window-information-leak",
          "name" : "js/cross-window-information-leak",
          "shortDescription" : {
            "text" : "Cross-window communication with unrestricted target origin"
          },
          "fullDescription" : {
            "text" : "When sending sensitive information to another window using `postMessage`, the origin of the target window should be restricted to avoid unintentional information leaks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Cross-window communication with unrestricted target origin\nThe `window.postMessage` method allows different windows or iframes to communicate directly, even if they were loaded from different origins, circumventing the usual same-origin policy.\n\nThe sender of the message can restrict the origin of the receiver by specifying a target origin. If the receiver window does not come from this origin, the message is not sent.\n\nAlternatively, the sender can specify a target origin of `'*'`, which means that any origin is acceptable and the message is always sent.\n\nThis feature should not be used if the message being sent contains sensitive data such as user credentials: the target window may have been loaded from a malicious site, to which the data would then become available.\n\n\n## Recommendation\nIf possible, specify a target origin when using `window.postMessage`. Alternatively, encrypt the sensitive data before sending it to prevent an unauthorized receiver from accessing it.\n\n\n## Example\nThe following example code sends user credentials (in this case, their user name) to `window.parent` without checking its origin. If a malicious site loads the page containing this code into an iframe it would be able to gain access to the user name.\n\n\n```javascript\nwindow.parent.postMessage(userName, '*');\n\n```\nTo prevent this from happening, the origin of the target window should be restricted, as in this example:\n\n\n```javascript\nwindow.parent.postMessage(userName, 'https://lgtm.com');\n\n```\n\n## References\n* Mozilla Developer Network: [Window.postMessage](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage).\n* Mozilla Developer Network: [Same-origin policy](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy).\n* Common Weakness Enumeration: [CWE-201](https://cwe.mitre.org/data/definitions/201.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n",
            "markdown" : "# Cross-window communication with unrestricted target origin\nThe `window.postMessage` method allows different windows or iframes to communicate directly, even if they were loaded from different origins, circumventing the usual same-origin policy.\n\nThe sender of the message can restrict the origin of the receiver by specifying a target origin. If the receiver window does not come from this origin, the message is not sent.\n\nAlternatively, the sender can specify a target origin of `'*'`, which means that any origin is acceptable and the message is always sent.\n\nThis feature should not be used if the message being sent contains sensitive data such as user credentials: the target window may have been loaded from a malicious site, to which the data would then become available.\n\n\n## Recommendation\nIf possible, specify a target origin when using `window.postMessage`. Alternatively, encrypt the sensitive data before sending it to prevent an unauthorized receiver from accessing it.\n\n\n## Example\nThe following example code sends user credentials (in this case, their user name) to `window.parent` without checking its origin. If a malicious site loads the page containing this code into an iframe it would be able to gain access to the user name.\n\n\n```javascript\nwindow.parent.postMessage(userName, '*');\n\n```\nTo prevent this from happening, the origin of the target window should be restricted, as in this example:\n\n\n```javascript\nwindow.parent.postMessage(userName, 'https://lgtm.com');\n\n```\n\n## References\n* Mozilla Developer Network: [Window.postMessage](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage).\n* Mozilla Developer Network: [Same-origin policy](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy).\n* Common Weakness Enumeration: [CWE-201](https://cwe.mitre.org/data/definitions/201.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-201", "external/cwe/cwe-359" ],
            "description" : "When sending sensitive information to another window using `postMessage`,\n              the origin of the target window should be restricted to avoid unintentional\n              information leaks.",
            "id" : "js/cross-window-information-leak",
            "kind" : "path-problem",
            "name" : "Cross-window communication with unrestricted target origin",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "4.3"
          }
        }, {
          "id" : "js/stack-trace-exposure",
          "name" : "js/stack-trace-exposure",
          "shortDescription" : {
            "text" : "Information exposure through a stack trace"
          },
          "fullDescription" : {
            "text" : "Propagating stack trace information to an external user can unintentionally reveal implementation details that are useful to an attacker for developing a subsequent exploit."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Information exposure through a stack trace\nSoftware developers often add stack traces to error messages, as a debugging aid. Whenever that error message occurs for an end user, the developer can use the stack trace to help identify how to fix the problem. In particular, stack traces can tell the developer more about the sequence of events that led to a failure, as opposed to merely the final state of the software when the error occurred.\n\nUnfortunately, the same information can be useful to an attacker. The sequence of function names in a stack trace can reveal the structure of the application as well as any internal components it relies on. Furthermore, the error message at the top of a stack trace can include information such as server-side file names and SQL code that the application relies on, allowing an attacker to fine-tune a subsequent injection attack.\n\n\n## Recommendation\nSend the user a more generic error message that reveals less information. Either suppress the stack trace entirely, or log it only on the server.\n\n\n## Example\nIn the following example, an exception is caught and its stack trace is sent back to the remote user as part of the HTTP response. As such, the user is able to see a detailed stack trace, which may contain sensitive information.\n\n\n```javascript\nvar http = require('http');\n\nhttp.createServer(function onRequest(req, res) {\n  var body;\n  try {\n    body = handleRequest(req);\n  }\n  catch (err) {\n    res.statusCode = 500;\n    res.setHeader(\"Content-Type\", \"text/plain\");\n    res.end(err.stack); // NOT OK\n    return;\n  }\n  res.statusCode = 200;\n  res.setHeader(\"Content-Type\", \"application/json\");\n  res.setHeader(\"Content-Length\", body.length);\n  res.end(body);\n}).listen(3000);\n\n```\nInstead, the stack trace should be logged only on the server. That way, the developers can still access and use the error log, but remote users will not see the information:\n\n\n```javascript\nvar http = require('http');\n\nhttp.createServer(function onRequest(req, res) {\n  var body;\n  try {\n    body = handleRequest(req);\n  }\n  catch (err) {\n    res.statusCode = 500;\n    res.setHeader(\"Content-Type\", \"text/plain\");\n    log(\"Exception occurred\", err.stack);\n    res.end(\"An exception occurred\"); // OK\n    return;\n  }\n  res.statusCode = 200;\n  res.setHeader(\"Content-Type\", \"application/json\");\n  res.setHeader(\"Content-Length\", body.length);\n  res.end(body);\n}).listen(3000);\n\n```\n\n## References\n* OWASP: [Improper Error Handling](https://owasp.org/www-community/Improper_Error_Handling).\n* Common Weakness Enumeration: [CWE-209](https://cwe.mitre.org/data/definitions/209.html).\n* Common Weakness Enumeration: [CWE-497](https://cwe.mitre.org/data/definitions/497.html).\n",
            "markdown" : "# Information exposure through a stack trace\nSoftware developers often add stack traces to error messages, as a debugging aid. Whenever that error message occurs for an end user, the developer can use the stack trace to help identify how to fix the problem. In particular, stack traces can tell the developer more about the sequence of events that led to a failure, as opposed to merely the final state of the software when the error occurred.\n\nUnfortunately, the same information can be useful to an attacker. The sequence of function names in a stack trace can reveal the structure of the application as well as any internal components it relies on. Furthermore, the error message at the top of a stack trace can include information such as server-side file names and SQL code that the application relies on, allowing an attacker to fine-tune a subsequent injection attack.\n\n\n## Recommendation\nSend the user a more generic error message that reveals less information. Either suppress the stack trace entirely, or log it only on the server.\n\n\n## Example\nIn the following example, an exception is caught and its stack trace is sent back to the remote user as part of the HTTP response. As such, the user is able to see a detailed stack trace, which may contain sensitive information.\n\n\n```javascript\nvar http = require('http');\n\nhttp.createServer(function onRequest(req, res) {\n  var body;\n  try {\n    body = handleRequest(req);\n  }\n  catch (err) {\n    res.statusCode = 500;\n    res.setHeader(\"Content-Type\", \"text/plain\");\n    res.end(err.stack); // NOT OK\n    return;\n  }\n  res.statusCode = 200;\n  res.setHeader(\"Content-Type\", \"application/json\");\n  res.setHeader(\"Content-Length\", body.length);\n  res.end(body);\n}).listen(3000);\n\n```\nInstead, the stack trace should be logged only on the server. That way, the developers can still access and use the error log, but remote users will not see the information:\n\n\n```javascript\nvar http = require('http');\n\nhttp.createServer(function onRequest(req, res) {\n  var body;\n  try {\n    body = handleRequest(req);\n  }\n  catch (err) {\n    res.statusCode = 500;\n    res.setHeader(\"Content-Type\", \"text/plain\");\n    log(\"Exception occurred\", err.stack);\n    res.end(\"An exception occurred\"); // OK\n    return;\n  }\n  res.statusCode = 200;\n  res.setHeader(\"Content-Type\", \"application/json\");\n  res.setHeader(\"Content-Length\", body.length);\n  res.end(body);\n}).listen(3000);\n\n```\n\n## References\n* OWASP: [Improper Error Handling](https://owasp.org/www-community/Improper_Error_Handling).\n* Common Weakness Enumeration: [CWE-209](https://cwe.mitre.org/data/definitions/209.html).\n* Common Weakness Enumeration: [CWE-497](https://cwe.mitre.org/data/definitions/497.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-209", "external/cwe/cwe-497" ],
            "description" : "Propagating stack trace information to an external user can\n              unintentionally reveal implementation details that are useful\n              to an attacker for developing a subsequent exploit.",
            "id" : "js/stack-trace-exposure",
            "kind" : "path-problem",
            "name" : "Information exposure through a stack trace",
            "precision" : "very-high",
            "problem.severity" : "warning",
            "security-severity" : "5.4"
          }
        }, {
          "id" : "js/disabling-certificate-validation",
          "name" : "js/disabling-certificate-validation",
          "shortDescription" : {
            "text" : "Disabling certificate validation"
          },
          "fullDescription" : {
            "text" : "Disabling cryptographic certificate validation can cause security vulnerabilities."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Disabling certificate validation\nCertificate validation is the standard authentication method of a secure TLS connection. Without it, there is no guarantee about who the other party of a TLS connection is, making man-in-the-middle attacks more likely to occur\n\nWhen testing software that uses TLS connections, it may be useful to disable the certificate validation temporarily. But disabling it in production environments is strongly discouraged, unless an alternative method of authentication is used.\n\n\n## Recommendation\nDo not disable certificate validation for TLS connections.\n\n\n## Example\nThe following example shows a HTTPS connection that transfers confidential information to a remote server. But the connection is not secure since the `rejectUnauthorized` option of the connection is set to `false`. As a consequence, anyone can impersonate the remote server, and receive the confidential information.\n\n\n```javascript\nlet https = require(\"https\");\n\nhttps.request(\n  {\n    hostname: \"secure.my-online-bank.com\",\n    port: 443,\n    method: \"POST\",\n    path: \"send-confidential-information\",\n    rejectUnauthorized: false // BAD\n  },\n  response => {\n    // ... communicate with secure.my-online-bank.com\n  }\n);\n\n```\nTo make the connection secure, the `rejectUnauthorized` option should have its default value, or be explicitly set to `true`.\n\n\n## References\n* Wikipedia: [Transport Layer Security (TLS)](https://en.wikipedia.org/wiki/Transport_Layer_Security)\n* Wikipedia: [Man-in-the-middle attack](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)\n* Node.js: [TLS (SSL)](https://nodejs.org/api/tls.html)\n* Common Weakness Enumeration: [CWE-295](https://cwe.mitre.org/data/definitions/295.html).\n* Common Weakness Enumeration: [CWE-297](https://cwe.mitre.org/data/definitions/297.html).\n",
            "markdown" : "# Disabling certificate validation\nCertificate validation is the standard authentication method of a secure TLS connection. Without it, there is no guarantee about who the other party of a TLS connection is, making man-in-the-middle attacks more likely to occur\n\nWhen testing software that uses TLS connections, it may be useful to disable the certificate validation temporarily. But disabling it in production environments is strongly discouraged, unless an alternative method of authentication is used.\n\n\n## Recommendation\nDo not disable certificate validation for TLS connections.\n\n\n## Example\nThe following example shows a HTTPS connection that transfers confidential information to a remote server. But the connection is not secure since the `rejectUnauthorized` option of the connection is set to `false`. As a consequence, anyone can impersonate the remote server, and receive the confidential information.\n\n\n```javascript\nlet https = require(\"https\");\n\nhttps.request(\n  {\n    hostname: \"secure.my-online-bank.com\",\n    port: 443,\n    method: \"POST\",\n    path: \"send-confidential-information\",\n    rejectUnauthorized: false // BAD\n  },\n  response => {\n    // ... communicate with secure.my-online-bank.com\n  }\n);\n\n```\nTo make the connection secure, the `rejectUnauthorized` option should have its default value, or be explicitly set to `true`.\n\n\n## References\n* Wikipedia: [Transport Layer Security (TLS)](https://en.wikipedia.org/wiki/Transport_Layer_Security)\n* Wikipedia: [Man-in-the-middle attack](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)\n* Node.js: [TLS (SSL)](https://nodejs.org/api/tls.html)\n* Common Weakness Enumeration: [CWE-295](https://cwe.mitre.org/data/definitions/295.html).\n* Common Weakness Enumeration: [CWE-297](https://cwe.mitre.org/data/definitions/297.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-295", "external/cwe/cwe-297" ],
            "description" : "Disabling cryptographic certificate validation can cause security vulnerabilities.",
            "id" : "js/disabling-certificate-validation",
            "kind" : "problem",
            "name" : "Disabling certificate validation",
            "precision" : "very-high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/insecure-dependency",
          "name" : "js/insecure-dependency",
          "shortDescription" : {
            "text" : "Dependency download using unencrypted communication channel"
          },
          "fullDescription" : {
            "text" : "Using unencrypted protocols to fetch dependencies can leave an application open to man-in-the-middle attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Dependency download using unencrypted communication channel\nUsing an insecure protocol like HTTP or FTP to download build dependencies makes the build process vulnerable to a man-in-the-middle (MITM) attack.\n\nThis can allow attackers to inject malicious code into the downloaded dependencies, and thereby infect the build artifacts and execute arbitrary code on the machine building the artifacts.\n\n\n## Recommendation\nAlways use a secure protocol, such as HTTPS or SFTP, when downloading artifacts from an URL.\n\n\n## Example\nThe below example shows a `package.json` file that downloads a dependency using the insecure HTTP protocol.\n\n\n```json\n{\n  \"name\": \"example-project\",\n  \"dependencies\": {\n    \"unencrypted\": \"http://example.org/foo/tarball/release/0.0.1\",\n    \"lodash\": \"^4.0.0\"\n  }\n}\n```\nThe fix is to change the protocol to HTTPS.\n\n\n```json\n{\n  \"name\": \"example-project\",\n  \"dependencies\": {\n    \"unencrypted\": \"https://example.org/foo/tarball/release/0.0.1\",\n    \"lodash\": \"^4.0.0\"\n  }\n}\n```\n\n## References\n* Jonathan Leitschuh: [ Want to take over the Java ecosystem? All you need is a MITM! ](https://infosecwriteups.com/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb)\n* Max Veytsman: [ How to take over the computer of any Java (or Closure or Scala) Developer. ](https://max.computer/blog/how-to-take-over-the-computer-of-any-java-or-clojure-or-scala-developer/)\n* Wikipedia: [Supply chain attack.](https://en.wikipedia.org/wiki/Supply_chain_attack)\n* Wikipedia: [Man-in-the-middle attack.](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)\n* Common Weakness Enumeration: [CWE-300](https://cwe.mitre.org/data/definitions/300.html).\n* Common Weakness Enumeration: [CWE-319](https://cwe.mitre.org/data/definitions/319.html).\n* Common Weakness Enumeration: [CWE-494](https://cwe.mitre.org/data/definitions/494.html).\n* Common Weakness Enumeration: [CWE-829](https://cwe.mitre.org/data/definitions/829.html).\n",
            "markdown" : "# Dependency download using unencrypted communication channel\nUsing an insecure protocol like HTTP or FTP to download build dependencies makes the build process vulnerable to a man-in-the-middle (MITM) attack.\n\nThis can allow attackers to inject malicious code into the downloaded dependencies, and thereby infect the build artifacts and execute arbitrary code on the machine building the artifacts.\n\n\n## Recommendation\nAlways use a secure protocol, such as HTTPS or SFTP, when downloading artifacts from an URL.\n\n\n## Example\nThe below example shows a `package.json` file that downloads a dependency using the insecure HTTP protocol.\n\n\n```json\n{\n  \"name\": \"example-project\",\n  \"dependencies\": {\n    \"unencrypted\": \"http://example.org/foo/tarball/release/0.0.1\",\n    \"lodash\": \"^4.0.0\"\n  }\n}\n```\nThe fix is to change the protocol to HTTPS.\n\n\n```json\n{\n  \"name\": \"example-project\",\n  \"dependencies\": {\n    \"unencrypted\": \"https://example.org/foo/tarball/release/0.0.1\",\n    \"lodash\": \"^4.0.0\"\n  }\n}\n```\n\n## References\n* Jonathan Leitschuh: [ Want to take over the Java ecosystem? All you need is a MITM! ](https://infosecwriteups.com/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb)\n* Max Veytsman: [ How to take over the computer of any Java (or Closure or Scala) Developer. ](https://max.computer/blog/how-to-take-over-the-computer-of-any-java-or-clojure-or-scala-developer/)\n* Wikipedia: [Supply chain attack.](https://en.wikipedia.org/wiki/Supply_chain_attack)\n* Wikipedia: [Man-in-the-middle attack.](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)\n* Common Weakness Enumeration: [CWE-300](https://cwe.mitre.org/data/definitions/300.html).\n* Common Weakness Enumeration: [CWE-319](https://cwe.mitre.org/data/definitions/319.html).\n* Common Weakness Enumeration: [CWE-494](https://cwe.mitre.org/data/definitions/494.html).\n* Common Weakness Enumeration: [CWE-829](https://cwe.mitre.org/data/definitions/829.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-300", "external/cwe/cwe-319", "external/cwe/cwe-494", "external/cwe/cwe-829" ],
            "description" : "Using unencrypted protocols to fetch dependencies can leave an application\n              open to man-in-the-middle attacks.",
            "id" : "js/insecure-dependency",
            "kind" : "problem",
            "name" : "Dependency download using unencrypted communication channel",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "8.1"
          }
        }, {
          "id" : "js/build-artifact-leak",
          "name" : "js/build-artifact-leak",
          "shortDescription" : {
            "text" : "Storage of sensitive information in build artifact"
          },
          "fullDescription" : {
            "text" : "Including sensitive information in a build artifact can expose it to an attacker."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Storage of sensitive information in build artifact\nSensitive information included in a build artifact can allow an attacker to access the sensitive information if the artifact is published.\n\n\n## Recommendation\nOnly store information that is meant to be publicly available in a build artifact.\n\n\n## Example\nThe following example creates a `webpack` configuration that inserts all environment variables from the host into the build artifact:\n\n\n```javascript\nconst webpack = require(\"webpack\");\n\nmodule.exports = [{\n    plugins: [\n        new webpack.DefinePlugin({\n            \"process.env\": JSON.stringify(process.env)\n        })\n    ]\n}];\n```\nThe environment variables might include API keys or other sensitive information, and the build-system should instead insert only the environment variables that are supposed to be public.\n\nThe issue has been fixed below, where only the `DEBUG` environment variable is inserted into the artifact.\n\n\n```javascript\nconst webpack = require(\"webpack\");\n\nmodule.exports = [{\n    plugins: [\n        new webpack.DefinePlugin({\n            'process.env': JSON.stringify({ DEBUG: process.env.DEBUG })\n        })\n    ]\n}];\n\n```\n\n## References\n* webpack: [DefinePlugin API](https://webpack.js.org/plugins/define-plugin/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-315](https://cwe.mitre.org/data/definitions/315.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n",
            "markdown" : "# Storage of sensitive information in build artifact\nSensitive information included in a build artifact can allow an attacker to access the sensitive information if the artifact is published.\n\n\n## Recommendation\nOnly store information that is meant to be publicly available in a build artifact.\n\n\n## Example\nThe following example creates a `webpack` configuration that inserts all environment variables from the host into the build artifact:\n\n\n```javascript\nconst webpack = require(\"webpack\");\n\nmodule.exports = [{\n    plugins: [\n        new webpack.DefinePlugin({\n            \"process.env\": JSON.stringify(process.env)\n        })\n    ]\n}];\n```\nThe environment variables might include API keys or other sensitive information, and the build-system should instead insert only the environment variables that are supposed to be public.\n\nThe issue has been fixed below, where only the `DEBUG` environment variable is inserted into the artifact.\n\n\n```javascript\nconst webpack = require(\"webpack\");\n\nmodule.exports = [{\n    plugins: [\n        new webpack.DefinePlugin({\n            'process.env': JSON.stringify({ DEBUG: process.env.DEBUG })\n        })\n    ]\n}];\n\n```\n\n## References\n* webpack: [DefinePlugin API](https://webpack.js.org/plugins/define-plugin/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-315](https://cwe.mitre.org/data/definitions/315.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-312", "external/cwe/cwe-315", "external/cwe/cwe-359" ],
            "description" : "Including sensitive information in a build artifact can\n              expose it to an attacker.",
            "id" : "js/build-artifact-leak",
            "kind" : "path-problem",
            "name" : "Storage of sensitive information in build artifact",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/clear-text-logging",
          "name" : "js/clear-text-logging",
          "shortDescription" : {
            "text" : "Clear-text logging of sensitive information"
          },
          "fullDescription" : {
            "text" : "Logging sensitive information without encryption or hashing can expose it to an attacker."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Clear-text logging of sensitive information\nSensitive information that is stored unencrypted is accessible to an attacker who gains access to the storage. This is particularly important for cookies, which are stored on the machine of the end-user.\n\n\n## Recommendation\nEnsure that sensitive information is always encrypted before being stored. If possible, avoid placing sensitive information in cookies altogether. Instead, prefer storing, in the cookie, a key that can be used to look up the sensitive information.\n\nIn general, decrypt sensitive information only at the point where it is necessary for it to be used in cleartext.\n\nBe aware that external processes often store the `standard out` and `standard error` streams of the application, causing logged sensitive information to be stored as well.\n\n\n## Example\nThe following example code stores user credentials (in this case, their password) in a cookie in plain text:\n\n\n```javascript\nvar express = require('express');\n\nvar app = express();\napp.get('/remember-password', function (req, res) {\n  let pw = req.param(\"current_password\");\n  // BAD: Setting a cookie value with cleartext sensitive data.\n  res.cookie(\"password\", pw);\n});\n\n```\nInstead, the credentials should be encrypted, for instance by using the Node.js `crypto` module:\n\n\n```javascript\nvar express = require('express');\nvar crypto = require('crypto'),\n    password = getPassword();\n\nfunction encrypt(text){\n  var cipher = crypto.createCipher('aes-256-ctr', password);\n  return cipher.update(text, 'utf8', 'hex') + cipher.final('hex');\n}\n\nvar app = express();\napp.get('/remember-password', function (req, res) {\n  let pw = req.param(\"current_password\");\n  // GOOD: Encoding the value before setting it.\n  res.cookie(\"password\", encrypt(pw));\n});\n\n```\n\n## References\n* M. Dowd, J. McDonald and J. Schuhm, *The Art of Software Security Assessment*, 1st Edition, Chapter 2 - 'Common Vulnerabilities of Encryption', p. 43. Addison Wesley, 2006.\n* M. Howard and D. LeBlanc, *Writing Secure Code*, 2nd Edition, Chapter 9 - 'Protecting Secret Data', p. 299. Microsoft, 2002.\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
            "markdown" : "# Clear-text logging of sensitive information\nSensitive information that is stored unencrypted is accessible to an attacker who gains access to the storage. This is particularly important for cookies, which are stored on the machine of the end-user.\n\n\n## Recommendation\nEnsure that sensitive information is always encrypted before being stored. If possible, avoid placing sensitive information in cookies altogether. Instead, prefer storing, in the cookie, a key that can be used to look up the sensitive information.\n\nIn general, decrypt sensitive information only at the point where it is necessary for it to be used in cleartext.\n\nBe aware that external processes often store the `standard out` and `standard error` streams of the application, causing logged sensitive information to be stored as well.\n\n\n## Example\nThe following example code stores user credentials (in this case, their password) in a cookie in plain text:\n\n\n```javascript\nvar express = require('express');\n\nvar app = express();\napp.get('/remember-password', function (req, res) {\n  let pw = req.param(\"current_password\");\n  // BAD: Setting a cookie value with cleartext sensitive data.\n  res.cookie(\"password\", pw);\n});\n\n```\nInstead, the credentials should be encrypted, for instance by using the Node.js `crypto` module:\n\n\n```javascript\nvar express = require('express');\nvar crypto = require('crypto'),\n    password = getPassword();\n\nfunction encrypt(text){\n  var cipher = crypto.createCipher('aes-256-ctr', password);\n  return cipher.update(text, 'utf8', 'hex') + cipher.final('hex');\n}\n\nvar app = express();\napp.get('/remember-password', function (req, res) {\n  let pw = req.param(\"current_password\");\n  // GOOD: Encoding the value before setting it.\n  res.cookie(\"password\", encrypt(pw));\n});\n\n```\n\n## References\n* M. Dowd, J. McDonald and J. Schuhm, *The Art of Software Security Assessment*, 1st Edition, Chapter 2 - 'Common Vulnerabilities of Encryption', p. 43. Addison Wesley, 2006.\n* M. Howard and D. LeBlanc, *Writing Secure Code*, 2nd Edition, Chapter 9 - 'Protecting Secret Data', p. 299. Microsoft, 2002.\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532" ],
            "description" : "Logging sensitive information without encryption or hashing can\n              expose it to an attacker.",
            "id" : "js/clear-text-logging",
            "kind" : "path-problem",
            "name" : "Clear-text logging of sensitive information",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/clear-text-storage-of-sensitive-data",
          "name" : "js/clear-text-storage-of-sensitive-data",
          "shortDescription" : {
            "text" : "Clear text storage of sensitive information"
          },
          "fullDescription" : {
            "text" : "Sensitive information stored without encryption or hashing can expose it to an attacker."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Clear text storage of sensitive information\nSensitive information that is stored unencrypted is accessible to an attacker who gains access to the storage. This is particularly important for cookies, which are stored on the machine of the end-user.\n\n\n## Recommendation\nEnsure that sensitive information is always encrypted before being stored. If possible, avoid placing sensitive information in cookies altogether. Instead, prefer storing, in the cookie, a key that can be used to look up the sensitive information.\n\nIn general, decrypt sensitive information only at the point where it is necessary for it to be used in cleartext.\n\nBe aware that external processes often store the `standard out` and `standard error` streams of the application, causing logged sensitive information to be stored as well.\n\n\n## Example\nThe following example code stores user credentials (in this case, their password) in a cookie in plain text:\n\n\n```javascript\nvar express = require('express');\n\nvar app = express();\napp.get('/remember-password', function (req, res) {\n  let pw = req.param(\"current_password\");\n  // BAD: Setting a cookie value with cleartext sensitive data.\n  res.cookie(\"password\", pw);\n});\n\n```\nInstead, the credentials should be encrypted, for instance by using the Node.js `crypto` module:\n\n\n```javascript\nvar express = require('express');\nvar crypto = require('crypto'),\n    password = getPassword();\n\nfunction encrypt(text){\n  var cipher = crypto.createCipher('aes-256-ctr', password);\n  return cipher.update(text, 'utf8', 'hex') + cipher.final('hex');\n}\n\nvar app = express();\napp.get('/remember-password', function (req, res) {\n  let pw = req.param(\"current_password\");\n  // GOOD: Encoding the value before setting it.\n  res.cookie(\"password\", encrypt(pw));\n});\n\n```\n\n## References\n* M. Dowd, J. McDonald and J. Schuhm, *The Art of Software Security Assessment*, 1st Edition, Chapter 2 - 'Common Vulnerabilities of Encryption', p. 43. Addison Wesley, 2006.\n* M. Howard and D. LeBlanc, *Writing Secure Code*, 2nd Edition, Chapter 9 - 'Protecting Secret Data', p. 299. Microsoft, 2002.\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-315](https://cwe.mitre.org/data/definitions/315.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n",
            "markdown" : "# Clear text storage of sensitive information\nSensitive information that is stored unencrypted is accessible to an attacker who gains access to the storage. This is particularly important for cookies, which are stored on the machine of the end-user.\n\n\n## Recommendation\nEnsure that sensitive information is always encrypted before being stored. If possible, avoid placing sensitive information in cookies altogether. Instead, prefer storing, in the cookie, a key that can be used to look up the sensitive information.\n\nIn general, decrypt sensitive information only at the point where it is necessary for it to be used in cleartext.\n\nBe aware that external processes often store the `standard out` and `standard error` streams of the application, causing logged sensitive information to be stored as well.\n\n\n## Example\nThe following example code stores user credentials (in this case, their password) in a cookie in plain text:\n\n\n```javascript\nvar express = require('express');\n\nvar app = express();\napp.get('/remember-password', function (req, res) {\n  let pw = req.param(\"current_password\");\n  // BAD: Setting a cookie value with cleartext sensitive data.\n  res.cookie(\"password\", pw);\n});\n\n```\nInstead, the credentials should be encrypted, for instance by using the Node.js `crypto` module:\n\n\n```javascript\nvar express = require('express');\nvar crypto = require('crypto'),\n    password = getPassword();\n\nfunction encrypt(text){\n  var cipher = crypto.createCipher('aes-256-ctr', password);\n  return cipher.update(text, 'utf8', 'hex') + cipher.final('hex');\n}\n\nvar app = express();\napp.get('/remember-password', function (req, res) {\n  let pw = req.param(\"current_password\");\n  // GOOD: Encoding the value before setting it.\n  res.cookie(\"password\", encrypt(pw));\n});\n\n```\n\n## References\n* M. Dowd, J. McDonald and J. Schuhm, *The Art of Software Security Assessment*, 1st Edition, Chapter 2 - 'Common Vulnerabilities of Encryption', p. 43. Addison Wesley, 2006.\n* M. Howard and D. LeBlanc, *Writing Secure Code*, 2nd Edition, Chapter 9 - 'Protecting Secret Data', p. 299. Microsoft, 2002.\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-315](https://cwe.mitre.org/data/definitions/315.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-312", "external/cwe/cwe-315", "external/cwe/cwe-359" ],
            "description" : "Sensitive information stored without encryption or hashing can expose it to an\n              attacker.",
            "id" : "js/clear-text-storage-of-sensitive-data",
            "kind" : "path-problem",
            "name" : "Clear text storage of sensitive information",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/insufficient-key-size",
          "name" : "js/insufficient-key-size",
          "shortDescription" : {
            "text" : "Use of a weak cryptographic key"
          },
          "fullDescription" : {
            "text" : "Using a weak cryptographic key can allow an attacker to compromise security."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Use of a weak cryptographic key\nModern encryption relies on it being computationally infeasible to break the cipher and decode a message without the key. As computational power increases, the ability to break ciphers grows and keys need to become larger.\n\n\n## Recommendation\nAn encryption key should be at least 2048-bit long when using RSA encryption, and 128-bit long when using symmetric encryption.\n\n\n## References\n* Wikipedia: [RSA](https://en.wikipedia.org/wiki/RSA_(cryptosystem)).\n* Wikipedia: [AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard).\n* NodeJS: [Crypto](https://nodejs.org/api/crypto.html).\n* NIST: [ Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf).\n* Wikipedia: [Key size](https://en.wikipedia.org/wiki/Key_size)\n* Common Weakness Enumeration: [CWE-326](https://cwe.mitre.org/data/definitions/326.html).\n",
            "markdown" : "# Use of a weak cryptographic key\nModern encryption relies on it being computationally infeasible to break the cipher and decode a message without the key. As computational power increases, the ability to break ciphers grows and keys need to become larger.\n\n\n## Recommendation\nAn encryption key should be at least 2048-bit long when using RSA encryption, and 128-bit long when using symmetric encryption.\n\n\n## References\n* Wikipedia: [RSA](https://en.wikipedia.org/wiki/RSA_(cryptosystem)).\n* Wikipedia: [AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard).\n* NodeJS: [Crypto](https://nodejs.org/api/crypto.html).\n* NIST: [ Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf).\n* Wikipedia: [Key size](https://en.wikipedia.org/wiki/Key_size)\n* Common Weakness Enumeration: [CWE-326](https://cwe.mitre.org/data/definitions/326.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-326" ],
            "description" : "Using a weak cryptographic key can allow an attacker to compromise security.",
            "id" : "js/insufficient-key-size",
            "kind" : "problem",
            "name" : "Use of a weak cryptographic key",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/biased-cryptographic-random",
          "name" : "js/biased-cryptographic-random",
          "shortDescription" : {
            "text" : "Creating biased random numbers from a cryptographically secure source."
          },
          "fullDescription" : {
            "text" : "Some mathematical operations on random numbers can cause bias in the results and compromise security."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Creating biased random numbers from a cryptographically secure source.\nGenerating secure random numbers can be an important part of creating a secure software system. This can be done using APIs that create cryptographically secure random numbers.\n\nHowever, using some mathematical operations on these cryptographically secure random numbers can create biased results, where some outcomes are more likely than others. Such biased results can make it easier for an attacker to guess the random numbers, and thereby break the security of the software system.\n\n\n## Recommendation\nBe very careful not to introduce bias when performing mathematical operations on cryptographically secure random numbers.\n\nIf possible, avoid performing mathematical operations on cryptographically secure random numbers at all, and use a preexisting library instead.\n\n\n## Example\nThe example below uses the modulo operator to create an array of 10 random digits using random bytes as the source for randomness.\n\n\n```javascript\nconst crypto = require('crypto');\n\nconst digits = [];\nfor (let i = 0; i < 10; i++) {\n    digits.push(crypto.randomBytes(1)[0] % 10); // NOT OK\n}\n```\nThe random byte is a uniformly random value between 0 and 255, and thus the result from using the modulo operator is slightly more likely to be between 0 and 5 than between 6 and 9.\n\nThe issue has been fixed in the code below by using a library that correctly generates cryptographically secure random values.\n\n\n```javascript\nconst cryptoRandomString = require('crypto-random-string');\n\nconst digits = cryptoRandomString({length: 10, type: 'numeric'});\n```\nAlternatively, the issue can be fixed by fixing the math in the original code. In the code below the random byte is discarded if the value is greater than or equal to 250. Thus the modulo operator is used on a uniformly random number between 0 and 249, which results in a uniformly random digit between 0 and 9.\n\n\n```javascript\nconst crypto = require('crypto');\n\nconst digits = [];\nwhile (digits.length < 10) {\n    const byte = crypto.randomBytes(1)[0];\n    if (byte >= 250) {\n        continue;\n    }\n    digits.push(byte % 10); // OK\n}\n```\n\n## References\n* Stack Overflow: [Understanding randomness](https://stackoverflow.com/questions/3956478/understanding-randomness).\n* OWASP: [Insecure Randomness](https://owasp.org/www-community/vulnerabilities/Insecure_Randomness).\n* OWASP: [Rule - Use strong approved cryptographic algorithms](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#rule---use-strong-approved-authenticated-encryption).\n* Common Weakness Enumeration: [CWE-327](https://cwe.mitre.org/data/definitions/327.html).\n",
            "markdown" : "# Creating biased random numbers from a cryptographically secure source.\nGenerating secure random numbers can be an important part of creating a secure software system. This can be done using APIs that create cryptographically secure random numbers.\n\nHowever, using some mathematical operations on these cryptographically secure random numbers can create biased results, where some outcomes are more likely than others. Such biased results can make it easier for an attacker to guess the random numbers, and thereby break the security of the software system.\n\n\n## Recommendation\nBe very careful not to introduce bias when performing mathematical operations on cryptographically secure random numbers.\n\nIf possible, avoid performing mathematical operations on cryptographically secure random numbers at all, and use a preexisting library instead.\n\n\n## Example\nThe example below uses the modulo operator to create an array of 10 random digits using random bytes as the source for randomness.\n\n\n```javascript\nconst crypto = require('crypto');\n\nconst digits = [];\nfor (let i = 0; i < 10; i++) {\n    digits.push(crypto.randomBytes(1)[0] % 10); // NOT OK\n}\n```\nThe random byte is a uniformly random value between 0 and 255, and thus the result from using the modulo operator is slightly more likely to be between 0 and 5 than between 6 and 9.\n\nThe issue has been fixed in the code below by using a library that correctly generates cryptographically secure random values.\n\n\n```javascript\nconst cryptoRandomString = require('crypto-random-string');\n\nconst digits = cryptoRandomString({length: 10, type: 'numeric'});\n```\nAlternatively, the issue can be fixed by fixing the math in the original code. In the code below the random byte is discarded if the value is greater than or equal to 250. Thus the modulo operator is used on a uniformly random number between 0 and 249, which results in a uniformly random digit between 0 and 9.\n\n\n```javascript\nconst crypto = require('crypto');\n\nconst digits = [];\nwhile (digits.length < 10) {\n    const byte = crypto.randomBytes(1)[0];\n    if (byte >= 250) {\n        continue;\n    }\n    digits.push(byte % 10); // OK\n}\n```\n\n## References\n* Stack Overflow: [Understanding randomness](https://stackoverflow.com/questions/3956478/understanding-randomness).\n* OWASP: [Insecure Randomness](https://owasp.org/www-community/vulnerabilities/Insecure_Randomness).\n* OWASP: [Rule - Use strong approved cryptographic algorithms](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#rule---use-strong-approved-authenticated-encryption).\n* Common Weakness Enumeration: [CWE-327](https://cwe.mitre.org/data/definitions/327.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-327" ],
            "description" : "Some mathematical operations on random numbers can cause bias in\n              the results and compromise security.",
            "id" : "js/biased-cryptographic-random",
            "kind" : "problem",
            "name" : "Creating biased random numbers from a cryptographically secure source.",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/weak-cryptographic-algorithm",
          "name" : "js/weak-cryptographic-algorithm",
          "shortDescription" : {
            "text" : "Use of a broken or weak cryptographic algorithm"
          },
          "fullDescription" : {
            "text" : "Using broken or weak cryptographic algorithms can compromise security."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Use of a broken or weak cryptographic algorithm\nUsing broken or weak cryptographic algorithms can leave data vulnerable to being decrypted or forged by an attacker.\n\nMany cryptographic algorithms provided by cryptography libraries are known to be weak, or flawed. Using such an algorithm means that encrypted or hashed data is less secure than it appears to be.\n\n\n## Recommendation\nEnsure that you use a strong, modern cryptographic algorithm. Use at least AES-128 or RSA-2048 for encryption, and SHA-2 or SHA-3 for secure hashing.\n\n\n## Example\nThe following code shows an example of using the builtin cryptographic library of NodeJS to encrypt some secret data. When creating a `Cipher` instance to encrypt the secret data with, you must specify the encryption algorithm to use. The first example uses DES, which is an older algorithm that is now considered weak. The second example uses AES, which is a strong modern algorithm.\n\n\n```javascript\nconst crypto = require('crypto');\n\nvar secretText = obj.getSecretText();\n\nconst desCipher = crypto.createCipher('des', key);\nlet desEncrypted = desCipher.write(secretText, 'utf8', 'hex'); // BAD: weak encryption\n\nconst aesCipher = crypto.createCipher('aes-128', key);\nlet aesEncrypted = aesCipher.update(secretText, 'utf8', 'hex'); // GOOD: strong encryption\n\n```\n\n## References\n* NIST, FIPS 140 Annex a: [ Approved Security Functions](http://csrc.nist.gov/publications/fips/fips140-2/fips1402annexa.pdf).\n* NIST, SP 800-131A: [ Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths](http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf).\n* OWASP: [Rule - Use strong approved cryptographic algorithms](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#rule---use-strong-approved-authenticated-encryption).\n* Common Weakness Enumeration: [CWE-327](https://cwe.mitre.org/data/definitions/327.html).\n* Common Weakness Enumeration: [CWE-328](https://cwe.mitre.org/data/definitions/328.html).\n",
            "markdown" : "# Use of a broken or weak cryptographic algorithm\nUsing broken or weak cryptographic algorithms can leave data vulnerable to being decrypted or forged by an attacker.\n\nMany cryptographic algorithms provided by cryptography libraries are known to be weak, or flawed. Using such an algorithm means that encrypted or hashed data is less secure than it appears to be.\n\n\n## Recommendation\nEnsure that you use a strong, modern cryptographic algorithm. Use at least AES-128 or RSA-2048 for encryption, and SHA-2 or SHA-3 for secure hashing.\n\n\n## Example\nThe following code shows an example of using the builtin cryptographic library of NodeJS to encrypt some secret data. When creating a `Cipher` instance to encrypt the secret data with, you must specify the encryption algorithm to use. The first example uses DES, which is an older algorithm that is now considered weak. The second example uses AES, which is a strong modern algorithm.\n\n\n```javascript\nconst crypto = require('crypto');\n\nvar secretText = obj.getSecretText();\n\nconst desCipher = crypto.createCipher('des', key);\nlet desEncrypted = desCipher.write(secretText, 'utf8', 'hex'); // BAD: weak encryption\n\nconst aesCipher = crypto.createCipher('aes-128', key);\nlet aesEncrypted = aesCipher.update(secretText, 'utf8', 'hex'); // GOOD: strong encryption\n\n```\n\n## References\n* NIST, FIPS 140 Annex a: [ Approved Security Functions](http://csrc.nist.gov/publications/fips/fips140-2/fips1402annexa.pdf).\n* NIST, SP 800-131A: [ Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths](http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf).\n* OWASP: [Rule - Use strong approved cryptographic algorithms](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#rule---use-strong-approved-authenticated-encryption).\n* Common Weakness Enumeration: [CWE-327](https://cwe.mitre.org/data/definitions/327.html).\n* Common Weakness Enumeration: [CWE-328](https://cwe.mitre.org/data/definitions/328.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-327", "external/cwe/cwe-328" ],
            "description" : "Using broken or weak cryptographic algorithms can compromise security.",
            "id" : "js/weak-cryptographic-algorithm",
            "kind" : "path-problem",
            "name" : "Use of a broken or weak cryptographic algorithm",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/insecure-randomness",
          "name" : "js/insecure-randomness",
          "shortDescription" : {
            "text" : "Insecure randomness"
          },
          "fullDescription" : {
            "text" : "Using a cryptographically weak pseudo-random number generator to generate a security-sensitive value may allow an attacker to predict what value will be generated."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Insecure randomness\nUsing a cryptographically weak pseudo-random number generator to generate a security-sensitive value, such as a password, makes it easier for an attacker to predict the value.\n\nPseudo-random number generators generate a sequence of numbers that only approximates the properties of random numbers. The sequence is not truly random because it is completely determined by a relatively small set of initial values, the seed. If the random number generator is cryptographically weak, then this sequence may be easily predictable through outside observations.\n\n\n## Recommendation\nUse a cryptographically secure pseudo-random number generator if the output is to be used in a security-sensitive context. As a rule of thumb, a value should be considered \"security-sensitive\" if predicting it would allow the attacker to perform an action that they would otherwise be unable to perform. For example, if an attacker could predict the random password generated for a new user, they would be able to log in as that new user.\n\nFor JavaScript on the NodeJS platform, `crypto.getRandomBytes` provides a cryptographically secure pseudo-random byte generator. Note that the conversion from bytes to numbers can introduce bias that breaks the security.\n\nFor JavaScript in the browser, `RandomSource.getRandomValues` provides a cryptographically secure pseudo-random number generator.\n\n\n## Example\nThe following examples show different ways of generating a password.\n\nIn the first case, we generate a fresh password by appending a random integer to the end of a static string. The random number generator used (`Math.random`) is not cryptographically secure, so it may be possible for an attacker to predict the generated password.\n\n\n```javascript\nfunction insecurePassword() {\n    // BAD: the random suffix is not cryptographically secure\n    var suffix = Math.random();\n    var password = \"myPassword\" + suffix;\n    return password;\n}\n\n```\nIn the second example, a cryptographically secure random number generator is used for the same purpose. In this case, it is much harder to predict the generated integers.\n\n\n```javascript\nfunction securePassword() {\n    // GOOD: the random suffix is cryptographically secure\n    var suffix = window.crypto.getRandomValues(new Uint32Array(1))[0];\n    var password = \"myPassword\" + suffix;\n    return password;\n}\n\n```\n\n## References\n* Wikipedia: [Pseudo-random number generator](http://en.wikipedia.org/wiki/Pseudorandom_number_generator).\n* Mozilla Developer Network: [RandomSource.getRandomValues](https://developer.mozilla.org/en-US/docs/Web/API/RandomSource/getRandomValues).\n* NodeJS: [crypto.randomBytes](https://nodejs.org/api/crypto.html#crypto_crypto_randombytes_size_callback)\n* Common Weakness Enumeration: [CWE-338](https://cwe.mitre.org/data/definitions/338.html).\n",
            "markdown" : "# Insecure randomness\nUsing a cryptographically weak pseudo-random number generator to generate a security-sensitive value, such as a password, makes it easier for an attacker to predict the value.\n\nPseudo-random number generators generate a sequence of numbers that only approximates the properties of random numbers. The sequence is not truly random because it is completely determined by a relatively small set of initial values, the seed. If the random number generator is cryptographically weak, then this sequence may be easily predictable through outside observations.\n\n\n## Recommendation\nUse a cryptographically secure pseudo-random number generator if the output is to be used in a security-sensitive context. As a rule of thumb, a value should be considered \"security-sensitive\" if predicting it would allow the attacker to perform an action that they would otherwise be unable to perform. For example, if an attacker could predict the random password generated for a new user, they would be able to log in as that new user.\n\nFor JavaScript on the NodeJS platform, `crypto.getRandomBytes` provides a cryptographically secure pseudo-random byte generator. Note that the conversion from bytes to numbers can introduce bias that breaks the security.\n\nFor JavaScript in the browser, `RandomSource.getRandomValues` provides a cryptographically secure pseudo-random number generator.\n\n\n## Example\nThe following examples show different ways of generating a password.\n\nIn the first case, we generate a fresh password by appending a random integer to the end of a static string. The random number generator used (`Math.random`) is not cryptographically secure, so it may be possible for an attacker to predict the generated password.\n\n\n```javascript\nfunction insecurePassword() {\n    // BAD: the random suffix is not cryptographically secure\n    var suffix = Math.random();\n    var password = \"myPassword\" + suffix;\n    return password;\n}\n\n```\nIn the second example, a cryptographically secure random number generator is used for the same purpose. In this case, it is much harder to predict the generated integers.\n\n\n```javascript\nfunction securePassword() {\n    // GOOD: the random suffix is cryptographically secure\n    var suffix = window.crypto.getRandomValues(new Uint32Array(1))[0];\n    var password = \"myPassword\" + suffix;\n    return password;\n}\n\n```\n\n## References\n* Wikipedia: [Pseudo-random number generator](http://en.wikipedia.org/wiki/Pseudorandom_number_generator).\n* Mozilla Developer Network: [RandomSource.getRandomValues](https://developer.mozilla.org/en-US/docs/Web/API/RandomSource/getRandomValues).\n* NodeJS: [crypto.randomBytes](https://nodejs.org/api/crypto.html#crypto_crypto_randombytes_size_callback)\n* Common Weakness Enumeration: [CWE-338](https://cwe.mitre.org/data/definitions/338.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-338" ],
            "description" : "Using a cryptographically weak pseudo-random number generator to generate a\n              security-sensitive value may allow an attacker to predict what value will\n              be generated.",
            "id" : "js/insecure-randomness",
            "kind" : "path-problem",
            "name" : "Insecure randomness",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "js/cors-misconfiguration-for-credentials",
          "name" : "js/cors-misconfiguration-for-credentials",
          "shortDescription" : {
            "text" : "CORS misconfiguration for credentials transfer"
          },
          "fullDescription" : {
            "text" : "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
            "markdown" : "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942" ],
            "description" : "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
            "id" : "js/cors-misconfiguration-for-credentials",
            "kind" : "path-problem",
            "name" : "CORS misconfiguration for credentials transfer",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/jwt-missing-verification",
          "name" : "js/jwt-missing-verification",
          "shortDescription" : {
            "text" : "JWT missing secret or public key verification"
          },
          "fullDescription" : {
            "text" : "The application does not verify the JWT payload with a cryptographic secret or public key."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# JWT missing secret or public key verification\nApplications decoding JSON Web Tokens (JWT) may be misconfigured due to the `None` algorithm.\n\nThe `None` algorithm is selected by calling the `verify()` function with a falsy value instead of a cryptographic secret or key. The `None` algorithm disables the integrity enforcement of a JWT payload and may allow a malicious actor to make unintended changes to a JWT payload leading to critical security issues like privilege escalation.\n\n\n## Recommendation\nCalls to `verify()` functions should use a cryptographic secret or key to decode JWT payloads.\n\n\n## Example\nIn the example below, `false` is used to disable the integrity enforcement of a JWT payload. This may allow a malicious actor to make changes to a JWT payload.\n\n\n```javascript\nconst jwt = require(\"jsonwebtoken\");\n\nconst secret = \"my-secret-key\";\n\nvar token = jwt.sign({ foo: 'bar' }, secret, { algorithm: \"none\" })\njwt.verify(token, false, { algorithms: [\"HS256\", \"none\"] })\n```\nThe following code fixes the problem by using a cryptographic secret or key to decode JWT payloads.\n\n\n```javascript\n\nconst jwt = require(\"jsonwebtoken\");\n\nconst secret = \"my-secret-key\";\n\nvar token = jwt.sign({ foo: 'bar' }, secret, { algorithm: \"HS256\" }) \njwt.verify(token, secret, { algorithms: [\"HS256\", \"none\"] })\n```\n\n## References\n* Auth0 Blog: [Meet the \"None\" Algorithm](https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/#Meet-the--None--Algorithm).\n* Common Weakness Enumeration: [CWE-347](https://cwe.mitre.org/data/definitions/347.html).\n",
            "markdown" : "# JWT missing secret or public key verification\nApplications decoding JSON Web Tokens (JWT) may be misconfigured due to the `None` algorithm.\n\nThe `None` algorithm is selected by calling the `verify()` function with a falsy value instead of a cryptographic secret or key. The `None` algorithm disables the integrity enforcement of a JWT payload and may allow a malicious actor to make unintended changes to a JWT payload leading to critical security issues like privilege escalation.\n\n\n## Recommendation\nCalls to `verify()` functions should use a cryptographic secret or key to decode JWT payloads.\n\n\n## Example\nIn the example below, `false` is used to disable the integrity enforcement of a JWT payload. This may allow a malicious actor to make changes to a JWT payload.\n\n\n```javascript\nconst jwt = require(\"jsonwebtoken\");\n\nconst secret = \"my-secret-key\";\n\nvar token = jwt.sign({ foo: 'bar' }, secret, { algorithm: \"none\" })\njwt.verify(token, false, { algorithms: [\"HS256\", \"none\"] })\n```\nThe following code fixes the problem by using a cryptographic secret or key to decode JWT payloads.\n\n\n```javascript\n\nconst jwt = require(\"jsonwebtoken\");\n\nconst secret = \"my-secret-key\";\n\nvar token = jwt.sign({ foo: 'bar' }, secret, { algorithm: \"HS256\" }) \njwt.verify(token, secret, { algorithms: [\"HS256\", \"none\"] })\n```\n\n## References\n* Auth0 Blog: [Meet the \"None\" Algorithm](https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/#Meet-the--None--Algorithm).\n* Common Weakness Enumeration: [CWE-347](https://cwe.mitre.org/data/definitions/347.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-347" ],
            "description" : "The application does not verify the JWT payload with a cryptographic secret or public key.",
            "id" : "js/jwt-missing-verification",
            "kind" : "problem",
            "name" : "JWT missing secret or public key verification",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.0"
          }
        }, {
          "id" : "js/missing-token-validation",
          "name" : "js/missing-token-validation",
          "shortDescription" : {
            "text" : "Missing CSRF middleware"
          },
          "fullDescription" : {
            "text" : "Using cookies without CSRF protection may allow malicious websites to submit requests on behalf of the user."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Missing CSRF middleware\nWebsites that rely on cookie-based authentication may be vulnerable to cross-site request forgery (CSRF). Specifically, a state-changing request should include a secret token so the request can't be forged by an attacker. Otherwise, unwanted requests can be submitted on behalf of a user who visits a malicious website.\n\nThis is typically mitigated by embedding a session-specific secret token in each request. This token is then checked as an additional authentication measure. A malicious website should have no way of guessing the correct token to embed in the request.\n\n\n## Recommendation\nUse a middleware package such as `csurf` to protect against CSRF attacks.\n\n\n## Example\nIn the example below, the server authenticates users before performing the `changeEmail` POST action:\n\n\n```javascript\nvar app = require(\"express\")(),\n  cookieParser = require(\"cookie-parser\"),\n  passport = require(\"passport\");\n\napp.use(cookieParser());\napp.use(passport.authorize({ session: true }));\n\napp.post(\"/changeEmail\", function(req, res) {\n  let newEmail = req.cookies[\"newEmail\"];\n  // ...\n});\n\n```\nThis is not secure. An attacker can submit a POST `changeEmail` request on behalf of a user who visited a malicious website. Since authentication happens without any action from the user, the `changeEmail` action would be executed, despite not being initiated by the user.\n\nThis vulnerability can be mitigated by installing a CSRF protecting middleware handler:\n\n\n```javascript\nvar app = require(\"express\")(),\n  cookieParser = require(\"cookie-parser\"),\n  passport = require(\"passport\"),\n  csrf = require(\"csurf\");\n\napp.use(cookieParser());\napp.use(passport.authorize({ session: true }));\napp.use(csrf({ cookie: true }));\napp.post(\"/changeEmail\", function(req, res) {\n  let newEmail = req.cookies[\"newEmail\"];\n  // ...\n});\n\n```\n\n## References\n* OWASP: [Cross-Site Request Forgery (CSRF)](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))\n* NPM: [csurf](https://www.npmjs.com/package/csurf)\n* Common Weakness Enumeration: [CWE-352](https://cwe.mitre.org/data/definitions/352.html).\n",
            "markdown" : "# Missing CSRF middleware\nWebsites that rely on cookie-based authentication may be vulnerable to cross-site request forgery (CSRF). Specifically, a state-changing request should include a secret token so the request can't be forged by an attacker. Otherwise, unwanted requests can be submitted on behalf of a user who visits a malicious website.\n\nThis is typically mitigated by embedding a session-specific secret token in each request. This token is then checked as an additional authentication measure. A malicious website should have no way of guessing the correct token to embed in the request.\n\n\n## Recommendation\nUse a middleware package such as `csurf` to protect against CSRF attacks.\n\n\n## Example\nIn the example below, the server authenticates users before performing the `changeEmail` POST action:\n\n\n```javascript\nvar app = require(\"express\")(),\n  cookieParser = require(\"cookie-parser\"),\n  passport = require(\"passport\");\n\napp.use(cookieParser());\napp.use(passport.authorize({ session: true }));\n\napp.post(\"/changeEmail\", function(req, res) {\n  let newEmail = req.cookies[\"newEmail\"];\n  // ...\n});\n\n```\nThis is not secure. An attacker can submit a POST `changeEmail` request on behalf of a user who visited a malicious website. Since authentication happens without any action from the user, the `changeEmail` action would be executed, despite not being initiated by the user.\n\nThis vulnerability can be mitigated by installing a CSRF protecting middleware handler:\n\n\n```javascript\nvar app = require(\"express\")(),\n  cookieParser = require(\"cookie-parser\"),\n  passport = require(\"passport\"),\n  csrf = require(\"csurf\");\n\napp.use(cookieParser());\napp.use(passport.authorize({ session: true }));\napp.use(csrf({ cookie: true }));\napp.post(\"/changeEmail\", function(req, res) {\n  let newEmail = req.cookies[\"newEmail\"];\n  // ...\n});\n\n```\n\n## References\n* OWASP: [Cross-Site Request Forgery (CSRF)](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))\n* NPM: [csurf](https://www.npmjs.com/package/csurf)\n* Common Weakness Enumeration: [CWE-352](https://cwe.mitre.org/data/definitions/352.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-352" ],
            "description" : "Using cookies without CSRF protection may allow malicious websites to\n              submit requests on behalf of the user.",
            "id" : "js/missing-token-validation",
            "kind" : "problem",
            "name" : "Missing CSRF middleware",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "js/resource-exhaustion-from-deep-object-traversal",
          "name" : "js/resource-exhaustion-from-deep-object-traversal",
          "shortDescription" : {
            "text" : "Resources exhaustion from deep object traversal"
          },
          "fullDescription" : {
            "text" : "Processing user-controlled object hierarchies inefficiently can lead to denial of service."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Resources exhaustion from deep object traversal\nProcessing user-controlled data with a method that allocates excessive amounts of memory can lead to denial of service.\n\nIf the JSON schema validation library `ajv` is configured with `allErrors: true` there is no limit to how many error objects will be allocated. An attacker can exploit this by sending an object that deliberately contains a huge number of errors, and in some cases, with longer and longer error messages. This can cause the service to become unresponsive due to the slow error-checking process.\n\n\n## Recommendation\nDo not use `allErrors: true` in production.\n\n\n## Example\nIn the example below, the user-submitted object `req.body` is validated using `ajv` and `allErrors: true`:\n\n\n```javascript\nimport express from 'express';\nimport Ajv from 'ajv';\n\nlet ajv = new Ajv({ allErrors: true });\najv.addSchema(require('./input-schema'), 'input');\n\nvar app = express();\napp.get('/user/:id', function(req, res) {\n\tif (!ajv.validate('input', req.body)) {\n\t\tres.end(ajv.errorsText());\n\t\treturn;\n\t}\n\t// ...\n});\n\n```\nAlthough this ensures that `req.body` conforms to the schema, the validation itself could be vulnerable to a denial-of-service attack. An attacker could send an object containing so many errors that the server runs out of memory.\n\nA solution is to not pass in `allErrors: true`, which means `ajv` will only report the first error, not all of them:\n\n\n```javascript\nimport express from 'express';\nimport Ajv from 'ajv';\n\nlet ajv = new Ajv({ allErrors: process.env['REST_DEBUG'] });\najv.addSchema(require('./input-schema'), 'input');\n\nvar app = express();\napp.get('/user/:id', function(req, res) {\n\tif (!ajv.validate('input', req.body)) {\n\t\tres.end(ajv.errorsText());\n\t\treturn;\n\t}\n\t// ...\n});\n\n```\n\n## References\n* Ajv documentation: [security considerations](https://github.com/ajv-validator/ajv/blob/master/docs/security.md#untrusted-schemas)\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n",
            "markdown" : "# Resources exhaustion from deep object traversal\nProcessing user-controlled data with a method that allocates excessive amounts of memory can lead to denial of service.\n\nIf the JSON schema validation library `ajv` is configured with `allErrors: true` there is no limit to how many error objects will be allocated. An attacker can exploit this by sending an object that deliberately contains a huge number of errors, and in some cases, with longer and longer error messages. This can cause the service to become unresponsive due to the slow error-checking process.\n\n\n## Recommendation\nDo not use `allErrors: true` in production.\n\n\n## Example\nIn the example below, the user-submitted object `req.body` is validated using `ajv` and `allErrors: true`:\n\n\n```javascript\nimport express from 'express';\nimport Ajv from 'ajv';\n\nlet ajv = new Ajv({ allErrors: true });\najv.addSchema(require('./input-schema'), 'input');\n\nvar app = express();\napp.get('/user/:id', function(req, res) {\n\tif (!ajv.validate('input', req.body)) {\n\t\tres.end(ajv.errorsText());\n\t\treturn;\n\t}\n\t// ...\n});\n\n```\nAlthough this ensures that `req.body` conforms to the schema, the validation itself could be vulnerable to a denial-of-service attack. An attacker could send an object containing so many errors that the server runs out of memory.\n\nA solution is to not pass in `allErrors: true`, which means `ajv` will only report the first error, not all of them:\n\n\n```javascript\nimport express from 'express';\nimport Ajv from 'ajv';\n\nlet ajv = new Ajv({ allErrors: process.env['REST_DEBUG'] });\najv.addSchema(require('./input-schema'), 'input');\n\nvar app = express();\napp.get('/user/:id', function(req, res) {\n\tif (!ajv.validate('input', req.body)) {\n\t\tres.end(ajv.errorsText());\n\t\treturn;\n\t}\n\t// ...\n});\n\n```\n\n## References\n* Ajv documentation: [security considerations](https://github.com/ajv-validator/ajv/blob/master/docs/security.md#untrusted-schemas)\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-400" ],
            "description" : "Processing user-controlled object hierarchies inefficiently can lead to denial of service.",
            "id" : "js/resource-exhaustion-from-deep-object-traversal",
            "kind" : "path-problem",
            "name" : "Resources exhaustion from deep object traversal",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/unsafe-deserialization",
          "name" : "js/unsafe-deserialization",
          "shortDescription" : {
            "text" : "Deserialization of user-controlled data"
          },
          "fullDescription" : {
            "text" : "Deserializing user-controlled data may allow attackers to execute arbitrary code."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Deserialization of user-controlled data\nDeserializing untrusted data using any deserialization framework that allows the construction of arbitrary functions is easily exploitable and, in many cases, allows an attacker to execute arbitrary code.\n\n\n## Recommendation\nAvoid deserialization of untrusted data if at all possible. If the architecture permits it, then use formats like JSON or XML that cannot represent functions. When using YAML or other formats that support the serialization and deserialization of functions, ensure that the parser is configured to disable deserialization of arbitrary functions.\n\n\n## Example\nThe following example calls the `load` function of the popular `js-yaml` package on data that comes from an HTTP request and hence is inherently unsafe.\n\n\n```javascript\nconst app = require(\"express\")(),\n  jsyaml = require(\"js-yaml\");\n\napp.get(\"load\", function(req, res) {\n  let data = jsyaml.load(req.params.data);\n  // ...\n});\n\n```\nUsing the `safeLoad` function instead (which does not deserialize YAML-encoded functions) removes the vulnerability.\n\n\n```javascript\nconst app = require(\"express\")(),\n  jsyaml = require(\"js-yaml\");\n\napp.get(\"load\", function(req, res) {\n  let data = jsyaml.safeLoad(req.params.data);\n  // ...\n});\n\n```\n\n## References\n* OWASP vulnerability description: [Deserialization of untrusted data](https://www.owasp.org/index.php/Deserialization_of_untrusted_data).\n* OWASP guidance on deserializing objects: [Deserialization Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html).\n* Neal Poole: [Code Execution via YAML in JS-YAML Node.js Module](https://nealpoole.com/blog/2013/06/code-execution-via-yaml-in-js-yaml-nodejs-module/).\n* Common Weakness Enumeration: [CWE-502](https://cwe.mitre.org/data/definitions/502.html).\n",
            "markdown" : "# Deserialization of user-controlled data\nDeserializing untrusted data using any deserialization framework that allows the construction of arbitrary functions is easily exploitable and, in many cases, allows an attacker to execute arbitrary code.\n\n\n## Recommendation\nAvoid deserialization of untrusted data if at all possible. If the architecture permits it, then use formats like JSON or XML that cannot represent functions. When using YAML or other formats that support the serialization and deserialization of functions, ensure that the parser is configured to disable deserialization of arbitrary functions.\n\n\n## Example\nThe following example calls the `load` function of the popular `js-yaml` package on data that comes from an HTTP request and hence is inherently unsafe.\n\n\n```javascript\nconst app = require(\"express\")(),\n  jsyaml = require(\"js-yaml\");\n\napp.get(\"load\", function(req, res) {\n  let data = jsyaml.load(req.params.data);\n  // ...\n});\n\n```\nUsing the `safeLoad` function instead (which does not deserialize YAML-encoded functions) removes the vulnerability.\n\n\n```javascript\nconst app = require(\"express\")(),\n  jsyaml = require(\"js-yaml\");\n\napp.get(\"load\", function(req, res) {\n  let data = jsyaml.safeLoad(req.params.data);\n  // ...\n});\n\n```\n\n## References\n* OWASP vulnerability description: [Deserialization of untrusted data](https://www.owasp.org/index.php/Deserialization_of_untrusted_data).\n* OWASP guidance on deserializing objects: [Deserialization Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html).\n* Neal Poole: [Code Execution via YAML in JS-YAML Node.js Module](https://nealpoole.com/blog/2013/06/code-execution-via-yaml-in-js-yaml-nodejs-module/).\n* Common Weakness Enumeration: [CWE-502](https://cwe.mitre.org/data/definitions/502.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-502" ],
            "description" : "Deserializing user-controlled data may allow attackers to\n              execute arbitrary code.",
            "id" : "js/unsafe-deserialization",
            "kind" : "path-problem",
            "name" : "Deserialization of user-controlled data",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "js/sensitive-get-query",
          "name" : "js/sensitive-get-query",
          "shortDescription" : {
            "text" : "Sensitive data read from GET request"
          },
          "fullDescription" : {
            "text" : "Placing sensitive data in a GET request increases the risk of the data being exposed to an attacker."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Sensitive data read from GET request\nSensitive information such as user passwords should not be transmitted within the query string of the requested URL. Sensitive information within URLs may be logged in various locations, including the user's browser, the web server, and any forward or reverse proxy servers between the two endpoints. URLs may also be displayed on-screen, bookmarked or emailed around by users. They may be disclosed to third parties via the Referer header when any off-site links are followed. Placing sensitive information into the URL therefore increases the risk that it will be captured by an attacker.\n\n\n## Recommendation\nUse HTTP POST to send sensitive information as part of the request body; for example, as form data.\n\n\n## Example\nThe following example shows two route handlers that both receive a username and a password. The first receives this sensitive information from the query parameters of a GET request, which is transmitted in the URL. The second receives this sensitive information from the request body of a POST request.\n\n\n```javascript\nconst express = require('express');\nconst app = express();\napp.use(require('body-parser').urlencoded({ extended: false }))\n\n// bad: sensitive information is read from query parameters\napp.get('/login1', (req, res) => {\n    const user = req.query.user;\n    const password = req.query.password;\n    if (checkUser(user, password)) {\n        res.send('Welcome');\n    } else {\n        res.send('Access denied');\n    }\n});\n\n// good: sensitive information is read from post body\napp.post('/login2', (req, res) => {\n    const user = req.body.user;\n    const password = req.body.password;\n    if (checkUser(user, password)) {\n        res.send('Welcome');\n    } else {\n        res.send('Access denied');\n    }\n});\n\n```\n\n## References\n* CWE: [CWE-598: Use of GET Request Method with Sensitive Query Strings](https://cwe.mitre.org/data/definitions/598.html)\n* PortSwigger (Burp): [Password Submitted using GET Method](https://portswigger.net/kb/issues/00400300_password-submitted-using-get-method)\n* OWASP: [Information Exposure through Query Strings in URL](https://owasp.org/www-community/vulnerabilities/Information_exposure_through_query_strings_in_url)\n* Common Weakness Enumeration: [CWE-598](https://cwe.mitre.org/data/definitions/598.html).\n",
            "markdown" : "# Sensitive data read from GET request\nSensitive information such as user passwords should not be transmitted within the query string of the requested URL. Sensitive information within URLs may be logged in various locations, including the user's browser, the web server, and any forward or reverse proxy servers between the two endpoints. URLs may also be displayed on-screen, bookmarked or emailed around by users. They may be disclosed to third parties via the Referer header when any off-site links are followed. Placing sensitive information into the URL therefore increases the risk that it will be captured by an attacker.\n\n\n## Recommendation\nUse HTTP POST to send sensitive information as part of the request body; for example, as form data.\n\n\n## Example\nThe following example shows two route handlers that both receive a username and a password. The first receives this sensitive information from the query parameters of a GET request, which is transmitted in the URL. The second receives this sensitive information from the request body of a POST request.\n\n\n```javascript\nconst express = require('express');\nconst app = express();\napp.use(require('body-parser').urlencoded({ extended: false }))\n\n// bad: sensitive information is read from query parameters\napp.get('/login1', (req, res) => {\n    const user = req.query.user;\n    const password = req.query.password;\n    if (checkUser(user, password)) {\n        res.send('Welcome');\n    } else {\n        res.send('Access denied');\n    }\n});\n\n// good: sensitive information is read from post body\napp.post('/login2', (req, res) => {\n    const user = req.body.user;\n    const password = req.body.password;\n    if (checkUser(user, password)) {\n        res.send('Welcome');\n    } else {\n        res.send('Access denied');\n    }\n});\n\n```\n\n## References\n* CWE: [CWE-598: Use of GET Request Method with Sensitive Query Strings](https://cwe.mitre.org/data/definitions/598.html)\n* PortSwigger (Burp): [Password Submitted using GET Method](https://portswigger.net/kb/issues/00400300_password-submitted-using-get-method)\n* OWASP: [Information Exposure through Query Strings in URL](https://owasp.org/www-community/vulnerabilities/Information_exposure_through_query_strings_in_url)\n* Common Weakness Enumeration: [CWE-598](https://cwe.mitre.org/data/definitions/598.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-598" ],
            "description" : "Placing sensitive data in a GET request increases the risk of\n              the data being exposed to an attacker.",
            "id" : "js/sensitive-get-query",
            "kind" : "problem",
            "name" : "Sensitive data read from GET request",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "6.5"
          }
        }, {
          "id" : "js/client-side-unvalidated-url-redirection",
          "name" : "js/client-side-unvalidated-url-redirection",
          "shortDescription" : {
            "text" : "Client-side URL redirect"
          },
          "fullDescription" : {
            "text" : "Client-side URL redirection based on unvalidated user input may cause redirection to malicious web sites."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Client-side URL redirect\nRedirecting to a URL that is constructed from parts of the DOM that may be controlled by an attacker can facilitate phishing attacks. In these attacks, unsuspecting users can be redirected to a malicious site that looks very similar to the real site they intend to visit, but which is controlled by the attacker.\n\n\n## Recommendation\nTo guard against untrusted URL redirection, it is advisable to avoid putting user input directly into a redirect URL. Instead, maintain a list of authorized redirects on the server; then choose from that list based on the user input provided.\n\n\n## Example\nThe following example uses a regular expression to extract a query parameter from the document URL, and then uses it to construct a new URL to redirect to without any further validation. This may allow an attacker to craft a link that redirects from a trusted website to some arbitrary website of their choosing, which facilitates phishing attacks:\n\n\n```javascript\nwindow.location = /.*redirect=([^&]*).*/.exec(document.location.href)[1];\n\n```\n\n## References\n* OWASP: [ XSS Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n* Common Weakness Enumeration: [CWE-601](https://cwe.mitre.org/data/definitions/601.html).\n",
            "markdown" : "# Client-side URL redirect\nRedirecting to a URL that is constructed from parts of the DOM that may be controlled by an attacker can facilitate phishing attacks. In these attacks, unsuspecting users can be redirected to a malicious site that looks very similar to the real site they intend to visit, but which is controlled by the attacker.\n\n\n## Recommendation\nTo guard against untrusted URL redirection, it is advisable to avoid putting user input directly into a redirect URL. Instead, maintain a list of authorized redirects on the server; then choose from that list based on the user input provided.\n\n\n## Example\nThe following example uses a regular expression to extract a query parameter from the document URL, and then uses it to construct a new URL to redirect to without any further validation. This may allow an attacker to craft a link that redirects from a trusted website to some arbitrary website of their choosing, which facilitates phishing attacks:\n\n\n```javascript\nwindow.location = /.*redirect=([^&]*).*/.exec(document.location.href)[1];\n\n```\n\n## References\n* OWASP: [ XSS Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n* Common Weakness Enumeration: [CWE-601](https://cwe.mitre.org/data/definitions/601.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079", "external/cwe/cwe-116", "external/cwe/cwe-601" ],
            "description" : "Client-side URL redirection based on unvalidated user input\n              may cause redirection to malicious web sites.",
            "id" : "js/client-side-unvalidated-url-redirection",
            "kind" : "path-problem",
            "name" : "Client-side URL redirect",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/server-side-unvalidated-url-redirection",
          "name" : "js/server-side-unvalidated-url-redirection",
          "shortDescription" : {
            "text" : "Server-side URL redirect"
          },
          "fullDescription" : {
            "text" : "Server-side URL redirection based on unvalidated user input may cause redirection to malicious web sites."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Server-side URL redirect\nDirectly incorporating user input into a URL redirect request without validating the input can facilitate phishing attacks. In these attacks, unsuspecting users can be redirected to a malicious site that looks very similar to the real site they intend to visit, but which is controlled by the attacker.\n\n\n## Recommendation\nTo guard against untrusted URL redirection, it is advisable to avoid putting user input directly into a redirect URL. Instead, maintain a list of authorized redirects on the server; then choose from that list based on the user input provided.\n\n\n## Example\nThe following example shows an HTTP request parameter being used directly in a URL redirect without validating the input, which facilitates phishing attacks:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get('/some/path', function(req, res) {\n  // BAD: a request parameter is incorporated without validation into a URL redirect\n  res.redirect(req.param(\"target\"));\n});\n\n```\nOne way to remedy the problem is to validate the user input against a known fixed string before doing the redirection:\n\n\n```javascript\nconst app = require(\"express\")();\n\nconst VALID_REDIRECT = \"http://cwe.mitre.org/data/definitions/601.html\";\n\napp.get('/some/path', function(req, res) {\n  // GOOD: the request parameter is validated against a known fixed string\n  let target = req.param(\"target\");\n  if (VALID_REDIRECT === target)\n    res.redirect(target);\n});\n\n```\n\n## References\n* OWASP: [ XSS Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html).\n* Common Weakness Enumeration: [CWE-601](https://cwe.mitre.org/data/definitions/601.html).\n",
            "markdown" : "# Server-side URL redirect\nDirectly incorporating user input into a URL redirect request without validating the input can facilitate phishing attacks. In these attacks, unsuspecting users can be redirected to a malicious site that looks very similar to the real site they intend to visit, but which is controlled by the attacker.\n\n\n## Recommendation\nTo guard against untrusted URL redirection, it is advisable to avoid putting user input directly into a redirect URL. Instead, maintain a list of authorized redirects on the server; then choose from that list based on the user input provided.\n\n\n## Example\nThe following example shows an HTTP request parameter being used directly in a URL redirect without validating the input, which facilitates phishing attacks:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get('/some/path', function(req, res) {\n  // BAD: a request parameter is incorporated without validation into a URL redirect\n  res.redirect(req.param(\"target\"));\n});\n\n```\nOne way to remedy the problem is to validate the user input against a known fixed string before doing the redirection:\n\n\n```javascript\nconst app = require(\"express\")();\n\nconst VALID_REDIRECT = \"http://cwe.mitre.org/data/definitions/601.html\";\n\napp.get('/some/path', function(req, res) {\n  // GOOD: the request parameter is validated against a known fixed string\n  let target = req.param(\"target\");\n  if (VALID_REDIRECT === target)\n    res.redirect(target);\n});\n\n```\n\n## References\n* OWASP: [ XSS Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html).\n* Common Weakness Enumeration: [CWE-601](https://cwe.mitre.org/data/definitions/601.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-601" ],
            "description" : "Server-side URL redirection based on unvalidated user input\n              may cause redirection to malicious web sites.",
            "id" : "js/server-side-unvalidated-url-redirection",
            "kind" : "path-problem",
            "name" : "Server-side URL redirect",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/xxe",
          "name" : "js/xxe",
          "shortDescription" : {
            "text" : "XML external entity expansion"
          },
          "fullDescription" : {
            "text" : "Parsing user input as an XML document with external entity expansion is vulnerable to XXE attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# XML external entity expansion\nParsing untrusted XML files with a weakly configured XML parser may lead to an XML External Entity (XXE) attack. This type of attack uses external entity references to access arbitrary files on a system, carry out denial-of-service (DoS) attacks, or server-side request forgery. Even when the result of parsing is not returned to the user, DoS attacks are still possible and out-of-band data retrieval techniques may allow attackers to steal sensitive data.\n\n\n## Recommendation\nThe easiest way to prevent XXE attacks is to disable external entity handling when parsing untrusted data. How this is done depends on the library being used. Note that some libraries, such as recent versions of `libxml`, disable entity expansion by default, so unless you have explicitly enabled entity expansion, no further action needs to be taken.\n\n\n## Example\nThe following example uses the `libxml` XML parser to parse a string `xmlSrc`. If that string is from an untrusted source, this code may be vulnerable to an XXE attack, since the parser is invoked with the `noent` option set to `true`:\n\n\n```javascript\nconst app = require(\"express\")(),\n  libxml = require(\"libxmljs\");\n\napp.post(\"upload\", (req, res) => {\n  let xmlSrc = req.body,\n    doc = libxml.parseXml(xmlSrc, { noent: true });\n});\n\n```\nTo guard against XXE attacks, the `noent` option should be omitted or set to `false`. This means that no entity expansion is undertaken at all, not even for standard internal entities such as `&amp;` or `&gt;`. If desired, these entities can be expanded in a separate step using utility functions provided by libraries such as [underscore](http://underscorejs.org/#unescape), [lodash](https://lodash.com/docs/4.17.15#unescape) or [he](https://github.com/mathiasbynens/he).\n\n\n```javascript\nconst app = require(\"express\")(),\n  libxml = require(\"libxmljs\");\n\napp.post(\"upload\", (req, res) => {\n  let xmlSrc = req.body,\n    doc = libxml.parseXml(xmlSrc);\n});\n\n```\n\n## References\n* OWASP: [XML External Entity (XXE) Processing](https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing).\n* Timothy Morgen: [XML Schema, DTD, and Entity Attacks](https://research.nccgroup.com/2014/05/19/xml-schema-dtd-and-entity-attacks-a-compendium-of-known-techniques/).\n* Timur Yunusov, Alexey Osipov: [XML Out-Of-Band Data Retrieval](https://www.slideshare.net/qqlan/bh-ready-v4).\n* Common Weakness Enumeration: [CWE-611](https://cwe.mitre.org/data/definitions/611.html).\n* Common Weakness Enumeration: [CWE-827](https://cwe.mitre.org/data/definitions/827.html).\n",
            "markdown" : "# XML external entity expansion\nParsing untrusted XML files with a weakly configured XML parser may lead to an XML External Entity (XXE) attack. This type of attack uses external entity references to access arbitrary files on a system, carry out denial-of-service (DoS) attacks, or server-side request forgery. Even when the result of parsing is not returned to the user, DoS attacks are still possible and out-of-band data retrieval techniques may allow attackers to steal sensitive data.\n\n\n## Recommendation\nThe easiest way to prevent XXE attacks is to disable external entity handling when parsing untrusted data. How this is done depends on the library being used. Note that some libraries, such as recent versions of `libxml`, disable entity expansion by default, so unless you have explicitly enabled entity expansion, no further action needs to be taken.\n\n\n## Example\nThe following example uses the `libxml` XML parser to parse a string `xmlSrc`. If that string is from an untrusted source, this code may be vulnerable to an XXE attack, since the parser is invoked with the `noent` option set to `true`:\n\n\n```javascript\nconst app = require(\"express\")(),\n  libxml = require(\"libxmljs\");\n\napp.post(\"upload\", (req, res) => {\n  let xmlSrc = req.body,\n    doc = libxml.parseXml(xmlSrc, { noent: true });\n});\n\n```\nTo guard against XXE attacks, the `noent` option should be omitted or set to `false`. This means that no entity expansion is undertaken at all, not even for standard internal entities such as `&amp;` or `&gt;`. If desired, these entities can be expanded in a separate step using utility functions provided by libraries such as [underscore](http://underscorejs.org/#unescape), [lodash](https://lodash.com/docs/4.17.15#unescape) or [he](https://github.com/mathiasbynens/he).\n\n\n```javascript\nconst app = require(\"express\")(),\n  libxml = require(\"libxmljs\");\n\napp.post(\"upload\", (req, res) => {\n  let xmlSrc = req.body,\n    doc = libxml.parseXml(xmlSrc);\n});\n\n```\n\n## References\n* OWASP: [XML External Entity (XXE) Processing](https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing).\n* Timothy Morgen: [XML Schema, DTD, and Entity Attacks](https://research.nccgroup.com/2014/05/19/xml-schema-dtd-and-entity-attacks-a-compendium-of-known-techniques/).\n* Timur Yunusov, Alexey Osipov: [XML Out-Of-Band Data Retrieval](https://www.slideshare.net/qqlan/bh-ready-v4).\n* Common Weakness Enumeration: [CWE-611](https://cwe.mitre.org/data/definitions/611.html).\n* Common Weakness Enumeration: [CWE-827](https://cwe.mitre.org/data/definitions/827.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-611", "external/cwe/cwe-827" ],
            "description" : "Parsing user input as an XML document with external\n              entity expansion is vulnerable to XXE attacks.",
            "id" : "js/xxe",
            "kind" : "path-problem",
            "name" : "XML external entity expansion",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.1"
          }
        }, {
          "id" : "js/clear-text-cookie",
          "name" : "js/clear-text-cookie",
          "shortDescription" : {
            "text" : "Clear text transmission of sensitive cookie"
          },
          "fullDescription" : {
            "text" : "Sending sensitive information in a cookie without requring SSL encryption can expose the cookie to an attacker."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Clear text transmission of sensitive cookie\nCookies that are transmitted in clear text can be intercepted by an attacker. If sensitive cookies are intercepted, the attacker can read the cookie and use it to perform actions on the user's behalf.\n\n\n## Recommendation\nAlways transmit sensitive cookies using SSL by setting the `secure` attribute on the cookie.\n\n\n## Example\nThe following example stores an authentication token in a cookie that can be transmitted in clear text.\n\n\n```javascript\nconst http = require('http');\n\nconst server = http.createServer((req, res) => {\n    res.setHeader(\"Set-Cookie\", `authKey=${makeAuthkey()}`);\n    res.writeHead(200, { 'Content-Type': 'text/html' });\n    res.end('<h2>Hello world</h2>');\n});\n```\nTo force the cookie to be transmitted using SSL, set the `secure` attribute on the cookie.\n\n\n```javascript\nconst http = require('http');\n\nconst server = http.createServer((req, res) => {\n    res.setHeader(\"Set-Cookie\", `authKey=${makeAuthkey()}; secure; httpOnly`);\n    res.writeHead(200, { 'Content-Type': 'text/html' });\n    res.end('<h2>Hello world</h2>');\n});\n```\n\n## References\n* ExpressJS: [Use cookies securely](https://expressjs.com/en/advanced/best-practice-security.html#use-cookies-securely).\n* OWASP: [Set cookie flags appropriately](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#set-cookie-flags-appropriately).\n* Mozilla: [Set-Cookie](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie).\n* Common Weakness Enumeration: [CWE-614](https://cwe.mitre.org/data/definitions/614.html).\n* Common Weakness Enumeration: [CWE-311](https://cwe.mitre.org/data/definitions/311.html).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-319](https://cwe.mitre.org/data/definitions/319.html).\n",
            "markdown" : "# Clear text transmission of sensitive cookie\nCookies that are transmitted in clear text can be intercepted by an attacker. If sensitive cookies are intercepted, the attacker can read the cookie and use it to perform actions on the user's behalf.\n\n\n## Recommendation\nAlways transmit sensitive cookies using SSL by setting the `secure` attribute on the cookie.\n\n\n## Example\nThe following example stores an authentication token in a cookie that can be transmitted in clear text.\n\n\n```javascript\nconst http = require('http');\n\nconst server = http.createServer((req, res) => {\n    res.setHeader(\"Set-Cookie\", `authKey=${makeAuthkey()}`);\n    res.writeHead(200, { 'Content-Type': 'text/html' });\n    res.end('<h2>Hello world</h2>');\n});\n```\nTo force the cookie to be transmitted using SSL, set the `secure` attribute on the cookie.\n\n\n```javascript\nconst http = require('http');\n\nconst server = http.createServer((req, res) => {\n    res.setHeader(\"Set-Cookie\", `authKey=${makeAuthkey()}; secure; httpOnly`);\n    res.writeHead(200, { 'Content-Type': 'text/html' });\n    res.end('<h2>Hello world</h2>');\n});\n```\n\n## References\n* ExpressJS: [Use cookies securely](https://expressjs.com/en/advanced/best-practice-security.html#use-cookies-securely).\n* OWASP: [Set cookie flags appropriately](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#set-cookie-flags-appropriately).\n* Mozilla: [Set-Cookie](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie).\n* Common Weakness Enumeration: [CWE-614](https://cwe.mitre.org/data/definitions/614.html).\n* Common Weakness Enumeration: [CWE-311](https://cwe.mitre.org/data/definitions/311.html).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-319](https://cwe.mitre.org/data/definitions/319.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-614", "external/cwe/cwe-311", "external/cwe/cwe-312", "external/cwe/cwe-319" ],
            "description" : "Sending sensitive information in a cookie without requring SSL encryption\n              can expose the cookie to an attacker.",
            "id" : "js/clear-text-cookie",
            "kind" : "problem",
            "name" : "Clear text transmission of sensitive cookie",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "5.0"
          }
        }, {
          "id" : "js/host-header-forgery-in-email-generation",
          "name" : "js/host-header-forgery-in-email-generation",
          "shortDescription" : {
            "text" : "Host header poisoning in email generation"
          },
          "fullDescription" : {
            "text" : "Using the HTTP Host header to construct a link in an email can facilitate phishing attacks and leak password reset tokens."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Host header poisoning in email generation\nUsing the HTTP Host header to construct a link in an email can facilitate phishing attacks and leak password reset tokens. A malicious user can send an HTTP request to the targeted web site, but with a Host header that refers to his own web site. This means the emails will be sent out to potential victims, originating from a server they trust, but with links leading to a malicious web site.\n\nIf the email contains a password reset link, and should the victim click the link, the secret reset token will be leaked to the attacker. Using the leaked token, the attacker can then construct the real reset link and use it to change the victim's password.\n\n\n## Recommendation\nObtain the server's host name from a configuration file and avoid relying on the Host header.\n\n\n## Example\nThe following example uses the `req.host` to generate a password reset link. This value is derived from the Host header, and can thus be set to anything by an attacker:\n\n\n```javascript\nlet nodemailer = require('nodemailer');\nlet express = require('express');\nlet backend = require('./backend');\n\nlet app = express();\n\nlet config = JSON.parse(fs.readFileSync('config.json', 'utf8'));\n\napp.post('/resetpass', (req, res) => {\n  let email = req.query.email;\n  let transport = nodemailer.createTransport(config.smtp);\n  let token = backend.getUserSecretResetToken(email);\n  transport.sendMail({\n    from: 'webmaster@example.com',\n    to: email,\n    subject: 'Forgot password',\n    text: `Click to reset password: https://${req.host}/resettoken/${token}`,\n  });\n});\n\n```\nTo ensure the link refers to the correct web site, get the host name from a configuration file:\n\n\n```javascript\nlet nodemailer = require('nodemailer');\nlet express = require('express');\nlet backend = require('./backend');\n\nlet app = express();\n\nlet config = JSON.parse(fs.readFileSync('config.json', 'utf8'));\n\napp.post('/resetpass', (req, res) => {\n  let email = req.query.email;\n  let transport = nodemailer.createTransport(config.smtp);\n  let token = backend.getUserSecretResetToken(email);\n  transport.sendMail({\n    from: 'webmaster@example.com',\n    to: email,\n    subject: 'Forgot password',\n    text: `Click to reset password: https://${config.hostname}/resettoken/${token}`,\n  });\n});\n\n```\n\n## References\n* Mitre: [CWE-640: Weak Password Recovery Mechanism for Forgotten Password](https://cwe.mitre.org/data/definitions/640.html).\n* Ian Muscat: [What is a Host Header Attack?](https://www.acunetix.com/blog/articles/automated-detection-of-host-header-attacks/).\n* Common Weakness Enumeration: [CWE-640](https://cwe.mitre.org/data/definitions/640.html).\n",
            "markdown" : "# Host header poisoning in email generation\nUsing the HTTP Host header to construct a link in an email can facilitate phishing attacks and leak password reset tokens. A malicious user can send an HTTP request to the targeted web site, but with a Host header that refers to his own web site. This means the emails will be sent out to potential victims, originating from a server they trust, but with links leading to a malicious web site.\n\nIf the email contains a password reset link, and should the victim click the link, the secret reset token will be leaked to the attacker. Using the leaked token, the attacker can then construct the real reset link and use it to change the victim's password.\n\n\n## Recommendation\nObtain the server's host name from a configuration file and avoid relying on the Host header.\n\n\n## Example\nThe following example uses the `req.host` to generate a password reset link. This value is derived from the Host header, and can thus be set to anything by an attacker:\n\n\n```javascript\nlet nodemailer = require('nodemailer');\nlet express = require('express');\nlet backend = require('./backend');\n\nlet app = express();\n\nlet config = JSON.parse(fs.readFileSync('config.json', 'utf8'));\n\napp.post('/resetpass', (req, res) => {\n  let email = req.query.email;\n  let transport = nodemailer.createTransport(config.smtp);\n  let token = backend.getUserSecretResetToken(email);\n  transport.sendMail({\n    from: 'webmaster@example.com',\n    to: email,\n    subject: 'Forgot password',\n    text: `Click to reset password: https://${req.host}/resettoken/${token}`,\n  });\n});\n\n```\nTo ensure the link refers to the correct web site, get the host name from a configuration file:\n\n\n```javascript\nlet nodemailer = require('nodemailer');\nlet express = require('express');\nlet backend = require('./backend');\n\nlet app = express();\n\nlet config = JSON.parse(fs.readFileSync('config.json', 'utf8'));\n\napp.post('/resetpass', (req, res) => {\n  let email = req.query.email;\n  let transport = nodemailer.createTransport(config.smtp);\n  let token = backend.getUserSecretResetToken(email);\n  transport.sendMail({\n    from: 'webmaster@example.com',\n    to: email,\n    subject: 'Forgot password',\n    text: `Click to reset password: https://${config.hostname}/resettoken/${token}`,\n  });\n});\n\n```\n\n## References\n* Mitre: [CWE-640: Weak Password Recovery Mechanism for Forgotten Password](https://cwe.mitre.org/data/definitions/640.html).\n* Ian Muscat: [What is a Host Header Attack?](https://www.acunetix.com/blog/articles/automated-detection-of-host-header-attacks/).\n* Common Weakness Enumeration: [CWE-640](https://cwe.mitre.org/data/definitions/640.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-640" ],
            "description" : "Using the HTTP Host header to construct a link in an email can facilitate phishing\n              attacks and leak password reset tokens.",
            "id" : "js/host-header-forgery-in-email-generation",
            "kind" : "path-problem",
            "name" : "Host header poisoning in email generation",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "js/xpath-injection",
          "name" : "js/xpath-injection",
          "shortDescription" : {
            "text" : "XPath injection"
          },
          "fullDescription" : {
            "text" : "Building an XPath expression from user-controlled sources is vulnerable to insertion of malicious code by the user."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# XPath injection\nIf an XPath expression is built using string concatenation, and the components of the concatenation include user input, it makes it very easy for a user to create a malicious XPath expression.\n\n\n## Recommendation\nIf user input must be included in an XPath expression, either sanitize the data or use variable references to safely embed it without altering the structure of the expression.\n\n\n## Example\nIn this example, the code accepts a user name specified by the user, and uses this unvalidated and unsanitized value in an XPath expression constructed using the `xpath` package. This is vulnerable to the user providing special characters or string sequences that change the meaning of the XPath expression to search for different values.\n\n\n```javascript\nconst express = require('express');\nconst xpath = require('xpath');\nconst app = express();\n\napp.get('/some/route', function(req, res) {\n  let userName = req.param(\"userName\");\n\n  // BAD: Use user-provided data directly in an XPath expression\n  let badXPathExpr = xpath.parse(\"//users/user[login/text()='\" + userName + \"']/home_dir/text()\");\n  badXPathExpr.select({\n    node: root\n  });\n});\n\n```\nInstead, embed the user input using the variable replacement mechanism offered by `xpath`:\n\n\n```javascript\nconst express = require('express');\nconst xpath = require('xpath');\nconst app = express();\n\napp.get('/some/route', function(req, res) {\n  let userName = req.param(\"userName\");\n\n  // GOOD: Embed user-provided data using variables\n  let goodXPathExpr = xpath.parse(\"//users/user[login/text()=$userName]/home_dir/text()\");\n  goodXPathExpr.select({\n    node: root,\n    variables: { userName: userName }\n  });\n});\n\n```\n\n## References\n* OWASP: [Testing for XPath Injection](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/09-Testing_for_XPath_Injection).\n* OWASP: [XPath Injection](https://www.owasp.org/index.php/XPATH_Injection).\n* npm: [xpath](https://www.npmjs.com/package/xpath).\n* Common Weakness Enumeration: [CWE-643](https://cwe.mitre.org/data/definitions/643.html).\n",
            "markdown" : "# XPath injection\nIf an XPath expression is built using string concatenation, and the components of the concatenation include user input, it makes it very easy for a user to create a malicious XPath expression.\n\n\n## Recommendation\nIf user input must be included in an XPath expression, either sanitize the data or use variable references to safely embed it without altering the structure of the expression.\n\n\n## Example\nIn this example, the code accepts a user name specified by the user, and uses this unvalidated and unsanitized value in an XPath expression constructed using the `xpath` package. This is vulnerable to the user providing special characters or string sequences that change the meaning of the XPath expression to search for different values.\n\n\n```javascript\nconst express = require('express');\nconst xpath = require('xpath');\nconst app = express();\n\napp.get('/some/route', function(req, res) {\n  let userName = req.param(\"userName\");\n\n  // BAD: Use user-provided data directly in an XPath expression\n  let badXPathExpr = xpath.parse(\"//users/user[login/text()='\" + userName + \"']/home_dir/text()\");\n  badXPathExpr.select({\n    node: root\n  });\n});\n\n```\nInstead, embed the user input using the variable replacement mechanism offered by `xpath`:\n\n\n```javascript\nconst express = require('express');\nconst xpath = require('xpath');\nconst app = express();\n\napp.get('/some/route', function(req, res) {\n  let userName = req.param(\"userName\");\n\n  // GOOD: Embed user-provided data using variables\n  let goodXPathExpr = xpath.parse(\"//users/user[login/text()=$userName]/home_dir/text()\");\n  goodXPathExpr.select({\n    node: root,\n    variables: { userName: userName }\n  });\n});\n\n```\n\n## References\n* OWASP: [Testing for XPath Injection](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/09-Testing_for_XPath_Injection).\n* OWASP: [XPath Injection](https://www.owasp.org/index.php/XPATH_Injection).\n* npm: [xpath](https://www.npmjs.com/package/xpath).\n* Common Weakness Enumeration: [CWE-643](https://cwe.mitre.org/data/definitions/643.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-643" ],
            "description" : "Building an XPath expression from user-controlled sources is vulnerable to insertion of\n              malicious code by the user.",
            "id" : "js/xpath-injection",
            "kind" : "path-problem",
            "name" : "XPath injection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "js/regex-injection",
          "name" : "js/regex-injection",
          "shortDescription" : {
            "text" : "Regular expression injection"
          },
          "fullDescription" : {
            "text" : "User input should not be used in regular expressions without first being escaped, otherwise a malicious user may be able to inject an expression that could require exponential time on certain inputs."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Regular expression injection\nConstructing a regular expression with unsanitized user input is dangerous as a malicious user may be able to modify the meaning of the expression. In particular, such a user may be able to provide a regular expression fragment that takes exponential time in the worst case, and use that to perform a Denial of Service attack.\n\n\n## Recommendation\nBefore embedding user input into a regular expression, use a sanitization function such as lodash's `_.escapeRegExp` to escape meta-characters that have special meaning.\n\n\n## Example\nThe following example shows a HTTP request parameter that is used to construct a regular expression without sanitizing it first:\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\napp.get('/findKey', function(req, res) {\n  var key = req.param(\"key\"), input = req.param(\"input\");\n\n  // BAD: Unsanitized user input is used to construct a regular expression\n  var re = new RegExp(\"\\\\b\" + key + \"=(.*)\\n\");\n});\n\n```\nInstead, the request parameter should be sanitized first, for example using the function `_.escapeRegExp` from the lodash package. This ensures that the user cannot insert characters which have a special meaning in regular expressions.\n\n\n```javascript\nvar express = require('express');\nvar _ = require('lodash');\nvar app = express();\n\napp.get('/findKey', function(req, res) {\n  var key = req.param(\"key\"), input = req.param(\"input\");\n\n  // GOOD: User input is sanitized before constructing the regex\n  var safeKey = _.escapeRegExp(key);\n  var re = new RegExp(\"\\\\b\" + safeKey + \"=(.*)\\n\");\n});\n\n```\n\n## References\n* OWASP: [Regular expression Denial of Service - ReDoS](https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS).\n* Wikipedia: [ReDoS](https://en.wikipedia.org/wiki/ReDoS).\n* npm: [lodash](https://www.npmjs.com/package/lodash).\n* Common Weakness Enumeration: [CWE-730](https://cwe.mitre.org/data/definitions/730.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n",
            "markdown" : "# Regular expression injection\nConstructing a regular expression with unsanitized user input is dangerous as a malicious user may be able to modify the meaning of the expression. In particular, such a user may be able to provide a regular expression fragment that takes exponential time in the worst case, and use that to perform a Denial of Service attack.\n\n\n## Recommendation\nBefore embedding user input into a regular expression, use a sanitization function such as lodash's `_.escapeRegExp` to escape meta-characters that have special meaning.\n\n\n## Example\nThe following example shows a HTTP request parameter that is used to construct a regular expression without sanitizing it first:\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\napp.get('/findKey', function(req, res) {\n  var key = req.param(\"key\"), input = req.param(\"input\");\n\n  // BAD: Unsanitized user input is used to construct a regular expression\n  var re = new RegExp(\"\\\\b\" + key + \"=(.*)\\n\");\n});\n\n```\nInstead, the request parameter should be sanitized first, for example using the function `_.escapeRegExp` from the lodash package. This ensures that the user cannot insert characters which have a special meaning in regular expressions.\n\n\n```javascript\nvar express = require('express');\nvar _ = require('lodash');\nvar app = express();\n\napp.get('/findKey', function(req, res) {\n  var key = req.param(\"key\"), input = req.param(\"input\");\n\n  // GOOD: User input is sanitized before constructing the regex\n  var safeKey = _.escapeRegExp(key);\n  var re = new RegExp(\"\\\\b\" + safeKey + \"=(.*)\\n\");\n});\n\n```\n\n## References\n* OWASP: [Regular expression Denial of Service - ReDoS](https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS).\n* Wikipedia: [ReDoS](https://en.wikipedia.org/wiki/ReDoS).\n* npm: [lodash](https://www.npmjs.com/package/lodash).\n* Common Weakness Enumeration: [CWE-730](https://cwe.mitre.org/data/definitions/730.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-730", "external/cwe/cwe-400" ],
            "description" : "User input should not be used in regular expressions without first being escaped,\n              otherwise a malicious user may be able to inject an expression that could require\n              exponential time on certain inputs.",
            "id" : "js/regex-injection",
            "kind" : "path-problem",
            "name" : "Regular expression injection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/server-crash",
          "name" : "js/server-crash",
          "shortDescription" : {
            "text" : "Server crash"
          },
          "fullDescription" : {
            "text" : "A server that can be forced to crash may be vulnerable to denial-of-service attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Server crash\nServers handle requests from clients until terminated deliberately by a server administrator. A client request that results in an uncaught server-side exception causes the current server response generation to fail, and should not have an effect on subsequent client requests.\n\nUnder some circumstances, uncaught exceptions can however cause the entire server to terminate abruptly. Such a behavior is highly undesirable, especially if it gives malicious users the ability to turn off the server at will, which is an efficient denial-of-service attack.\n\n\n## Recommendation\nEnsure that the processing of client requests can not cause uncaught exceptions to terminate the entire server abruptly.\n\n\n## Example\nThe following server implementation checks if a client-provided file path is valid and throws an exception if the check fails. It can be seen that the exception is uncaught, and it is therefore reasonable to expect the server to respond with an error response to client requests that cause the check to fail. But since the exception is uncaught in the context of an asynchronous callback invocation (`fs.access(...)`), the entire server will terminate instead.\n\n\n```javascript\nconst express = require(\"express\"),\n  fs = require(\"fs\");\n\nfunction save(rootDir, path, content) {\n  if (!isValidPath(rootDir, req.query.filePath)) {\n    throw new Error(`Invalid filePath: ${req.query.filePath}`); // BAD crashes the server\n  }\n  // write content to disk\n}\nexpress().post(\"/save\", (req, res) => {\n  fs.exists(rootDir, (exists) => {\n    if (!exists) {\n      console.error(`Server setup is corrupted, ${rootDir} does not exist!`);\n      res.status(500);\n      res.end();\n      return;\n    }\n    save(rootDir, req.query.path, req.body);\n    res.status(200);\n    res.end();\n  });\n});\n\n```\nTo remedy this, the server can catch the exception explicitly with a `try/catch` block, and generate an appropriate error response instead:\n\n\n```javascript\n// ...\nexpress().post(\"/save\", (req, res) => {\n  fs.exists(rootDir, (exists) => {\n    // ...\n    try {\n      save(rootDir, req.query.path, req.body); // GOOD no uncaught exception\n      res.status(200);\n      res.end();\n    } catch (e) {\n      res.status(500);\n      res.end();\n    }\n  });\n});\n\n```\nAn alternative is to use an `async` and `await` for the asynchronous behavior, since the server will then print warning messages about uncaught exceptions instead of terminating, unless the server was started with the commandline option `--unhandled-rejections=strict`:\n\n\n```javascript\n// ...\nexpress().post(\"/save\", async (req, res) => {\n  if (!(await fs.promises.exists(rootDir))) {\n    console.error(`Server setup is corrupted, ${rootDir} does not exist!`);\n    res.status(500);\n    res.end();\n    return;\n  }\n  save(rootDir, req.query.path, req.body); // MAYBE BAD, depends on the commandline options\n  res.status(200);\n  res.end();\n});\n\n```\n\n## References\n* Common Weakness Enumeration: [CWE-248](https://cwe.mitre.org/data/definitions/248.html).\n* Common Weakness Enumeration: [CWE-730](https://cwe.mitre.org/data/definitions/730.html).\n",
            "markdown" : "# Server crash\nServers handle requests from clients until terminated deliberately by a server administrator. A client request that results in an uncaught server-side exception causes the current server response generation to fail, and should not have an effect on subsequent client requests.\n\nUnder some circumstances, uncaught exceptions can however cause the entire server to terminate abruptly. Such a behavior is highly undesirable, especially if it gives malicious users the ability to turn off the server at will, which is an efficient denial-of-service attack.\n\n\n## Recommendation\nEnsure that the processing of client requests can not cause uncaught exceptions to terminate the entire server abruptly.\n\n\n## Example\nThe following server implementation checks if a client-provided file path is valid and throws an exception if the check fails. It can be seen that the exception is uncaught, and it is therefore reasonable to expect the server to respond with an error response to client requests that cause the check to fail. But since the exception is uncaught in the context of an asynchronous callback invocation (`fs.access(...)`), the entire server will terminate instead.\n\n\n```javascript\nconst express = require(\"express\"),\n  fs = require(\"fs\");\n\nfunction save(rootDir, path, content) {\n  if (!isValidPath(rootDir, req.query.filePath)) {\n    throw new Error(`Invalid filePath: ${req.query.filePath}`); // BAD crashes the server\n  }\n  // write content to disk\n}\nexpress().post(\"/save\", (req, res) => {\n  fs.exists(rootDir, (exists) => {\n    if (!exists) {\n      console.error(`Server setup is corrupted, ${rootDir} does not exist!`);\n      res.status(500);\n      res.end();\n      return;\n    }\n    save(rootDir, req.query.path, req.body);\n    res.status(200);\n    res.end();\n  });\n});\n\n```\nTo remedy this, the server can catch the exception explicitly with a `try/catch` block, and generate an appropriate error response instead:\n\n\n```javascript\n// ...\nexpress().post(\"/save\", (req, res) => {\n  fs.exists(rootDir, (exists) => {\n    // ...\n    try {\n      save(rootDir, req.query.path, req.body); // GOOD no uncaught exception\n      res.status(200);\n      res.end();\n    } catch (e) {\n      res.status(500);\n      res.end();\n    }\n  });\n});\n\n```\nAn alternative is to use an `async` and `await` for the asynchronous behavior, since the server will then print warning messages about uncaught exceptions instead of terminating, unless the server was started with the commandline option `--unhandled-rejections=strict`:\n\n\n```javascript\n// ...\nexpress().post(\"/save\", async (req, res) => {\n  if (!(await fs.promises.exists(rootDir))) {\n    console.error(`Server setup is corrupted, ${rootDir} does not exist!`);\n    res.status(500);\n    res.end();\n    return;\n  }\n  save(rootDir, req.query.path, req.body); // MAYBE BAD, depends on the commandline options\n  res.status(200);\n  res.end();\n});\n\n```\n\n## References\n* Common Weakness Enumeration: [CWE-248](https://cwe.mitre.org/data/definitions/248.html).\n* Common Weakness Enumeration: [CWE-730](https://cwe.mitre.org/data/definitions/730.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-248", "external/cwe/cwe-730" ],
            "description" : "A server that can be forced to crash may be vulnerable to denial-of-service\n              attacks.",
            "id" : "js/server-crash",
            "kind" : "path-problem",
            "name" : "Server crash",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/unvalidated-dynamic-method-call",
          "name" : "js/unvalidated-dynamic-method-call",
          "shortDescription" : {
            "text" : "Unvalidated dynamic method call"
          },
          "fullDescription" : {
            "text" : "Calling a method with a user-controlled name may dispatch to an unexpected target, which could cause an exception."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Unvalidated dynamic method call\nJavaScript makes it easy to look up object properties dynamically at runtime. In particular, methods can be looked up by name and then called. However, if the method name is user-controlled, an attacker could choose a name that makes the application invoke an unexpected method, which may cause a runtime exception. If this exception is not handled, it could be used to mount a denial-of-service attack.\n\nFor example, there might not be a method of the given name, or the result of the lookup might not be a function. In either case the method call will throw a `TypeError` at runtime.\n\nAnother, more subtle example is where the result of the lookup is a standard library method from `Object.prototype`, which most objects have on their prototype chain. Examples of such methods include `valueOf`, `hasOwnProperty` and `__defineSetter__`. If the method call passes the wrong number or kind of arguments to these methods, they will throw an exception.\n\n\n## Recommendation\nIt is best to avoid dynamic method lookup involving user-controlled names altogether, for instance by using a `Map` instead of a plain object.\n\nIf the dynamic method lookup cannot be avoided, consider whitelisting permitted method names. At the very least, check that the method is an own property and not inherited from the prototype object. If the object on which the method is looked up contains properties that are not methods, you should additionally check that the result of the lookup is a function. Even if the object only contains methods, it is still a good idea to perform this check in case other properties are added to the object later on.\n\n\n## Example\nIn the following example, an HTTP request parameter `action` property is used to dynamically look up a function in the `actions` map, which is then invoked with the `payload` parameter as its argument.\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\nvar actions = {\n  play(data) {\n    // ...\n  },\n  pause(data) {\n    // ...\n  }\n}\n\napp.get('/perform/:action/:payload', function(req, res) {\n  let action = actions[req.params.action];\n  // BAD: `action` may not be a function\n  res.end(action(req.params.payload));\n});\n\n```\nThe intention is to allow clients to invoke the `play` or `pause` method, but there is no check that `action` is actually the name of a method stored in `actions`. If, for example, `action` is `rewind`, `action` will be `undefined` and the call will result in a runtime error.\n\nThe easiest way to prevent this is to turn `actions` into a `Map` and using `Map.prototype.has` to check whether the method name is valid before looking it up.\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\nvar actions = new Map();\nactions.put(\"play\", function play(data) {\n  // ...\n});\nactions.put(\"pause\", function pause(data) {\n  // ...\n});\n\napp.get('/perform/:action/:payload', function(req, res) {\n  if (actions.has(req.params.action)) {\n    if (typeof actions.get(req.params.action) === 'function'){\n      let action = actions.get(req.params.action);\n    }\n    // GOOD: `action` is either the `play` or the `pause` function from above\n    res.end(action(req.params.payload));\n  } else {\n    res.end(\"Unsupported action.\");\n  }\n});\n\n```\nIf `actions` cannot be turned into a `Map`, a `hasOwnProperty` check should be added to validate the method name:\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\nvar actions = {\n  play(data) {\n    // ...\n  },\n  pause(data) {\n    // ...\n  }\n}\n\napp.get('/perform/:action/:payload', function(req, res) {\n  if (actions.hasOwnProperty(req.params.action)) {\n    let action = actions[req.params.action];\n    if (typeof action === 'function') {\n      // GOOD: `action` is an own method of `actions`\n      res.end(action(req.params.payload));\n      return;\n    }\n  }\n  res.end(\"Unsupported action.\");\n});\n\n```\n\n## References\n* OWASP: [Denial of Service](https://www.owasp.org/index.php/Denial_of_Service).\n* MDN: [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map).\n* MDN: [Object.prototype](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/prototype).\n* Common Weakness Enumeration: [CWE-754](https://cwe.mitre.org/data/definitions/754.html).\n",
            "markdown" : "# Unvalidated dynamic method call\nJavaScript makes it easy to look up object properties dynamically at runtime. In particular, methods can be looked up by name and then called. However, if the method name is user-controlled, an attacker could choose a name that makes the application invoke an unexpected method, which may cause a runtime exception. If this exception is not handled, it could be used to mount a denial-of-service attack.\n\nFor example, there might not be a method of the given name, or the result of the lookup might not be a function. In either case the method call will throw a `TypeError` at runtime.\n\nAnother, more subtle example is where the result of the lookup is a standard library method from `Object.prototype`, which most objects have on their prototype chain. Examples of such methods include `valueOf`, `hasOwnProperty` and `__defineSetter__`. If the method call passes the wrong number or kind of arguments to these methods, they will throw an exception.\n\n\n## Recommendation\nIt is best to avoid dynamic method lookup involving user-controlled names altogether, for instance by using a `Map` instead of a plain object.\n\nIf the dynamic method lookup cannot be avoided, consider whitelisting permitted method names. At the very least, check that the method is an own property and not inherited from the prototype object. If the object on which the method is looked up contains properties that are not methods, you should additionally check that the result of the lookup is a function. Even if the object only contains methods, it is still a good idea to perform this check in case other properties are added to the object later on.\n\n\n## Example\nIn the following example, an HTTP request parameter `action` property is used to dynamically look up a function in the `actions` map, which is then invoked with the `payload` parameter as its argument.\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\nvar actions = {\n  play(data) {\n    // ...\n  },\n  pause(data) {\n    // ...\n  }\n}\n\napp.get('/perform/:action/:payload', function(req, res) {\n  let action = actions[req.params.action];\n  // BAD: `action` may not be a function\n  res.end(action(req.params.payload));\n});\n\n```\nThe intention is to allow clients to invoke the `play` or `pause` method, but there is no check that `action` is actually the name of a method stored in `actions`. If, for example, `action` is `rewind`, `action` will be `undefined` and the call will result in a runtime error.\n\nThe easiest way to prevent this is to turn `actions` into a `Map` and using `Map.prototype.has` to check whether the method name is valid before looking it up.\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\nvar actions = new Map();\nactions.put(\"play\", function play(data) {\n  // ...\n});\nactions.put(\"pause\", function pause(data) {\n  // ...\n});\n\napp.get('/perform/:action/:payload', function(req, res) {\n  if (actions.has(req.params.action)) {\n    if (typeof actions.get(req.params.action) === 'function'){\n      let action = actions.get(req.params.action);\n    }\n    // GOOD: `action` is either the `play` or the `pause` function from above\n    res.end(action(req.params.payload));\n  } else {\n    res.end(\"Unsupported action.\");\n  }\n});\n\n```\nIf `actions` cannot be turned into a `Map`, a `hasOwnProperty` check should be added to validate the method name:\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\nvar actions = {\n  play(data) {\n    // ...\n  },\n  pause(data) {\n    // ...\n  }\n}\n\napp.get('/perform/:action/:payload', function(req, res) {\n  if (actions.hasOwnProperty(req.params.action)) {\n    let action = actions[req.params.action];\n    if (typeof action === 'function') {\n      // GOOD: `action` is an own method of `actions`\n      res.end(action(req.params.payload));\n      return;\n    }\n  }\n  res.end(\"Unsupported action.\");\n});\n\n```\n\n## References\n* OWASP: [Denial of Service](https://www.owasp.org/index.php/Denial_of_Service).\n* MDN: [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map).\n* MDN: [Object.prototype](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/prototype).\n* Common Weakness Enumeration: [CWE-754](https://cwe.mitre.org/data/definitions/754.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-754" ],
            "description" : "Calling a method with a user-controlled name may dispatch to\n              an unexpected target, which could cause an exception.",
            "id" : "js/unvalidated-dynamic-method-call",
            "kind" : "path-problem",
            "name" : "Unvalidated dynamic method call",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/missing-rate-limiting",
          "name" : "js/missing-rate-limiting",
          "shortDescription" : {
            "text" : "Missing rate limiting"
          },
          "fullDescription" : {
            "text" : "An HTTP request handler that performs expensive operations without restricting the rate at which operations can be carried out is vulnerable to denial-of-service attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Missing rate limiting\nHTTP request handlers should not perform expensive operations such as accessing the file system, executing an operating system command or interacting with a database without limiting the rate at which requests are accepted. Otherwise, the application becomes vulnerable to denial-of-service attacks where an attacker can cause the application to crash or become unresponsive by issuing a large number of requests at the same time.\n\n\n## Recommendation\nA rate-limiting middleware should be used to prevent such attacks.\n\n\n## Example\nThe following example shows an Express application that serves static files without rate limiting:\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\napp.get('/:path', function(req, res) {\n  let path = req.params.path;\n  if (isValidPath(path))\n    res.sendFile(path);\n});\n\n```\nTo prevent denial-of-service attacks, the `express-rate-limit` package can be used:\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\n// set up rate limiter: maximum of five requests per minute\nvar RateLimit = require('express-rate-limit');\nvar limiter = new RateLimit({\n  windowMs: 1*60*1000, // 1 minute\n  max: 5\n});\n\n// apply rate limiter to all requests\napp.use(limiter);\n\napp.get('/:path', function(req, res) {\n  let path = req.params.path;\n  if (isValidPath(path))\n    res.sendFile(path);\n});\n\n```\n\n## References\n* OWASP: [Denial of Service Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html).\n* Wikipedia: [Denial-of-service attack](https://en.wikipedia.org/wiki/Denial-of-service_attack).\n* NPM: [express-rate-limit](https://www.npmjs.com/package/express-rate-limit).\n* Common Weakness Enumeration: [CWE-770](https://cwe.mitre.org/data/definitions/770.html).\n* Common Weakness Enumeration: [CWE-307](https://cwe.mitre.org/data/definitions/307.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n",
            "markdown" : "# Missing rate limiting\nHTTP request handlers should not perform expensive operations such as accessing the file system, executing an operating system command or interacting with a database without limiting the rate at which requests are accepted. Otherwise, the application becomes vulnerable to denial-of-service attacks where an attacker can cause the application to crash or become unresponsive by issuing a large number of requests at the same time.\n\n\n## Recommendation\nA rate-limiting middleware should be used to prevent such attacks.\n\n\n## Example\nThe following example shows an Express application that serves static files without rate limiting:\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\napp.get('/:path', function(req, res) {\n  let path = req.params.path;\n  if (isValidPath(path))\n    res.sendFile(path);\n});\n\n```\nTo prevent denial-of-service attacks, the `express-rate-limit` package can be used:\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\n// set up rate limiter: maximum of five requests per minute\nvar RateLimit = require('express-rate-limit');\nvar limiter = new RateLimit({\n  windowMs: 1*60*1000, // 1 minute\n  max: 5\n});\n\n// apply rate limiter to all requests\napp.use(limiter);\n\napp.get('/:path', function(req, res) {\n  let path = req.params.path;\n  if (isValidPath(path))\n    res.sendFile(path);\n});\n\n```\n\n## References\n* OWASP: [Denial of Service Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html).\n* Wikipedia: [Denial-of-service attack](https://en.wikipedia.org/wiki/Denial-of-service_attack).\n* NPM: [express-rate-limit](https://www.npmjs.com/package/express-rate-limit).\n* Common Weakness Enumeration: [CWE-770](https://cwe.mitre.org/data/definitions/770.html).\n* Common Weakness Enumeration: [CWE-307](https://cwe.mitre.org/data/definitions/307.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-770", "external/cwe/cwe-307", "external/cwe/cwe-400" ],
            "description" : "An HTTP request handler that performs expensive operations without\n              restricting the rate at which operations can be carried out is vulnerable\n              to denial-of-service attacks.",
            "id" : "js/missing-rate-limiting",
            "kind" : "problem",
            "name" : "Missing rate limiting",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/resource-exhaustion",
          "name" : "js/resource-exhaustion",
          "shortDescription" : {
            "text" : "Resource exhaustion"
          },
          "fullDescription" : {
            "text" : "Allocating objects or timers with user-controlled sizes or durations can cause resource exhaustion."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Resource exhaustion\nApplications are constrained by how many resources they can make use of. Failing to respect these constraints may cause the application to be unresponsive or crash. It is therefore problematic if attackers can control the sizes or lifetimes of allocated objects.\n\n\n## Recommendation\nEnsure that attackers can not control object sizes and their lifetimes. If object sizes and lifetimes must be controlled by external parties, ensure you restrict the object sizes and lifetimes so that they are within acceptable ranges.\n\n\n## Example\nThe following example allocates a buffer with a user-controlled size.\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar size = parseInt(url.parse(req.url, true).query.size);\n\n\tlet buffer = Buffer.alloc(size); // BAD\n\n\t// ... use the buffer\n});\n```\nThis is problematic since an attacker can choose a size that makes the application run out of memory. Even worse, in older versions of Node.js, this could leak confidential memory. To prevent such attacks, limit the buffer size:\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar size = parseInt(url.parse(req.url, true).query.size);\n\n\tif (size > 1024) {\n\t\tres.statusCode = 400;\n\t\tres.end(\"Bad request.\");\n\t\treturn;\n\t}\n\n\tlet buffer = Buffer.alloc(size); // GOOD\n\n\t// ... use the buffer\n});\n```\n\n## Example\nAs another example, consider an application that allocates an array with a user-controlled size, and then fills it with values:\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar size = parseInt(url.parse(req.url, true).query.size);\n\n\tlet dogs = new Array(size).fill(\"dog\"); // BAD\n\n\t// ... use the dog\n});\n```\nThe allocation of the array itself is not problematic since arrays are allocated sparsely, but the subsequent filling of the array will take a long time, causing the application to be unresponsive, or even run out of memory. Again, a limit on the size will prevent the attack:\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar size = parseInt(url.parse(req.url, true).query.size);\n\n\tif (size > 1024) {\n\t\tres.statusCode = 400;\n\t\tres.end(\"Bad request.\");\n\t\treturn;\n\t}\n\n\tlet dogs = new Array(size).fill(\"dog\"); // GOOD\n\n\t// ... use the dogs\n});\n```\n\n## Example\nFinally, the following example lets a user choose a delay after which a function is executed:\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar delay = parseInt(url.parse(req.url, true).query.delay);\n\n\tsetTimeout(f, delay); // BAD\n\n});\n\n```\nThis is problematic because a large delay essentially makes the application wait indefinitely before executing the function. Repeated registrations of such delays will therefore use up all of the memory in the application. A limit on the delay will prevent the attack:\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar delay = parseInt(url.parse(req.url, true).query.delay);\n\n\tif (delay > 1000) {\n\t\tres.statusCode = 400;\n\t\tres.end(\"Bad request.\");\n\t\treturn;\n\t}\n\n\tsetTimeout(f, delay); // GOOD\n\n});\n\n```\n\n## References\n* Wikipedia: [Denial-of-service attack](https://en.wikipedia.org/wiki/Denial-of-service_attack).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n* Common Weakness Enumeration: [CWE-770](https://cwe.mitre.org/data/definitions/770.html).\n",
            "markdown" : "# Resource exhaustion\nApplications are constrained by how many resources they can make use of. Failing to respect these constraints may cause the application to be unresponsive or crash. It is therefore problematic if attackers can control the sizes or lifetimes of allocated objects.\n\n\n## Recommendation\nEnsure that attackers can not control object sizes and their lifetimes. If object sizes and lifetimes must be controlled by external parties, ensure you restrict the object sizes and lifetimes so that they are within acceptable ranges.\n\n\n## Example\nThe following example allocates a buffer with a user-controlled size.\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar size = parseInt(url.parse(req.url, true).query.size);\n\n\tlet buffer = Buffer.alloc(size); // BAD\n\n\t// ... use the buffer\n});\n```\nThis is problematic since an attacker can choose a size that makes the application run out of memory. Even worse, in older versions of Node.js, this could leak confidential memory. To prevent such attacks, limit the buffer size:\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar size = parseInt(url.parse(req.url, true).query.size);\n\n\tif (size > 1024) {\n\t\tres.statusCode = 400;\n\t\tres.end(\"Bad request.\");\n\t\treturn;\n\t}\n\n\tlet buffer = Buffer.alloc(size); // GOOD\n\n\t// ... use the buffer\n});\n```\n\n## Example\nAs another example, consider an application that allocates an array with a user-controlled size, and then fills it with values:\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar size = parseInt(url.parse(req.url, true).query.size);\n\n\tlet dogs = new Array(size).fill(\"dog\"); // BAD\n\n\t// ... use the dog\n});\n```\nThe allocation of the array itself is not problematic since arrays are allocated sparsely, but the subsequent filling of the array will take a long time, causing the application to be unresponsive, or even run out of memory. Again, a limit on the size will prevent the attack:\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar size = parseInt(url.parse(req.url, true).query.size);\n\n\tif (size > 1024) {\n\t\tres.statusCode = 400;\n\t\tres.end(\"Bad request.\");\n\t\treturn;\n\t}\n\n\tlet dogs = new Array(size).fill(\"dog\"); // GOOD\n\n\t// ... use the dogs\n});\n```\n\n## Example\nFinally, the following example lets a user choose a delay after which a function is executed:\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar delay = parseInt(url.parse(req.url, true).query.delay);\n\n\tsetTimeout(f, delay); // BAD\n\n});\n\n```\nThis is problematic because a large delay essentially makes the application wait indefinitely before executing the function. Repeated registrations of such delays will therefore use up all of the memory in the application. A limit on the delay will prevent the attack:\n\n\n```javascript\nvar http = require(\"http\"),\n    url = require(\"url\");\n\nvar server = http.createServer(function(req, res) {\n\tvar delay = parseInt(url.parse(req.url, true).query.delay);\n\n\tif (delay > 1000) {\n\t\tres.statusCode = 400;\n\t\tres.end(\"Bad request.\");\n\t\treturn;\n\t}\n\n\tsetTimeout(f, delay); // GOOD\n\n});\n\n```\n\n## References\n* Wikipedia: [Denial-of-service attack](https://en.wikipedia.org/wiki/Denial-of-service_attack).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n* Common Weakness Enumeration: [CWE-770](https://cwe.mitre.org/data/definitions/770.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-400", "external/cwe/cwe-770" ],
            "description" : "Allocating objects or timers with user-controlled\n              sizes or durations can cause resource exhaustion.",
            "id" : "js/resource-exhaustion",
            "kind" : "path-problem",
            "name" : "Resource exhaustion",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/xml-bomb",
          "name" : "js/xml-bomb",
          "shortDescription" : {
            "text" : "XML internal entity expansion"
          },
          "fullDescription" : {
            "text" : "Parsing user input as an XML document with arbitrary internal entity expansion is vulnerable to denial-of-service attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# XML internal entity expansion\nParsing untrusted XML files with a weakly configured XML parser may be vulnerable to denial-of-service (DoS) attacks exploiting uncontrolled internal entity expansion.\n\nIn XML, so-called *internal entities* are a mechanism for introducing an abbreviation for a piece of text or part of a document. When a parser that has been configured to expand entities encounters a reference to an internal entity, it replaces the entity by the data it represents. The replacement text may itself contain other entity references, which are expanded recursively. This means that entity expansion can increase document size dramatically.\n\nIf untrusted XML is parsed with entity expansion enabled, a malicious attacker could submit a document that contains very deeply nested entity definitions, causing the parser to take a very long time or use large amounts of memory. This is sometimes called an *XML bomb* attack.\n\n\n## Recommendation\nThe safest way to prevent XML bomb attacks is to disable entity expansion when parsing untrusted data. How this is done depends on the library being used. Note that some libraries, such as recent versions of `libxmljs` (though not its SAX parser API), disable entity expansion by default, so unless you have explicitly enabled entity expansion, no further action is needed.\n\n\n## Example\nThe following example uses the XML parser provided by the `node-expat` package to parse a string `xmlSrc`. If that string is from an untrusted source, this code may be vulnerable to a DoS attack, since `node-expat` expands internal entities by default:\n\n\n```javascript\nconst app = require(\"express\")(),\n  expat = require(\"node-expat\");\n\napp.post(\"upload\", (req, res) => {\n  let xmlSrc = req.body,\n    parser = new expat.Parser();\n  parser.on(\"startElement\", handleStart);\n  parser.on(\"text\", handleText);\n  parser.write(xmlSrc);\n});\n\n```\nAt the time of writing, `node-expat` does not provide a way of controlling entity expansion, but the example could be rewritten to use the `sax` package instead, which only expands standard entities such as `&amp;`:\n\n\n```javascript\nconst app = require(\"express\")(),\n  sax = require(\"sax\");\n\napp.post(\"upload\", (req, res) => {\n  let xmlSrc = req.body,\n    parser = sax.parser(true);\n  parser.onopentag = handleStart;\n  parser.ontext = handleText;\n  parser.write(xmlSrc);\n});\n\n```\n\n## References\n* Wikipedia: [Billion Laughs](https://en.wikipedia.org/wiki/Billion_laughs).\n* Bryan Sullivan: [Security Briefs - XML Denial of Service Attacks and Defenses](https://msdn.microsoft.com/en-us/magazine/ee335713.aspx).\n* Common Weakness Enumeration: [CWE-776](https://cwe.mitre.org/data/definitions/776.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n",
            "markdown" : "# XML internal entity expansion\nParsing untrusted XML files with a weakly configured XML parser may be vulnerable to denial-of-service (DoS) attacks exploiting uncontrolled internal entity expansion.\n\nIn XML, so-called *internal entities* are a mechanism for introducing an abbreviation for a piece of text or part of a document. When a parser that has been configured to expand entities encounters a reference to an internal entity, it replaces the entity by the data it represents. The replacement text may itself contain other entity references, which are expanded recursively. This means that entity expansion can increase document size dramatically.\n\nIf untrusted XML is parsed with entity expansion enabled, a malicious attacker could submit a document that contains very deeply nested entity definitions, causing the parser to take a very long time or use large amounts of memory. This is sometimes called an *XML bomb* attack.\n\n\n## Recommendation\nThe safest way to prevent XML bomb attacks is to disable entity expansion when parsing untrusted data. How this is done depends on the library being used. Note that some libraries, such as recent versions of `libxmljs` (though not its SAX parser API), disable entity expansion by default, so unless you have explicitly enabled entity expansion, no further action is needed.\n\n\n## Example\nThe following example uses the XML parser provided by the `node-expat` package to parse a string `xmlSrc`. If that string is from an untrusted source, this code may be vulnerable to a DoS attack, since `node-expat` expands internal entities by default:\n\n\n```javascript\nconst app = require(\"express\")(),\n  expat = require(\"node-expat\");\n\napp.post(\"upload\", (req, res) => {\n  let xmlSrc = req.body,\n    parser = new expat.Parser();\n  parser.on(\"startElement\", handleStart);\n  parser.on(\"text\", handleText);\n  parser.write(xmlSrc);\n});\n\n```\nAt the time of writing, `node-expat` does not provide a way of controlling entity expansion, but the example could be rewritten to use the `sax` package instead, which only expands standard entities such as `&amp;`:\n\n\n```javascript\nconst app = require(\"express\")(),\n  sax = require(\"sax\");\n\napp.post(\"upload\", (req, res) => {\n  let xmlSrc = req.body,\n    parser = sax.parser(true);\n  parser.onopentag = handleStart;\n  parser.ontext = handleText;\n  parser.write(xmlSrc);\n});\n\n```\n\n## References\n* Wikipedia: [Billion Laughs](https://en.wikipedia.org/wiki/Billion_laughs).\n* Bryan Sullivan: [Security Briefs - XML Denial of Service Attacks and Defenses](https://msdn.microsoft.com/en-us/magazine/ee335713.aspx).\n* Common Weakness Enumeration: [CWE-776](https://cwe.mitre.org/data/definitions/776.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-776", "external/cwe/cwe-400" ],
            "description" : "Parsing user input as an XML document with arbitrary internal\n              entity expansion is vulnerable to denial-of-service attacks.",
            "id" : "js/xml-bomb",
            "kind" : "path-problem",
            "name" : "XML internal entity expansion",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/hardcoded-credentials",
          "name" : "js/hardcoded-credentials",
          "shortDescription" : {
            "text" : "Hard-coded credentials"
          },
          "fullDescription" : {
            "text" : "Hard-coding credentials in source code may enable an attacker to gain unauthorized access."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Hard-coded credentials\nIncluding unencrypted hard-coded authentication credentials in source code is dangerous because the credentials may be easily discovered. For example, the code may be open source, or it may be leaked or accidentally revealed, making the credentials visible to an attacker. This, in turn, might enable them to gain unauthorized access, or to obtain privileged information.\n\n\n## Recommendation\nRemove hard-coded credentials, such as user names, passwords and certificates, from source code. Instead, place them in configuration files, environment variables or other data stores if necessary. If possible, store configuration files including credential data separately from the source code, in a secure location with restricted access.\n\n\n## Example\nThe following code example connects to a Postgres database using the `pg` package and hard-codes user name and password:\n\n\n```javascript\nconst pg = require(\"pg\");\n\nconst client = new pg.Client({\n  user: \"bob\",\n  host: \"database.server.com\",\n  database: \"mydb\",\n  password: \"correct-horse-battery-staple\",\n  port: 3211\n});\nclient.connect();\n\n```\nInstead, user name and password can be supplied through the environment variables `PGUSER` and `PGPASSWORD`, which can be set externally without hard-coding credentials in the source code.\n\n\n## References\n* OWASP: [Use of hard-coded password](https://www.owasp.org/index.php/Use_of_hard-coded_password).\n* Common Weakness Enumeration: [CWE-259](https://cwe.mitre.org/data/definitions/259.html).\n* Common Weakness Enumeration: [CWE-321](https://cwe.mitre.org/data/definitions/321.html).\n* Common Weakness Enumeration: [CWE-798](https://cwe.mitre.org/data/definitions/798.html).\n",
            "markdown" : "# Hard-coded credentials\nIncluding unencrypted hard-coded authentication credentials in source code is dangerous because the credentials may be easily discovered. For example, the code may be open source, or it may be leaked or accidentally revealed, making the credentials visible to an attacker. This, in turn, might enable them to gain unauthorized access, or to obtain privileged information.\n\n\n## Recommendation\nRemove hard-coded credentials, such as user names, passwords and certificates, from source code. Instead, place them in configuration files, environment variables or other data stores if necessary. If possible, store configuration files including credential data separately from the source code, in a secure location with restricted access.\n\n\n## Example\nThe following code example connects to a Postgres database using the `pg` package and hard-codes user name and password:\n\n\n```javascript\nconst pg = require(\"pg\");\n\nconst client = new pg.Client({\n  user: \"bob\",\n  host: \"database.server.com\",\n  database: \"mydb\",\n  password: \"correct-horse-battery-staple\",\n  port: 3211\n});\nclient.connect();\n\n```\nInstead, user name and password can be supplied through the environment variables `PGUSER` and `PGPASSWORD`, which can be set externally without hard-coding credentials in the source code.\n\n\n## References\n* OWASP: [Use of hard-coded password](https://www.owasp.org/index.php/Use_of_hard-coded_password).\n* Common Weakness Enumeration: [CWE-259](https://cwe.mitre.org/data/definitions/259.html).\n* Common Weakness Enumeration: [CWE-321](https://cwe.mitre.org/data/definitions/321.html).\n* Common Weakness Enumeration: [CWE-798](https://cwe.mitre.org/data/definitions/798.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-259", "external/cwe/cwe-321", "external/cwe/cwe-798" ],
            "description" : "Hard-coding credentials in source code may enable an attacker\n              to gain unauthorized access.",
            "id" : "js/hardcoded-credentials",
            "kind" : "path-problem",
            "name" : "Hard-coded credentials",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "js/insecure-download",
          "name" : "js/insecure-download",
          "shortDescription" : {
            "text" : "Download of sensitive file through insecure connection"
          },
          "fullDescription" : {
            "text" : "Downloading executables and other sensitive files over an insecure connection opens up for potential man-in-the-middle attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Download of sensitive file through insecure connection\nDownloading executables or other sensitive files over an unencrypted connection can leave a server open to man-in-the-middle attacks (MITM). Such an attack can allow an attacker to insert arbitrary content into the downloaded file, and in the worst case, allow the attacker to execute arbitrary code on the vulnerable system.\n\n\n## Recommendation\nUse a secure transfer protocol when downloading executables or other sensitive files.\n\n\n## Example\nIn this example, a server downloads a shell script from a remote URL using the `node-fetch` library, and then executes this shell script.\n\n\n```javascript\nconst fetch = require(\"node-fetch\");\nconst cp = require(\"child_process\");\n\nfetch('http://mydownload.example.org/myscript.sh')\n    .then(res => res.text())\n    .then(script => cp.execSync(script));\n```\nThe HTTP protocol is vulnerable to MITM, and thus an attacker could potentially replace the downloaded shell script with arbitrary code, which gives the attacker complete control over the system.\n\nThe issue has been fixed in the example below by replacing the HTTP protocol with the HTTPS protocol.\n\n\n```javascript\nconst fetch = require(\"node-fetch\");\nconst cp = require(\"child_process\");\n\nfetch('https://mydownload.example.org/myscript.sh')\n    .then(res => res.text())\n    .then(script => cp.execSync(script));\n```\n\n## References\n* Wikipedia: [Man-in-the-middle attack](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)\n* Common Weakness Enumeration: [CWE-829](https://cwe.mitre.org/data/definitions/829.html).\n",
            "markdown" : "# Download of sensitive file through insecure connection\nDownloading executables or other sensitive files over an unencrypted connection can leave a server open to man-in-the-middle attacks (MITM). Such an attack can allow an attacker to insert arbitrary content into the downloaded file, and in the worst case, allow the attacker to execute arbitrary code on the vulnerable system.\n\n\n## Recommendation\nUse a secure transfer protocol when downloading executables or other sensitive files.\n\n\n## Example\nIn this example, a server downloads a shell script from a remote URL using the `node-fetch` library, and then executes this shell script.\n\n\n```javascript\nconst fetch = require(\"node-fetch\");\nconst cp = require(\"child_process\");\n\nfetch('http://mydownload.example.org/myscript.sh')\n    .then(res => res.text())\n    .then(script => cp.execSync(script));\n```\nThe HTTP protocol is vulnerable to MITM, and thus an attacker could potentially replace the downloaded shell script with arbitrary code, which gives the attacker complete control over the system.\n\nThe issue has been fixed in the example below by replacing the HTTP protocol with the HTTPS protocol.\n\n\n```javascript\nconst fetch = require(\"node-fetch\");\nconst cp = require(\"child_process\");\n\nfetch('https://mydownload.example.org/myscript.sh')\n    .then(res => res.text())\n    .then(script => cp.execSync(script));\n```\n\n## References\n* Wikipedia: [Man-in-the-middle attack](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)\n* Common Weakness Enumeration: [CWE-829](https://cwe.mitre.org/data/definitions/829.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-829" ],
            "description" : "Downloading executables and other sensitive files over an insecure connection\n              opens up for potential man-in-the-middle attacks.",
            "id" : "js/insecure-download",
            "kind" : "path-problem",
            "name" : "Download of sensitive file through insecure connection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "8.1"
          }
        }, {
          "id" : "js/functionality-from-untrusted-source",
          "name" : "js/functionality-from-untrusted-source",
          "shortDescription" : {
            "text" : "Inclusion of functionality from an untrusted source"
          },
          "fullDescription" : {
            "text" : "Including functionality from an untrusted source may allow an attacker to control the functionality and execute arbitrary code."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Inclusion of functionality from an untrusted source\nIncluding a resource from an untrusted source or using an untrusted channel may allow an attacker to include arbitrary code in the response. When including an external resource (for example, a `script` element or an `iframe` element) on a page, it is important to ensure that the received data is not malicious.\n\nWhen including external resources, it is possible to verify that the responding server is the intended one by using an `https` URL. This prevents a MITM (man-in-the-middle) attack where an attacker might have been able to spoof a server response.\n\nEven when `https` is used, an attacker might still compromise the server. When you use a `script` element, you can check for subresource integrity - that is, you can check the contents of the data received by supplying a cryptographic digest of the expected sources to the `script` element. The script will only load sources that match the digest and an attacker will be unable to modify the script even when the server is compromised.\n\nSubresource integrity checking is commonly recommended when importing a fixed version of a library - for example, from a CDN (content-delivery network). Then, the fixed digest of that version of the library can easily be added to the `script` element's `integrity` attribute.\n\n\n## Recommendation\nWhen an `iframe` element is used to embed a page, it is important to use an `https` URL.\n\nWhen using a `script` element to load a script, it is important to use an `https` URL and to consider checking subresource integrity.\n\n\n## Example\nThe following example loads the jQuery library from the jQuery CDN without using `https` and without checking subresource integrity.\n\n\n```html\n<html>\n    <head>\n        <title>jQuery demo</title>\n        <script src=\"http://code.jquery.com/jquery-3.6.0.slim.min.js\" crossorigin=\"anonymous\"></script>\n    </head>\n    <body>\n        ...\n    </body>\n</html>\n```\nInstead, loading jQuery from the same domain using `https` and checking subresource integrity is recommended, as in the next example.\n\n\n```html\n<html>\n    <head>\n        <title>jQuery demo</title>\n        <script src=\"https://code.jquery.com/jquery-3.6.0.slim.min.js\" integrity=\"sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=\" crossorigin=\"anonymous\"></script>\n    </head>\n    <body>\n        ...\n    </body>\n</html>\n```\n\n## References\n* MDN: [Subresource Integrity](https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity)\n* Smashing Magazine: [Understanding Subresource Integrity](https://www.smashingmagazine.com/2019/04/understanding-subresource-integrity/)\n* Common Weakness Enumeration: [CWE-830](https://cwe.mitre.org/data/definitions/830.html).\n",
            "markdown" : "# Inclusion of functionality from an untrusted source\nIncluding a resource from an untrusted source or using an untrusted channel may allow an attacker to include arbitrary code in the response. When including an external resource (for example, a `script` element or an `iframe` element) on a page, it is important to ensure that the received data is not malicious.\n\nWhen including external resources, it is possible to verify that the responding server is the intended one by using an `https` URL. This prevents a MITM (man-in-the-middle) attack where an attacker might have been able to spoof a server response.\n\nEven when `https` is used, an attacker might still compromise the server. When you use a `script` element, you can check for subresource integrity - that is, you can check the contents of the data received by supplying a cryptographic digest of the expected sources to the `script` element. The script will only load sources that match the digest and an attacker will be unable to modify the script even when the server is compromised.\n\nSubresource integrity checking is commonly recommended when importing a fixed version of a library - for example, from a CDN (content-delivery network). Then, the fixed digest of that version of the library can easily be added to the `script` element's `integrity` attribute.\n\n\n## Recommendation\nWhen an `iframe` element is used to embed a page, it is important to use an `https` URL.\n\nWhen using a `script` element to load a script, it is important to use an `https` URL and to consider checking subresource integrity.\n\n\n## Example\nThe following example loads the jQuery library from the jQuery CDN without using `https` and without checking subresource integrity.\n\n\n```html\n<html>\n    <head>\n        <title>jQuery demo</title>\n        <script src=\"http://code.jquery.com/jquery-3.6.0.slim.min.js\" crossorigin=\"anonymous\"></script>\n    </head>\n    <body>\n        ...\n    </body>\n</html>\n```\nInstead, loading jQuery from the same domain using `https` and checking subresource integrity is recommended, as in the next example.\n\n\n```html\n<html>\n    <head>\n        <title>jQuery demo</title>\n        <script src=\"https://code.jquery.com/jquery-3.6.0.slim.min.js\" integrity=\"sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=\" crossorigin=\"anonymous\"></script>\n    </head>\n    <body>\n        ...\n    </body>\n</html>\n```\n\n## References\n* MDN: [Subresource Integrity](https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity)\n* Smashing Magazine: [Understanding Subresource Integrity](https://www.smashingmagazine.com/2019/04/understanding-subresource-integrity/)\n* Common Weakness Enumeration: [CWE-830](https://cwe.mitre.org/data/definitions/830.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-830" ],
            "description" : "Including functionality from an untrusted source may allow\n              an attacker to control the functionality and execute arbitrary code.",
            "id" : "js/functionality-from-untrusted-source",
            "kind" : "problem",
            "name" : "Inclusion of functionality from an untrusted source",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "6.0"
          }
        }, {
          "id" : "js/loop-bound-injection",
          "name" : "js/loop-bound-injection",
          "shortDescription" : {
            "text" : "Loop bound injection"
          },
          "fullDescription" : {
            "text" : "Iterating over an object with a user-controlled .length property can cause indefinite looping."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Loop bound injection\nUsing the `.length` property of an untrusted object as a loop bound may cause indefinite looping since a malicious attacker can set the `.length` property to a very large number. For example, when a program that expects an array is passed a JSON object such as `{length: 1e100}`, the loop will be run for 10<sup>100</sup> iterations. This may cause the program to hang or run out of memory, which can be used to mount a denial-of-service (DoS) attack.\n\n\n## Recommendation\nEither check that the object is indeed an array or limit the size of the `.length` property.\n\n\n## Example\nIn the example below, an HTTP request handler iterates over a user-controlled object `obj` using the `obj.length` property in order to copy the elements from `obj` to an array.\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\napp.post(\"/foo\", (req, res) => {\n    var obj = req.body;\n\n    var ret = [];\n\n    // Potential DoS if obj.length is large.\n    for (var i = 0; i < obj.length; i++) {\n        ret.push(obj[i]);\n    }\n});\n\n```\nThis is not secure since an attacker can control the value of `obj.length`, and thereby cause the loop to iterate indefinitely. Here the potential DoS is fixed by enforcing that the user-controlled object is an array.\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\napp.post(\"/foo\", (req, res) => {\n    var obj = req.body;\n    \n    if (!(obj instanceof Array)) { // Prevents DoS.\n        return [];\n    }\n\n    var ret = [];\n\n    for (var i = 0; i < obj.length; i++) {\n        ret.push(obj[i]);\n    }\n});\n\n```\n\n## References\n* Common Weakness Enumeration: [CWE-834](https://cwe.mitre.org/data/definitions/834.html).\n* Common Weakness Enumeration: [CWE-730](https://cwe.mitre.org/data/definitions/730.html).\n",
            "markdown" : "# Loop bound injection\nUsing the `.length` property of an untrusted object as a loop bound may cause indefinite looping since a malicious attacker can set the `.length` property to a very large number. For example, when a program that expects an array is passed a JSON object such as `{length: 1e100}`, the loop will be run for 10<sup>100</sup> iterations. This may cause the program to hang or run out of memory, which can be used to mount a denial-of-service (DoS) attack.\n\n\n## Recommendation\nEither check that the object is indeed an array or limit the size of the `.length` property.\n\n\n## Example\nIn the example below, an HTTP request handler iterates over a user-controlled object `obj` using the `obj.length` property in order to copy the elements from `obj` to an array.\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\napp.post(\"/foo\", (req, res) => {\n    var obj = req.body;\n\n    var ret = [];\n\n    // Potential DoS if obj.length is large.\n    for (var i = 0; i < obj.length; i++) {\n        ret.push(obj[i]);\n    }\n});\n\n```\nThis is not secure since an attacker can control the value of `obj.length`, and thereby cause the loop to iterate indefinitely. Here the potential DoS is fixed by enforcing that the user-controlled object is an array.\n\n\n```javascript\nvar express = require('express');\nvar app = express();\n\napp.post(\"/foo\", (req, res) => {\n    var obj = req.body;\n    \n    if (!(obj instanceof Array)) { // Prevents DoS.\n        return [];\n    }\n\n    var ret = [];\n\n    for (var i = 0; i < obj.length; i++) {\n        ret.push(obj[i]);\n    }\n});\n\n```\n\n## References\n* Common Weakness Enumeration: [CWE-834](https://cwe.mitre.org/data/definitions/834.html).\n* Common Weakness Enumeration: [CWE-730](https://cwe.mitre.org/data/definitions/730.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-834", "external/cwe/cwe-730" ],
            "description" : "Iterating over an object with a user-controlled .length\n              property can cause indefinite looping.",
            "id" : "js/loop-bound-injection",
            "kind" : "path-problem",
            "name" : "Loop bound injection",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "js/type-confusion-through-parameter-tampering",
          "name" : "js/type-confusion-through-parameter-tampering",
          "shortDescription" : {
            "text" : "Type confusion through parameter tampering"
          },
          "fullDescription" : {
            "text" : "Sanitizing an HTTP request parameter may be ineffective if the user controls its type."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Type confusion through parameter tampering\nSanitizing untrusted HTTP request parameters is a common technique for preventing injection attacks such as SQL injection or path traversal. This is sometimes done by checking if the request parameters contain blacklisted substrings.\n\nHowever, sanitizing request parameters assuming they have type `String` and using the builtin string methods such as `String.prototype.indexOf` is susceptible to type confusion attacks. In a type confusion attack, an attacker tampers with an HTTP request parameter such that it has a value of type `Array` instead of the expected type `String`. Furthermore, the content of the array has been crafted to bypass sanitizers by exploiting that some identically named methods of strings and arrays behave differently.\n\n\n## Recommendation\nCheck the runtime type of sanitizer inputs if the input type is user-controlled.\n\nAn even safer alternative is to design the application so that sanitization is not needed, for instance by using prepared statements for SQL queries.\n\n\n## Example\nFor example, Node.js server frameworks usually present request parameters as strings. But if an attacker sends multiple request parameters with the same name, then the request parameter is represented as an array instead.\n\nIn the following example, a sanitizer checks that a path does not contain the `\"..\"` string, which would allow an attacker to access content outside a user-accessible directory.\n\n\n```javascript\nvar app = require(\"express\")(),\n  path = require(\"path\");\n\napp.get(\"/user-files\", function(req, res) {\n  var file = req.param(\"file\");\n  if (file.indexOf(\"..\") !== -1) {\n    // BAD\n    // we forbid relative paths that contain ..\n    // as these could leave the public directory\n    res.status(400).send(\"Bad request\");\n  } else {\n    var absolute = path.resolve(\"/public/\" + file);\n    console.log(\"Sending file: %s\", absolute);\n    res.sendFile(absolute);\n  }\n});\n\n```\nAs written, this sanitizer is ineffective: an array like `[\"../\", \"/../secret.txt\"]` will bypass the sanitizer. The array does not contain `\"..\"` as an element, so the call to `indexOf` returns `-1` . This is problematic since the value of the `absolute` variable then ends up being `\"/secret.txt\"`. This happens since the concatenation of `\"/public/\"` and the array results in `\"/public/../,/../secret.txt\"`, which the `resolve`-call converts to `\"/secret.txt\"`.\n\nTo fix the sanitizer, check that the request parameter is a string, and not an array:\n\n\n```javascript\nvar app = require(\"express\")(),\n  path = require(\"path\");\n\napp.get(\"/user-files\", function(req, res) {\n  var file = req.param(\"file\");\n  if (typeof file !== 'string' || file.indexOf(\"..\") !== -1) {\n    // GOOD\n    // we forbid relative paths that contain ..\n    // as these could leave the public directory\n    res.status(400).send(\"Bad request\");\n  } else {\n    var absolute = path.resolve(\"/public/\" + file);\n    console.log(\"Sending file: %s\", absolute);\n    res.sendFile(absolute);\n  }\n});\n\n```\n\n## References\n* Node.js API: [querystring](https://nodejs.org/api/querystring.html).\n* Common Weakness Enumeration: [CWE-843](https://cwe.mitre.org/data/definitions/843.html).\n",
            "markdown" : "# Type confusion through parameter tampering\nSanitizing untrusted HTTP request parameters is a common technique for preventing injection attacks such as SQL injection or path traversal. This is sometimes done by checking if the request parameters contain blacklisted substrings.\n\nHowever, sanitizing request parameters assuming they have type `String` and using the builtin string methods such as `String.prototype.indexOf` is susceptible to type confusion attacks. In a type confusion attack, an attacker tampers with an HTTP request parameter such that it has a value of type `Array` instead of the expected type `String`. Furthermore, the content of the array has been crafted to bypass sanitizers by exploiting that some identically named methods of strings and arrays behave differently.\n\n\n## Recommendation\nCheck the runtime type of sanitizer inputs if the input type is user-controlled.\n\nAn even safer alternative is to design the application so that sanitization is not needed, for instance by using prepared statements for SQL queries.\n\n\n## Example\nFor example, Node.js server frameworks usually present request parameters as strings. But if an attacker sends multiple request parameters with the same name, then the request parameter is represented as an array instead.\n\nIn the following example, a sanitizer checks that a path does not contain the `\"..\"` string, which would allow an attacker to access content outside a user-accessible directory.\n\n\n```javascript\nvar app = require(\"express\")(),\n  path = require(\"path\");\n\napp.get(\"/user-files\", function(req, res) {\n  var file = req.param(\"file\");\n  if (file.indexOf(\"..\") !== -1) {\n    // BAD\n    // we forbid relative paths that contain ..\n    // as these could leave the public directory\n    res.status(400).send(\"Bad request\");\n  } else {\n    var absolute = path.resolve(\"/public/\" + file);\n    console.log(\"Sending file: %s\", absolute);\n    res.sendFile(absolute);\n  }\n});\n\n```\nAs written, this sanitizer is ineffective: an array like `[\"../\", \"/../secret.txt\"]` will bypass the sanitizer. The array does not contain `\"..\"` as an element, so the call to `indexOf` returns `-1` . This is problematic since the value of the `absolute` variable then ends up being `\"/secret.txt\"`. This happens since the concatenation of `\"/public/\"` and the array results in `\"/public/../,/../secret.txt\"`, which the `resolve`-call converts to `\"/secret.txt\"`.\n\nTo fix the sanitizer, check that the request parameter is a string, and not an array:\n\n\n```javascript\nvar app = require(\"express\")(),\n  path = require(\"path\");\n\napp.get(\"/user-files\", function(req, res) {\n  var file = req.param(\"file\");\n  if (typeof file !== 'string' || file.indexOf(\"..\") !== -1) {\n    // GOOD\n    // we forbid relative paths that contain ..\n    // as these could leave the public directory\n    res.status(400).send(\"Bad request\");\n  } else {\n    var absolute = path.resolve(\"/public/\" + file);\n    console.log(\"Sending file: %s\", absolute);\n    res.sendFile(absolute);\n  }\n});\n\n```\n\n## References\n* Node.js API: [querystring](https://nodejs.org/api/querystring.html).\n* Common Weakness Enumeration: [CWE-843](https://cwe.mitre.org/data/definitions/843.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-843" ],
            "description" : "Sanitizing an HTTP request parameter may be ineffective if the user controls its type.",
            "id" : "js/type-confusion-through-parameter-tampering",
            "kind" : "path-problem",
            "name" : "Type confusion through parameter tampering",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "js/prototype-polluting-assignment",
          "name" : "js/prototype-polluting-assignment",
          "shortDescription" : {
            "text" : "Prototype-polluting assignment"
          },
          "fullDescription" : {
            "text" : "Modifying an object obtained via a user-controlled property name may lead to accidental mutation of the built-in Object prototype, and possibly escalate to remote code execution or cross-site scripting."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Prototype-polluting assignment\nMost JavaScript objects inherit the properties of the built-in `Object.prototype` object. Prototype pollution is a type of vulnerability in which an attacker is able to modify `Object.prototype`. Since most objects inherit from the compromised `Object.prototype` object, the attacker can use this to tamper with the application logic, and often escalate to remote code execution or cross-site scripting.\n\nOne way to cause prototype pollution is by modifying an object obtained via a user-controlled property name. Most objects have a special `__proto__` property that refers to `Object.prototype`. An attacker can abuse this special property to trick the application into performing unintended modifications of `Object.prototype`.\n\n\n## Recommendation\nUse an associative data structure that is resilient to untrusted key values, such as a [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map). In some cases, a prototype-less object created with [Object.create(null)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create) may be preferable.\n\nAlternatively, restrict the computed property name so it can't clash with a built-in property, either by prefixing it with a constant string, or by rejecting inputs that don't conform to the expected format.\n\n\n## Example\nIn the example below, the untrusted value `req.params.id` is used as the property name `req.session.todos[id]`. If a malicious user passes in the ID value `__proto__`, the variable `todo` will then refer to `Object.prototype`. Finally, the modification of `todo` then allows the attacker to inject arbitrary properties onto `Object.prototype`.\n\n\n```javascript\nlet express = require('express');\nlet app = express()\n\napp.put('/todos/:id', (req, res) => {\n    let id = req.params.id;\n    let items = req.session.todos[id];\n    if (!items) {\n        items = req.session.todos[id] = {};\n    }\n    items[req.query.name] = req.query.text;\n    res.end(200);\n});\n\n```\nOne way to fix this is to use [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) objects to associate key/value pairs instead of regular objects, as shown below:\n\n\n```javascript\nlet express = require('express');\nlet app = express()\n\napp.put('/todos/:id', (req, res) => {\n    let id = req.params.id;\n    let items = req.session.todos.get(id);\n    if (!items) {\n        items = new Map();\n        req.sessions.todos.set(id, items);\n    }\n    items.set(req.query.name, req.query.text);\n    res.end(200);\n});\n\n```\n\n## References\n* MDN: [Object.prototype.__proto__](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/proto)\n* MDN: [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map)\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n* Common Weakness Enumeration: [CWE-471](https://cwe.mitre.org/data/definitions/471.html).\n* Common Weakness Enumeration: [CWE-915](https://cwe.mitre.org/data/definitions/915.html).\n",
            "markdown" : "# Prototype-polluting assignment\nMost JavaScript objects inherit the properties of the built-in `Object.prototype` object. Prototype pollution is a type of vulnerability in which an attacker is able to modify `Object.prototype`. Since most objects inherit from the compromised `Object.prototype` object, the attacker can use this to tamper with the application logic, and often escalate to remote code execution or cross-site scripting.\n\nOne way to cause prototype pollution is by modifying an object obtained via a user-controlled property name. Most objects have a special `__proto__` property that refers to `Object.prototype`. An attacker can abuse this special property to trick the application into performing unintended modifications of `Object.prototype`.\n\n\n## Recommendation\nUse an associative data structure that is resilient to untrusted key values, such as a [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map). In some cases, a prototype-less object created with [Object.create(null)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create) may be preferable.\n\nAlternatively, restrict the computed property name so it can't clash with a built-in property, either by prefixing it with a constant string, or by rejecting inputs that don't conform to the expected format.\n\n\n## Example\nIn the example below, the untrusted value `req.params.id` is used as the property name `req.session.todos[id]`. If a malicious user passes in the ID value `__proto__`, the variable `todo` will then refer to `Object.prototype`. Finally, the modification of `todo` then allows the attacker to inject arbitrary properties onto `Object.prototype`.\n\n\n```javascript\nlet express = require('express');\nlet app = express()\n\napp.put('/todos/:id', (req, res) => {\n    let id = req.params.id;\n    let items = req.session.todos[id];\n    if (!items) {\n        items = req.session.todos[id] = {};\n    }\n    items[req.query.name] = req.query.text;\n    res.end(200);\n});\n\n```\nOne way to fix this is to use [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) objects to associate key/value pairs instead of regular objects, as shown below:\n\n\n```javascript\nlet express = require('express');\nlet app = express()\n\napp.put('/todos/:id', (req, res) => {\n    let id = req.params.id;\n    let items = req.session.todos.get(id);\n    if (!items) {\n        items = new Map();\n        req.sessions.todos.set(id, items);\n    }\n    items.set(req.query.name, req.query.text);\n    res.end(200);\n});\n\n```\n\n## References\n* MDN: [Object.prototype.__proto__](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/proto)\n* MDN: [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map)\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n* Common Weakness Enumeration: [CWE-471](https://cwe.mitre.org/data/definitions/471.html).\n* Common Weakness Enumeration: [CWE-915](https://cwe.mitre.org/data/definitions/915.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-078", "external/cwe/cwe-079", "external/cwe/cwe-094", "external/cwe/cwe-400", "external/cwe/cwe-471", "external/cwe/cwe-915" ],
            "description" : "Modifying an object obtained via a user-controlled property name may\n              lead to accidental mutation of the built-in Object prototype,\n              and possibly escalate to remote code execution or cross-site scripting.",
            "id" : "js/prototype-polluting-assignment",
            "kind" : "path-problem",
            "name" : "Prototype-polluting assignment",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/prototype-pollution-utility",
          "name" : "js/prototype-pollution-utility",
          "shortDescription" : {
            "text" : "Prototype-polluting function"
          },
          "fullDescription" : {
            "text" : "Functions recursively assigning properties on objects may be the cause of accidental modification of a built-in prototype object."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Prototype-polluting function\nMost JavaScript objects inherit the properties of the built-in `Object.prototype` object. Prototype pollution is a type of vulnerability in which an attacker is able to modify `Object.prototype`. Since most objects inherit from the compromised `Object.prototype`, the attacker can use this to tamper with the application logic, and often escalate to remote code execution or cross-site scripting.\n\nOne way to cause prototype pollution is through use of an unsafe *merge* or *extend* function to recursively copy properties from one object to another, or through the use of a *deep assignment* function to assign to an unverified chain of property names. Such a function has the potential to modify any object reachable from the destination object, and the built-in `Object.prototype` is usually reachable through the special properties `__proto__` and `constructor.prototype`.\n\n\n## Recommendation\nThe most effective place to guard against this is in the function that performs the recursive copy or deep assignment.\n\nOnly merge or assign a property recursively when it is an own property of the *destination* object. Alternatively, block the property names `__proto__` and `constructor` from being merged or assigned to.\n\n\n## Example\nThis function recursively copies properties from `src` to `dst`:\n\n\n```javascript\nfunction merge(dst, src) {\n    for (let key in src) {\n        if (!src.hasOwnProperty(key)) continue;\n        if (isObject(dst[key])) {\n            merge(dst[key], src[key]);\n        } else {\n            dst[key] = src[key];\n        }\n    }\n}\n\n```\nHowever, if `src` is the object `{\"__proto__\": {\"isAdmin\": true}}`, it will inject the property `isAdmin: true` in `Object.prototype`.\n\nThe issue can be fixed by ensuring that only own properties of the destination object are merged recursively:\n\n\n```javascript\nfunction merge(dst, src) {\n    for (let key in src) {\n        if (!src.hasOwnProperty(key)) continue;\n        if (dst.hasOwnProperty(key) && isObject(dst[key])) {\n            merge(dst[key], src[key]);\n        } else {\n            dst[key] = src[key];\n        }\n    }\n}\n\n```\nAlternatively, block the `__proto__` and `constructor` properties:\n\n\n```javascript\nfunction merge(dst, src) {\n    for (let key in src) {\n        if (!src.hasOwnProperty(key)) continue;\n        if (key === \"__proto__\" || key === \"constructor\") continue;\n        if (isObject(dst[key])) {\n            merge(dst[key], src[key]);\n        } else {\n            dst[key] = src[key];\n        }\n    }\n}\n\n```\n\n## References\n* Prototype pollution attacks: [lodash](https://hackerone.com/reports/380873), [jQuery](https://hackerone.com/reports/454365), [extend](https://hackerone.com/reports/381185), [just-extend](https://hackerone.com/reports/430291), [merge.recursive](https://hackerone.com/reports/381194).\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n* Common Weakness Enumeration: [CWE-471](https://cwe.mitre.org/data/definitions/471.html).\n* Common Weakness Enumeration: [CWE-915](https://cwe.mitre.org/data/definitions/915.html).\n",
            "markdown" : "# Prototype-polluting function\nMost JavaScript objects inherit the properties of the built-in `Object.prototype` object. Prototype pollution is a type of vulnerability in which an attacker is able to modify `Object.prototype`. Since most objects inherit from the compromised `Object.prototype`, the attacker can use this to tamper with the application logic, and often escalate to remote code execution or cross-site scripting.\n\nOne way to cause prototype pollution is through use of an unsafe *merge* or *extend* function to recursively copy properties from one object to another, or through the use of a *deep assignment* function to assign to an unverified chain of property names. Such a function has the potential to modify any object reachable from the destination object, and the built-in `Object.prototype` is usually reachable through the special properties `__proto__` and `constructor.prototype`.\n\n\n## Recommendation\nThe most effective place to guard against this is in the function that performs the recursive copy or deep assignment.\n\nOnly merge or assign a property recursively when it is an own property of the *destination* object. Alternatively, block the property names `__proto__` and `constructor` from being merged or assigned to.\n\n\n## Example\nThis function recursively copies properties from `src` to `dst`:\n\n\n```javascript\nfunction merge(dst, src) {\n    for (let key in src) {\n        if (!src.hasOwnProperty(key)) continue;\n        if (isObject(dst[key])) {\n            merge(dst[key], src[key]);\n        } else {\n            dst[key] = src[key];\n        }\n    }\n}\n\n```\nHowever, if `src` is the object `{\"__proto__\": {\"isAdmin\": true}}`, it will inject the property `isAdmin: true` in `Object.prototype`.\n\nThe issue can be fixed by ensuring that only own properties of the destination object are merged recursively:\n\n\n```javascript\nfunction merge(dst, src) {\n    for (let key in src) {\n        if (!src.hasOwnProperty(key)) continue;\n        if (dst.hasOwnProperty(key) && isObject(dst[key])) {\n            merge(dst[key], src[key]);\n        } else {\n            dst[key] = src[key];\n        }\n    }\n}\n\n```\nAlternatively, block the `__proto__` and `constructor` properties:\n\n\n```javascript\nfunction merge(dst, src) {\n    for (let key in src) {\n        if (!src.hasOwnProperty(key)) continue;\n        if (key === \"__proto__\" || key === \"constructor\") continue;\n        if (isObject(dst[key])) {\n            merge(dst[key], src[key]);\n        } else {\n            dst[key] = src[key];\n        }\n    }\n}\n\n```\n\n## References\n* Prototype pollution attacks: [lodash](https://hackerone.com/reports/380873), [jQuery](https://hackerone.com/reports/454365), [extend](https://hackerone.com/reports/381185), [just-extend](https://hackerone.com/reports/430291), [merge.recursive](https://hackerone.com/reports/381194).\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n* Common Weakness Enumeration: [CWE-471](https://cwe.mitre.org/data/definitions/471.html).\n* Common Weakness Enumeration: [CWE-915](https://cwe.mitre.org/data/definitions/915.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-078", "external/cwe/cwe-079", "external/cwe/cwe-094", "external/cwe/cwe-400", "external/cwe/cwe-471", "external/cwe/cwe-915" ],
            "description" : "Functions recursively assigning properties on objects may be\n              the cause of accidental modification of a built-in prototype object.",
            "id" : "js/prototype-pollution-utility",
            "kind" : "path-problem",
            "name" : "Prototype-polluting function",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/prototype-pollution",
          "name" : "js/prototype-pollution",
          "shortDescription" : {
            "text" : "Prototype-polluting merge call"
          },
          "fullDescription" : {
            "text" : "Recursively merging a user-controlled object into another object can allow an attacker to modify the built-in Object prototype, and possibly escalate to remote code execution or cross-site scripting."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Prototype-polluting merge call\nMost JavaScript objects inherit the properties of the built-in `Object.prototype` object. Prototype pollution is a type of vulnerability in which an attacker is able to modify `Object.prototype`. Since most objects inherit from the compromised `Object.prototype`, the attacker can use this to tamper with the application logic, and often escalate to remote code execution or cross-site scripting.\n\nOne way to cause prototype pollution is through use of an unsafe *merge* or *extend* function to recursively copy properties from an untrusted source object. Such a call can modify any object reachable from the destination object, and the built-in `Object.prototype` is usually reachable through the special properties `__proto__` and `constructor.prototype`. An attacker can abuse this by sending an object with these property names and thereby modify `Object.prototype`.\n\n\n## Recommendation\nUpdate your library dependencies in order to use a safe version of the *merge* or *extend* function. If your library has no fixed version, switch to another library.\n\n\n## Example\nIn the example below, the untrusted value `req.query.prefs` is parsed as JSON and then copied into a new object:\n\n\n```javascript\napp.get('/news', (req, res) => {\n  let prefs = lodash.merge({}, JSON.parse(req.query.prefs));\n})\n\n```\nPrior to lodash 4.17.11 this would be vulnerable to prototype pollution. An attacker could send the following GET request:\n\n```\nGET /news?prefs={\"constructor\":{\"prototype\":{\"xxx\":true}}}\n```\nThis causes the `xxx` property to be injected on `Object.prototype`. Fix this by updating the lodash version:\n\n\n```json\n{\n  \"dependencies\": {\n    \"lodash\": \"^4.17.12\"\n  }\n}\n\n```\nNote that some web frameworks, such as Express, parse query parameters using extended URL-encoding by default. When this is the case, the application may be vulnerable even if not using `JSON.parse`. The example below would also be susceptible to prototype pollution:\n\n\n```javascript\napp.get('/news', (req, res) => {\n  let config = lodash.merge({}, {\n    prefs: req.query.prefs\n  });\n})\n\n```\nIn the above example, an attacker can cause prototype pollution by sending the following GET request:\n\n```\nGET /news?prefs[constructor][prototype][xxx]=true\n```\n\n## References\n* Prototype pollution attacks: [lodash](https://hackerone.com/reports/380873), [jQuery](https://hackerone.com/reports/454365), [extend](https://hackerone.com/reports/381185), [just-extend](https://hackerone.com/reports/430291), [merge.recursive](https://hackerone.com/reports/381194).\n* Express: [urlencoded()](https://expressjs.com/en/api.html#express.urlencoded)\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n* Common Weakness Enumeration: [CWE-471](https://cwe.mitre.org/data/definitions/471.html).\n* Common Weakness Enumeration: [CWE-915](https://cwe.mitre.org/data/definitions/915.html).\n",
            "markdown" : "# Prototype-polluting merge call\nMost JavaScript objects inherit the properties of the built-in `Object.prototype` object. Prototype pollution is a type of vulnerability in which an attacker is able to modify `Object.prototype`. Since most objects inherit from the compromised `Object.prototype`, the attacker can use this to tamper with the application logic, and often escalate to remote code execution or cross-site scripting.\n\nOne way to cause prototype pollution is through use of an unsafe *merge* or *extend* function to recursively copy properties from an untrusted source object. Such a call can modify any object reachable from the destination object, and the built-in `Object.prototype` is usually reachable through the special properties `__proto__` and `constructor.prototype`. An attacker can abuse this by sending an object with these property names and thereby modify `Object.prototype`.\n\n\n## Recommendation\nUpdate your library dependencies in order to use a safe version of the *merge* or *extend* function. If your library has no fixed version, switch to another library.\n\n\n## Example\nIn the example below, the untrusted value `req.query.prefs` is parsed as JSON and then copied into a new object:\n\n\n```javascript\napp.get('/news', (req, res) => {\n  let prefs = lodash.merge({}, JSON.parse(req.query.prefs));\n})\n\n```\nPrior to lodash 4.17.11 this would be vulnerable to prototype pollution. An attacker could send the following GET request:\n\n```\nGET /news?prefs={\"constructor\":{\"prototype\":{\"xxx\":true}}}\n```\nThis causes the `xxx` property to be injected on `Object.prototype`. Fix this by updating the lodash version:\n\n\n```json\n{\n  \"dependencies\": {\n    \"lodash\": \"^4.17.12\"\n  }\n}\n\n```\nNote that some web frameworks, such as Express, parse query parameters using extended URL-encoding by default. When this is the case, the application may be vulnerable even if not using `JSON.parse`. The example below would also be susceptible to prototype pollution:\n\n\n```javascript\napp.get('/news', (req, res) => {\n  let config = lodash.merge({}, {\n    prefs: req.query.prefs\n  });\n})\n\n```\nIn the above example, an attacker can cause prototype pollution by sending the following GET request:\n\n```\nGET /news?prefs[constructor][prototype][xxx]=true\n```\n\n## References\n* Prototype pollution attacks: [lodash](https://hackerone.com/reports/380873), [jQuery](https://hackerone.com/reports/454365), [extend](https://hackerone.com/reports/381185), [just-extend](https://hackerone.com/reports/430291), [merge.recursive](https://hackerone.com/reports/381194).\n* Express: [urlencoded()](https://expressjs.com/en/api.html#express.urlencoded)\n* Common Weakness Enumeration: [CWE-78](https://cwe.mitre.org/data/definitions/78.html).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-94](https://cwe.mitre.org/data/definitions/94.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n* Common Weakness Enumeration: [CWE-471](https://cwe.mitre.org/data/definitions/471.html).\n* Common Weakness Enumeration: [CWE-915](https://cwe.mitre.org/data/definitions/915.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-078", "external/cwe/cwe-079", "external/cwe/cwe-094", "external/cwe/cwe-400", "external/cwe/cwe-471", "external/cwe/cwe-915" ],
            "description" : "Recursively merging a user-controlled object into another object\n              can allow an attacker to modify the built-in Object prototype,\n              and possibly escalate to remote code execution or cross-site scripting.",
            "id" : "js/prototype-pollution",
            "kind" : "path-problem",
            "name" : "Prototype-polluting merge call",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "js/insufficient-password-hash",
          "name" : "js/insufficient-password-hash",
          "shortDescription" : {
            "text" : "Use of password hash with insufficient computational effort"
          },
          "fullDescription" : {
            "text" : "Creating a hash of a password with low computational effort makes the hash vulnerable to password cracking attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "help" : {
            "text" : "# Use of password hash with insufficient computational effort\nStoring cryptographic hashes of passwords is standard security practice, but it is equally important to select the right hashing scheme. If an attacker obtains the hashed passwords of an application, the password hashing scheme should still prevent the attacker from easily obtaining the original cleartext passwords.\n\nA good password hashing scheme requires a computation that cannot be done efficiently. Standard hashing schemes, such as `md5` or `sha1`, are efficiently computable, and are therefore not suitable for password hashing.\n\n\n## Recommendation\nUse a secure password hashing scheme such as `bcrypt`, `scrypt`, `PBKDF2`, or `Argon2`.\n\n\n## Example\nIn the example below, the `md5` algorithm computes the hash of a password.\n\n\n```javascript\nconst crypto = require(\"crypto\");\nfunction hashPassword(password) {\n    var hasher = crypto.createHash('md5');\n    var hashed = hasher.update(password).digest(\"hex\"); // BAD\n    return hashed;\n}\n\n```\nThis is not secure, since the password can be efficiently cracked by an attacker that obtains the hash. A more secure scheme is to hash the password with the `bcrypt` algorithm:\n\n\n```javascript\nconst bcrypt = require(\"bcrypt\");\nfunction hashPassword(password, salt) {\n  var hashed = bcrypt.hashSync(password, salt); // GOOD\n  return hashed;\n}\n\n```\n\n## References\n* OWASP: [Password storage](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html).\n* Common Weakness Enumeration: [CWE-916](https://cwe.mitre.org/data/definitions/916.html).\n",
            "markdown" : "# Use of password hash with insufficient computational effort\nStoring cryptographic hashes of passwords is standard security practice, but it is equally important to select the right hashing scheme. If an attacker obtains the hashed passwords of an application, the password hashing scheme should still prevent the attacker from easily obtaining the original cleartext passwords.\n\nA good password hashing scheme requires a computation that cannot be done efficiently. Standard hashing schemes, such as `md5` or `sha1`, are efficiently computable, and are therefore not suitable for password hashing.\n\n\n## Recommendation\nUse a secure password hashing scheme such as `bcrypt`, `scrypt`, `PBKDF2`, or `Argon2`.\n\n\n## Example\nIn the example below, the `md5` algorithm computes the hash of a password.\n\n\n```javascript\nconst crypto = require(\"crypto\");\nfunction hashPassword(password) {\n    var hasher = crypto.createHash('md5');\n    var hashed = hasher.update(password).digest(\"hex\"); // BAD\n    return hashed;\n}\n\n```\nThis is not secure, since the password can be efficiently cracked by an attacker that obtains the hash. A more secure scheme is to hash the password with the `bcrypt` algorithm:\n\n\n```javascript\nconst bcrypt = require(\"bcrypt\");\nfunction hashPassword(password, salt) {\n  var hashed = bcrypt.hashSync(password, salt); // GOOD\n  return hashed;\n}\n\n```\n\n## References\n* OWASP: [Password storage](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html).\n* Common Weakness Enumeration: [CWE-916](https://cwe.mitre.org/data/definitions/916.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-916" ],
            "description" : "Creating a hash of a password with low computational effort makes the hash vulnerable to password cracking attacks.",
            "id" : "js/insufficient-password-hash",
            "kind" : "path-problem",
            "name" : "Use of password hash with insufficient computational effort",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "8.1"
          }
        }, {
          "id" : "js/request-forgery",
          "name" : "js/request-forgery",
          "shortDescription" : {
            "text" : "Server-side request forgery"
          },
          "fullDescription" : {
            "text" : "Making a network request with user-controlled data in the URL allows for request forgery attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "help" : {
            "text" : "# Server-side request forgery\nDirectly incorporating user input in the URL of an outgoing HTTP request can enable a request forgery attack, in which the request is altered to target an unintended API endpoint or resource. If the server performing the request is connected to an internal network, this can give an attacker the means to bypass the network boundary and make requests against internal services. A forged request may perform an unintended action on behalf of the attacker, or cause information leak if redirected to an external server or if the request response is fed back to the user. It may also compromise the server making the request, if the request response is handled in an unsafe way.\n\n\n## Recommendation\nRestrict user inputs in the URL of an outgoing request, in particular:\n\n* Avoid user input in the hostname of the URL. Pick the hostname from an allow-list instead of constructing it directly from user input.\n* Take care when user input is part of the pathname of the URL. Restrict the input so that path traversal (\"`../`\") cannot be used to redirect the request to an unintended endpoint.\n\n## Example\nThe following example shows an HTTP request parameter being used directly in the URL of a request without validating the input, which facilitates an SSRF attack. The request `http.get(...)` is vulnerable since attackers can choose the value of `target` to be anything they want. For instance, the attacker can choose `\"internal.example.com/#\"` as the target, causing the URL used in the request to be `\"https://internal.example.com/#.example.com/data\"`.\n\nA request to `https://internal.example.com` may be problematic if that server is not meant to be directly accessible from the attacker's machine.\n\n\n```javascript\nimport http from 'http';\nimport url from 'url';\n\nvar server = http.createServer(function(req, res) {\n    var target = url.parse(req.url, true).query.target;\n\n    // BAD: `target` is controlled by the attacker\n    http.get('https://' + target + \".example.com/data/\", res => {\n        // process request response ...\n    });\n\n});\n\n```\nOne way to remedy the problem is to use the user input to select a known fixed string before performing the request:\n\n\n```javascript\nimport http from 'http';\nimport url from 'url';\n\nvar server = http.createServer(function(req, res) {\n    var target = url.parse(req.url, true).query.target;\n\n    var subdomain;\n    if (target === 'EU') {\n        subdomain = \"europe\"\n    } else {\n        subdomain = \"world\"\n    }\n\n    // GOOD: `subdomain` is controlled by the server\n    http.get('https://' + subdomain + \".example.com/data/\", res => {\n        // process request response ...\n    });\n\n});\n\n```\n\n## References\n* OWASP: [SSRF](https://www.owasp.org/index.php/Server_Side_Request_Forgery)\n* Common Weakness Enumeration: [CWE-918](https://cwe.mitre.org/data/definitions/918.html).\n",
            "markdown" : "# Server-side request forgery\nDirectly incorporating user input in the URL of an outgoing HTTP request can enable a request forgery attack, in which the request is altered to target an unintended API endpoint or resource. If the server performing the request is connected to an internal network, this can give an attacker the means to bypass the network boundary and make requests against internal services. A forged request may perform an unintended action on behalf of the attacker, or cause information leak if redirected to an external server or if the request response is fed back to the user. It may also compromise the server making the request, if the request response is handled in an unsafe way.\n\n\n## Recommendation\nRestrict user inputs in the URL of an outgoing request, in particular:\n\n* Avoid user input in the hostname of the URL. Pick the hostname from an allow-list instead of constructing it directly from user input.\n* Take care when user input is part of the pathname of the URL. Restrict the input so that path traversal (\"`../`\") cannot be used to redirect the request to an unintended endpoint.\n\n## Example\nThe following example shows an HTTP request parameter being used directly in the URL of a request without validating the input, which facilitates an SSRF attack. The request `http.get(...)` is vulnerable since attackers can choose the value of `target` to be anything they want. For instance, the attacker can choose `\"internal.example.com/#\"` as the target, causing the URL used in the request to be `\"https://internal.example.com/#.example.com/data\"`.\n\nA request to `https://internal.example.com` may be problematic if that server is not meant to be directly accessible from the attacker's machine.\n\n\n```javascript\nimport http from 'http';\nimport url from 'url';\n\nvar server = http.createServer(function(req, res) {\n    var target = url.parse(req.url, true).query.target;\n\n    // BAD: `target` is controlled by the attacker\n    http.get('https://' + target + \".example.com/data/\", res => {\n        // process request response ...\n    });\n\n});\n\n```\nOne way to remedy the problem is to use the user input to select a known fixed string before performing the request:\n\n\n```javascript\nimport http from 'http';\nimport url from 'url';\n\nvar server = http.createServer(function(req, res) {\n    var target = url.parse(req.url, true).query.target;\n\n    var subdomain;\n    if (target === 'EU') {\n        subdomain = \"europe\"\n    } else {\n        subdomain = \"world\"\n    }\n\n    // GOOD: `subdomain` is controlled by the server\n    http.get('https://' + subdomain + \".example.com/data/\", res => {\n        // process request response ...\n    });\n\n});\n\n```\n\n## References\n* OWASP: [SSRF](https://www.owasp.org/index.php/Server_Side_Request_Forgery)\n* Common Weakness Enumeration: [CWE-918](https://cwe.mitre.org/data/definitions/918.html).\n"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-918" ],
            "description" : "Making a network request with user-controlled data in the URL allows for request forgery attacks.",
            "id" : "js/request-forgery",
            "kind" : "path-problem",
            "name" : "Server-side request forgery",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.1"
          }
        }, {
          "id" : "js/summary/lines-of-code",
          "name" : "js/summary/lines-of-code",
          "shortDescription" : {
            "text" : "Total lines of JavaScript and TypeScript code in the database"
          },
          "fullDescription" : {
            "text" : "The total number of lines of JavaScript or TypeScript code across all files checked into the repository, except in `node_modules`. This is a useful metric of the size of a database. For all files that were seen during extraction, this query counts the lines of code, excluding whitespace or comments."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary" ],
            "description" : "The total number of lines of JavaScript or TypeScript code across all files checked into the repository, except in `node_modules`. This is a useful metric of the size of a database. For all files that were seen during extraction, this query counts the lines of code, excluding whitespace or comments.",
            "id" : "js/summary/lines-of-code",
            "kind" : "metric",
            "name" : "Total lines of JavaScript and TypeScript code in the database"
          }
        }, {
          "id" : "js/summary/lines-of-user-code",
          "name" : "js/summary/lines-of-user-code",
          "shortDescription" : {
            "text" : "Total lines of user written JavaScript and TypeScript code in the database"
          },
          "fullDescription" : {
            "text" : "The total number of lines of JavaScript and TypeScript code from the source code directory, excluding auto-generated files and files in `node_modules`. This query counts the lines of code, excluding whitespace or comments."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary", "lines-of-code" ],
            "description" : "The total number of lines of JavaScript and TypeScript code from the source code directory,\n   excluding auto-generated files and files in `node_modules`. This query counts the lines of code, excluding\n   whitespace or comments.",
            "id" : "js/summary/lines-of-user-code",
            "kind" : "metric",
            "name" : "Total lines of user written JavaScript and TypeScript code in the database"
          }
        } ],
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/javascript-queries/0.4.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/javascript-queries/0.4.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/csharp-all",
        "semanticVersion" : "0.4.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/csharp-all/0.4.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/csharp-all/0.4.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/ssa",
        "semanticVersion" : "0.0.3+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/ssa/0.0.3/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/ssa/0.0.3/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/ruby-queries",
        "semanticVersion" : "0.4.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/ruby-queries/0.4.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/ruby-queries/0.4.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/cpp-examples",
        "semanticVersion" : "0.0.0+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/cpp-examples/0.0.0/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/cpp-examples/0.0.0/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/go-queries",
        "semanticVersion" : "0.3.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/go-queries/0.3.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/go-queries/0.3.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/javascript-examples",
        "semanticVersion" : "0.0.0+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/javascript-examples/0.0.0/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/javascript-examples/0.0.0/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/cpp-all",
        "semanticVersion" : "0.4.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/cpp-all/0.4.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/cpp-all/0.4.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/swift-queries",
        "semanticVersion" : "0.0.0+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/swift-queries/0.0.0/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/swift-queries/0.0.0/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/python-examples",
        "semanticVersion" : "0.0.0+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/python-examples/0.0.0/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/python-examples/0.0.0/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/suite-helpers",
        "semanticVersion" : "0.3.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/suite-helpers/0.3.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/suite-helpers/0.3.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/python-all",
        "semanticVersion" : "0.6.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/python-all/0.6.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/python-all/0.6.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/python-queries",
        "semanticVersion" : "0.5.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/python-queries/0.5.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/python-queries/0.5.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/go-all",
        "semanticVersion" : "0.3.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/go-all/0.3.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/go-all/0.3.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/csharp-examples",
        "semanticVersion" : "0.0.0+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/csharp-examples/0.0.0/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/csharp-examples/0.0.0/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/cpp-queries",
        "semanticVersion" : "0.4.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/cpp-queries/0.4.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/cpp-queries/0.4.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/javascript-all",
        "semanticVersion" : "0.3.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/javascript-all/0.3.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/javascript-all/0.3.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/ruby-examples",
        "semanticVersion" : "0.0.0+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/ruby-examples/0.0.0/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/ruby-examples/0.0.0/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/typos",
        "semanticVersion" : "0.0.3+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/typos/0.0.3/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/typos/0.0.3/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/go-examples",
        "semanticVersion" : "0.0.0+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/go-examples/0.0.0/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/go-examples/0.0.0/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/java-queries",
        "semanticVersion" : "0.4.2+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/java-queries/0.4.2/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/java-queries/0.4.2/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "codeql/swift-all",
        "semanticVersion" : "0.0.0+a520de3986987baf4c5f846bd82bf68536ae042c",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/swift-all/0.0.0/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/qlpacks/codeql/swift-all/0.0.0/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      }, {
        "name" : "legacy-upgrades",
        "semanticVersion" : "0.0.0",
        "locations" : [ {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/legacy-upgrades/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///opt/hostedtoolcache/CodeQL/0.0.0-20221024/x64/codeql/legacy-upgrades/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      } ]
    },
    "invocations" : [ {
      "toolExecutionNotifications" : [ {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : ".eslintrc",
              "uriBaseId" : "%SRCROOT%",
              "index" : 2
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : ".github/workflows/node.js.yml",
              "uriBaseId" : "%SRCROOT%",
              "index" : 3
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "dist/amazon-connect-chat.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 1
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "package.json",
              "uriBaseId" : "%SRCROOT%",
              "index" : 4
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "showcase/index.html",
              "uriBaseId" : "%SRCROOT%",
              "index" : 5
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "showcase/test.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 6
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/chat.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 7
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/chat.spec.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 8
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/client/aws-sdk-connectparticipant.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 0
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/client/client.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 9
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/configs/csmConfig.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 10
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/constants.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 11
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/chatArgsValidator.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 12
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/chatArgsValidator.spec.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 13
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/chatController.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 14
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/chatController.spec.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 15
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/chatSession.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 16
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/chatSession.spec.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 17
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/connectionHelpers/LpcConnectionHelper.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 18
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/connectionHelpers/LpcConnectionHelper.spec.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 19
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/connectionHelpers/baseConnectionHelper.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 20
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/connectionHelpers/baseConnectionHelper.spec.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 21
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/connectionHelpers/connectionDetailsProvider.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 22
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/connectionHelpers/connectionDetailsProvider.spec.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 23
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/eventbus.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 24
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/core/exceptions.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 25
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/globalConfig.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 26
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/globalConfig.spec.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 27
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/index.d.ts",
              "uriBaseId" : "%SRCROOT%",
              "index" : 28
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/index.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 29
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/lib/amazon-connect-websocket-manager.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 30
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/lib/connect-csm-worker.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 31
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/lib/connect-csm.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 32
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/log.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 33
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/service/csmService.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 34
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/service/csmService.spec.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 35
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/utils.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 36
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/utils.spec.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 37
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "test/jestSetup.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 38
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "test/polyfills.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 39
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "tsconfig.json",
              "uriBaseId" : "%SRCROOT%",
              "index" : 40
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "webpack.config.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 41
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/diagnostics/successfully-extracted-files",
          "index" : 1,
          "toolComponent" : {
            "index" : 4
          }
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          },
          "relatedLocations" : [ ]
        }
      } ],
      "executionSuccessful" : true
    } ],
    "artifacts" : [ {
      "location" : {
        "uri" : "src/client/aws-sdk-connectparticipant.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 0
      }
    }, {
      "location" : {
        "uri" : "dist/amazon-connect-chat.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 1
      }
    }, {
      "location" : {
        "uri" : ".eslintrc",
        "uriBaseId" : "%SRCROOT%",
        "index" : 2
      }
    }, {
      "location" : {
        "uri" : ".github/workflows/node.js.yml",
        "uriBaseId" : "%SRCROOT%",
        "index" : 3
      }
    }, {
      "location" : {
        "uri" : "package.json",
        "uriBaseId" : "%SRCROOT%",
        "index" : 4
      }
    }, {
      "location" : {
        "uri" : "showcase/index.html",
        "uriBaseId" : "%SRCROOT%",
        "index" : 5
      }
    }, {
      "location" : {
        "uri" : "showcase/test.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 6
      }
    }, {
      "location" : {
        "uri" : "src/chat.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 7
      }
    }, {
      "location" : {
        "uri" : "src/chat.spec.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 8
      }
    }, {
      "location" : {
        "uri" : "src/client/client.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 9
      }
    }, {
      "location" : {
        "uri" : "src/configs/csmConfig.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 10
      }
    }, {
      "location" : {
        "uri" : "src/constants.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 11
      }
    }, {
      "location" : {
        "uri" : "src/core/chatArgsValidator.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 12
      }
    }, {
      "location" : {
        "uri" : "src/core/chatArgsValidator.spec.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 13
      }
    }, {
      "location" : {
        "uri" : "src/core/chatController.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 14
      }
    }, {
      "location" : {
        "uri" : "src/core/chatController.spec.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 15
      }
    }, {
      "location" : {
        "uri" : "src/core/chatSession.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 16
      }
    }, {
      "location" : {
        "uri" : "src/core/chatSession.spec.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 17
      }
    }, {
      "location" : {
        "uri" : "src/core/connectionHelpers/LpcConnectionHelper.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 18
      }
    }, {
      "location" : {
        "uri" : "src/core/connectionHelpers/LpcConnectionHelper.spec.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 19
      }
    }, {
      "location" : {
        "uri" : "src/core/connectionHelpers/baseConnectionHelper.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 20
      }
    }, {
      "location" : {
        "uri" : "src/core/connectionHelpers/baseConnectionHelper.spec.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 21
      }
    }, {
      "location" : {
        "uri" : "src/core/connectionHelpers/connectionDetailsProvider.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 22
      }
    }, {
      "location" : {
        "uri" : "src/core/connectionHelpers/connectionDetailsProvider.spec.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 23
      }
    }, {
      "location" : {
        "uri" : "src/core/eventbus.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 24
      }
    }, {
      "location" : {
        "uri" : "src/core/exceptions.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 25
      }
    }, {
      "location" : {
        "uri" : "src/globalConfig.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 26
      }
    }, {
      "location" : {
        "uri" : "src/globalConfig.spec.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 27
      }
    }, {
      "location" : {
        "uri" : "src/index.d.ts",
        "uriBaseId" : "%SRCROOT%",
        "index" : 28
      }
    }, {
      "location" : {
        "uri" : "src/index.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 29
      }
    }, {
      "location" : {
        "uri" : "src/lib/amazon-connect-websocket-manager.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 30
      }
    }, {
      "location" : {
        "uri" : "src/lib/connect-csm-worker.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 31
      }
    }, {
      "location" : {
        "uri" : "src/lib/connect-csm.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 32
      }
    }, {
      "location" : {
        "uri" : "src/log.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 33
      }
    }, {
      "location" : {
        "uri" : "src/service/csmService.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 34
      }
    }, {
      "location" : {
        "uri" : "src/service/csmService.spec.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 35
      }
    }, {
      "location" : {
        "uri" : "src/utils.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 36
      }
    }, {
      "location" : {
        "uri" : "src/utils.spec.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 37
      }
    }, {
      "location" : {
        "uri" : "test/jestSetup.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 38
      }
    }, {
      "location" : {
        "uri" : "test/polyfills.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 39
      }
    }, {
      "location" : {
        "uri" : "tsconfig.json",
        "uriBaseId" : "%SRCROOT%",
        "index" : 40
      }
    }, {
      "location" : {
        "uri" : "webpack.config.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 41
      }
    } ],
    "results" : [ {
      "ruleId" : "js/incomplete-sanitization",
      "rule" : {
        "id" : "js/incomplete-sanitization",
        "index" : 39,
        "toolComponent" : {
          "index" : 4
        }
      },
      "message" : {
        "text" : "This replaces only the first occurrence of /%3A/i."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/client/aws-sdk-connectparticipant.js",
            "uriBaseId" : "%SRCROOT%",
            "index" : 0
          },
          "region" : {
            "startLine" : 11,
            "startColumn" : 4721,
            "endColumn" : 4730
          },
          "contextRegion" : {
            "startLine" : 9,
            "endLine" : 11,
            "snippet" : {
              "text" : "var r=this,n=Array.prototype.slice.call(arguments);return new t(function(t,i){n.push(function(e,r){e?i(e):t(r)}),r[e].apply(r,n)})}},isDualstackAvailable:function(t){if(!t)return!1;var r=e(\"../apis/metadata.json\");return\"string\"!=typeof t&&(t=t.serviceIdentifier),!(\"string\"!=typeof t||!r.hasOwnProperty(t))&&!!r[t].dualstackAvailable},calculateRetryDelay:function(e,t,r){t||(t={});var n=t.customBackoff||null;if(\"function\"==typeof n)return n(e,r);var i=\"number\"==typeof t.base?t.base:100;return Math.random()*(Math.pow(2,e)*i)},handleRequestWithRetries:function(e,t,r){t||(t={});var n=i.HttpClient.getInstance(),s=t.httpOptions||{},a=0,u=function(e){var n=t.maxRetries||0;if(e&&\"TimeoutError\"===e.code&&(e.retryable=!0),e&&e.retryable&&a<n){var i=o.calculateRetryDelay(a,t.retryDelayOptions,e);if(i>=0)return a++,void setTimeout(c,i+(e.retryAfter||0))}r(e)},c=function(){var t=\"\";n.handleRequest(e,s,function(e){e.on(\"data\",function(e){t+=e.toString()}),e.on(\"end\",function(){var n=e.statusCode;if(n<300)r(null,t);else{var i=1e3*parseInt(e.headers[\"retry-after\"],10)||0,s=o.error(new Error,{statusCode:n,retryable:n>=500||429===n});i&&s.retryable&&(s.retryAfter=i),u(s)}})},u)};i.util.defer(c)},uuid:{v4:function(){return e(\"uuid\").v4()}},convertPayloadToString:function(e){var t=e.request,r=t.operation,n=t.service.api.operations[r].output||{};n.payload&&e.data[n.payload]&&(e.data[n.payload]=e.data[n.payload].toString())},defer:function(e){\"object\"==typeof r&&\"function\"==typeof r.nextTick?r.nextTick(e):\"function\"==typeof n?n(e):setTimeout(e,0)},getRequestPayloadShape:function(e){var t=e.service.api.operations;if(t){var r=(t||{})[e.operation];if(r&&r.input&&r.input.payload)return r.input.members[r.input.payload]}},getProfilesFromSharedConfig:function(e,t){function n(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++)e[n[r]]=t[n[r]];return e}var i={},s={};if(r.env[o.configOptInEnv])var s=e.loadFrom({isConfig:!0,filename:r.env[o.sharedConfigFileEnv]});for(var a=e.loadFrom({filename:t||r.env[o.configOptInEnv]&&r.env[o.sharedCredentialsFileEnv]}),u=0,c=Object.keys(s);u<c.length;u++)i[c[u]]=n(i[c[u]]||{},s[c[u]]);for(var u=0,c=Object.keys(a);u<c.length;u++)i[c[u]]=n(i[c[u]]||{},a[c[u]]);return i},ARN:{validate:function(e){return e&&0===e.indexOf(\"arn:\")&&e.split(\":\").length>=6},parse:function(e){var t=e.split(\":\");return{partition:t[1],service:t[2],region:t[3],accountId:t[4],resource:t.slice(5).join(\":\")}},build:function(e){if(void 0===e.service||void 0===e.region||void 0===e.accountId||void 0===e.resource)throw o.error(new Error(\"Input ARN object is invalid\"));return\"arn:\"+(e.partition||\"aws\")+\":\"+e.service+\":\"+e.region+\":\"+e.accountId+\":\"+e.resource}},defaultProfile:\"default\",configOptInEnv:\"AWS_SDK_LOAD_CONFIG\",sharedCredentialsFileEnv:\"AWS_SHARED_CREDENTIALS_FILE\",sharedConfigFileEnv:\"AWS_CONFIG_FILE\",imdsDisabledEnv:\"AWS_EC2_METADATA_DISABLED\"};t.exports=o}).call(this)}).call(this,e(\"_process\"),e(\"timers\").setImmediate)},{\"../apis/metadata.json\":5,\"./core\":20,_process:87,fs:81,timers:95,uuid:100}],74:[function(e,t,r){function n(){}function i(e,t){for(var r=e.getElementsByTagName(t),n=0,i=r.length;n<i;n++)if(r[n].parentNode===e)return r[n]}function o(e,t){switch(t||(t={}),t.type){case\"structure\":return s(e,t);case\"map\":return a(e,t);case\"list\":return u(e,t);case void 0:case null:return l(e);default:return c(e,t)}}function s(e,t){var r={};return null===e?r:(p.each(t.members,function(n,s){if(s.isXmlAttribute){if(Object.prototype.hasOwnProperty.call(e.attributes,s.name)){var a=e.attributes[s.name].value;r[n]=o({textContent:a},s)}}else{var u=s.flattened?e:i(e,s.name);u?r[n]=o(u,s):s.flattened||\"list\"!==s.type||t.api.xmlNoDefaultLists||(r[n]=s.defaultValue)}}),r)}function a(e,t){for(var r={},n=t.key.name||\"key\",s=t.value.name||\"value\",a=t.flattened?t.name:\"entry\",u=e.firstElementChild;u;){if(u.nodeName===a){var c=i(u,n).textContent,l=i(u,s);r[c]=o(l,t.value)}u=u.nextElementSibling}return r}function u(e,t){for(var r=[],n=t.flattened?t.name:t.member.name||\"member\",i=e.firstElementChild;i;)i.nodeName===n&&r.push(o(i,t.member)),i=i.nextElementSibling;return r}function c(e,t){if(e.getAttribute){var r=e.getAttribute(\"encoding\");\"base64\"===r&&(t=new h.create({type:r}))}var n=e.textContent;return\"\"===n&&(n=null),\"function\"==typeof t.toType?t.toType(n):n}function l(e){if(void 0===e||null===e)return\"\";if(!e.firstElementChild)return null===e.parentNode.parentNode?{}:0===e.childNodes.length?\"\":e.textContent;for(var t={type:\"structure\",members:{}},r=e.firstElementChild;r;){var n=r.nodeName;Object.prototype.hasOwnProperty.call(t.members,n)?t.members[n].type=\"list\":t.members[n]={name:n},r=r.nextElementSibling}return s(e,t)}var p=e(\"../util\"),h=e(\"../model/shape\");n.prototype.parse=function(e,t){if(\"\"===e.replace(/^\\s+/,\"\"))return{};var r,n;try{if(window.DOMParser){try{r=(new DOMParser).parseFromString(e,\"text/xml\")}catch(e){throw p.error(new Error(\"Parse error in document\"),{originalError:e,code:\"XMLParserError\",retryable:!0})}if(null===r.documentElement)throw p.error(new Error(\"Cannot parse empty document.\"),{code:\"XMLParserError\",retryable:!0});var s=r.getElementsByTagName(\"parsererror\")[0];if(s&&(s.parentNode===r||\"body\"===s.parentNode.nodeName||s.parentNode.parentNode===r||\"body\"===s.parentNode.parentNode.nodeName)){var a=s.getElementsByTagName(\"div\")[0]||s;throw p.error(new Error(a.textContent||\"Parser error in document\"),{code:\"XMLParserError\",retryable:!0})}}else{if(!window.ActiveXObject)throw new Error(\"Cannot load XML parser\");if(r=new window.ActiveXObject(\"Microsoft.XMLDOM\"),r.async=!1,!r.loadXML(e))throw p.error(new Error(\"Parse error in document\"),{code:\"XMLParserError\",retryable:!0})}}catch(e){n=e}if(r&&r.documentElement&&!n){var u=o(r.documentElement,t),c=i(r.documentElement,\"ResponseMetadata\");return c&&(u.ResponseMetadata=o(c,{})),u}if(n)throw p.error(n||new Error,{code:\"XMLParserError\",retryable:!0});return{}},t.exports=n},{\"../model/shape\":45,\"../util\":73}],75:[function(e,t,r){function n(){}function i(e,t,r){switch(r.type){case\"structure\":return o(e,t,r);case\"map\":return s(e,t,r);case\"list\":return a(e,t,r);default:return u(e,t,r)}}function o(e,t,r){l.arrayEach(r.memberNames,function(n){var o=r.members[n];if(\"body\"===o.location){var s=t[n],a=o.name;if(void 0!==s&&null!==s)if(o.isXmlAttribute)e.addAttribute(a,s);else if(o.flattened)i(e,s,o);else{var u=new p(a);e.addChildNode(u),c(u,o),i(u,s,o)}}})}function s(e,t,r){var n=r.key.name||\"key\",o=r.value.name||\"value\";l.each(t,function(t,s){var a=new p(r.flattened?r.name:\"entry\");e.addChildNode(a);var u=new p(n),c=new p(o);a.addChildNode(u),a.addChildNode(c),i(u,t,r.key),i(c,s,r.value)})}function a(e,t,r){r.flattened?l.arrayEach(t,function(t){var n=r.member.name||r.name,o=new p(n);e.addChildNode(o),i(o,t,r.member)}):l.arrayEach(t,function(t){var n=r.member.name||\"member\",o=new p(n);e.addChildNode(o),i(o,t,r.member)})}function u(e,t,r){e.addChildNode(new h(r.toWireFormat(t)))}function c(e,t,r){var n,i=\"xmlns\";t.xmlNamespaceUri?(n=t.xmlNamespaceUri,t.xmlNamespacePrefix&&(i+=\":\"+t.xmlNamespacePrefix)):r&&t.api.xmlNamespaceUri&&(n=t.api.xmlNamespaceUri),n&&e.addAttribute(i,n)}var l=e(\"../util\"),p=e(\"./xml-node\").XmlNode,h=e(\"./xml-text\").XmlText;n.prototype.toXML=function(e,t,r,n){var o=new p(r);return c(o,t,!0),i(o,e,t),o.children.length>0||n?o.toString():\"\"},t.exports=n},{\"../util\":73,\"./xml-node\":78,\"./xml-text\":79}],76:[function(e,t,r){function n(e){return e.replace(/&/g,\"&amp;\").replace(/'/g,\"&apos;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\")}t.exports={escapeAttribute:n}},{}],77:[function(e,t,r){function n(e){return e.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\")}t.exports={escapeElement:n}},{}],78:[function(e,t,r){function n(e,t){void 0===t&&(t=[]),this.name=e,this.children=t,this.attributes={}}var i=e(\"./escape-attribute\").escapeAttribute;n.prototype.addAttribute=function(e,t){return this.attributes[e]=t,this},n.prototype.addChildNode=function(e){return this.children.push(e),this},n.prototype.removeAttribute=function(e){return delete this.attributes[e],this},n.prototype.toString=function(){for(var e=Boolean(this.children.length),t=\"<\"+this.name,r=this.attributes,n=0,o=Object.keys(r);n<o.length;n++){var s=o[n],a=r[s];void 0!==a&&null!==a&&(t+=\" \"+s+'=\"'+i(\"\"+a)+'\"')}return t+=e?\">\"+this.children.map(function(e){return e.toString()}).join(\"\")+\"</\"+this.name+\">\":\"/>\"},t.exports={XmlNode:n}},{\"./escape-attribute\":76}],79:[function(e,t,r){function n(e){this.value=e}var i=e(\"./escape-element\").escapeElement;n.prototype.toString=function(){return i(\"\"+this.value)},t.exports={XmlText:n}},{\"./escape-element\":77}],80:[function(e,t,r){\"use strict\";function n(e){var t=e.length;if(t%4>0)throw new Error(\"Invalid string. Length must be a multiple of 4\");var r=e.indexOf(\"=\");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function i(e){var t=n(e),r=t[0],i=t[1];return 3*(r+i)/4-i}function o(e,t,r){return 3*(t+r)/4-r}function s(e){var t,r,i=n(e),s=i[0],a=i[1],u=new h(o(e,s,a)),c=0,l=a>0?s-4:s;for(r=0;r<l;r+=4)t=p[e.charCodeAt(r)]<<18|p[e.charCodeAt(r+1)]<<12|p[e.charCodeAt(r+2)]<<6|p[e.charCodeAt(r+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===a&&(t=p[e.charCodeAt(r)]<<2|p[e.charCodeAt(r+1)]>>4,u[c++]=255&t),1===a&&(t=p[e.charCodeAt(r)]<<10|p[e.charCodeAt(r+1)]<<4|p[e.charCodeAt(r+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u}function a(e){return l[e>>18&63]+l[e>>12&63]+l[e>>6&63]+l[63&e]}function u(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(a(n));return i.join(\"\")}function c(e){for(var t,r=e.length,n=r%3,i=[],o=0,s=r-n;o<s;o+=16383)i.push(u(e,o,o+16383>s?s:o+16383));return 1===n?(t=e[r-1],i.push(l[t>>2]+l[t<<4&63]+\"==\")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(l[t>>10]+l[t>>4&63]+l[t<<2&63]+\"=\")),i.join(\"\")}r.byteLength=i,r.toByteArray=s,r.fromByteArray=c;for(var l=[],p=[],h=\"undefined\"!=typeof Uint8Array?Uint8Array:Array,f=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",d=0,m=f.length;d<m;++d)l[d]=f[d],p[f.charCodeAt(d)]=d;p[\"-\".charCodeAt(0)]=62,p[\"_\".charCodeAt(0)]=63},{}],81:[function(e,t,r){},{}],82:[function(e,t,r){(function(t,n){(function(){\"use strict\";function n(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(n()<t)throw new RangeError(\"Invalid typed array length\");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,r){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,r);if(\"number\"==typeof e){if(\"string\"==typeof t)throw new Error(\"If encoding is specified then the first argument must be a string\");return c(this,e)}return s(this,e,t,r)}function s(e,t,r,n){if(\"number\"==typeof t)throw new TypeError('\"value\" argument must not be a number');return\"undefined\"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?h(e,t,r,n):\"string\"==typeof t?l(e,t,r):f(e,t)}function a(e){if(\"number\"!=typeof e)throw new TypeError('\"size\" argument must be a number');if(e<0)throw new RangeError('\"size\" argument must not be negative')}function u(e,t,r,n){return a(t),t<=0?i(e,t):void 0!==r?\"string\"==typeof n?i(e,t).fill(r,n):i(e,t).fill(r):i(e,t)}function c(e,t){if(a(t),e=i(e,t<0?0:0|d(t)),!o.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function l(e,t,r){if(\"string\"==typeof r&&\"\"!==r||(r=\"utf8\"),!o.isEncoding(r))throw new TypeError('\"encoding\" must be a valid string encoding');var n=0|v(t,r);e=i(e,n);var s=e.write(t,r);return s!==n&&(e=e.slice(0,s)),e}function p(e,t){var r=t.length<0?0:0|d(t.length);e=i(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function h(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError(\"'offset' is out of bounds\");if(t.byteLength<r+(n||0))throw new RangeError(\"'length' is out of bounds\");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=p(e,t),e}function f(e,t){if(o.isBuffer(t)){var r=0|d(t.length);return e=i(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if(\"undefined\"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||\"length\"in t)return\"number\"!=typeof t.length||Y(t.length)?i(e,0):p(e,t);if(\"Buffer\"===t.type&&$(t.data))return p(e,t.data)}throw new TypeError(\"First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.\")}function d(e){if(e>=n())throw new RangeError(\"Attempt to allocate Buffer larger than maximum size: 0x\"+n().toString(16)+\" bytes\");return 0|e}function m(e){return+e!=e&&(e=0),o.alloc(+e)}function v(e,t){if(o.isBuffer(e))return e.length;if(\"undefined\"!=typeof ArrayBuffer&&\"function\"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;\"string\"!=typeof e&&(e=\"\"+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case\"ascii\":case\"latin1\":case\"binary\":return r;case\"utf8\":case\"utf-8\":case void 0:return V(e).length;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return 2*r;case\"hex\":return r>>>1;case\"base64\":return X(e).length;default:if(n)return V(e).length;t=(\"\"+t).toLowerCase(),n=!0}}function g(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return\"\";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return\"\";if(r>>>=0,t>>>=0,r<=t)return\"\";for(e||(e=\"utf8\");;)switch(e){case\"hex\":return q(this,t,r);case\"utf8\":case\"utf-8\":return T(this,t,r);case\"ascii\":return k(this,t,r);case\"latin1\":case\"binary\":return P(this,t,r);case\"base64\":return x(this,t,r);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return L(this,t,r);default:if(n)throw new TypeError(\"Unknown encoding: \"+e);e=(e+\"\").toLowerCase(),n=!0}}function y(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,n,i){if(0===e.length)return-1;if(\"string\"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if(\"string\"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,i);if(\"number\"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&\"function\"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,i);throw new TypeError(\"val must be string, number or Buffer\")}function w(e,t,r,n,i){function o(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,a=e.length,u=t.length;if(void 0!==n&&(\"ucs2\"===(n=String(n).toLowerCase())||\"ucs-2\"===n||\"utf16le\"===n||\"utf-16le\"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}var c;if(i){var l=-1;for(c=r;c<a;c++)if(o(e,c)===o(t,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===u)return l*s}else-1!==l&&(c-=c-l),l=-1}else for(r+u>a&&(r=a-u),c=r;c>=0;c--){for(var p=!0,h=0;h<u;h++)if(o(e,c+h)!==o(t,h)){p=!1;break}if(p)return c}return-1}function E(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError(\"Invalid hex string\");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function S(e,t,r,n){return G(V(t,e.length-r),e,r,n)}function _(e,t,r,n){return G(W(t),e,r,n)}function C(e,t,r,n){return _(e,t,r,n)}function A(e,t,r,n){return G(X(t),e,r,n)}function R(e,t,r,n){return G(K(t,e.length-r),e,r,n)}function x(e,t,r){return 0===t&&r===e.length?J.fromByteArray(e):J.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){var u,c,l,p;switch(a){case 1:o<128&&(s=o);break;case 2:u=e[i+1],128==(192&u)&&(p=(31&o)<<6|63&u)>127&&(s=p);break;case 3:u=e[i+1],c=e[i+2],128==(192&u)&&128==(192&c)&&(p=(15&o)<<12|(63&u)<<6|63&c)>2047&&(p<55296||p>57343)&&(s=p);break;case 4:u=e[i+1],c=e[i+2],l=e[i+3],128==(192&u)&&128==(192&c)&&128==(192&l)&&(p=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&p<1114112&&(s=p)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=a}return I(n)}function I(e){var t=e.length;if(t<=Q)return String.fromCharCode.apply(String,e);for(var r=\"\",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Q));return r}function k(e,t,r){var n=\"\";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function P(e,t,r){var n=\"\";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function q(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i=\"\",o=t;o<r;++o)i+=H(e[o]);return i}function L(e,t,r){for(var n=e.slice(t,r),i=\"\",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function O(e,t,r){if(e%1!=0||e<0)throw new RangeError(\"offset is not uint\");if(e+t>r)throw new RangeError(\"Trying to access beyond buffer length\")}function N(e,t,r,n,i,s){if(!o.isBuffer(e))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('\"value\" argument is out of bounds');if(r+n>e.length)throw new RangeError(\"Index out of range\")}function U(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function D(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function M(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError(\"Index out of range\");if(r<0)throw new RangeError(\"Index out of range\")}function j(e,t,r,n,i){return i||M(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(e,t,r,n,23,4),r+4}function B(e,t,r,n,i){return i||M(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(e,t,r,n,52,8),r+8}function F(e){if(e=z(e).replace(ee,\"\"),e.length<2)return\"\";for(;e.length%4!=0;)e+=\"=\";return e}function z(e){return e.trim?e.trim():e.replace(/^\\s+|\\s+$/g,\"\")}function H(e){return e<16?\"0\"+e.toString(16):e.toString(16)}function V(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error(\"Invalid code point\");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function W(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function K(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function X(e){return J.toByteArray(F(e))}function G(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function Y(e){return e!==e}var J=e(\"base64-js\"),Z=e(\"ieee754\"),$=e(\"isarray\");r.Buffer=o,r.SlowBuffer=m,r.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&\"function\"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),r.kMaxLength=n(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,r){return s(null,e,t,r)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,\"undefined\"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,r){return u(null,e,t,r)},o.allocUnsafe=function(e){return c(null,e)},o.allocUnsafeSlow=function(e){return c(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError(\"Arguments must be Buffers\");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},o.concat=function(e,t){if(!$(e))throw new TypeError('\"list\" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=o.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(!o.isBuffer(s))throw new TypeError('\"list\" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},o.byteLength=v,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError(\"Buffer size must be a multiple of 16-bits\");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError(\"Buffer size must be a multiple of 32-bits\");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError(\"Buffer size must be a multiple of 64-bits\");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?\"\":0===arguments.length?T(this,0,e):g.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e=\"\",t=r.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString(\"hex\",0,t).match(/.{2}/g).join(\" \"),this.length>t&&(e+=\" ... \")),\"<Buffer \"+e+\">\"},o.prototype.compare=function(e,t,r,n,i){if(!o.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError(\"out of range index\");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var s=i-n,a=r-t,u=Math.min(s,a),c=this.slice(n,i),l=e.slice(t,r),p=0;p<u;++p)if(c[p]!==l[p]){s=c[p],a=l[p];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},o.prototype.write=function(e,t,r,n){if(void 0===t)n=\"utf8\",r=this.length,t=0;else if(void 0===r&&\"string\"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error(\"Buffer.write(string, encoding, offset[, length]) is no longer supported\");t|=0,isFinite(r)?(r|=0,void 0===n&&(n=\"utf8\")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError(\"Attempt to write outside buffer bounds\");n||(n=\"utf8\");for(var o=!1;;)switch(n){case\"hex\":return E(this,e,t,r);case\"utf8\":case\"utf-8\":return S(this,e,t,r);case\"ascii\":return _(this,e,t,r);case\"latin1\":case\"binary\":return C(this,e,t,r);case\"base64\":return A(this,e,t,r);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return R(this,e,t,r);default:if(o)throw new TypeError(\"Unknown encoding: \"+n);n=(\"\"+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n;if(o.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=o.prototype;else{var i=t-e;n=new o(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+e]}return n},o.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},o.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),Z.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),Z.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),Z.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),Z.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){N(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){N(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return B(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return B(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError(\"targetStart out of bounds\");if(r<0||r>=this.length)throw new RangeError(\"sourceStart out of bounds\");if(n<0)throw new RangeError(\"sourceEnd out of bounds\");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,s=n-r;if(this===e&&r<t&&t<n)for(i=s-1;i>=0;--i)e[i+t]=this[i+r];else if(s<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+s),t);return s},o.prototype.fill=function(e,t,r,n){if(\"string\"==typeof e){if(\"string\"==typeof t?(n=t,t=0,r=this.length):\"string\"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&\"string\"!=typeof n)throw new TypeError(\"encoding must be a string\");if(\"string\"==typeof n&&!o.isEncoding(n))throw new TypeError(\"Unknown encoding: \"+n)}else\"number\"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError(\"Out of range index\");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var s;if(\"number\"==typeof e)for(s=t;s<r;++s)this[s]=e;else{var a=o.isBuffer(e)?e:V(new o(e,n).toString()),u=a.length;for(s=0;s<r-t;++s)this[s+t]=a[s%u]}return this};var ee=/[^+\\/0-9A-Za-z-_]/g}).call(this)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer)},{\"base64-js\":80,buffer:82,ieee754:84,isarray:85}],83:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return\"function\"==typeof e}function o(e){return\"number\"==typeof e}function s(e){return\"object\"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError(\"n must be a positive number\");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,o,u,c;if(this._events||(this._events={}),\"error\"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified \"error\" event. ('+t+\")\");throw l.context=t,l}if(r=this._events[e],a(r))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(s(r))for(o=Array.prototype.slice.call(arguments,1),c=r.slice(),n=c.length,u=0;u<n;u++)c[u].apply(this,o);return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError(\"listener must be a function\");return this._events||(this._events={}),this._events.newListener&&this.emit(\"newListener\",e,i(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,\nconsole.error(\"(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.\",this._events[e].length),\"function\"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!i(t))throw TypeError(\"listener must be a function\");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,o,a;if(!i(t))throw TypeError(\"listener must be a function\");if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit(\"removeListener\",e,t);else if(s(r)){for(a=o;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){n=a;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit(\"removeListener\",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)\"removeListener\"!==t&&this.removeAllListeners(t);return this.removeAllListeners(\"removeListener\"),this._events={},this}if(r=this._events[e],i(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],84:[function(e,t,r){r.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,c=u>>1,l=-7,p=r?i-1:0,h=r?-1:1,f=e[t+p];for(p+=h,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+e[t+p],p+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+p],p+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=c}return(f?-1:1)*s*Math.pow(2,o-n)},r.write=function(e,t,r,n,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,p=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,d=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),t+=s+p>=1?h/u:h*Math.pow(2,1-p),t*u>=2&&(s++,u/=2),s+p>=l?(a=0,s=l):s+p>=1?(a=(t*u-1)*Math.pow(2,i),s+=p):(a=t*Math.pow(2,p-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+f]=255&s,f+=d,s/=256,c-=8);e[r+f-d]|=128*m}},{}],85:[function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return\"[object Array]\"==n.call(e)}},{}],86:[function(e,t,r){!function(e){\"use strict\";function t(e){return null!==e&&\"[object Array]\"===Object.prototype.toString.call(e)}function r(e){return null!==e&&\"[object Object]\"===Object.prototype.toString.call(e)}function n(e,i){if(e===i)return!0;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(i))return!1;if(!0===t(e)){if(e.length!==i.length)return!1;for(var o=0;o<e.length;o++)if(!1===n(e[o],i[o]))return!1;return!0}if(!0===r(e)){var s={};for(var a in e)if(hasOwnProperty.call(e,a)){if(!1===n(e[a],i[a]))return!1;s[a]=!0}for(var u in i)if(hasOwnProperty.call(i,u)&&!0!==s[u])return!1;return!0}return!1}function i(e){if(\"\"===e||!1===e||null===e)return!0;if(t(e)&&0===e.length)return!0;if(r(e)){for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}return!1}function o(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;n++)r.push(e[t[n]]);return r}function s(e){return e>=\"a\"&&e<=\"z\"||e>=\"A\"&&e<=\"Z\"||\"_\"===e}function a(e){return e>=\"0\"&&e<=\"9\"||\"-\"===e}function u(e){return e>=\"a\"&&e<=\"z\"||e>=\"A\"&&e<=\"Z\"||e>=\"0\"&&e<=\"9\"||\"_\"===e}function c(){}function l(){}function p(e){this.runtime=e}function h(e){this._interpreter=e,this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[g]}]},avg:{_func:this._functionAvg,_signature:[{types:[_]}]},ceil:{_func:this._functionCeil,_signature:[{types:[g]}]},contains:{_func:this._functionContains,_signature:[{types:[b,w]},{types:[y]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[b]},{types:[b]}]},floor:{_func:this._functionFloor,_signature:[{types:[g]}]},length:{_func:this._functionLength,_signature:[{types:[b,w,E]}]},map:{_func:this._functionMap,_signature:[{types:[S]},{types:[w]}]},max:{_func:this._functionMax,_signature:[{types:[_,C]}]},merge:{_func:this._functionMerge,_signature:[{types:[E],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[w]},{types:[S]}]},sum:{_func:this._functionSum,_signature:[{types:[_]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[b]},{types:[b]}]},min:{_func:this._functionMin,_signature:[{types:[_,C]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[w]},{types:[S]}]},type:{_func:this._functionType,_signature:[{types:[y]}]},keys:{_func:this._functionKeys,_signature:[{types:[E]}]},values:{_func:this._functionValues,_signature:[{types:[E]}]},sort:{_func:this._functionSort,_signature:[{types:[C,_]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[w]},{types:[S]}]},join:{_func:this._functionJoin,_signature:[{types:[b]},{types:[C]}]},reverse:{_func:this._functionReverse,_signature:[{types:[b,w]}]},to_array:{_func:this._functionToArray,_signature:[{types:[y]}]},to_string:{_func:this._functionToString,_signature:[{types:[y]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[y]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[y],variadic:!0}]}}}function f(e){return(new l).parse(e)}function d(e){return(new c).tokenize(e)}function m(e,t){var r=new l,n=new h,i=new p(n);n._interpreter=i;var o=r.parse(t);return i.search(o,e)}var v;v=\"function\"==typeof String.prototype.trimLeft?function(e){return e.trimLeft()}:function(e){return e.match(/^\\s*(.*)/)[1]};var g=0,y=1,b=2,w=3,E=4,S=6,_=8,C=9,A={\".\":\"Dot\",\"*\":\"Star\",\",\":\"Comma\",\":\":\"Colon\",\"{\":\"Lbrace\",\"}\":\"Rbrace\",\"]\":\"Rbracket\",\"(\":\"Lparen\",\")\":\"Rparen\",\"@\":\"Current\"},R={\"<\":!0,\">\":!0,\"=\":!0,\"!\":!0},x={\" \":!0,\"\\t\":!0,\"\\n\":!0};c.prototype={tokenize:function(e){var t=[];this._current=0;for(var r,n,i;this._current<e.length;)if(s(e[this._current]))r=this._current,n=this._consumeUnquotedIdentifier(e),t.push({type:\"UnquotedIdentifier\",value:n,start:r});else if(void 0!==A[e[this._current]])t.push({type:A[e[this._current]],value:e[this._current],start:this._current}),this._current++;else if(a(e[this._current]))i=this._consumeNumber(e),t.push(i);else if(\"[\"===e[this._current])i=this._consumeLBracket(e),t.push(i);else if('\"'===e[this._current])r=this._current,n=this._consumeQuotedIdentifier(e),t.push({type:\"QuotedIdentifier\",value:n,start:r});else if(\"'\"===e[this._current])r=this._current,n=this._consumeRawStringLiteral(e),t.push({type:\"Literal\",value:n,start:r});else if(\"`\"===e[this._current]){r=this._current;var o=this._consumeLiteral(e);t.push({type:\"Literal\",value:o,start:r})}else if(void 0!==R[e[this._current]])t.push(this._consumeOperator(e));else if(void 0!==x[e[this._current]])this._current++;else if(\"&\"===e[this._current])r=this._current,this._current++,\"&\"===e[this._current]?(this._current++,t.push({type:\"And\",value:\"&&\",start:r})):t.push({type:\"Expref\",value:\"&\",start:r});else{if(\"|\"!==e[this._current]){var u=new Error(\"Unknown character:\"+e[this._current]);throw u.name=\"LexerError\",u}r=this._current,this._current++,\"|\"===e[this._current]?(this._current++,t.push({type:\"Or\",value:\"||\",start:r})):t.push({type:\"Pipe\",value:\"|\",start:r})}return t},_consumeUnquotedIdentifier:function(e){var t=this._current;for(this._current++;this._current<e.length&&u(e[this._current]);)this._current++;return e.slice(t,this._current)},_consumeQuotedIdentifier:function(e){var t=this._current;this._current++;for(var r=e.length;'\"'!==e[this._current]&&this._current<r;){var n=this._current;\"\\\\\"!==e[n]||\"\\\\\"!==e[n+1]&&'\"'!==e[n+1]?n++:n+=2,this._current=n}return this._current++,JSON.parse(e.slice(t,this._current))},_consumeRawStringLiteral:function(e){var t=this._current;this._current++;for(var r=e.length;\"'\"!==e[this._current]&&this._current<r;){var n=this._current;\"\\\\\"!==e[n]||\"\\\\\"!==e[n+1]&&\"'\"!==e[n+1]?n++:n+=2,this._current=n}return this._current++,e.slice(t+1,this._current-1).replace(\"\\\\'\",\"'\")},_consumeNumber:function(e){var t=this._current;this._current++;for(var r=e.length;a(e[this._current])&&this._current<r;)this._current++;return{type:\"Number\",value:parseInt(e.slice(t,this._current)),start:t}},_consumeLBracket:function(e){var t=this._current;return this._current++,\"?\"===e[this._current]?(this._current++,{type:\"Filter\",value:\"[?\",start:t}):\"]\"===e[this._current]?(this._current++,{type:\"Flatten\",value:\"[]\",start:t}):{type:\"Lbracket\",value:\"[\",start:t}},_consumeOperator:function(e){var t=this._current,r=e[t];return this._current++,\"!\"===r?\"=\"===e[this._current]?(this._current++,{type:\"NE\",value:\"!=\",start:t}):{type:\"Not\",value:\"!\",start:t}:\"<\"===r?\"=\"===e[this._current]?(this._current++,{type:\"LTE\",value:\"<=\",start:t}):{type:\"LT\",value:\"<\",start:t}:\">\"===r?\"=\"===e[this._current]?(this._current++,{type:\"GTE\",value:\">=\",start:t}):{type:\"GT\",value:\">\",start:t}:\"=\"===r&&\"=\"===e[this._current]?(this._current++,{type:\"EQ\",value:\"==\",start:t}):void 0},_consumeLiteral:function(e){this._current++;for(var t,r=this._current,n=e.length;\"`\"!==e[this._current]&&this._current<n;){var i=this._current;\"\\\\\"!==e[i]||\"\\\\\"!==e[i+1]&&\"`\"!==e[i+1]?i++:i+=2,this._current=i}var o=v(e.slice(r,this._current));return o=o.replace(\"\\\\`\",\"`\"),t=this._looksLikeJSON(o)?JSON.parse(o):JSON.parse('\"'+o+'\"'),this._current++,t},_looksLikeJSON:function(e){var t='[{\"',r=[\"true\",\"false\",\"null\"],n=\"-0123456789\";if(\"\"===e)return!1;if(t.indexOf(e[0])>=0)return!0;if(r.indexOf(e)>=0)return!0;if(!(n.indexOf(e[0])>=0))return!1;try{return JSON.parse(e),!0}catch(e){return!1}}};var T={};T.EOF=0,T.UnquotedIdentifier=0,T.QuotedIdentifier=0,T.Rbracket=0,T.Rparen=0,T.Comma=0,T.Rbrace=0,T.Number=0,T.Current=0,T.Expref=0,T.Pipe=1,T.Or=2,T.And=3,T.EQ=5,T.GT=5,T.LT=5,T.GTE=5,T.LTE=5,T.NE=5,T.Flatten=9,T.Star=20,T.Filter=21,T.Dot=40,T.Not=45,T.Lbrace=50,T.Lbracket=55,T.Lparen=60,l.prototype={parse:function(e){this._loadTokens(e),this.index=0;var t=this.expression(0);if(\"EOF\"!==this._lookahead(0)){var r=this._lookaheadToken(0),n=new Error(\"Unexpected token type: \"+r.type+\", value: \"+r.value);throw n.name=\"ParserError\",n}return t},_loadTokens:function(e){var t=new c,r=t.tokenize(e);r.push({type:\"EOF\",value:\"\",start:e.length}),this.tokens=r},expression:function(e){var t=this._lookaheadToken(0);this._advance();for(var r=this.nud(t),n=this._lookahead(0);e<T[n];)this._advance(),r=this.led(n,r),n=this._lookahead(0);return r},_lookahead:function(e){return this.tokens[this.index+e].type},_lookaheadToken:function(e){return this.tokens[this.index+e]},_advance:function(){this.index++},nud:function(e){var t,r,n;switch(e.type){case\"Literal\":return{type:\"Literal\",value:e.value};case\"UnquotedIdentifier\":return{type:\"Field\",name:e.value};case\"QuotedIdentifier\":var i={type:\"Field\",name:e.value};if(\"Lparen\"===this._lookahead(0))throw new Error(\"Quoted identifier not allowed for function names.\");return i;case\"Not\":return r=this.expression(T.Not),{type:\"NotExpression\",children:[r]};case\"Star\":return t={type:\"Identity\"},r=null,r=\"Rbracket\"===this._lookahead(0)?{type:\"Identity\"}:this._parseProjectionRHS(T.Star),{type:\"ValueProjection\",children:[t,r]};case\"Filter\":return this.led(e.type,{type:\"Identity\"});case\"Lbrace\":return this._parseMultiselectHash();case\"Flatten\":return t={type:\"Flatten\",children:[{type:\"Identity\"}]},r=this._parseProjectionRHS(T.Flatten),{type:\"Projection\",children:[t,r]};case\"Lbracket\":return\"Number\"===this._lookahead(0)||\"Colon\"===this._lookahead(0)?(r=this._parseIndexExpression(),this._projectIfSlice({type:\"Identity\"},r)):\"Star\"===this._lookahead(0)&&\"Rbracket\"===this._lookahead(1)?(this._advance(),this._advance(),r=this._parseProjectionRHS(T.Star),{type:\"Projection\",children:[{type:\"Identity\"},r]}):this._parseMultiselectList();case\"Current\":return{type:\"Current\"};case\"Expref\":return n=this.expression(T.Expref),{type:\"ExpressionReference\",children:[n]};case\"Lparen\":for(var o=[];\"Rparen\"!==this._lookahead(0);)\"Current\"===this._lookahead(0)?(n={type:\"Current\"},this._advance()):n=this.expression(0),o.push(n);return this._match(\"Rparen\"),o[0];default:this._errorToken(e)}},led:function(e,t){var r;switch(e){case\"Dot\":var n=T.Dot;return\"Star\"!==this._lookahead(0)?(r=this._parseDotRHS(n),{type:\"Subexpression\",children:[t,r]}):(this._advance(),r=this._parseProjectionRHS(n),{type:\"ValueProjection\",children:[t,r]});case\"Pipe\":return r=this.expression(T.Pipe),{type:\"Pipe\",children:[t,r]};case\"Or\":return r=this.expression(T.Or),{type:\"OrExpression\",children:[t,r]};case\"And\":return r=this.expression(T.And),{type:\"AndExpression\",children:[t,r]};case\"Lparen\":for(var i,o=t.name,s=[];\"Rparen\"!==this._lookahead(0);)\"Current\"===this._lookahead(0)?(i={type:\"Current\"},this._advance()):i=this.expression(0),\"Comma\"===this._lookahead(0)&&this._match(\"Comma\"),s.push(i);return this._match(\"Rparen\"),{type:\"Function\",name:o,children:s};case\"Filter\":var a=this.expression(0);return this._match(\"Rbracket\"),r=\"Flatten\"===this._lookahead(0)?{type:\"Identity\"}:this._parseProjectionRHS(T.Filter),{type:\"FilterProjection\",children:[t,r,a]};case\"Flatten\":return{type:\"Projection\",children:[{type:\"Flatten\",children:[t]},this._parseProjectionRHS(T.Flatten)]};case\"EQ\":case\"NE\":case\"GT\":case\"GTE\":case\"LT\":case\"LTE\":return this._parseComparator(t,e);case\"Lbracket\":var u=this._lookaheadToken(0);return\"Number\"===u.type||\"Colon\"===u.type?(r=this._parseIndexExpression(),this._projectIfSlice(t,r)):(this._match(\"Star\"),this._match(\"Rbracket\"),r=this._parseProjectionRHS(T.Star),{type:\"Projection\",children:[t,r]});default:this._errorToken(this._lookaheadToken(0))}},_match:function(e){if(this._lookahead(0)!==e){var t=this._lookaheadToken(0),r=new Error(\"Expected \"+e+\", got: \"+t.type);throw r.name=\"ParserError\",r}this._advance()},_errorToken:function(e){var t=new Error(\"Invalid token (\"+e.type+'): \"'+e.value+'\"');throw t.name=\"ParserError\",t},_parseIndexExpression:function(){if(\"Colon\"===this._lookahead(0)||\"Colon\"===this._lookahead(1))return this._parseSliceExpression();var e={type:\"Index\",value:this._lookaheadToken(0).value};return this._advance(),this._match(\"Rbracket\"),e},_projectIfSlice:function(e,t){var r={type:\"IndexExpression\",children:[e,t]};return\"Slice\"===t.type?{type:\"Projection\",children:[r,this._parseProjectionRHS(T.Star)]}:r},_parseSliceExpression:function(){for(var e=[null,null,null],t=0,r=this._lookahead(0);\"Rbracket\"!==r&&t<3;){if(\"Colon\"===r)t++,this._advance();else{if(\"Number\"!==r){var n=this._lookahead(0),i=new Error(\"Syntax error, unexpected token: \"+n.value+\"(\"+n.type+\")\");throw i.name=\"Parsererror\",i}e[t]=this._lookaheadToken(0).value,this._advance()}r=this._lookahead(0)}return this._match(\"Rbracket\"),{type:\"Slice\",children:e}},_parseComparator:function(e,t){return{type:\"Comparator\",name:t,children:[e,this.expression(T[t])]}},_parseDotRHS:function(e){var t=this._lookahead(0);return[\"UnquotedIdentifier\",\"QuotedIdentifier\",\"Star\"].indexOf(t)>=0?this.expression(e):\"Lbracket\"===t?(this._match(\"Lbracket\"),this._parseMultiselectList()):\"Lbrace\"===t?(this._match(\"Lbrace\"),this._parseMultiselectHash()):void 0},_parseProjectionRHS:function(e){var t;if(T[this._lookahead(0)]<10)t={type:\"Identity\"};else if(\"Lbracket\"===this._lookahead(0))t=this.expression(e);else if(\"Filter\"===this._lookahead(0))t=this.expression(e);else{if(\"Dot\"!==this._lookahead(0)){var r=this._lookaheadToken(0),n=new Error(\"Sytanx error, unexpected token: \"+r.value+\"(\"+r.type+\")\");throw n.name=\"ParserError\",n}this._match(\"Dot\"),t=this._parseDotRHS(e)}return t},_parseMultiselectList:function(){for(var e=[];\"Rbracket\"!==this._lookahead(0);){var t=this.expression(0);if(e.push(t),\"Comma\"===this._lookahead(0)&&(this._match(\"Comma\"),\"Rbracket\"===this._lookahead(0)))throw new Error(\"Unexpected token Rbracket\")}return this._match(\"Rbracket\"),{type:\"MultiSelectList\",children:e}},_parseMultiselectHash:function(){for(var e,t,r,n,i=[],o=[\"UnquotedIdentifier\",\"QuotedIdentifier\"];;){if(e=this._lookaheadToken(0),o.indexOf(e.type)<0)throw new Error(\"Expecting an identifier token, got: \"+e.type);if(t=e.value,this._advance(),this._match(\"Colon\"),r=this.expression(0),n={type:\"KeyValuePair\",name:t,value:r},i.push(n),\"Comma\"===this._lookahead(0))this._match(\"Comma\");else if(\"Rbrace\"===this._lookahead(0)){this._match(\"Rbrace\");break}}return{type:\"MultiSelectHash\",children:i}}},p.prototype={search:function(e,t){return this.visit(e,t)},visit:function(e,s){var a,u,c,l,p,h,f,d,m;switch(e.type){case\"Field\":return null===s?null:r(s)?(h=s[e.name],void 0===h?null:h):null;case\"Subexpression\":for(c=this.visit(e.children[0],s),m=1;m<e.children.length;m++)if(null===(c=this.visit(e.children[1],c)))return null;return c;case\"IndexExpression\":return f=this.visit(e.children[0],s),this.visit(e.children[1],f);case\"Index\":if(!t(s))return null;var v=e.value;return v<0&&(v=s.length+v),c=s[v],void 0===c&&(c=null),c;case\"Slice\":if(!t(s))return null;var g=e.children.slice(0),y=this.computeSliceParams(s.length,g),b=y[0],w=y[1],E=y[2];if(c=[],E>0)for(m=b;m<w;m+=E)c.push(s[m]);else for(m=b;m>w;m+=E)c.push(s[m]);return c;case\"Projection\":var S=this.visit(e.children[0],s);if(!t(S))return null;for(d=[],m=0;m<S.length;m++)null!==(u=this.visit(e.children[1],S[m]))&&d.push(u);return d;case\"ValueProjection\":if(S=this.visit(e.children[0],s),!r(S))return null;d=[];var _=o(S);for(m=0;m<_.length;m++)null!==(u=this.visit(e.children[1],_[m]))&&d.push(u);return d;case\"FilterProjection\":if(S=this.visit(e.children[0],s),!t(S))return null;var C=[],A=[];for(m=0;m<S.length;m++)a=this.visit(e.children[2],S[m]),i(a)||C.push(S[m]);for(var R=0;R<C.length;R++)null!==(u=this.visit(e.children[1],C[R]))&&A.push(u);return A;case\"Comparator\":switch(l=this.visit(e.children[0],s),p=this.visit(e.children[1],s),e.name){case\"EQ\":c=n(l,p);break;case\"NE\":c=!n(l,p);break;case\"GT\":c=l>p;break;case\"GTE\":c=l>=p;break;case\"LT\":c=l<p;break;case\"LTE\":c=l<=p;break;default:throw new Error(\"Unknown comparator: \"+e.name)}return c;case\"Flatten\":var x=this.visit(e.children[0],s);if(!t(x))return null;var T=[];for(m=0;m<x.length;m++)u=x[m],t(u)?T.push.apply(T,u):T.push(u);return T;case\"Identity\":return s;case\"MultiSelectList\":if(null===s)return null;for(d=[],m=0;m<e.children.length;m++)d.push(this.visit(e.children[m],s));return d;case\"MultiSelectHash\":if(null===s)return null;d={};var I;for(m=0;m<e.children.length;m++)I=e.children[m],d[I.name]=this.visit(I.value,s);return d;case\"OrExpression\":return a=this.visit(e.children[0],s),i(a)&&(a=this.visit(e.children[1],s)),a;case\"AndExpression\":return l=this.visit(e.children[0],s),!0===i(l)?l:this.visit(e.children[1],s);case\"NotExpression\":return l=this.visit(e.children[0],s),i(l);case\"Literal\":return e.value;case\"Pipe\":return f=this.visit(e.children[0],s),this.visit(e.children[1],f);case\"Current\":return s;case\"Function\":var k=[];for(m=0;m<e.children.length;m++)k.push(this.visit(e.children[m],s));return this.runtime.callFunction(e.name,k);case\"ExpressionReference\":var P=e.children[0];return P.jmespathType=\"Expref\",P;default:throw new Error(\"Unknown node type: \"+e.type)}},computeSliceParams:function(e,t){var r=t[0],n=t[1],i=t[2],o=[null,null,null];if(null===i)i=1;else if(0===i){var s=new Error(\"Invalid slice, step cannot be 0\");throw s.name=\"RuntimeError\",s}var a=i<0;return r=null===r?a?e-1:0:this.capSliceRange(e,r,i),n=null===n?a?-1:e:this.capSliceRange(e,n,i),o[0]=r,o[1]=n,o[2]=i,o},capSliceRange:function(e,t,r){return t<0?(t+=e)<0&&(t=r<0?-1:0):t>=e&&(t=r<0?e-1:e),t}},h.prototype={callFunction:function(e,t){var r=this.functionTable[e];if(void 0===r)throw new Error(\"Unknown function: \"+e+\"()\");return this._validateArgs(e,t,r._signature),r._func.call(this,t)},_validateArgs:function(e,t,r){var n;if(r[r.length-1].variadic){if(t.length<r.length)throw n=1===r.length?\" argument\":\" arguments\",new Error(\"ArgumentError: \"+e+\"() takes at least\"+r.length+n+\" but received \"+t.length)}else if(t.length!==r.length)throw n=1===r.length?\" argument\":\" arguments\",new Error(\"ArgumentError: \"+e+\"() takes \"+r.length+n+\" but received \"+t.length);for(var i,o,s,a=0;a<r.length;a++){s=!1,i=r[a].types,o=this._getTypeName(t[a]);for(var u=0;u<i.length;u++)if(this._typeMatches(o,i[u],t[a])){s=!0;break}if(!s)throw new Error(\"TypeError: \"+e+\"() expected argument \"+(a+1)+\" to be type \"+i+\" but received type \"+o+\" instead.\")}},_typeMatches:function(e,t,r){if(t===y)return!0;if(t!==C&&t!==_&&t!==w)return e===t;if(t===w)return e===w;if(e===w){var n;t===_?n=g:t===C&&(n=b);for(var i=0;i<r.length;i++)if(!this._typeMatches(this._getTypeName(r[i]),n,r[i]))return!1;return!0}},_getTypeName:function(e){switch(Object.prototype.toString.call(e)){case\"[object String]\":return b;case\"[object Number]\":return g;case\"[object Array]\":return w;case\"[object Boolean]\":return 5;case\"[object Null]\":return 7;case\"[object Object]\":return\"Expref\"===e.jmespathType?S:E}},_functionStartsWith:function(e){return 0===e[0].lastIndexOf(e[1])},_functionEndsWith:function(e){var t=e[0],r=e[1];return-1!==t.indexOf(r,t.length-r.length)},_functionReverse:function(e){if(this._getTypeName(e[0])===b){for(var t=e[0],r=\"\",n=t.length-1;n>=0;n--)r+=t[n];return r}var i=e[0].slice(0);return i.reverse(),i},_functionAbs:function(e){return Math.abs(e[0])},_functionCeil:function(e){return Math.ceil(e[0])},_functionAvg:function(e){for(var t=0,r=e[0],n=0;n<r.length;n++)t+=r[n];return t/r.length},_functionContains:function(e){return e[0].indexOf(e[1])>=0},_functionFloor:function(e){return Math.floor(e[0])},_functionLength:function(e){return r(e[0])?Object.keys(e[0]).length:e[0].length},_functionMap:function(e){for(var t=[],r=this._interpreter,n=e[0],i=e[1],o=0;o<i.length;o++)t.push(r.visit(n,i[o]));return t},_functionMerge:function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];for(var i in n)t[i]=n[i]}return t},_functionMax:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===g)return Math.max.apply(Math,e[0]);for(var t=e[0],r=t[0],n=1;n<t.length;n++)r.localeCompare(t[n])<0&&(r=t[n]);return r}return null},_functionMin:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===g)return Math.min.apply(Math,e[0]);for(var t=e[0],r=t[0],n=1;n<t.length;n++)t[n].localeCompare(r)<0&&(r=t[n]);return r}return null},_functionSum:function(e){for(var t=0,r=e[0],n=0;n<r.length;n++)t+=r[n];return t},_functionType:function(e){switch(this._getTypeName(e[0])){case g:return\"number\";case b:return\"string\";case w:return\"array\";case E:return\"object\";case 5:return\"boolean\";case S:return\"expref\";case 7:return\"null\"}},_functionKeys:function(e){return Object.keys(e[0])},_functionValues:function(e){for(var t=e[0],r=Object.keys(t),n=[],i=0;i<r.length;i++)n.push(t[r[i]]);return n},_functionJoin:function(e){var t=e[0];return e[1].join(t)},_functionToArray:function(e){return this._getTypeName(e[0])===w?e[0]:[e[0]]},_functionToString:function(e){return this._getTypeName(e[0])===b?e[0]:JSON.stringify(e[0])},_functionToNumber:function(e){var t,r=this._getTypeName(e[0]);return r===g?e[0]:r!==b||(t=+e[0],isNaN(t))?null:t},_functionNotNull:function(e){for(var t=0;t<e.length;t++)if(7!==this._getTypeName(e[t]))return e[t];return null},_functionSort:function(e){var t=e[0].slice(0);return t.sort(),t},_functionSortBy:function(e){var t=e[0].slice(0);if(0===t.length)return t;var r=this._interpreter,n=e[1],i=this._getTypeName(r.visit(n,t[0]));if([g,b].indexOf(i)<0)throw new Error(\"TypeError\");for(var o=this,s=[],a=0;a<t.length;a++)s.push([a,t[a]]);s.sort(function(e,t){var s=r.visit(n,e[1]),a=r.visit(n,t[1]);if(o._getTypeName(s)!==i)throw new Error(\"TypeError: expected \"+i+\", received \"+o._getTypeName(s));if(o._getTypeName(a)!==i)throw new Error(\"TypeError: expected \"+i+\", received \"+o._getTypeName(a));return s>a?1:s<a?-1:e[0]-t[0]});for(var u=0;u<s.length;u++)t[u]=s[u][1];return t},_functionMaxBy:function(e){for(var t,r,n=e[1],i=e[0],o=this.createKeyFunction(n,[g,b]),s=-1/0,a=0;a<i.length;a++)(r=o(i[a]))>s&&(s=r,t=i[a]);return t},_functionMinBy:function(e){for(var t,r,n=e[1],i=e[0],o=this.createKeyFunction(n,[g,b]),s=1/0,a=0;a<i.length;a++)(r=o(i[a]))<s&&(s=r,t=i[a]);return t},createKeyFunction:function(e,t){var r=this,n=this._interpreter;return function(i){var o=n.visit(e,i);if(t.indexOf(r._getTypeName(o))<0){var s=\"TypeError: expected one of \"+t+\", received \"+r._getTypeName(o);throw new Error(s)}return o}}},e.tokenize=d,e.compile=f,e.search=m,e.strictDeepEqual=n}(void 0===r?this.jmespath={}:r)},{}],87:[function(e,t,r){function n(){throw new Error(\"setTimeout has not been defined\")}function i(){throw new Error(\"clearTimeout has not been defined\")}function o(e){if(p===setTimeout)return setTimeout(e,0);if((p===n||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function s(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){v&&d&&(v=!1,d.length?m=d.concat(m):g=-1,m.length&&u())}function u(){if(!v){var e=o(a);v=!0;for(var t=m.length;t;){for(d=m,m=[];++g<t;)d&&d[g].run();g=-1,t=m.length}d=null,v=!1,s(e)}}function c(e,t){this.fun=e,this.array=t}function l(){}var p,h,f=t.exports={};!function(){try{p=\"function\"==typeof setTimeout?setTimeout:n}catch(e){p=n}try{h=\"function\"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var d,m=[],v=!1,g=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];m.push(new c(e,t)),1!==m.length||v||o(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title=\"browser\",f.browser=!0,f.env={},f.argv=[],f.version=\"\",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(e){return[]},f.binding=function(e){throw new Error(\"process.binding is not supported\")},f.cwd=function(){return\"/\"},f.chdir=function(e){throw new Error(\"process.chdir is not supported\")},f.umask=function(){return 0}},{}],88:[function(e,t,r){(function(e){(function(){!function(n){function i(e){throw RangeError(L[e])}function o(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function s(e,t){var r=e.split(\"@\"),n=\"\";return r.length>1&&(n=r[0]+\"@\",e=r[1]),e=e.replace(q,\".\"),n+o(e.split(\".\"),t).join(\".\")}function a(e){for(var t,r,n=[],i=0,o=e.length;i<o;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<o?(r=e.charCodeAt(i++),56320==(64512&r)?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--)):n.push(t);return n}function u(e){return o(e,function(e){var t=\"\";return e>65535&&(e-=65536,t+=U(e>>>10&1023|55296),e=56320|1023&e),t+=U(e)}).join(\"\")}function c(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:S}function l(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function p(e,t,r){var n=0;for(e=r?N(e/R):e>>1,e+=N(e/t);e>O*C>>1;n+=S)e=N(e/O);return N(n+(O+1)*e/(e+A))}function h(e){var t,r,n,o,s,a,l,h,f,d,m=[],v=e.length,g=0,y=T,b=x;for(r=e.lastIndexOf(I),r<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&i(\"not-basic\"),m.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<v;){for(s=g,a=1,l=S;o>=v&&i(\"invalid-input\"),h=c(e.charCodeAt(o++)),(h>=S||h>N((E-g)/a))&&i(\"overflow\"),g+=h*a,f=l<=b?_:l>=b+C?C:l-b,!(h<f);l+=S)d=S-f,a>N(E/d)&&i(\"overflow\"),a*=d;t=m.length+1,b=p(g-s,t,0==s),N(g/t)>E-y&&i(\"overflow\"),y+=N(g/t),g%=t,m.splice(g++,0,y)}return u(m)}function f(e){var t,r,n,o,s,u,c,h,f,d,m,v,g,y,b,w=[];for(e=a(e),v=e.length,t=T,r=0,s=x,u=0;u<v;++u)(m=e[u])<128&&w.push(U(m));for(n=o=w.length,o&&w.push(I);n<v;){for(c=E,u=0;u<v;++u)(m=e[u])>=t&&m<c&&(c=m);for(g=n+1,c-t>N((E-r)/g)&&i(\"overflow\"),r+=(c-t)*g,t=c,u=0;u<v;++u)if(m=e[u],m<t&&++r>E&&i(\"overflow\"),m==t){for(h=r,f=S;d=f<=s?_:f>=s+C?C:f-s,!(h<d);f+=S)b=h-d,y=S-d,w.push(U(l(d+b%y,0))),h=N(b/y);w.push(U(l(h,0))),s=p(r,g,n==o),r=0,++n}++r,++t}return w.join(\"\")}function d(e){return s(e,function(e){return k.test(e)?h(e.slice(4).toLowerCase()):e})}function m(e){return s(e,function(e){return P.test(e)?\"xn--\"+f(e):e})}var v=\"object\"==typeof r&&r&&!r.nodeType&&r,g=\"object\"==typeof t&&t&&!t.nodeType&&t,y=\"object\"==typeof e&&e;y.global!==y&&y.window!==y&&y.self!==y||(n=y);var b,w,E=2147483647,S=36,_=1,C=26,A=38,R=700,x=72,T=128,I=\"-\",k=/^xn--/,P=/[^\\x20-\\x7E]/,q=/[\\x2E\\u3002\\uFF0E\\uFF61]/g,L={overflow:\"Overflow: input needs wider integers to process\",\"not-basic\":\"Illegal input >= 0x80 (not a basic code point)\",\"invalid-input\":\"Invalid input\"},O=S-_,N=Math.floor,U=String.fromCharCode;if(b={version:\"1.3.2\",ucs2:{decode:a,encode:u},decode:h,encode:f,toASCII:m,toUnicode:d},\"function\"==typeof define&&\"object\"==typeof define.amd&&define.amd)define(\"punycode\",function(){return b});else if(v&&g)if(t.exports==v)g.exports=b;else for(w in b)b.hasOwnProperty(w)&&(v[w]=b[w]);else n.punycode=b}(this)}).call(this)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],89:[function(e,t,r){\"use strict\";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,o){t=t||\"&\",r=r||\"=\";var s={};if(\"string\"!=typeof e||0===e.length)return s;var a=/\\+/g;e=e.split(t);var u=1e3;o&&\"number\"==typeof o.maxKeys&&(u=o.maxKeys);var c=e.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var p,h,f,d,m=e[l].replace(a,\"%20\"),v=m.indexOf(r);v>=0?(p=m.substr(0,v),h=m.substr(v+1)):(p=m,h=\"\"),f=decodeURIComponent(p),d=decodeURIComponent(h),n(s,f)?i(s[f])?s[f].push(d):s[f]=[s[f],d]:s[f]=d}return s};var i=Array.isArray||function(e){return\"[object Array]\"===Object.prototype.toString.call(e)}},{}],90:[function(e,t,r){\"use strict\";function n(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var i=function(e){switch(typeof e){case\"string\":return e;case\"boolean\":return e?\"true\":\"false\";case\"number\":return isFinite(e)?e:\"\";default:return\"\"}};t.exports=function(e,t,r,a){return t=t||\"&\",r=r||\"=\",null===e&&(e=void 0),\"object\"==typeof e?n(s(e),function(s){var a=encodeURIComponent(i(s))+r;return o(e[s])?n(e[s],function(e){return a+encodeURIComponent(i(e))}).join(t):a+encodeURIComponent(i(e[s]))}).join(t):a?encodeURIComponent(i(a))+r+encodeURIComponent(i(e)):\"\"};var o=Array.isArray||function(e){return\"[object Array]\"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],91:[function(e,t,r){\"use strict\";r.decode=r.parse=e(\"./decode\"),r.encode=r.stringify=e(\"./encode\")},{\"./decode\":89,\"./encode\":90}],92:[function(e,t,r){\"use strict\";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,i){t=t||\"&\",r=r||\"=\";var o={};if(\"string\"!=typeof e||0===e.length)return o;var s=/\\+/g;e=e.split(t);var a=1e3;i&&\"number\"==typeof i.maxKeys&&(a=i.maxKeys);var u=e.length;a>0&&u>a&&(u=a);for(var c=0;c<u;++c){var l,p,h,f,d=e[c].replace(s,\"%20\"),m=d.indexOf(r);m>=0?(l=d.substr(0,m),p=d.substr(m+1)):(l=d,p=\"\"),h=decodeURIComponent(l),f=decodeURIComponent(p),n(o,h)?Array.isArray(o[h])?o[h].push(f):o[h]=[o[h],f]:o[h]=f}return o}},{}],93:[function(e,t,r){\"use strict\";var n=function(e){switch(typeof e){case\"string\":return e;case\"boolean\":return e?\"true\":\"false\";case\"number\":return isFinite(e)?e:\"\";default:return\"\"}};t.exports=function(e,t,r,i){return t=t||\"&\",r=r||\"=\",null===e&&(e=void 0),\"object\"==typeof e?Object.keys(e).map(function(i){var o=encodeURIComponent(n(i))+r;return Array.isArray(e[i])?e[i].map(function(e){return o+encodeURIComponent(n(e))}).join(t):o+encodeURIComponent(n(e[i]))}).join(t):i?encodeURIComponent(n(i))+r+encodeURIComponent(n(e)):\"\"}\n},{}],94:[function(e,t,r){arguments[4][91][0].apply(r,arguments)},{\"./decode\":92,\"./encode\":93,dup:91}],95:[function(e,t,r){(function(t,n){(function(){function i(e,t){this._id=e,this._clearFn=t}var o=e(\"process/browser.js\").nextTick,s=Function.prototype.apply,a=Array.prototype.slice,u={},c=0;r.setTimeout=function(){return new i(s.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new i(s.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r.setImmediate=\"function\"==typeof t?t:function(e){var t=c++,n=!(arguments.length<2)&&a.call(arguments,1);return u[t]=!0,o(function(){u[t]&&(n?e.apply(null,n):e.call(null),r.clearImmediate(t))}),t},r.clearImmediate=\"function\"==typeof n?n:function(e){delete u[e]}}).call(this)}).call(this,e(\"timers\").setImmediate,e(\"timers\").clearImmediate)},{\"process/browser.js\":87,timers:95}],96:[function(e,t,r){function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,r){if(e&&c(e)&&e instanceof n)return e;var i=new n;return i.parse(e,t,r),i}function o(e){return u(e)&&(e=i(e)),e instanceof n?e.format():n.prototype.format.call(e)}function s(e,t){return i(e,!1,!0).resolve(t)}function a(e,t){return e?i(e,!1,!0).resolveObject(t):t}function u(e){return\"string\"==typeof e}function c(e){return\"object\"==typeof e&&null!==e}function l(e){return null===e}function p(e){return null==e}var h=e(\"punycode\");r.parse=i,r.resolve=s,r.resolveObject=a,r.format=o,r.Url=n;var f=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,m=[\"<\",\">\",'\"',\"`\",\" \",\"\\r\",\"\\n\",\"\\t\"],v=[\"{\",\"}\",\"|\",\"\\\\\",\"^\",\"`\"].concat(m),g=[\"'\"].concat(v),y=[\"%\",\"/\",\"?\",\";\",\"#\"].concat(g),b=[\"/\",\"?\",\"#\"],w=/^[a-z0-9A-Z_-]{0,63}$/,E=/^([a-z0-9A-Z_-]{0,63})(.*)$/,S={javascript:!0,\"javascript:\":!0},_={javascript:!0,\"javascript:\":!0},C={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,\"http:\":!0,\"https:\":!0,\"ftp:\":!0,\"gopher:\":!0,\"file:\":!0},A=e(\"querystring\");n.prototype.parse=function(e,t,r){if(!u(e))throw new TypeError(\"Parameter 'url' must be a string, not \"+typeof e);var n=e;n=n.trim();var i=f.exec(n);if(i){i=i[0];var o=i.toLowerCase();this.protocol=o,n=n.substr(i.length)}if(r||i||n.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)){var s=\"//\"===n.substr(0,2);!s||i&&_[i]||(n=n.substr(2),this.slashes=!0)}if(!_[i]&&(s||i&&!C[i])){for(var a=-1,c=0;c<b.length;c++){var l=n.indexOf(b[c]);-1!==l&&(-1===a||l<a)&&(a=l)}var p,d;d=-1===a?n.lastIndexOf(\"@\"):n.lastIndexOf(\"@\",a),-1!==d&&(p=n.slice(0,d),n=n.slice(d+1),this.auth=decodeURIComponent(p)),a=-1;for(var c=0;c<y.length;c++){var l=n.indexOf(y[c]);-1!==l&&(-1===a||l<a)&&(a=l)}-1===a&&(a=n.length),this.host=n.slice(0,a),n=n.slice(a),this.parseHost(),this.hostname=this.hostname||\"\";var m=\"[\"===this.hostname[0]&&\"]\"===this.hostname[this.hostname.length-1];if(!m)for(var v=this.hostname.split(/\\./),c=0,R=v.length;c<R;c++){var x=v[c];if(x&&!x.match(w)){for(var T=\"\",I=0,k=x.length;I<k;I++)x.charCodeAt(I)>127?T+=\"x\":T+=x[I];if(!T.match(w)){var P=v.slice(0,c),q=v.slice(c+1),L=x.match(E);L&&(P.push(L[1]),q.unshift(L[2])),q.length&&(n=\"/\"+q.join(\".\")+n),this.hostname=P.join(\".\");break}}}if(this.hostname.length>255?this.hostname=\"\":this.hostname=this.hostname.toLowerCase(),!m){for(var O=this.hostname.split(\".\"),N=[],c=0;c<O.length;++c){var U=O[c];N.push(U.match(/[^A-Za-z0-9_-]/)?\"xn--\"+h.encode(U):U)}this.hostname=N.join(\".\")}var D=this.port?\":\"+this.port:\"\",M=this.hostname||\"\";this.host=M+D,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),\"/\"!==n[0]&&(n=\"/\"+n))}if(!S[o])for(var c=0,R=g.length;c<R;c++){var j=g[c],B=encodeURIComponent(j);B===j&&(B=escape(j)),n=n.split(j).join(B)}var F=n.indexOf(\"#\");-1!==F&&(this.hash=n.substr(F),n=n.slice(0,F));var z=n.indexOf(\"?\");if(-1!==z?(this.search=n.substr(z),this.query=n.substr(z+1),t&&(this.query=A.parse(this.query)),n=n.slice(0,z)):t&&(this.search=\"\",this.query={}),n&&(this.pathname=n),C[o]&&this.hostname&&!this.pathname&&(this.pathname=\"/\"),this.pathname||this.search){var D=this.pathname||\"\",U=this.search||\"\";this.path=D+U}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||\"\";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,\":\"),e+=\"@\");var t=this.protocol||\"\",r=this.pathname||\"\",n=this.hash||\"\",i=!1,o=\"\";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(\":\")?this.hostname:\"[\"+this.hostname+\"]\"),this.port&&(i+=\":\"+this.port)),this.query&&c(this.query)&&Object.keys(this.query).length&&(o=A.stringify(this.query));var s=this.search||o&&\"?\"+o||\"\";return t&&\":\"!==t.substr(-1)&&(t+=\":\"),this.slashes||(!t||C[t])&&!1!==i?(i=\"//\"+(i||\"\"),r&&\"/\"!==r.charAt(0)&&(r=\"/\"+r)):i||(i=\"\"),n&&\"#\"!==n.charAt(0)&&(n=\"#\"+n),s&&\"?\"!==s.charAt(0)&&(s=\"?\"+s),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace(\"#\",\"%23\"),t+i+r+s+n},n.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if(u(e)){var t=new n;t.parse(e,!1,!0),e=t}var r=new n;if(Object.keys(this).forEach(function(e){r[e]=this[e]},this),r.hash=e.hash,\"\"===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){\"protocol\"!==t&&(r[t]=e[t])}),C[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname=\"/\"),r.href=r.format(),r;if(e.protocol&&e.protocol!==r.protocol){if(!C[e.protocol])return Object.keys(e).forEach(function(t){r[t]=e[t]}),r.href=r.format(),r;if(r.protocol=e.protocol,e.host||_[e.protocol])r.pathname=e.pathname;else{for(var i=(e.pathname||\"\").split(\"/\");i.length&&!(e.host=i.shift()););e.host||(e.host=\"\"),e.hostname||(e.hostname=\"\"),\"\"!==i[0]&&i.unshift(\"\"),i.length<2&&i.unshift(\"\"),r.pathname=i.join(\"/\")}if(r.search=e.search,r.query=e.query,r.host=e.host||\"\",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var o=r.pathname||\"\",s=r.search||\"\";r.path=o+s}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var a=r.pathname&&\"/\"===r.pathname.charAt(0),c=e.host||e.pathname&&\"/\"===e.pathname.charAt(0),h=c||a||r.host&&e.pathname,f=h,d=r.pathname&&r.pathname.split(\"/\")||[],i=e.pathname&&e.pathname.split(\"/\")||[],m=r.protocol&&!C[r.protocol];if(m&&(r.hostname=\"\",r.port=null,r.host&&(\"\"===d[0]?d[0]=r.host:d.unshift(r.host)),r.host=\"\",e.protocol&&(e.hostname=null,e.port=null,e.host&&(\"\"===i[0]?i[0]=e.host:i.unshift(e.host)),e.host=null),h=h&&(\"\"===i[0]||\"\"===d[0])),c)r.host=e.host||\"\"===e.host?e.host:r.host,r.hostname=e.hostname||\"\"===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,d=i;else if(i.length)d||(d=[]),d.pop(),d=d.concat(i),r.search=e.search,r.query=e.query;else if(!p(e.search)){if(m){r.hostname=r.host=d.shift();var v=!!(r.host&&r.host.indexOf(\"@\")>0)&&r.host.split(\"@\");v&&(r.auth=v.shift(),r.host=r.hostname=v.shift())}return r.search=e.search,r.query=e.query,l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:\"\")+(r.search?r.search:\"\")),r.href=r.format(),r}if(!d.length)return r.pathname=null,r.search?r.path=\"/\"+r.search:r.path=null,r.href=r.format(),r;for(var g=d.slice(-1)[0],y=(r.host||e.host)&&(\".\"===g||\"..\"===g)||\"\"===g,b=0,w=d.length;w>=0;w--)g=d[w],\".\"==g?d.splice(w,1):\"..\"===g?(d.splice(w,1),b++):b&&(d.splice(w,1),b--);if(!h&&!f)for(;b--;b)d.unshift(\"..\");!h||\"\"===d[0]||d[0]&&\"/\"===d[0].charAt(0)||d.unshift(\"\"),y&&\"/\"!==d.join(\"/\").substr(-1)&&d.push(\"\");var E=\"\"===d[0]||d[0]&&\"/\"===d[0].charAt(0);if(m){r.hostname=r.host=E?\"\":d.length?d.shift():\"\";var v=!!(r.host&&r.host.indexOf(\"@\")>0)&&r.host.split(\"@\");v&&(r.auth=v.shift(),r.host=r.hostname=v.shift())}return h=h||r.host&&d.length,h&&!E&&d.unshift(\"\"),d.length?r.pathname=d.join(\"/\"):(r.pathname=null,r.path=null),l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:\"\")+(r.search?r.search:\"\")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var e=this.host,t=d.exec(e);t&&(t=t[0],\":\"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:88,querystring:91}],97:[function(e,t,r){\"function\"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],98:[function(e,t,r){t.exports=function(e){return e&&\"object\"==typeof e&&\"function\"==typeof e.copy&&\"function\"==typeof e.fill&&\"function\"==typeof e.readUInt8}},{}],99:[function(e,t,r){(function(t,n){(function(){function i(e,t){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(t)?n.showHidden=t:t&&r._extend(n,t),E(n.showHidden)&&(n.showHidden=!1),E(n.depth)&&(n.depth=2),E(n.colors)&&(n.colors=!1),E(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),u(n,e,n.depth)}function o(e,t){var r=i.styles[t];return r?\"\u001B[\"+i.colors[r][0]+\"m\"+e+\"\u001B[\"+i.colors[r][1]+\"m\":e}function s(e,t){return e}function a(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function u(e,t,n){if(e.customInspect&&t&&R(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return b(i)||(i=u(e,i,n)),i}var o=c(e,t);if(o)return o;var s=Object.keys(t),m=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),A(t)&&(s.indexOf(\"message\")>=0||s.indexOf(\"description\")>=0))return l(t);if(0===s.length){if(R(t)){var v=t.name?\": \"+t.name:\"\";return e.stylize(\"[Function\"+v+\"]\",\"special\")}if(S(t))return e.stylize(RegExp.prototype.toString.call(t),\"regexp\");if(C(t))return e.stylize(Date.prototype.toString.call(t),\"date\");if(A(t))return l(t)}var g=\"\",y=!1,w=[\"{\",\"}\"];if(d(t)&&(y=!0,w=[\"[\",\"]\"]),R(t)){g=\" [Function\"+(t.name?\": \"+t.name:\"\")+\"]\"}if(S(t)&&(g=\" \"+RegExp.prototype.toString.call(t)),C(t)&&(g=\" \"+Date.prototype.toUTCString.call(t)),A(t)&&(g=\" \"+l(t)),0===s.length&&(!y||0==t.length))return w[0]+g+w[1];if(n<0)return S(t)?e.stylize(RegExp.prototype.toString.call(t),\"regexp\"):e.stylize(\"[Object]\",\"special\");e.seen.push(t);var E;return E=y?p(e,t,n,m,s):s.map(function(r){return h(e,t,n,m,r,y)}),e.seen.pop(),f(E,g,w)}function c(e,t){if(E(t))return e.stylize(\"undefined\",\"undefined\");if(b(t)){var r=\"'\"+JSON.stringify(t).replace(/^\"|\"$/g,\"\").replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"')+\"'\";return e.stylize(r,\"string\")}return y(t)?e.stylize(\"\"+t,\"number\"):m(t)?e.stylize(\"\"+t,\"boolean\"):v(t)?e.stylize(\"null\",\"null\"):void 0}function l(e){return\"[\"+Error.prototype.toString.call(e)+\"]\"}function p(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)P(t,String(s))?o.push(h(e,t,r,n,String(s),!0)):o.push(\"\");return i.forEach(function(i){i.match(/^\\d+$/)||o.push(h(e,t,r,n,i,!0))}),o}function h(e,t,r,n,i,o){var s,a,c;if(c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},c.get?a=c.set?e.stylize(\"[Getter/Setter]\",\"special\"):e.stylize(\"[Getter]\",\"special\"):c.set&&(a=e.stylize(\"[Setter]\",\"special\")),P(n,i)||(s=\"[\"+i+\"]\"),a||(e.seen.indexOf(c.value)<0?(a=v(r)?u(e,c.value,null):u(e,c.value,r-1),a.indexOf(\"\\n\")>-1&&(a=o?a.split(\"\\n\").map(function(e){return\"  \"+e}).join(\"\\n\").substr(2):\"\\n\"+a.split(\"\\n\").map(function(e){return\"   \"+e}).join(\"\\n\"))):a=e.stylize(\"[Circular]\",\"special\")),E(s)){if(o&&i.match(/^\\d+$/))return a;s=JSON.stringify(\"\"+i),s.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,\"name\")):(s=s.replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"').replace(/(^\"|\"$)/g,\"'\"),s=e.stylize(s,\"string\"))}return s+\": \"+a}function f(e,t,r){var n=0;return e.reduce(function(e,t){return n++,t.indexOf(\"\\n\")>=0&&n++,e+t.replace(/\\u001b\\[\\d\\d?m/g,\"\").length+1},0)>60?r[0]+(\"\"===t?\"\":t+\"\\n \")+\" \"+e.join(\",\\n  \")+\" \"+r[1]:r[0]+t+\" \"+e.join(\", \")+\" \"+r[1]}function d(e){return Array.isArray(e)}function m(e){return\"boolean\"==typeof e}function v(e){return null===e}function g(e){return null==e}function y(e){return\"number\"==typeof e}function b(e){return\"string\"==typeof e}function w(e){return\"symbol\"==typeof e}function E(e){return void 0===e}function S(e){return _(e)&&\"[object RegExp]\"===T(e)}function _(e){return\"object\"==typeof e&&null!==e}function C(e){return _(e)&&\"[object Date]\"===T(e)}function A(e){return _(e)&&(\"[object Error]\"===T(e)||e instanceof Error)}function R(e){return\"function\"==typeof e}function x(e){return null===e||\"boolean\"==typeof e||\"number\"==typeof e||\"string\"==typeof e||\"symbol\"==typeof e||void 0===e}function T(e){return Object.prototype.toString.call(e)}function I(e){return e<10?\"0\"+e.toString(10):e.toString(10)}function k(){var e=new Date,t=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(\":\");return[e.getDate(),N[e.getMonth()],t].join(\" \")}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var q=/%[sdj%]/g;r.format=function(e){if(!b(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(i(arguments[r]));return t.join(\" \")}for(var r=1,n=arguments,o=n.length,s=String(e).replace(q,function(e){if(\"%%\"===e)return\"%\";if(r>=o)return e;switch(e){case\"%s\":return String(n[r++]);case\"%d\":return Number(n[r++]);case\"%j\":try{return JSON.stringify(n[r++])}catch(e){return\"[Circular]\"}default:return e}}),a=n[r];r<o;a=n[++r])v(a)||!_(a)?s+=\" \"+a:s+=\" \"+i(a);return s},r.deprecate=function(e,i){function o(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}if(E(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var s=!1;return o};var L,O={};r.debuglog=function(e){if(E(L)&&(L=t.env.NODE_DEBUG||\"\"),e=e.toUpperCase(),!O[e])if(new RegExp(\"\\\\b\"+e+\"\\\\b\",\"i\").test(L)){var n=t.pid;O[e]=function(){var t=r.format.apply(r,arguments);console.error(\"%s %d: %s\",e,n,t)}}else O[e]=function(){};return O[e]},r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:\"cyan\",number:\"yellow\",boolean:\"yellow\",undefined:\"grey\",null:\"bold\",string:\"green\",date:\"magenta\",regexp:\"red\"},r.isArray=d,r.isBoolean=m,r.isNull=v,r.isNullOrUndefined=g,r.isNumber=y,r.isString=b,r.isSymbol=w,r.isUndefined=E,r.isRegExp=S,r.isObject=_,r.isDate=C,r.isError=A,r.isFunction=R,r.isPrimitive=x,r.isBuffer=e(\"./support/isBuffer\");var N=[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];r.log=function(){console.log(\"%s - %s\",k(),r.format.apply(r,arguments))},r.inherits=e(\"inherits\"),r._extend=function(e,t){if(!t||!_(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this)}).call(this,e(\"_process\"),\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./support/isBuffer\":98,_process:87,inherits:97}],100:[function(e,t,r){var n=e(\"./v1\"),i=e(\"./v4\"),o=i;o.v1=n,o.v4=i,t.exports=o},{\"./v1\":103,\"./v4\":104}],101:[function(e,t,r){function n(e,t){var r=t||0,n=i;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],\"-\",n[e[r++]],n[e[r++]],\"-\",n[e[r++]],n[e[r++]],\"-\",n[e[r++]],n[e[r++]],\"-\",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join(\"\")}for(var i=[],o=0;o<256;++o)i[o]=(o+256).toString(16).substr(1);t.exports=n},{}],102:[function(e,t,r){var n=\"undefined\"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||\"undefined\"!=typeof msCrypto&&\"function\"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var o=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},{}],103:[function(e,t,r){function n(e,t,r){var n=t&&r||0,l=t||[];e=e||{};var p=e.node||i,h=void 0!==e.clockseq?e.clockseq:o;if(null==p||null==h){var f=s();null==p&&(p=i=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=o=16383&(f[6]<<8|f[7]))}var d=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,v=d-u+(m-c)/1e4;if(v<0&&void 0===e.clockseq&&(h=h+1&16383),(v<0||d>u)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");u=d,c=m,o=h,d+=122192928e5;var g=(1e4*(268435455&d)+m)%4294967296;l[n++]=g>>>24&255,l[n++]=g>>>16&255,l[n++]=g>>>8&255,l[n++]=255&g;var y=d/4294967296*1e4&268435455;l[n++]=y>>>8&255,l[n++]=255&y,l[n++]=y>>>24&15|16,l[n++]=y>>>16&255,l[n++]=h>>>8|128,l[n++]=255&h;for(var b=0;b<6;++b)l[n+b]=p[b];return t||a(l)}var i,o,s=e(\"./lib/rng\"),a=e(\"./lib/bytesToUuid\"),u=0,c=0;t.exports=n},{\"./lib/bytesToUuid\":101,\"./lib/rng\":102}],104:[function(e,t,r){function n(e,t,r){var n=t&&r||0;\"string\"==typeof e&&(t=\"binary\"===e?new Array(16):null,e=null),e=e||{};var s=e.random||(e.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[n+a]=s[a];return t||o(s)}var i=e(\"./lib/rng\"),o=e(\"./lib/bytesToUuid\");t.exports=n},{\"./lib/bytesToUuid\":101,\"./lib/rng\":102}],105:[function(e,t,r){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0});var n=e(\"./utils/LRU\"),i=1e3,o=function(){function e(e){void 0===e&&(e=i),this.maxSize=e,this.cache=new n.LRUCache(e)}return Object.defineProperty(e.prototype,\"size\",{get:function(){return this.cache.length},enumerable:!0,configurable:!0}),e.prototype.put=function(t,r){var n=\"string\"!=typeof t?e.getKeyString(t):t,i=this.populateValue(r);this.cache.put(n,i)},e.prototype.get=function(t){var r=\"string\"!=typeof t?e.getKeyString(t):t,n=Date.now(),i=this.cache.get(r);if(i)for(var o=0;o<i.length;o++){var s=i[o];if(s.Expire<n)return void this.cache.remove(r)}return i},e.getKeyString=function(e){for(var t=[],r=Object.keys(e).sort(),n=0;n<r.length;n++){var i=r[n];void 0!==e[i]&&t.push(e[i])}return t.join(\" \")},e.prototype.populateValue=function(e){var t=Date.now();return e.map(function(e){return{Address:e.Address||\"\",Expire:t+60*(e.CachePeriodInMinutes||1)*1e3}})},e.prototype.empty=function(){this.cache.empty()},e.prototype.remove=function(t){var r=\"string\"!=typeof t?e.getKeyString(t):t;this.cache.remove(r)},e}();r.EndpointCache=o},{\"./utils/LRU\":106}],106:[function(e,t,r){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0});var n=function(){function e(e,t){this.key=e,this.value=t}return e}(),i=function(){function e(e){if(this.nodeMap={},this.size=0,\"number\"!=typeof e||e<1)throw new Error(\"Cache size can only be positive number\");this.sizeLimit=e}return Object.defineProperty(e.prototype,\"length\",{get:function(){return this.size},enumerable:!0,configurable:!0}),e.prototype.prependToList=function(e){this.headerNode?(this.headerNode.prev=e,e.next=this.headerNode):this.tailNode=e,this.headerNode=e,this.size++},e.prototype.removeFromTail=function(){if(this.tailNode){var e=this.tailNode,t=e.prev;return t&&(t.next=void 0),e.prev=void 0,this.tailNode=t,this.size--,e}},e.prototype.detachFromList=function(e){this.headerNode===e&&(this.headerNode=e.next),this.tailNode===e&&(this.tailNode=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.next=void 0,e.prev=void 0,this.size--},e.prototype.get=function(e){if(this.nodeMap[e]){var t=this.nodeMap[e];return this.detachFromList(t),this.prependToList(t),t.value}},e.prototype.remove=function(e){if(this.nodeMap[e]){var t=this.nodeMap[e];this.detachFromList(t),delete this.nodeMap[e]}},e.prototype.put=function(e,t){if(this.nodeMap[e])this.remove(e);else if(this.size===this.sizeLimit){var r=this.removeFromTail(),i=r.key;delete this.nodeMap[i]}var o=new n(e,t);this.nodeMap[e]=o,this.prependToList(o)},e.prototype.empty=function(){for(var e=Object.keys(this.nodeMap),t=0;t<e.length;t++){var r=e[t],n=this.nodeMap[r];this.detachFromList(n),delete this.nodeMap[r]}},e}();r.LRUCache=i},{}],107:[function(e,t,r){e(\"./browser_loader\");var n=e(\"./core\");\"undefined\"!=typeof window&&(window.AWS=n),void 0!==t&&(t.exports=n),\"undefined\"!=typeof self&&(self.AWS=n),Object.prototype.hasOwnProperty.call(n,\"ConnectParticipant\")||(n.apiLoader.services.connectparticipant={},n.ConnectParticipant=n.Service.defineService(\"connectparticipant\",[\"2018-09-07\"])),n.apiLoader.services.connectparticipant[\"2018-09-07\"]=e(\"../apis/connectparticipant-2018-09-07.min\"),n.apiLoader.services.connectparticipant[\"2018-09-07\"].paginators=e(\"../apis/connectparticipant-2018-09-07.paginators\").pagination,Object.prototype.hasOwnProperty.call(n,\"STS\")||(n.apiLoader.services.sts={},n.STS=n.Service.defineService(\"sts\",[\"2011-06-15\"]),e(\"./services/sts\"))},{\"../apis/connectparticipant-2018-09-07.min\":3,\"../apis/connectparticipant-2018-09-07.paginators\":4,\"../apis/sts-2011-06-15.min\":6,\"./browser_loader\":17,\"./core\":20,\"./services/sts\":63}]},{},[107]);\n"
            }
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "ace6619fd081fa9d:1",
        "primaryLocationStartColumnFingerprint" : "4720"
      }
    }, {
      "ruleId" : "js/incomplete-sanitization",
      "rule" : {
        "id" : "js/incomplete-sanitization",
        "index" : 39,
        "toolComponent" : {
          "index" : 4
        }
      },
      "message" : {
        "text" : "This replaces only the first occurrence of \"#\"."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/client/aws-sdk-connectparticipant.js",
            "uriBaseId" : "%SRCROOT%",
            "index" : 0
          },
          "region" : {
            "startLine" : 11,
            "startColumn" : 5345,
            "endColumn" : 5354
          },
          "contextRegion" : {
            "startLine" : 9,
            "endLine" : 11,
            "snippet" : {
              "text" : "var r=this,n=Array.prototype.slice.call(arguments);return new t(function(t,i){n.push(function(e,r){e?i(e):t(r)}),r[e].apply(r,n)})}},isDualstackAvailable:function(t){if(!t)return!1;var r=e(\"../apis/metadata.json\");return\"string\"!=typeof t&&(t=t.serviceIdentifier),!(\"string\"!=typeof t||!r.hasOwnProperty(t))&&!!r[t].dualstackAvailable},calculateRetryDelay:function(e,t,r){t||(t={});var n=t.customBackoff||null;if(\"function\"==typeof n)return n(e,r);var i=\"number\"==typeof t.base?t.base:100;return Math.random()*(Math.pow(2,e)*i)},handleRequestWithRetries:function(e,t,r){t||(t={});var n=i.HttpClient.getInstance(),s=t.httpOptions||{},a=0,u=function(e){var n=t.maxRetries||0;if(e&&\"TimeoutError\"===e.code&&(e.retryable=!0),e&&e.retryable&&a<n){var i=o.calculateRetryDelay(a,t.retryDelayOptions,e);if(i>=0)return a++,void setTimeout(c,i+(e.retryAfter||0))}r(e)},c=function(){var t=\"\";n.handleRequest(e,s,function(e){e.on(\"data\",function(e){t+=e.toString()}),e.on(\"end\",function(){var n=e.statusCode;if(n<300)r(null,t);else{var i=1e3*parseInt(e.headers[\"retry-after\"],10)||0,s=o.error(new Error,{statusCode:n,retryable:n>=500||429===n});i&&s.retryable&&(s.retryAfter=i),u(s)}})},u)};i.util.defer(c)},uuid:{v4:function(){return e(\"uuid\").v4()}},convertPayloadToString:function(e){var t=e.request,r=t.operation,n=t.service.api.operations[r].output||{};n.payload&&e.data[n.payload]&&(e.data[n.payload]=e.data[n.payload].toString())},defer:function(e){\"object\"==typeof r&&\"function\"==typeof r.nextTick?r.nextTick(e):\"function\"==typeof n?n(e):setTimeout(e,0)},getRequestPayloadShape:function(e){var t=e.service.api.operations;if(t){var r=(t||{})[e.operation];if(r&&r.input&&r.input.payload)return r.input.members[r.input.payload]}},getProfilesFromSharedConfig:function(e,t){function n(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++)e[n[r]]=t[n[r]];return e}var i={},s={};if(r.env[o.configOptInEnv])var s=e.loadFrom({isConfig:!0,filename:r.env[o.sharedConfigFileEnv]});for(var a=e.loadFrom({filename:t||r.env[o.configOptInEnv]&&r.env[o.sharedCredentialsFileEnv]}),u=0,c=Object.keys(s);u<c.length;u++)i[c[u]]=n(i[c[u]]||{},s[c[u]]);for(var u=0,c=Object.keys(a);u<c.length;u++)i[c[u]]=n(i[c[u]]||{},a[c[u]]);return i},ARN:{validate:function(e){return e&&0===e.indexOf(\"arn:\")&&e.split(\":\").length>=6},parse:function(e){var t=e.split(\":\");return{partition:t[1],service:t[2],region:t[3],accountId:t[4],resource:t.slice(5).join(\":\")}},build:function(e){if(void 0===e.service||void 0===e.region||void 0===e.accountId||void 0===e.resource)throw o.error(new Error(\"Input ARN object is invalid\"));return\"arn:\"+(e.partition||\"aws\")+\":\"+e.service+\":\"+e.region+\":\"+e.accountId+\":\"+e.resource}},defaultProfile:\"default\",configOptInEnv:\"AWS_SDK_LOAD_CONFIG\",sharedCredentialsFileEnv:\"AWS_SHARED_CREDENTIALS_FILE\",sharedConfigFileEnv:\"AWS_CONFIG_FILE\",imdsDisabledEnv:\"AWS_EC2_METADATA_DISABLED\"};t.exports=o}).call(this)}).call(this,e(\"_process\"),e(\"timers\").setImmediate)},{\"../apis/metadata.json\":5,\"./core\":20,_process:87,fs:81,timers:95,uuid:100}],74:[function(e,t,r){function n(){}function i(e,t){for(var r=e.getElementsByTagName(t),n=0,i=r.length;n<i;n++)if(r[n].parentNode===e)return r[n]}function o(e,t){switch(t||(t={}),t.type){case\"structure\":return s(e,t);case\"map\":return a(e,t);case\"list\":return u(e,t);case void 0:case null:return l(e);default:return c(e,t)}}function s(e,t){var r={};return null===e?r:(p.each(t.members,function(n,s){if(s.isXmlAttribute){if(Object.prototype.hasOwnProperty.call(e.attributes,s.name)){var a=e.attributes[s.name].value;r[n]=o({textContent:a},s)}}else{var u=s.flattened?e:i(e,s.name);u?r[n]=o(u,s):s.flattened||\"list\"!==s.type||t.api.xmlNoDefaultLists||(r[n]=s.defaultValue)}}),r)}function a(e,t){for(var r={},n=t.key.name||\"key\",s=t.value.name||\"value\",a=t.flattened?t.name:\"entry\",u=e.firstElementChild;u;){if(u.nodeName===a){var c=i(u,n).textContent,l=i(u,s);r[c]=o(l,t.value)}u=u.nextElementSibling}return r}function u(e,t){for(var r=[],n=t.flattened?t.name:t.member.name||\"member\",i=e.firstElementChild;i;)i.nodeName===n&&r.push(o(i,t.member)),i=i.nextElementSibling;return r}function c(e,t){if(e.getAttribute){var r=e.getAttribute(\"encoding\");\"base64\"===r&&(t=new h.create({type:r}))}var n=e.textContent;return\"\"===n&&(n=null),\"function\"==typeof t.toType?t.toType(n):n}function l(e){if(void 0===e||null===e)return\"\";if(!e.firstElementChild)return null===e.parentNode.parentNode?{}:0===e.childNodes.length?\"\":e.textContent;for(var t={type:\"structure\",members:{}},r=e.firstElementChild;r;){var n=r.nodeName;Object.prototype.hasOwnProperty.call(t.members,n)?t.members[n].type=\"list\":t.members[n]={name:n},r=r.nextElementSibling}return s(e,t)}var p=e(\"../util\"),h=e(\"../model/shape\");n.prototype.parse=function(e,t){if(\"\"===e.replace(/^\\s+/,\"\"))return{};var r,n;try{if(window.DOMParser){try{r=(new DOMParser).parseFromString(e,\"text/xml\")}catch(e){throw p.error(new Error(\"Parse error in document\"),{originalError:e,code:\"XMLParserError\",retryable:!0})}if(null===r.documentElement)throw p.error(new Error(\"Cannot parse empty document.\"),{code:\"XMLParserError\",retryable:!0});var s=r.getElementsByTagName(\"parsererror\")[0];if(s&&(s.parentNode===r||\"body\"===s.parentNode.nodeName||s.parentNode.parentNode===r||\"body\"===s.parentNode.parentNode.nodeName)){var a=s.getElementsByTagName(\"div\")[0]||s;throw p.error(new Error(a.textContent||\"Parser error in document\"),{code:\"XMLParserError\",retryable:!0})}}else{if(!window.ActiveXObject)throw new Error(\"Cannot load XML parser\");if(r=new window.ActiveXObject(\"Microsoft.XMLDOM\"),r.async=!1,!r.loadXML(e))throw p.error(new Error(\"Parse error in document\"),{code:\"XMLParserError\",retryable:!0})}}catch(e){n=e}if(r&&r.documentElement&&!n){var u=o(r.documentElement,t),c=i(r.documentElement,\"ResponseMetadata\");return c&&(u.ResponseMetadata=o(c,{})),u}if(n)throw p.error(n||new Error,{code:\"XMLParserError\",retryable:!0});return{}},t.exports=n},{\"../model/shape\":45,\"../util\":73}],75:[function(e,t,r){function n(){}function i(e,t,r){switch(r.type){case\"structure\":return o(e,t,r);case\"map\":return s(e,t,r);case\"list\":return a(e,t,r);default:return u(e,t,r)}}function o(e,t,r){l.arrayEach(r.memberNames,function(n){var o=r.members[n];if(\"body\"===o.location){var s=t[n],a=o.name;if(void 0!==s&&null!==s)if(o.isXmlAttribute)e.addAttribute(a,s);else if(o.flattened)i(e,s,o);else{var u=new p(a);e.addChildNode(u),c(u,o),i(u,s,o)}}})}function s(e,t,r){var n=r.key.name||\"key\",o=r.value.name||\"value\";l.each(t,function(t,s){var a=new p(r.flattened?r.name:\"entry\");e.addChildNode(a);var u=new p(n),c=new p(o);a.addChildNode(u),a.addChildNode(c),i(u,t,r.key),i(c,s,r.value)})}function a(e,t,r){r.flattened?l.arrayEach(t,function(t){var n=r.member.name||r.name,o=new p(n);e.addChildNode(o),i(o,t,r.member)}):l.arrayEach(t,function(t){var n=r.member.name||\"member\",o=new p(n);e.addChildNode(o),i(o,t,r.member)})}function u(e,t,r){e.addChildNode(new h(r.toWireFormat(t)))}function c(e,t,r){var n,i=\"xmlns\";t.xmlNamespaceUri?(n=t.xmlNamespaceUri,t.xmlNamespacePrefix&&(i+=\":\"+t.xmlNamespacePrefix)):r&&t.api.xmlNamespaceUri&&(n=t.api.xmlNamespaceUri),n&&e.addAttribute(i,n)}var l=e(\"../util\"),p=e(\"./xml-node\").XmlNode,h=e(\"./xml-text\").XmlText;n.prototype.toXML=function(e,t,r,n){var o=new p(r);return c(o,t,!0),i(o,e,t),o.children.length>0||n?o.toString():\"\"},t.exports=n},{\"../util\":73,\"./xml-node\":78,\"./xml-text\":79}],76:[function(e,t,r){function n(e){return e.replace(/&/g,\"&amp;\").replace(/'/g,\"&apos;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\")}t.exports={escapeAttribute:n}},{}],77:[function(e,t,r){function n(e){return e.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\")}t.exports={escapeElement:n}},{}],78:[function(e,t,r){function n(e,t){void 0===t&&(t=[]),this.name=e,this.children=t,this.attributes={}}var i=e(\"./escape-attribute\").escapeAttribute;n.prototype.addAttribute=function(e,t){return this.attributes[e]=t,this},n.prototype.addChildNode=function(e){return this.children.push(e),this},n.prototype.removeAttribute=function(e){return delete this.attributes[e],this},n.prototype.toString=function(){for(var e=Boolean(this.children.length),t=\"<\"+this.name,r=this.attributes,n=0,o=Object.keys(r);n<o.length;n++){var s=o[n],a=r[s];void 0!==a&&null!==a&&(t+=\" \"+s+'=\"'+i(\"\"+a)+'\"')}return t+=e?\">\"+this.children.map(function(e){return e.toString()}).join(\"\")+\"</\"+this.name+\">\":\"/>\"},t.exports={XmlNode:n}},{\"./escape-attribute\":76}],79:[function(e,t,r){function n(e){this.value=e}var i=e(\"./escape-element\").escapeElement;n.prototype.toString=function(){return i(\"\"+this.value)},t.exports={XmlText:n}},{\"./escape-element\":77}],80:[function(e,t,r){\"use strict\";function n(e){var t=e.length;if(t%4>0)throw new Error(\"Invalid string. Length must be a multiple of 4\");var r=e.indexOf(\"=\");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function i(e){var t=n(e),r=t[0],i=t[1];return 3*(r+i)/4-i}function o(e,t,r){return 3*(t+r)/4-r}function s(e){var t,r,i=n(e),s=i[0],a=i[1],u=new h(o(e,s,a)),c=0,l=a>0?s-4:s;for(r=0;r<l;r+=4)t=p[e.charCodeAt(r)]<<18|p[e.charCodeAt(r+1)]<<12|p[e.charCodeAt(r+2)]<<6|p[e.charCodeAt(r+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===a&&(t=p[e.charCodeAt(r)]<<2|p[e.charCodeAt(r+1)]>>4,u[c++]=255&t),1===a&&(t=p[e.charCodeAt(r)]<<10|p[e.charCodeAt(r+1)]<<4|p[e.charCodeAt(r+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u}function a(e){return l[e>>18&63]+l[e>>12&63]+l[e>>6&63]+l[63&e]}function u(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(a(n));return i.join(\"\")}function c(e){for(var t,r=e.length,n=r%3,i=[],o=0,s=r-n;o<s;o+=16383)i.push(u(e,o,o+16383>s?s:o+16383));return 1===n?(t=e[r-1],i.push(l[t>>2]+l[t<<4&63]+\"==\")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(l[t>>10]+l[t>>4&63]+l[t<<2&63]+\"=\")),i.join(\"\")}r.byteLength=i,r.toByteArray=s,r.fromByteArray=c;for(var l=[],p=[],h=\"undefined\"!=typeof Uint8Array?Uint8Array:Array,f=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",d=0,m=f.length;d<m;++d)l[d]=f[d],p[f.charCodeAt(d)]=d;p[\"-\".charCodeAt(0)]=62,p[\"_\".charCodeAt(0)]=63},{}],81:[function(e,t,r){},{}],82:[function(e,t,r){(function(t,n){(function(){\"use strict\";function n(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(n()<t)throw new RangeError(\"Invalid typed array length\");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,r){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,r);if(\"number\"==typeof e){if(\"string\"==typeof t)throw new Error(\"If encoding is specified then the first argument must be a string\");return c(this,e)}return s(this,e,t,r)}function s(e,t,r,n){if(\"number\"==typeof t)throw new TypeError('\"value\" argument must not be a number');return\"undefined\"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?h(e,t,r,n):\"string\"==typeof t?l(e,t,r):f(e,t)}function a(e){if(\"number\"!=typeof e)throw new TypeError('\"size\" argument must be a number');if(e<0)throw new RangeError('\"size\" argument must not be negative')}function u(e,t,r,n){return a(t),t<=0?i(e,t):void 0!==r?\"string\"==typeof n?i(e,t).fill(r,n):i(e,t).fill(r):i(e,t)}function c(e,t){if(a(t),e=i(e,t<0?0:0|d(t)),!o.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function l(e,t,r){if(\"string\"==typeof r&&\"\"!==r||(r=\"utf8\"),!o.isEncoding(r))throw new TypeError('\"encoding\" must be a valid string encoding');var n=0|v(t,r);e=i(e,n);var s=e.write(t,r);return s!==n&&(e=e.slice(0,s)),e}function p(e,t){var r=t.length<0?0:0|d(t.length);e=i(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function h(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError(\"'offset' is out of bounds\");if(t.byteLength<r+(n||0))throw new RangeError(\"'length' is out of bounds\");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=p(e,t),e}function f(e,t){if(o.isBuffer(t)){var r=0|d(t.length);return e=i(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if(\"undefined\"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||\"length\"in t)return\"number\"!=typeof t.length||Y(t.length)?i(e,0):p(e,t);if(\"Buffer\"===t.type&&$(t.data))return p(e,t.data)}throw new TypeError(\"First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.\")}function d(e){if(e>=n())throw new RangeError(\"Attempt to allocate Buffer larger than maximum size: 0x\"+n().toString(16)+\" bytes\");return 0|e}function m(e){return+e!=e&&(e=0),o.alloc(+e)}function v(e,t){if(o.isBuffer(e))return e.length;if(\"undefined\"!=typeof ArrayBuffer&&\"function\"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;\"string\"!=typeof e&&(e=\"\"+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case\"ascii\":case\"latin1\":case\"binary\":return r;case\"utf8\":case\"utf-8\":case void 0:return V(e).length;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return 2*r;case\"hex\":return r>>>1;case\"base64\":return X(e).length;default:if(n)return V(e).length;t=(\"\"+t).toLowerCase(),n=!0}}function g(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return\"\";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return\"\";if(r>>>=0,t>>>=0,r<=t)return\"\";for(e||(e=\"utf8\");;)switch(e){case\"hex\":return q(this,t,r);case\"utf8\":case\"utf-8\":return T(this,t,r);case\"ascii\":return k(this,t,r);case\"latin1\":case\"binary\":return P(this,t,r);case\"base64\":return x(this,t,r);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return L(this,t,r);default:if(n)throw new TypeError(\"Unknown encoding: \"+e);e=(e+\"\").toLowerCase(),n=!0}}function y(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,n,i){if(0===e.length)return-1;if(\"string\"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if(\"string\"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,i);if(\"number\"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&\"function\"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,i);throw new TypeError(\"val must be string, number or Buffer\")}function w(e,t,r,n,i){function o(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,a=e.length,u=t.length;if(void 0!==n&&(\"ucs2\"===(n=String(n).toLowerCase())||\"ucs-2\"===n||\"utf16le\"===n||\"utf-16le\"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}var c;if(i){var l=-1;for(c=r;c<a;c++)if(o(e,c)===o(t,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===u)return l*s}else-1!==l&&(c-=c-l),l=-1}else for(r+u>a&&(r=a-u),c=r;c>=0;c--){for(var p=!0,h=0;h<u;h++)if(o(e,c+h)!==o(t,h)){p=!1;break}if(p)return c}return-1}function E(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError(\"Invalid hex string\");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function S(e,t,r,n){return G(V(t,e.length-r),e,r,n)}function _(e,t,r,n){return G(W(t),e,r,n)}function C(e,t,r,n){return _(e,t,r,n)}function A(e,t,r,n){return G(X(t),e,r,n)}function R(e,t,r,n){return G(K(t,e.length-r),e,r,n)}function x(e,t,r){return 0===t&&r===e.length?J.fromByteArray(e):J.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){var u,c,l,p;switch(a){case 1:o<128&&(s=o);break;case 2:u=e[i+1],128==(192&u)&&(p=(31&o)<<6|63&u)>127&&(s=p);break;case 3:u=e[i+1],c=e[i+2],128==(192&u)&&128==(192&c)&&(p=(15&o)<<12|(63&u)<<6|63&c)>2047&&(p<55296||p>57343)&&(s=p);break;case 4:u=e[i+1],c=e[i+2],l=e[i+3],128==(192&u)&&128==(192&c)&&128==(192&l)&&(p=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&p<1114112&&(s=p)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=a}return I(n)}function I(e){var t=e.length;if(t<=Q)return String.fromCharCode.apply(String,e);for(var r=\"\",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Q));return r}function k(e,t,r){var n=\"\";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function P(e,t,r){var n=\"\";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function q(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i=\"\",o=t;o<r;++o)i+=H(e[o]);return i}function L(e,t,r){for(var n=e.slice(t,r),i=\"\",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function O(e,t,r){if(e%1!=0||e<0)throw new RangeError(\"offset is not uint\");if(e+t>r)throw new RangeError(\"Trying to access beyond buffer length\")}function N(e,t,r,n,i,s){if(!o.isBuffer(e))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('\"value\" argument is out of bounds');if(r+n>e.length)throw new RangeError(\"Index out of range\")}function U(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function D(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function M(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError(\"Index out of range\");if(r<0)throw new RangeError(\"Index out of range\")}function j(e,t,r,n,i){return i||M(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(e,t,r,n,23,4),r+4}function B(e,t,r,n,i){return i||M(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(e,t,r,n,52,8),r+8}function F(e){if(e=z(e).replace(ee,\"\"),e.length<2)return\"\";for(;e.length%4!=0;)e+=\"=\";return e}function z(e){return e.trim?e.trim():e.replace(/^\\s+|\\s+$/g,\"\")}function H(e){return e<16?\"0\"+e.toString(16):e.toString(16)}function V(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error(\"Invalid code point\");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function W(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function K(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function X(e){return J.toByteArray(F(e))}function G(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function Y(e){return e!==e}var J=e(\"base64-js\"),Z=e(\"ieee754\"),$=e(\"isarray\");r.Buffer=o,r.SlowBuffer=m,r.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&\"function\"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),r.kMaxLength=n(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,r){return s(null,e,t,r)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,\"undefined\"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,r){return u(null,e,t,r)},o.allocUnsafe=function(e){return c(null,e)},o.allocUnsafeSlow=function(e){return c(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError(\"Arguments must be Buffers\");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},o.concat=function(e,t){if(!$(e))throw new TypeError('\"list\" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=o.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(!o.isBuffer(s))throw new TypeError('\"list\" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},o.byteLength=v,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError(\"Buffer size must be a multiple of 16-bits\");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError(\"Buffer size must be a multiple of 32-bits\");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError(\"Buffer size must be a multiple of 64-bits\");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?\"\":0===arguments.length?T(this,0,e):g.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e=\"\",t=r.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString(\"hex\",0,t).match(/.{2}/g).join(\" \"),this.length>t&&(e+=\" ... \")),\"<Buffer \"+e+\">\"},o.prototype.compare=function(e,t,r,n,i){if(!o.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError(\"out of range index\");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var s=i-n,a=r-t,u=Math.min(s,a),c=this.slice(n,i),l=e.slice(t,r),p=0;p<u;++p)if(c[p]!==l[p]){s=c[p],a=l[p];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},o.prototype.write=function(e,t,r,n){if(void 0===t)n=\"utf8\",r=this.length,t=0;else if(void 0===r&&\"string\"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error(\"Buffer.write(string, encoding, offset[, length]) is no longer supported\");t|=0,isFinite(r)?(r|=0,void 0===n&&(n=\"utf8\")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError(\"Attempt to write outside buffer bounds\");n||(n=\"utf8\");for(var o=!1;;)switch(n){case\"hex\":return E(this,e,t,r);case\"utf8\":case\"utf-8\":return S(this,e,t,r);case\"ascii\":return _(this,e,t,r);case\"latin1\":case\"binary\":return C(this,e,t,r);case\"base64\":return A(this,e,t,r);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return R(this,e,t,r);default:if(o)throw new TypeError(\"Unknown encoding: \"+n);n=(\"\"+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n;if(o.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=o.prototype;else{var i=t-e;n=new o(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+e]}return n},o.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},o.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),Z.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),Z.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),Z.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),Z.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){N(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){N(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return B(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return B(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError(\"targetStart out of bounds\");if(r<0||r>=this.length)throw new RangeError(\"sourceStart out of bounds\");if(n<0)throw new RangeError(\"sourceEnd out of bounds\");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,s=n-r;if(this===e&&r<t&&t<n)for(i=s-1;i>=0;--i)e[i+t]=this[i+r];else if(s<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+s),t);return s},o.prototype.fill=function(e,t,r,n){if(\"string\"==typeof e){if(\"string\"==typeof t?(n=t,t=0,r=this.length):\"string\"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&\"string\"!=typeof n)throw new TypeError(\"encoding must be a string\");if(\"string\"==typeof n&&!o.isEncoding(n))throw new TypeError(\"Unknown encoding: \"+n)}else\"number\"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError(\"Out of range index\");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var s;if(\"number\"==typeof e)for(s=t;s<r;++s)this[s]=e;else{var a=o.isBuffer(e)?e:V(new o(e,n).toString()),u=a.length;for(s=0;s<r-t;++s)this[s+t]=a[s%u]}return this};var ee=/[^+\\/0-9A-Za-z-_]/g}).call(this)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer)},{\"base64-js\":80,buffer:82,ieee754:84,isarray:85}],83:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return\"function\"==typeof e}function o(e){return\"number\"==typeof e}function s(e){return\"object\"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError(\"n must be a positive number\");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,o,u,c;if(this._events||(this._events={}),\"error\"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified \"error\" event. ('+t+\")\");throw l.context=t,l}if(r=this._events[e],a(r))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(s(r))for(o=Array.prototype.slice.call(arguments,1),c=r.slice(),n=c.length,u=0;u<n;u++)c[u].apply(this,o);return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError(\"listener must be a function\");return this._events||(this._events={}),this._events.newListener&&this.emit(\"newListener\",e,i(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,\nconsole.error(\"(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.\",this._events[e].length),\"function\"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!i(t))throw TypeError(\"listener must be a function\");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,o,a;if(!i(t))throw TypeError(\"listener must be a function\");if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit(\"removeListener\",e,t);else if(s(r)){for(a=o;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){n=a;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit(\"removeListener\",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)\"removeListener\"!==t&&this.removeAllListeners(t);return this.removeAllListeners(\"removeListener\"),this._events={},this}if(r=this._events[e],i(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],84:[function(e,t,r){r.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,c=u>>1,l=-7,p=r?i-1:0,h=r?-1:1,f=e[t+p];for(p+=h,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+e[t+p],p+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+p],p+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=c}return(f?-1:1)*s*Math.pow(2,o-n)},r.write=function(e,t,r,n,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,p=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,d=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),t+=s+p>=1?h/u:h*Math.pow(2,1-p),t*u>=2&&(s++,u/=2),s+p>=l?(a=0,s=l):s+p>=1?(a=(t*u-1)*Math.pow(2,i),s+=p):(a=t*Math.pow(2,p-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+f]=255&s,f+=d,s/=256,c-=8);e[r+f-d]|=128*m}},{}],85:[function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return\"[object Array]\"==n.call(e)}},{}],86:[function(e,t,r){!function(e){\"use strict\";function t(e){return null!==e&&\"[object Array]\"===Object.prototype.toString.call(e)}function r(e){return null!==e&&\"[object Object]\"===Object.prototype.toString.call(e)}function n(e,i){if(e===i)return!0;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(i))return!1;if(!0===t(e)){if(e.length!==i.length)return!1;for(var o=0;o<e.length;o++)if(!1===n(e[o],i[o]))return!1;return!0}if(!0===r(e)){var s={};for(var a in e)if(hasOwnProperty.call(e,a)){if(!1===n(e[a],i[a]))return!1;s[a]=!0}for(var u in i)if(hasOwnProperty.call(i,u)&&!0!==s[u])return!1;return!0}return!1}function i(e){if(\"\"===e||!1===e||null===e)return!0;if(t(e)&&0===e.length)return!0;if(r(e)){for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}return!1}function o(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;n++)r.push(e[t[n]]);return r}function s(e){return e>=\"a\"&&e<=\"z\"||e>=\"A\"&&e<=\"Z\"||\"_\"===e}function a(e){return e>=\"0\"&&e<=\"9\"||\"-\"===e}function u(e){return e>=\"a\"&&e<=\"z\"||e>=\"A\"&&e<=\"Z\"||e>=\"0\"&&e<=\"9\"||\"_\"===e}function c(){}function l(){}function p(e){this.runtime=e}function h(e){this._interpreter=e,this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[g]}]},avg:{_func:this._functionAvg,_signature:[{types:[_]}]},ceil:{_func:this._functionCeil,_signature:[{types:[g]}]},contains:{_func:this._functionContains,_signature:[{types:[b,w]},{types:[y]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[b]},{types:[b]}]},floor:{_func:this._functionFloor,_signature:[{types:[g]}]},length:{_func:this._functionLength,_signature:[{types:[b,w,E]}]},map:{_func:this._functionMap,_signature:[{types:[S]},{types:[w]}]},max:{_func:this._functionMax,_signature:[{types:[_,C]}]},merge:{_func:this._functionMerge,_signature:[{types:[E],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[w]},{types:[S]}]},sum:{_func:this._functionSum,_signature:[{types:[_]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[b]},{types:[b]}]},min:{_func:this._functionMin,_signature:[{types:[_,C]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[w]},{types:[S]}]},type:{_func:this._functionType,_signature:[{types:[y]}]},keys:{_func:this._functionKeys,_signature:[{types:[E]}]},values:{_func:this._functionValues,_signature:[{types:[E]}]},sort:{_func:this._functionSort,_signature:[{types:[C,_]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[w]},{types:[S]}]},join:{_func:this._functionJoin,_signature:[{types:[b]},{types:[C]}]},reverse:{_func:this._functionReverse,_signature:[{types:[b,w]}]},to_array:{_func:this._functionToArray,_signature:[{types:[y]}]},to_string:{_func:this._functionToString,_signature:[{types:[y]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[y]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[y],variadic:!0}]}}}function f(e){return(new l).parse(e)}function d(e){return(new c).tokenize(e)}function m(e,t){var r=new l,n=new h,i=new p(n);n._interpreter=i;var o=r.parse(t);return i.search(o,e)}var v;v=\"function\"==typeof String.prototype.trimLeft?function(e){return e.trimLeft()}:function(e){return e.match(/^\\s*(.*)/)[1]};var g=0,y=1,b=2,w=3,E=4,S=6,_=8,C=9,A={\".\":\"Dot\",\"*\":\"Star\",\",\":\"Comma\",\":\":\"Colon\",\"{\":\"Lbrace\",\"}\":\"Rbrace\",\"]\":\"Rbracket\",\"(\":\"Lparen\",\")\":\"Rparen\",\"@\":\"Current\"},R={\"<\":!0,\">\":!0,\"=\":!0,\"!\":!0},x={\" \":!0,\"\\t\":!0,\"\\n\":!0};c.prototype={tokenize:function(e){var t=[];this._current=0;for(var r,n,i;this._current<e.length;)if(s(e[this._current]))r=this._current,n=this._consumeUnquotedIdentifier(e),t.push({type:\"UnquotedIdentifier\",value:n,start:r});else if(void 0!==A[e[this._current]])t.push({type:A[e[this._current]],value:e[this._current],start:this._current}),this._current++;else if(a(e[this._current]))i=this._consumeNumber(e),t.push(i);else if(\"[\"===e[this._current])i=this._consumeLBracket(e),t.push(i);else if('\"'===e[this._current])r=this._current,n=this._consumeQuotedIdentifier(e),t.push({type:\"QuotedIdentifier\",value:n,start:r});else if(\"'\"===e[this._current])r=this._current,n=this._consumeRawStringLiteral(e),t.push({type:\"Literal\",value:n,start:r});else if(\"`\"===e[this._current]){r=this._current;var o=this._consumeLiteral(e);t.push({type:\"Literal\",value:o,start:r})}else if(void 0!==R[e[this._current]])t.push(this._consumeOperator(e));else if(void 0!==x[e[this._current]])this._current++;else if(\"&\"===e[this._current])r=this._current,this._current++,\"&\"===e[this._current]?(this._current++,t.push({type:\"And\",value:\"&&\",start:r})):t.push({type:\"Expref\",value:\"&\",start:r});else{if(\"|\"!==e[this._current]){var u=new Error(\"Unknown character:\"+e[this._current]);throw u.name=\"LexerError\",u}r=this._current,this._current++,\"|\"===e[this._current]?(this._current++,t.push({type:\"Or\",value:\"||\",start:r})):t.push({type:\"Pipe\",value:\"|\",start:r})}return t},_consumeUnquotedIdentifier:function(e){var t=this._current;for(this._current++;this._current<e.length&&u(e[this._current]);)this._current++;return e.slice(t,this._current)},_consumeQuotedIdentifier:function(e){var t=this._current;this._current++;for(var r=e.length;'\"'!==e[this._current]&&this._current<r;){var n=this._current;\"\\\\\"!==e[n]||\"\\\\\"!==e[n+1]&&'\"'!==e[n+1]?n++:n+=2,this._current=n}return this._current++,JSON.parse(e.slice(t,this._current))},_consumeRawStringLiteral:function(e){var t=this._current;this._current++;for(var r=e.length;\"'\"!==e[this._current]&&this._current<r;){var n=this._current;\"\\\\\"!==e[n]||\"\\\\\"!==e[n+1]&&\"'\"!==e[n+1]?n++:n+=2,this._current=n}return this._current++,e.slice(t+1,this._current-1).replace(\"\\\\'\",\"'\")},_consumeNumber:function(e){var t=this._current;this._current++;for(var r=e.length;a(e[this._current])&&this._current<r;)this._current++;return{type:\"Number\",value:parseInt(e.slice(t,this._current)),start:t}},_consumeLBracket:function(e){var t=this._current;return this._current++,\"?\"===e[this._current]?(this._current++,{type:\"Filter\",value:\"[?\",start:t}):\"]\"===e[this._current]?(this._current++,{type:\"Flatten\",value:\"[]\",start:t}):{type:\"Lbracket\",value:\"[\",start:t}},_consumeOperator:function(e){var t=this._current,r=e[t];return this._current++,\"!\"===r?\"=\"===e[this._current]?(this._current++,{type:\"NE\",value:\"!=\",start:t}):{type:\"Not\",value:\"!\",start:t}:\"<\"===r?\"=\"===e[this._current]?(this._current++,{type:\"LTE\",value:\"<=\",start:t}):{type:\"LT\",value:\"<\",start:t}:\">\"===r?\"=\"===e[this._current]?(this._current++,{type:\"GTE\",value:\">=\",start:t}):{type:\"GT\",value:\">\",start:t}:\"=\"===r&&\"=\"===e[this._current]?(this._current++,{type:\"EQ\",value:\"==\",start:t}):void 0},_consumeLiteral:function(e){this._current++;for(var t,r=this._current,n=e.length;\"`\"!==e[this._current]&&this._current<n;){var i=this._current;\"\\\\\"!==e[i]||\"\\\\\"!==e[i+1]&&\"`\"!==e[i+1]?i++:i+=2,this._current=i}var o=v(e.slice(r,this._current));return o=o.replace(\"\\\\`\",\"`\"),t=this._looksLikeJSON(o)?JSON.parse(o):JSON.parse('\"'+o+'\"'),this._current++,t},_looksLikeJSON:function(e){var t='[{\"',r=[\"true\",\"false\",\"null\"],n=\"-0123456789\";if(\"\"===e)return!1;if(t.indexOf(e[0])>=0)return!0;if(r.indexOf(e)>=0)return!0;if(!(n.indexOf(e[0])>=0))return!1;try{return JSON.parse(e),!0}catch(e){return!1}}};var T={};T.EOF=0,T.UnquotedIdentifier=0,T.QuotedIdentifier=0,T.Rbracket=0,T.Rparen=0,T.Comma=0,T.Rbrace=0,T.Number=0,T.Current=0,T.Expref=0,T.Pipe=1,T.Or=2,T.And=3,T.EQ=5,T.GT=5,T.LT=5,T.GTE=5,T.LTE=5,T.NE=5,T.Flatten=9,T.Star=20,T.Filter=21,T.Dot=40,T.Not=45,T.Lbrace=50,T.Lbracket=55,T.Lparen=60,l.prototype={parse:function(e){this._loadTokens(e),this.index=0;var t=this.expression(0);if(\"EOF\"!==this._lookahead(0)){var r=this._lookaheadToken(0),n=new Error(\"Unexpected token type: \"+r.type+\", value: \"+r.value);throw n.name=\"ParserError\",n}return t},_loadTokens:function(e){var t=new c,r=t.tokenize(e);r.push({type:\"EOF\",value:\"\",start:e.length}),this.tokens=r},expression:function(e){var t=this._lookaheadToken(0);this._advance();for(var r=this.nud(t),n=this._lookahead(0);e<T[n];)this._advance(),r=this.led(n,r),n=this._lookahead(0);return r},_lookahead:function(e){return this.tokens[this.index+e].type},_lookaheadToken:function(e){return this.tokens[this.index+e]},_advance:function(){this.index++},nud:function(e){var t,r,n;switch(e.type){case\"Literal\":return{type:\"Literal\",value:e.value};case\"UnquotedIdentifier\":return{type:\"Field\",name:e.value};case\"QuotedIdentifier\":var i={type:\"Field\",name:e.value};if(\"Lparen\"===this._lookahead(0))throw new Error(\"Quoted identifier not allowed for function names.\");return i;case\"Not\":return r=this.expression(T.Not),{type:\"NotExpression\",children:[r]};case\"Star\":return t={type:\"Identity\"},r=null,r=\"Rbracket\"===this._lookahead(0)?{type:\"Identity\"}:this._parseProjectionRHS(T.Star),{type:\"ValueProjection\",children:[t,r]};case\"Filter\":return this.led(e.type,{type:\"Identity\"});case\"Lbrace\":return this._parseMultiselectHash();case\"Flatten\":return t={type:\"Flatten\",children:[{type:\"Identity\"}]},r=this._parseProjectionRHS(T.Flatten),{type:\"Projection\",children:[t,r]};case\"Lbracket\":return\"Number\"===this._lookahead(0)||\"Colon\"===this._lookahead(0)?(r=this._parseIndexExpression(),this._projectIfSlice({type:\"Identity\"},r)):\"Star\"===this._lookahead(0)&&\"Rbracket\"===this._lookahead(1)?(this._advance(),this._advance(),r=this._parseProjectionRHS(T.Star),{type:\"Projection\",children:[{type:\"Identity\"},r]}):this._parseMultiselectList();case\"Current\":return{type:\"Current\"};case\"Expref\":return n=this.expression(T.Expref),{type:\"ExpressionReference\",children:[n]};case\"Lparen\":for(var o=[];\"Rparen\"!==this._lookahead(0);)\"Current\"===this._lookahead(0)?(n={type:\"Current\"},this._advance()):n=this.expression(0),o.push(n);return this._match(\"Rparen\"),o[0];default:this._errorToken(e)}},led:function(e,t){var r;switch(e){case\"Dot\":var n=T.Dot;return\"Star\"!==this._lookahead(0)?(r=this._parseDotRHS(n),{type:\"Subexpression\",children:[t,r]}):(this._advance(),r=this._parseProjectionRHS(n),{type:\"ValueProjection\",children:[t,r]});case\"Pipe\":return r=this.expression(T.Pipe),{type:\"Pipe\",children:[t,r]};case\"Or\":return r=this.expression(T.Or),{type:\"OrExpression\",children:[t,r]};case\"And\":return r=this.expression(T.And),{type:\"AndExpression\",children:[t,r]};case\"Lparen\":for(var i,o=t.name,s=[];\"Rparen\"!==this._lookahead(0);)\"Current\"===this._lookahead(0)?(i={type:\"Current\"},this._advance()):i=this.expression(0),\"Comma\"===this._lookahead(0)&&this._match(\"Comma\"),s.push(i);return this._match(\"Rparen\"),{type:\"Function\",name:o,children:s};case\"Filter\":var a=this.expression(0);return this._match(\"Rbracket\"),r=\"Flatten\"===this._lookahead(0)?{type:\"Identity\"}:this._parseProjectionRHS(T.Filter),{type:\"FilterProjection\",children:[t,r,a]};case\"Flatten\":return{type:\"Projection\",children:[{type:\"Flatten\",children:[t]},this._parseProjectionRHS(T.Flatten)]};case\"EQ\":case\"NE\":case\"GT\":case\"GTE\":case\"LT\":case\"LTE\":return this._parseComparator(t,e);case\"Lbracket\":var u=this._lookaheadToken(0);return\"Number\"===u.type||\"Colon\"===u.type?(r=this._parseIndexExpression(),this._projectIfSlice(t,r)):(this._match(\"Star\"),this._match(\"Rbracket\"),r=this._parseProjectionRHS(T.Star),{type:\"Projection\",children:[t,r]});default:this._errorToken(this._lookaheadToken(0))}},_match:function(e){if(this._lookahead(0)!==e){var t=this._lookaheadToken(0),r=new Error(\"Expected \"+e+\", got: \"+t.type);throw r.name=\"ParserError\",r}this._advance()},_errorToken:function(e){var t=new Error(\"Invalid token (\"+e.type+'): \"'+e.value+'\"');throw t.name=\"ParserError\",t},_parseIndexExpression:function(){if(\"Colon\"===this._lookahead(0)||\"Colon\"===this._lookahead(1))return this._parseSliceExpression();var e={type:\"Index\",value:this._lookaheadToken(0).value};return this._advance(),this._match(\"Rbracket\"),e},_projectIfSlice:function(e,t){var r={type:\"IndexExpression\",children:[e,t]};return\"Slice\"===t.type?{type:\"Projection\",children:[r,this._parseProjectionRHS(T.Star)]}:r},_parseSliceExpression:function(){for(var e=[null,null,null],t=0,r=this._lookahead(0);\"Rbracket\"!==r&&t<3;){if(\"Colon\"===r)t++,this._advance();else{if(\"Number\"!==r){var n=this._lookahead(0),i=new Error(\"Syntax error, unexpected token: \"+n.value+\"(\"+n.type+\")\");throw i.name=\"Parsererror\",i}e[t]=this._lookaheadToken(0).value,this._advance()}r=this._lookahead(0)}return this._match(\"Rbracket\"),{type:\"Slice\",children:e}},_parseComparator:function(e,t){return{type:\"Comparator\",name:t,children:[e,this.expression(T[t])]}},_parseDotRHS:function(e){var t=this._lookahead(0);return[\"UnquotedIdentifier\",\"QuotedIdentifier\",\"Star\"].indexOf(t)>=0?this.expression(e):\"Lbracket\"===t?(this._match(\"Lbracket\"),this._parseMultiselectList()):\"Lbrace\"===t?(this._match(\"Lbrace\"),this._parseMultiselectHash()):void 0},_parseProjectionRHS:function(e){var t;if(T[this._lookahead(0)]<10)t={type:\"Identity\"};else if(\"Lbracket\"===this._lookahead(0))t=this.expression(e);else if(\"Filter\"===this._lookahead(0))t=this.expression(e);else{if(\"Dot\"!==this._lookahead(0)){var r=this._lookaheadToken(0),n=new Error(\"Sytanx error, unexpected token: \"+r.value+\"(\"+r.type+\")\");throw n.name=\"ParserError\",n}this._match(\"Dot\"),t=this._parseDotRHS(e)}return t},_parseMultiselectList:function(){for(var e=[];\"Rbracket\"!==this._lookahead(0);){var t=this.expression(0);if(e.push(t),\"Comma\"===this._lookahead(0)&&(this._match(\"Comma\"),\"Rbracket\"===this._lookahead(0)))throw new Error(\"Unexpected token Rbracket\")}return this._match(\"Rbracket\"),{type:\"MultiSelectList\",children:e}},_parseMultiselectHash:function(){for(var e,t,r,n,i=[],o=[\"UnquotedIdentifier\",\"QuotedIdentifier\"];;){if(e=this._lookaheadToken(0),o.indexOf(e.type)<0)throw new Error(\"Expecting an identifier token, got: \"+e.type);if(t=e.value,this._advance(),this._match(\"Colon\"),r=this.expression(0),n={type:\"KeyValuePair\",name:t,value:r},i.push(n),\"Comma\"===this._lookahead(0))this._match(\"Comma\");else if(\"Rbrace\"===this._lookahead(0)){this._match(\"Rbrace\");break}}return{type:\"MultiSelectHash\",children:i}}},p.prototype={search:function(e,t){return this.visit(e,t)},visit:function(e,s){var a,u,c,l,p,h,f,d,m;switch(e.type){case\"Field\":return null===s?null:r(s)?(h=s[e.name],void 0===h?null:h):null;case\"Subexpression\":for(c=this.visit(e.children[0],s),m=1;m<e.children.length;m++)if(null===(c=this.visit(e.children[1],c)))return null;return c;case\"IndexExpression\":return f=this.visit(e.children[0],s),this.visit(e.children[1],f);case\"Index\":if(!t(s))return null;var v=e.value;return v<0&&(v=s.length+v),c=s[v],void 0===c&&(c=null),c;case\"Slice\":if(!t(s))return null;var g=e.children.slice(0),y=this.computeSliceParams(s.length,g),b=y[0],w=y[1],E=y[2];if(c=[],E>0)for(m=b;m<w;m+=E)c.push(s[m]);else for(m=b;m>w;m+=E)c.push(s[m]);return c;case\"Projection\":var S=this.visit(e.children[0],s);if(!t(S))return null;for(d=[],m=0;m<S.length;m++)null!==(u=this.visit(e.children[1],S[m]))&&d.push(u);return d;case\"ValueProjection\":if(S=this.visit(e.children[0],s),!r(S))return null;d=[];var _=o(S);for(m=0;m<_.length;m++)null!==(u=this.visit(e.children[1],_[m]))&&d.push(u);return d;case\"FilterProjection\":if(S=this.visit(e.children[0],s),!t(S))return null;var C=[],A=[];for(m=0;m<S.length;m++)a=this.visit(e.children[2],S[m]),i(a)||C.push(S[m]);for(var R=0;R<C.length;R++)null!==(u=this.visit(e.children[1],C[R]))&&A.push(u);return A;case\"Comparator\":switch(l=this.visit(e.children[0],s),p=this.visit(e.children[1],s),e.name){case\"EQ\":c=n(l,p);break;case\"NE\":c=!n(l,p);break;case\"GT\":c=l>p;break;case\"GTE\":c=l>=p;break;case\"LT\":c=l<p;break;case\"LTE\":c=l<=p;break;default:throw new Error(\"Unknown comparator: \"+e.name)}return c;case\"Flatten\":var x=this.visit(e.children[0],s);if(!t(x))return null;var T=[];for(m=0;m<x.length;m++)u=x[m],t(u)?T.push.apply(T,u):T.push(u);return T;case\"Identity\":return s;case\"MultiSelectList\":if(null===s)return null;for(d=[],m=0;m<e.children.length;m++)d.push(this.visit(e.children[m],s));return d;case\"MultiSelectHash\":if(null===s)return null;d={};var I;for(m=0;m<e.children.length;m++)I=e.children[m],d[I.name]=this.visit(I.value,s);return d;case\"OrExpression\":return a=this.visit(e.children[0],s),i(a)&&(a=this.visit(e.children[1],s)),a;case\"AndExpression\":return l=this.visit(e.children[0],s),!0===i(l)?l:this.visit(e.children[1],s);case\"NotExpression\":return l=this.visit(e.children[0],s),i(l);case\"Literal\":return e.value;case\"Pipe\":return f=this.visit(e.children[0],s),this.visit(e.children[1],f);case\"Current\":return s;case\"Function\":var k=[];for(m=0;m<e.children.length;m++)k.push(this.visit(e.children[m],s));return this.runtime.callFunction(e.name,k);case\"ExpressionReference\":var P=e.children[0];return P.jmespathType=\"Expref\",P;default:throw new Error(\"Unknown node type: \"+e.type)}},computeSliceParams:function(e,t){var r=t[0],n=t[1],i=t[2],o=[null,null,null];if(null===i)i=1;else if(0===i){var s=new Error(\"Invalid slice, step cannot be 0\");throw s.name=\"RuntimeError\",s}var a=i<0;return r=null===r?a?e-1:0:this.capSliceRange(e,r,i),n=null===n?a?-1:e:this.capSliceRange(e,n,i),o[0]=r,o[1]=n,o[2]=i,o},capSliceRange:function(e,t,r){return t<0?(t+=e)<0&&(t=r<0?-1:0):t>=e&&(t=r<0?e-1:e),t}},h.prototype={callFunction:function(e,t){var r=this.functionTable[e];if(void 0===r)throw new Error(\"Unknown function: \"+e+\"()\");return this._validateArgs(e,t,r._signature),r._func.call(this,t)},_validateArgs:function(e,t,r){var n;if(r[r.length-1].variadic){if(t.length<r.length)throw n=1===r.length?\" argument\":\" arguments\",new Error(\"ArgumentError: \"+e+\"() takes at least\"+r.length+n+\" but received \"+t.length)}else if(t.length!==r.length)throw n=1===r.length?\" argument\":\" arguments\",new Error(\"ArgumentError: \"+e+\"() takes \"+r.length+n+\" but received \"+t.length);for(var i,o,s,a=0;a<r.length;a++){s=!1,i=r[a].types,o=this._getTypeName(t[a]);for(var u=0;u<i.length;u++)if(this._typeMatches(o,i[u],t[a])){s=!0;break}if(!s)throw new Error(\"TypeError: \"+e+\"() expected argument \"+(a+1)+\" to be type \"+i+\" but received type \"+o+\" instead.\")}},_typeMatches:function(e,t,r){if(t===y)return!0;if(t!==C&&t!==_&&t!==w)return e===t;if(t===w)return e===w;if(e===w){var n;t===_?n=g:t===C&&(n=b);for(var i=0;i<r.length;i++)if(!this._typeMatches(this._getTypeName(r[i]),n,r[i]))return!1;return!0}},_getTypeName:function(e){switch(Object.prototype.toString.call(e)){case\"[object String]\":return b;case\"[object Number]\":return g;case\"[object Array]\":return w;case\"[object Boolean]\":return 5;case\"[object Null]\":return 7;case\"[object Object]\":return\"Expref\"===e.jmespathType?S:E}},_functionStartsWith:function(e){return 0===e[0].lastIndexOf(e[1])},_functionEndsWith:function(e){var t=e[0],r=e[1];return-1!==t.indexOf(r,t.length-r.length)},_functionReverse:function(e){if(this._getTypeName(e[0])===b){for(var t=e[0],r=\"\",n=t.length-1;n>=0;n--)r+=t[n];return r}var i=e[0].slice(0);return i.reverse(),i},_functionAbs:function(e){return Math.abs(e[0])},_functionCeil:function(e){return Math.ceil(e[0])},_functionAvg:function(e){for(var t=0,r=e[0],n=0;n<r.length;n++)t+=r[n];return t/r.length},_functionContains:function(e){return e[0].indexOf(e[1])>=0},_functionFloor:function(e){return Math.floor(e[0])},_functionLength:function(e){return r(e[0])?Object.keys(e[0]).length:e[0].length},_functionMap:function(e){for(var t=[],r=this._interpreter,n=e[0],i=e[1],o=0;o<i.length;o++)t.push(r.visit(n,i[o]));return t},_functionMerge:function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];for(var i in n)t[i]=n[i]}return t},_functionMax:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===g)return Math.max.apply(Math,e[0]);for(var t=e[0],r=t[0],n=1;n<t.length;n++)r.localeCompare(t[n])<0&&(r=t[n]);return r}return null},_functionMin:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===g)return Math.min.apply(Math,e[0]);for(var t=e[0],r=t[0],n=1;n<t.length;n++)t[n].localeCompare(r)<0&&(r=t[n]);return r}return null},_functionSum:function(e){for(var t=0,r=e[0],n=0;n<r.length;n++)t+=r[n];return t},_functionType:function(e){switch(this._getTypeName(e[0])){case g:return\"number\";case b:return\"string\";case w:return\"array\";case E:return\"object\";case 5:return\"boolean\";case S:return\"expref\";case 7:return\"null\"}},_functionKeys:function(e){return Object.keys(e[0])},_functionValues:function(e){for(var t=e[0],r=Object.keys(t),n=[],i=0;i<r.length;i++)n.push(t[r[i]]);return n},_functionJoin:function(e){var t=e[0];return e[1].join(t)},_functionToArray:function(e){return this._getTypeName(e[0])===w?e[0]:[e[0]]},_functionToString:function(e){return this._getTypeName(e[0])===b?e[0]:JSON.stringify(e[0])},_functionToNumber:function(e){var t,r=this._getTypeName(e[0]);return r===g?e[0]:r!==b||(t=+e[0],isNaN(t))?null:t},_functionNotNull:function(e){for(var t=0;t<e.length;t++)if(7!==this._getTypeName(e[t]))return e[t];return null},_functionSort:function(e){var t=e[0].slice(0);return t.sort(),t},_functionSortBy:function(e){var t=e[0].slice(0);if(0===t.length)return t;var r=this._interpreter,n=e[1],i=this._getTypeName(r.visit(n,t[0]));if([g,b].indexOf(i)<0)throw new Error(\"TypeError\");for(var o=this,s=[],a=0;a<t.length;a++)s.push([a,t[a]]);s.sort(function(e,t){var s=r.visit(n,e[1]),a=r.visit(n,t[1]);if(o._getTypeName(s)!==i)throw new Error(\"TypeError: expected \"+i+\", received \"+o._getTypeName(s));if(o._getTypeName(a)!==i)throw new Error(\"TypeError: expected \"+i+\", received \"+o._getTypeName(a));return s>a?1:s<a?-1:e[0]-t[0]});for(var u=0;u<s.length;u++)t[u]=s[u][1];return t},_functionMaxBy:function(e){for(var t,r,n=e[1],i=e[0],o=this.createKeyFunction(n,[g,b]),s=-1/0,a=0;a<i.length;a++)(r=o(i[a]))>s&&(s=r,t=i[a]);return t},_functionMinBy:function(e){for(var t,r,n=e[1],i=e[0],o=this.createKeyFunction(n,[g,b]),s=1/0,a=0;a<i.length;a++)(r=o(i[a]))<s&&(s=r,t=i[a]);return t},createKeyFunction:function(e,t){var r=this,n=this._interpreter;return function(i){var o=n.visit(e,i);if(t.indexOf(r._getTypeName(o))<0){var s=\"TypeError: expected one of \"+t+\", received \"+r._getTypeName(o);throw new Error(s)}return o}}},e.tokenize=d,e.compile=f,e.search=m,e.strictDeepEqual=n}(void 0===r?this.jmespath={}:r)},{}],87:[function(e,t,r){function n(){throw new Error(\"setTimeout has not been defined\")}function i(){throw new Error(\"clearTimeout has not been defined\")}function o(e){if(p===setTimeout)return setTimeout(e,0);if((p===n||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function s(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){v&&d&&(v=!1,d.length?m=d.concat(m):g=-1,m.length&&u())}function u(){if(!v){var e=o(a);v=!0;for(var t=m.length;t;){for(d=m,m=[];++g<t;)d&&d[g].run();g=-1,t=m.length}d=null,v=!1,s(e)}}function c(e,t){this.fun=e,this.array=t}function l(){}var p,h,f=t.exports={};!function(){try{p=\"function\"==typeof setTimeout?setTimeout:n}catch(e){p=n}try{h=\"function\"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var d,m=[],v=!1,g=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];m.push(new c(e,t)),1!==m.length||v||o(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title=\"browser\",f.browser=!0,f.env={},f.argv=[],f.version=\"\",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(e){return[]},f.binding=function(e){throw new Error(\"process.binding is not supported\")},f.cwd=function(){return\"/\"},f.chdir=function(e){throw new Error(\"process.chdir is not supported\")},f.umask=function(){return 0}},{}],88:[function(e,t,r){(function(e){(function(){!function(n){function i(e){throw RangeError(L[e])}function o(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function s(e,t){var r=e.split(\"@\"),n=\"\";return r.length>1&&(n=r[0]+\"@\",e=r[1]),e=e.replace(q,\".\"),n+o(e.split(\".\"),t).join(\".\")}function a(e){for(var t,r,n=[],i=0,o=e.length;i<o;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<o?(r=e.charCodeAt(i++),56320==(64512&r)?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--)):n.push(t);return n}function u(e){return o(e,function(e){var t=\"\";return e>65535&&(e-=65536,t+=U(e>>>10&1023|55296),e=56320|1023&e),t+=U(e)}).join(\"\")}function c(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:S}function l(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function p(e,t,r){var n=0;for(e=r?N(e/R):e>>1,e+=N(e/t);e>O*C>>1;n+=S)e=N(e/O);return N(n+(O+1)*e/(e+A))}function h(e){var t,r,n,o,s,a,l,h,f,d,m=[],v=e.length,g=0,y=T,b=x;for(r=e.lastIndexOf(I),r<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&i(\"not-basic\"),m.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<v;){for(s=g,a=1,l=S;o>=v&&i(\"invalid-input\"),h=c(e.charCodeAt(o++)),(h>=S||h>N((E-g)/a))&&i(\"overflow\"),g+=h*a,f=l<=b?_:l>=b+C?C:l-b,!(h<f);l+=S)d=S-f,a>N(E/d)&&i(\"overflow\"),a*=d;t=m.length+1,b=p(g-s,t,0==s),N(g/t)>E-y&&i(\"overflow\"),y+=N(g/t),g%=t,m.splice(g++,0,y)}return u(m)}function f(e){var t,r,n,o,s,u,c,h,f,d,m,v,g,y,b,w=[];for(e=a(e),v=e.length,t=T,r=0,s=x,u=0;u<v;++u)(m=e[u])<128&&w.push(U(m));for(n=o=w.length,o&&w.push(I);n<v;){for(c=E,u=0;u<v;++u)(m=e[u])>=t&&m<c&&(c=m);for(g=n+1,c-t>N((E-r)/g)&&i(\"overflow\"),r+=(c-t)*g,t=c,u=0;u<v;++u)if(m=e[u],m<t&&++r>E&&i(\"overflow\"),m==t){for(h=r,f=S;d=f<=s?_:f>=s+C?C:f-s,!(h<d);f+=S)b=h-d,y=S-d,w.push(U(l(d+b%y,0))),h=N(b/y);w.push(U(l(h,0))),s=p(r,g,n==o),r=0,++n}++r,++t}return w.join(\"\")}function d(e){return s(e,function(e){return k.test(e)?h(e.slice(4).toLowerCase()):e})}function m(e){return s(e,function(e){return P.test(e)?\"xn--\"+f(e):e})}var v=\"object\"==typeof r&&r&&!r.nodeType&&r,g=\"object\"==typeof t&&t&&!t.nodeType&&t,y=\"object\"==typeof e&&e;y.global!==y&&y.window!==y&&y.self!==y||(n=y);var b,w,E=2147483647,S=36,_=1,C=26,A=38,R=700,x=72,T=128,I=\"-\",k=/^xn--/,P=/[^\\x20-\\x7E]/,q=/[\\x2E\\u3002\\uFF0E\\uFF61]/g,L={overflow:\"Overflow: input needs wider integers to process\",\"not-basic\":\"Illegal input >= 0x80 (not a basic code point)\",\"invalid-input\":\"Invalid input\"},O=S-_,N=Math.floor,U=String.fromCharCode;if(b={version:\"1.3.2\",ucs2:{decode:a,encode:u},decode:h,encode:f,toASCII:m,toUnicode:d},\"function\"==typeof define&&\"object\"==typeof define.amd&&define.amd)define(\"punycode\",function(){return b});else if(v&&g)if(t.exports==v)g.exports=b;else for(w in b)b.hasOwnProperty(w)&&(v[w]=b[w]);else n.punycode=b}(this)}).call(this)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],89:[function(e,t,r){\"use strict\";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,o){t=t||\"&\",r=r||\"=\";var s={};if(\"string\"!=typeof e||0===e.length)return s;var a=/\\+/g;e=e.split(t);var u=1e3;o&&\"number\"==typeof o.maxKeys&&(u=o.maxKeys);var c=e.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var p,h,f,d,m=e[l].replace(a,\"%20\"),v=m.indexOf(r);v>=0?(p=m.substr(0,v),h=m.substr(v+1)):(p=m,h=\"\"),f=decodeURIComponent(p),d=decodeURIComponent(h),n(s,f)?i(s[f])?s[f].push(d):s[f]=[s[f],d]:s[f]=d}return s};var i=Array.isArray||function(e){return\"[object Array]\"===Object.prototype.toString.call(e)}},{}],90:[function(e,t,r){\"use strict\";function n(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var i=function(e){switch(typeof e){case\"string\":return e;case\"boolean\":return e?\"true\":\"false\";case\"number\":return isFinite(e)?e:\"\";default:return\"\"}};t.exports=function(e,t,r,a){return t=t||\"&\",r=r||\"=\",null===e&&(e=void 0),\"object\"==typeof e?n(s(e),function(s){var a=encodeURIComponent(i(s))+r;return o(e[s])?n(e[s],function(e){return a+encodeURIComponent(i(e))}).join(t):a+encodeURIComponent(i(e[s]))}).join(t):a?encodeURIComponent(i(a))+r+encodeURIComponent(i(e)):\"\"};var o=Array.isArray||function(e){return\"[object Array]\"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],91:[function(e,t,r){\"use strict\";r.decode=r.parse=e(\"./decode\"),r.encode=r.stringify=e(\"./encode\")},{\"./decode\":89,\"./encode\":90}],92:[function(e,t,r){\"use strict\";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,i){t=t||\"&\",r=r||\"=\";var o={};if(\"string\"!=typeof e||0===e.length)return o;var s=/\\+/g;e=e.split(t);var a=1e3;i&&\"number\"==typeof i.maxKeys&&(a=i.maxKeys);var u=e.length;a>0&&u>a&&(u=a);for(var c=0;c<u;++c){var l,p,h,f,d=e[c].replace(s,\"%20\"),m=d.indexOf(r);m>=0?(l=d.substr(0,m),p=d.substr(m+1)):(l=d,p=\"\"),h=decodeURIComponent(l),f=decodeURIComponent(p),n(o,h)?Array.isArray(o[h])?o[h].push(f):o[h]=[o[h],f]:o[h]=f}return o}},{}],93:[function(e,t,r){\"use strict\";var n=function(e){switch(typeof e){case\"string\":return e;case\"boolean\":return e?\"true\":\"false\";case\"number\":return isFinite(e)?e:\"\";default:return\"\"}};t.exports=function(e,t,r,i){return t=t||\"&\",r=r||\"=\",null===e&&(e=void 0),\"object\"==typeof e?Object.keys(e).map(function(i){var o=encodeURIComponent(n(i))+r;return Array.isArray(e[i])?e[i].map(function(e){return o+encodeURIComponent(n(e))}).join(t):o+encodeURIComponent(n(e[i]))}).join(t):i?encodeURIComponent(n(i))+r+encodeURIComponent(n(e)):\"\"}\n},{}],94:[function(e,t,r){arguments[4][91][0].apply(r,arguments)},{\"./decode\":92,\"./encode\":93,dup:91}],95:[function(e,t,r){(function(t,n){(function(){function i(e,t){this._id=e,this._clearFn=t}var o=e(\"process/browser.js\").nextTick,s=Function.prototype.apply,a=Array.prototype.slice,u={},c=0;r.setTimeout=function(){return new i(s.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new i(s.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r.setImmediate=\"function\"==typeof t?t:function(e){var t=c++,n=!(arguments.length<2)&&a.call(arguments,1);return u[t]=!0,o(function(){u[t]&&(n?e.apply(null,n):e.call(null),r.clearImmediate(t))}),t},r.clearImmediate=\"function\"==typeof n?n:function(e){delete u[e]}}).call(this)}).call(this,e(\"timers\").setImmediate,e(\"timers\").clearImmediate)},{\"process/browser.js\":87,timers:95}],96:[function(e,t,r){function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,r){if(e&&c(e)&&e instanceof n)return e;var i=new n;return i.parse(e,t,r),i}function o(e){return u(e)&&(e=i(e)),e instanceof n?e.format():n.prototype.format.call(e)}function s(e,t){return i(e,!1,!0).resolve(t)}function a(e,t){return e?i(e,!1,!0).resolveObject(t):t}function u(e){return\"string\"==typeof e}function c(e){return\"object\"==typeof e&&null!==e}function l(e){return null===e}function p(e){return null==e}var h=e(\"punycode\");r.parse=i,r.resolve=s,r.resolveObject=a,r.format=o,r.Url=n;var f=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,m=[\"<\",\">\",'\"',\"`\",\" \",\"\\r\",\"\\n\",\"\\t\"],v=[\"{\",\"}\",\"|\",\"\\\\\",\"^\",\"`\"].concat(m),g=[\"'\"].concat(v),y=[\"%\",\"/\",\"?\",\";\",\"#\"].concat(g),b=[\"/\",\"?\",\"#\"],w=/^[a-z0-9A-Z_-]{0,63}$/,E=/^([a-z0-9A-Z_-]{0,63})(.*)$/,S={javascript:!0,\"javascript:\":!0},_={javascript:!0,\"javascript:\":!0},C={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,\"http:\":!0,\"https:\":!0,\"ftp:\":!0,\"gopher:\":!0,\"file:\":!0},A=e(\"querystring\");n.prototype.parse=function(e,t,r){if(!u(e))throw new TypeError(\"Parameter 'url' must be a string, not \"+typeof e);var n=e;n=n.trim();var i=f.exec(n);if(i){i=i[0];var o=i.toLowerCase();this.protocol=o,n=n.substr(i.length)}if(r||i||n.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)){var s=\"//\"===n.substr(0,2);!s||i&&_[i]||(n=n.substr(2),this.slashes=!0)}if(!_[i]&&(s||i&&!C[i])){for(var a=-1,c=0;c<b.length;c++){var l=n.indexOf(b[c]);-1!==l&&(-1===a||l<a)&&(a=l)}var p,d;d=-1===a?n.lastIndexOf(\"@\"):n.lastIndexOf(\"@\",a),-1!==d&&(p=n.slice(0,d),n=n.slice(d+1),this.auth=decodeURIComponent(p)),a=-1;for(var c=0;c<y.length;c++){var l=n.indexOf(y[c]);-1!==l&&(-1===a||l<a)&&(a=l)}-1===a&&(a=n.length),this.host=n.slice(0,a),n=n.slice(a),this.parseHost(),this.hostname=this.hostname||\"\";var m=\"[\"===this.hostname[0]&&\"]\"===this.hostname[this.hostname.length-1];if(!m)for(var v=this.hostname.split(/\\./),c=0,R=v.length;c<R;c++){var x=v[c];if(x&&!x.match(w)){for(var T=\"\",I=0,k=x.length;I<k;I++)x.charCodeAt(I)>127?T+=\"x\":T+=x[I];if(!T.match(w)){var P=v.slice(0,c),q=v.slice(c+1),L=x.match(E);L&&(P.push(L[1]),q.unshift(L[2])),q.length&&(n=\"/\"+q.join(\".\")+n),this.hostname=P.join(\".\");break}}}if(this.hostname.length>255?this.hostname=\"\":this.hostname=this.hostname.toLowerCase(),!m){for(var O=this.hostname.split(\".\"),N=[],c=0;c<O.length;++c){var U=O[c];N.push(U.match(/[^A-Za-z0-9_-]/)?\"xn--\"+h.encode(U):U)}this.hostname=N.join(\".\")}var D=this.port?\":\"+this.port:\"\",M=this.hostname||\"\";this.host=M+D,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),\"/\"!==n[0]&&(n=\"/\"+n))}if(!S[o])for(var c=0,R=g.length;c<R;c++){var j=g[c],B=encodeURIComponent(j);B===j&&(B=escape(j)),n=n.split(j).join(B)}var F=n.indexOf(\"#\");-1!==F&&(this.hash=n.substr(F),n=n.slice(0,F));var z=n.indexOf(\"?\");if(-1!==z?(this.search=n.substr(z),this.query=n.substr(z+1),t&&(this.query=A.parse(this.query)),n=n.slice(0,z)):t&&(this.search=\"\",this.query={}),n&&(this.pathname=n),C[o]&&this.hostname&&!this.pathname&&(this.pathname=\"/\"),this.pathname||this.search){var D=this.pathname||\"\",U=this.search||\"\";this.path=D+U}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||\"\";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,\":\"),e+=\"@\");var t=this.protocol||\"\",r=this.pathname||\"\",n=this.hash||\"\",i=!1,o=\"\";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(\":\")?this.hostname:\"[\"+this.hostname+\"]\"),this.port&&(i+=\":\"+this.port)),this.query&&c(this.query)&&Object.keys(this.query).length&&(o=A.stringify(this.query));var s=this.search||o&&\"?\"+o||\"\";return t&&\":\"!==t.substr(-1)&&(t+=\":\"),this.slashes||(!t||C[t])&&!1!==i?(i=\"//\"+(i||\"\"),r&&\"/\"!==r.charAt(0)&&(r=\"/\"+r)):i||(i=\"\"),n&&\"#\"!==n.charAt(0)&&(n=\"#\"+n),s&&\"?\"!==s.charAt(0)&&(s=\"?\"+s),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace(\"#\",\"%23\"),t+i+r+s+n},n.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if(u(e)){var t=new n;t.parse(e,!1,!0),e=t}var r=new n;if(Object.keys(this).forEach(function(e){r[e]=this[e]},this),r.hash=e.hash,\"\"===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){\"protocol\"!==t&&(r[t]=e[t])}),C[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname=\"/\"),r.href=r.format(),r;if(e.protocol&&e.protocol!==r.protocol){if(!C[e.protocol])return Object.keys(e).forEach(function(t){r[t]=e[t]}),r.href=r.format(),r;if(r.protocol=e.protocol,e.host||_[e.protocol])r.pathname=e.pathname;else{for(var i=(e.pathname||\"\").split(\"/\");i.length&&!(e.host=i.shift()););e.host||(e.host=\"\"),e.hostname||(e.hostname=\"\"),\"\"!==i[0]&&i.unshift(\"\"),i.length<2&&i.unshift(\"\"),r.pathname=i.join(\"/\")}if(r.search=e.search,r.query=e.query,r.host=e.host||\"\",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var o=r.pathname||\"\",s=r.search||\"\";r.path=o+s}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var a=r.pathname&&\"/\"===r.pathname.charAt(0),c=e.host||e.pathname&&\"/\"===e.pathname.charAt(0),h=c||a||r.host&&e.pathname,f=h,d=r.pathname&&r.pathname.split(\"/\")||[],i=e.pathname&&e.pathname.split(\"/\")||[],m=r.protocol&&!C[r.protocol];if(m&&(r.hostname=\"\",r.port=null,r.host&&(\"\"===d[0]?d[0]=r.host:d.unshift(r.host)),r.host=\"\",e.protocol&&(e.hostname=null,e.port=null,e.host&&(\"\"===i[0]?i[0]=e.host:i.unshift(e.host)),e.host=null),h=h&&(\"\"===i[0]||\"\"===d[0])),c)r.host=e.host||\"\"===e.host?e.host:r.host,r.hostname=e.hostname||\"\"===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,d=i;else if(i.length)d||(d=[]),d.pop(),d=d.concat(i),r.search=e.search,r.query=e.query;else if(!p(e.search)){if(m){r.hostname=r.host=d.shift();var v=!!(r.host&&r.host.indexOf(\"@\")>0)&&r.host.split(\"@\");v&&(r.auth=v.shift(),r.host=r.hostname=v.shift())}return r.search=e.search,r.query=e.query,l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:\"\")+(r.search?r.search:\"\")),r.href=r.format(),r}if(!d.length)return r.pathname=null,r.search?r.path=\"/\"+r.search:r.path=null,r.href=r.format(),r;for(var g=d.slice(-1)[0],y=(r.host||e.host)&&(\".\"===g||\"..\"===g)||\"\"===g,b=0,w=d.length;w>=0;w--)g=d[w],\".\"==g?d.splice(w,1):\"..\"===g?(d.splice(w,1),b++):b&&(d.splice(w,1),b--);if(!h&&!f)for(;b--;b)d.unshift(\"..\");!h||\"\"===d[0]||d[0]&&\"/\"===d[0].charAt(0)||d.unshift(\"\"),y&&\"/\"!==d.join(\"/\").substr(-1)&&d.push(\"\");var E=\"\"===d[0]||d[0]&&\"/\"===d[0].charAt(0);if(m){r.hostname=r.host=E?\"\":d.length?d.shift():\"\";var v=!!(r.host&&r.host.indexOf(\"@\")>0)&&r.host.split(\"@\");v&&(r.auth=v.shift(),r.host=r.hostname=v.shift())}return h=h||r.host&&d.length,h&&!E&&d.unshift(\"\"),d.length?r.pathname=d.join(\"/\"):(r.pathname=null,r.path=null),l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:\"\")+(r.search?r.search:\"\")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var e=this.host,t=d.exec(e);t&&(t=t[0],\":\"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:88,querystring:91}],97:[function(e,t,r){\"function\"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],98:[function(e,t,r){t.exports=function(e){return e&&\"object\"==typeof e&&\"function\"==typeof e.copy&&\"function\"==typeof e.fill&&\"function\"==typeof e.readUInt8}},{}],99:[function(e,t,r){(function(t,n){(function(){function i(e,t){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(t)?n.showHidden=t:t&&r._extend(n,t),E(n.showHidden)&&(n.showHidden=!1),E(n.depth)&&(n.depth=2),E(n.colors)&&(n.colors=!1),E(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),u(n,e,n.depth)}function o(e,t){var r=i.styles[t];return r?\"\u001B[\"+i.colors[r][0]+\"m\"+e+\"\u001B[\"+i.colors[r][1]+\"m\":e}function s(e,t){return e}function a(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function u(e,t,n){if(e.customInspect&&t&&R(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return b(i)||(i=u(e,i,n)),i}var o=c(e,t);if(o)return o;var s=Object.keys(t),m=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),A(t)&&(s.indexOf(\"message\")>=0||s.indexOf(\"description\")>=0))return l(t);if(0===s.length){if(R(t)){var v=t.name?\": \"+t.name:\"\";return e.stylize(\"[Function\"+v+\"]\",\"special\")}if(S(t))return e.stylize(RegExp.prototype.toString.call(t),\"regexp\");if(C(t))return e.stylize(Date.prototype.toString.call(t),\"date\");if(A(t))return l(t)}var g=\"\",y=!1,w=[\"{\",\"}\"];if(d(t)&&(y=!0,w=[\"[\",\"]\"]),R(t)){g=\" [Function\"+(t.name?\": \"+t.name:\"\")+\"]\"}if(S(t)&&(g=\" \"+RegExp.prototype.toString.call(t)),C(t)&&(g=\" \"+Date.prototype.toUTCString.call(t)),A(t)&&(g=\" \"+l(t)),0===s.length&&(!y||0==t.length))return w[0]+g+w[1];if(n<0)return S(t)?e.stylize(RegExp.prototype.toString.call(t),\"regexp\"):e.stylize(\"[Object]\",\"special\");e.seen.push(t);var E;return E=y?p(e,t,n,m,s):s.map(function(r){return h(e,t,n,m,r,y)}),e.seen.pop(),f(E,g,w)}function c(e,t){if(E(t))return e.stylize(\"undefined\",\"undefined\");if(b(t)){var r=\"'\"+JSON.stringify(t).replace(/^\"|\"$/g,\"\").replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"')+\"'\";return e.stylize(r,\"string\")}return y(t)?e.stylize(\"\"+t,\"number\"):m(t)?e.stylize(\"\"+t,\"boolean\"):v(t)?e.stylize(\"null\",\"null\"):void 0}function l(e){return\"[\"+Error.prototype.toString.call(e)+\"]\"}function p(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)P(t,String(s))?o.push(h(e,t,r,n,String(s),!0)):o.push(\"\");return i.forEach(function(i){i.match(/^\\d+$/)||o.push(h(e,t,r,n,i,!0))}),o}function h(e,t,r,n,i,o){var s,a,c;if(c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},c.get?a=c.set?e.stylize(\"[Getter/Setter]\",\"special\"):e.stylize(\"[Getter]\",\"special\"):c.set&&(a=e.stylize(\"[Setter]\",\"special\")),P(n,i)||(s=\"[\"+i+\"]\"),a||(e.seen.indexOf(c.value)<0?(a=v(r)?u(e,c.value,null):u(e,c.value,r-1),a.indexOf(\"\\n\")>-1&&(a=o?a.split(\"\\n\").map(function(e){return\"  \"+e}).join(\"\\n\").substr(2):\"\\n\"+a.split(\"\\n\").map(function(e){return\"   \"+e}).join(\"\\n\"))):a=e.stylize(\"[Circular]\",\"special\")),E(s)){if(o&&i.match(/^\\d+$/))return a;s=JSON.stringify(\"\"+i),s.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,\"name\")):(s=s.replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"').replace(/(^\"|\"$)/g,\"'\"),s=e.stylize(s,\"string\"))}return s+\": \"+a}function f(e,t,r){var n=0;return e.reduce(function(e,t){return n++,t.indexOf(\"\\n\")>=0&&n++,e+t.replace(/\\u001b\\[\\d\\d?m/g,\"\").length+1},0)>60?r[0]+(\"\"===t?\"\":t+\"\\n \")+\" \"+e.join(\",\\n  \")+\" \"+r[1]:r[0]+t+\" \"+e.join(\", \")+\" \"+r[1]}function d(e){return Array.isArray(e)}function m(e){return\"boolean\"==typeof e}function v(e){return null===e}function g(e){return null==e}function y(e){return\"number\"==typeof e}function b(e){return\"string\"==typeof e}function w(e){return\"symbol\"==typeof e}function E(e){return void 0===e}function S(e){return _(e)&&\"[object RegExp]\"===T(e)}function _(e){return\"object\"==typeof e&&null!==e}function C(e){return _(e)&&\"[object Date]\"===T(e)}function A(e){return _(e)&&(\"[object Error]\"===T(e)||e instanceof Error)}function R(e){return\"function\"==typeof e}function x(e){return null===e||\"boolean\"==typeof e||\"number\"==typeof e||\"string\"==typeof e||\"symbol\"==typeof e||void 0===e}function T(e){return Object.prototype.toString.call(e)}function I(e){return e<10?\"0\"+e.toString(10):e.toString(10)}function k(){var e=new Date,t=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(\":\");return[e.getDate(),N[e.getMonth()],t].join(\" \")}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var q=/%[sdj%]/g;r.format=function(e){if(!b(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(i(arguments[r]));return t.join(\" \")}for(var r=1,n=arguments,o=n.length,s=String(e).replace(q,function(e){if(\"%%\"===e)return\"%\";if(r>=o)return e;switch(e){case\"%s\":return String(n[r++]);case\"%d\":return Number(n[r++]);case\"%j\":try{return JSON.stringify(n[r++])}catch(e){return\"[Circular]\"}default:return e}}),a=n[r];r<o;a=n[++r])v(a)||!_(a)?s+=\" \"+a:s+=\" \"+i(a);return s},r.deprecate=function(e,i){function o(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}if(E(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var s=!1;return o};var L,O={};r.debuglog=function(e){if(E(L)&&(L=t.env.NODE_DEBUG||\"\"),e=e.toUpperCase(),!O[e])if(new RegExp(\"\\\\b\"+e+\"\\\\b\",\"i\").test(L)){var n=t.pid;O[e]=function(){var t=r.format.apply(r,arguments);console.error(\"%s %d: %s\",e,n,t)}}else O[e]=function(){};return O[e]},r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:\"cyan\",number:\"yellow\",boolean:\"yellow\",undefined:\"grey\",null:\"bold\",string:\"green\",date:\"magenta\",regexp:\"red\"},r.isArray=d,r.isBoolean=m,r.isNull=v,r.isNullOrUndefined=g,r.isNumber=y,r.isString=b,r.isSymbol=w,r.isUndefined=E,r.isRegExp=S,r.isObject=_,r.isDate=C,r.isError=A,r.isFunction=R,r.isPrimitive=x,r.isBuffer=e(\"./support/isBuffer\");var N=[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];r.log=function(){console.log(\"%s - %s\",k(),r.format.apply(r,arguments))},r.inherits=e(\"inherits\"),r._extend=function(e,t){if(!t||!_(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this)}).call(this,e(\"_process\"),\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./support/isBuffer\":98,_process:87,inherits:97}],100:[function(e,t,r){var n=e(\"./v1\"),i=e(\"./v4\"),o=i;o.v1=n,o.v4=i,t.exports=o},{\"./v1\":103,\"./v4\":104}],101:[function(e,t,r){function n(e,t){var r=t||0,n=i;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],\"-\",n[e[r++]],n[e[r++]],\"-\",n[e[r++]],n[e[r++]],\"-\",n[e[r++]],n[e[r++]],\"-\",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join(\"\")}for(var i=[],o=0;o<256;++o)i[o]=(o+256).toString(16).substr(1);t.exports=n},{}],102:[function(e,t,r){var n=\"undefined\"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||\"undefined\"!=typeof msCrypto&&\"function\"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var o=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},{}],103:[function(e,t,r){function n(e,t,r){var n=t&&r||0,l=t||[];e=e||{};var p=e.node||i,h=void 0!==e.clockseq?e.clockseq:o;if(null==p||null==h){var f=s();null==p&&(p=i=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=o=16383&(f[6]<<8|f[7]))}var d=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,v=d-u+(m-c)/1e4;if(v<0&&void 0===e.clockseq&&(h=h+1&16383),(v<0||d>u)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");u=d,c=m,o=h,d+=122192928e5;var g=(1e4*(268435455&d)+m)%4294967296;l[n++]=g>>>24&255,l[n++]=g>>>16&255,l[n++]=g>>>8&255,l[n++]=255&g;var y=d/4294967296*1e4&268435455;l[n++]=y>>>8&255,l[n++]=255&y,l[n++]=y>>>24&15|16,l[n++]=y>>>16&255,l[n++]=h>>>8|128,l[n++]=255&h;for(var b=0;b<6;++b)l[n+b]=p[b];return t||a(l)}var i,o,s=e(\"./lib/rng\"),a=e(\"./lib/bytesToUuid\"),u=0,c=0;t.exports=n},{\"./lib/bytesToUuid\":101,\"./lib/rng\":102}],104:[function(e,t,r){function n(e,t,r){var n=t&&r||0;\"string\"==typeof e&&(t=\"binary\"===e?new Array(16):null,e=null),e=e||{};var s=e.random||(e.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[n+a]=s[a];return t||o(s)}var i=e(\"./lib/rng\"),o=e(\"./lib/bytesToUuid\");t.exports=n},{\"./lib/bytesToUuid\":101,\"./lib/rng\":102}],105:[function(e,t,r){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0});var n=e(\"./utils/LRU\"),i=1e3,o=function(){function e(e){void 0===e&&(e=i),this.maxSize=e,this.cache=new n.LRUCache(e)}return Object.defineProperty(e.prototype,\"size\",{get:function(){return this.cache.length},enumerable:!0,configurable:!0}),e.prototype.put=function(t,r){var n=\"string\"!=typeof t?e.getKeyString(t):t,i=this.populateValue(r);this.cache.put(n,i)},e.prototype.get=function(t){var r=\"string\"!=typeof t?e.getKeyString(t):t,n=Date.now(),i=this.cache.get(r);if(i)for(var o=0;o<i.length;o++){var s=i[o];if(s.Expire<n)return void this.cache.remove(r)}return i},e.getKeyString=function(e){for(var t=[],r=Object.keys(e).sort(),n=0;n<r.length;n++){var i=r[n];void 0!==e[i]&&t.push(e[i])}return t.join(\" \")},e.prototype.populateValue=function(e){var t=Date.now();return e.map(function(e){return{Address:e.Address||\"\",Expire:t+60*(e.CachePeriodInMinutes||1)*1e3}})},e.prototype.empty=function(){this.cache.empty()},e.prototype.remove=function(t){var r=\"string\"!=typeof t?e.getKeyString(t):t;this.cache.remove(r)},e}();r.EndpointCache=o},{\"./utils/LRU\":106}],106:[function(e,t,r){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0});var n=function(){function e(e,t){this.key=e,this.value=t}return e}(),i=function(){function e(e){if(this.nodeMap={},this.size=0,\"number\"!=typeof e||e<1)throw new Error(\"Cache size can only be positive number\");this.sizeLimit=e}return Object.defineProperty(e.prototype,\"length\",{get:function(){return this.size},enumerable:!0,configurable:!0}),e.prototype.prependToList=function(e){this.headerNode?(this.headerNode.prev=e,e.next=this.headerNode):this.tailNode=e,this.headerNode=e,this.size++},e.prototype.removeFromTail=function(){if(this.tailNode){var e=this.tailNode,t=e.prev;return t&&(t.next=void 0),e.prev=void 0,this.tailNode=t,this.size--,e}},e.prototype.detachFromList=function(e){this.headerNode===e&&(this.headerNode=e.next),this.tailNode===e&&(this.tailNode=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.next=void 0,e.prev=void 0,this.size--},e.prototype.get=function(e){if(this.nodeMap[e]){var t=this.nodeMap[e];return this.detachFromList(t),this.prependToList(t),t.value}},e.prototype.remove=function(e){if(this.nodeMap[e]){var t=this.nodeMap[e];this.detachFromList(t),delete this.nodeMap[e]}},e.prototype.put=function(e,t){if(this.nodeMap[e])this.remove(e);else if(this.size===this.sizeLimit){var r=this.removeFromTail(),i=r.key;delete this.nodeMap[i]}var o=new n(e,t);this.nodeMap[e]=o,this.prependToList(o)},e.prototype.empty=function(){for(var e=Object.keys(this.nodeMap),t=0;t<e.length;t++){var r=e[t],n=this.nodeMap[r];this.detachFromList(n),delete this.nodeMap[r]}},e}();r.LRUCache=i},{}],107:[function(e,t,r){e(\"./browser_loader\");var n=e(\"./core\");\"undefined\"!=typeof window&&(window.AWS=n),void 0!==t&&(t.exports=n),\"undefined\"!=typeof self&&(self.AWS=n),Object.prototype.hasOwnProperty.call(n,\"ConnectParticipant\")||(n.apiLoader.services.connectparticipant={},n.ConnectParticipant=n.Service.defineService(\"connectparticipant\",[\"2018-09-07\"])),n.apiLoader.services.connectparticipant[\"2018-09-07\"]=e(\"../apis/connectparticipant-2018-09-07.min\"),n.apiLoader.services.connectparticipant[\"2018-09-07\"].paginators=e(\"../apis/connectparticipant-2018-09-07.paginators\").pagination,Object.prototype.hasOwnProperty.call(n,\"STS\")||(n.apiLoader.services.sts={},n.STS=n.Service.defineService(\"sts\",[\"2011-06-15\"]),e(\"./services/sts\"))},{\"../apis/connectparticipant-2018-09-07.min\":3,\"../apis/connectparticipant-2018-09-07.paginators\":4,\"../apis/sts-2011-06-15.min\":6,\"./browser_loader\":17,\"./core\":20,\"./services/sts\":63}]},{},[107]);\n"
            }
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "ace6619fd081fa9d:1",
        "primaryLocationStartColumnFingerprint" : "5344"
      }
    }, {
      "ruleId" : "js/incomplete-sanitization",
      "rule" : {
        "id" : "js/incomplete-sanitization",
        "index" : 39,
        "toolComponent" : {
          "index" : 4
        }
      },
      "message" : {
        "text" : "This replaces only the first occurrence of /%3A/i."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "dist/amazon-connect-chat.js",
            "uriBaseId" : "%SRCROOT%",
            "index" : 1
          },
          "region" : {
            "startLine" : 1,
            "startColumn" : 227427,
            "endColumn" : 227460
          },
          "contextRegion" : {
            "startLine" : 1,
            "endLine" : 2,
            "snippet" : {
              "text" : "(()=>{var e={228:(e,t,n)=>{var r;!function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){if(o)return o(s,!0);var c=new Error(\"Cannot find module '\"+s+\"'\");throw c.code=\"MODULE_NOT_FOUND\",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,(function(e){return i(t[s][1][e]||e)}),u,u.exports,e,t,n,r)}return n[s].exports}for(var o=void 0,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){t.exports={version:\"2.0\",metadata:{apiVersion:\"2014-06-30\",endpointPrefix:\"cognito-identity\",jsonVersion:\"1.1\",protocol:\"json\",serviceFullName:\"Amazon Cognito Identity\",serviceId:\"Cognito Identity\",signatureVersion:\"v4\",targetPrefix:\"AWSCognitoIdentityService\",uid:\"cognito-identity-2014-06-30\"},operations:{CreateIdentityPool:{input:{type:\"structure\",required:[\"IdentityPoolName\",\"AllowUnauthenticatedIdentities\"],members:{IdentityPoolName:{},AllowUnauthenticatedIdentities:{type:\"boolean\"},AllowClassicFlow:{type:\"boolean\"},SupportedLoginProviders:{shape:\"S5\"},DeveloperProviderName:{},OpenIdConnectProviderARNs:{shape:\"S9\"},CognitoIdentityProviders:{shape:\"Sb\"},SamlProviderARNs:{shape:\"Sg\"},IdentityPoolTags:{shape:\"Sh\"}}},output:{shape:\"Sk\"}},DeleteIdentities:{input:{type:\"structure\",required:[\"IdentityIdsToDelete\"],members:{IdentityIdsToDelete:{type:\"list\",member:{}}}},output:{type:\"structure\",members:{UnprocessedIdentityIds:{type:\"list\",member:{type:\"structure\",members:{IdentityId:{},ErrorCode:{}}}}}}},DeleteIdentityPool:{input:{type:\"structure\",required:[\"IdentityPoolId\"],members:{IdentityPoolId:{}}}},DescribeIdentity:{input:{type:\"structure\",required:[\"IdentityId\"],members:{IdentityId:{}}},output:{shape:\"Sv\"}},DescribeIdentityPool:{input:{type:\"structure\",required:[\"IdentityPoolId\"],members:{IdentityPoolId:{}}},output:{shape:\"Sk\"}},GetCredentialsForIdentity:{input:{type:\"structure\",required:[\"IdentityId\"],members:{IdentityId:{},Logins:{shape:\"S10\"},CustomRoleArn:{}}},output:{type:\"structure\",members:{IdentityId:{},Credentials:{type:\"structure\",members:{AccessKeyId:{},SecretKey:{},SessionToken:{},Expiration:{type:\"timestamp\"}}}}}},GetId:{input:{type:\"structure\",required:[\"IdentityPoolId\"],members:{AccountId:{},IdentityPoolId:{},Logins:{shape:\"S10\"}}},output:{type:\"structure\",members:{IdentityId:{}}}},GetIdentityPoolRoles:{input:{type:\"structure\",required:[\"IdentityPoolId\"],members:{IdentityPoolId:{}}},output:{type:\"structure\",members:{IdentityPoolId:{},Roles:{shape:\"S1c\"},RoleMappings:{shape:\"S1e\"}}}},GetOpenIdToken:{input:{type:\"structure\",required:[\"IdentityId\"],members:{IdentityId:{},Logins:{shape:\"S10\"}}},output:{type:\"structure\",members:{IdentityId:{},Token:{}}}},GetOpenIdTokenForDeveloperIdentity:{input:{type:\"structure\",required:[\"IdentityPoolId\",\"Logins\"],members:{IdentityPoolId:{},IdentityId:{},Logins:{shape:\"S10\"},TokenDuration:{type:\"long\"}}},output:{type:\"structure\",members:{IdentityId:{},Token:{}}}},ListIdentities:{input:{type:\"structure\",required:[\"IdentityPoolId\",\"MaxResults\"],members:{IdentityPoolId:{},MaxResults:{type:\"integer\"},NextToken:{},HideDisabled:{type:\"boolean\"}}},output:{type:\"structure\",members:{IdentityPoolId:{},Identities:{type:\"list\",member:{shape:\"Sv\"}},NextToken:{}}}},ListIdentityPools:{input:{type:\"structure\",required:[\"MaxResults\"],members:{MaxResults:{type:\"integer\"},NextToken:{}}},output:{type:\"structure\",members:{IdentityPools:{type:\"list\",member:{type:\"structure\",members:{IdentityPoolId:{},IdentityPoolName:{}}}},NextToken:{}}}},ListTagsForResource:{input:{type:\"structure\",required:[\"ResourceArn\"],members:{ResourceArn:{}}},output:{type:\"structure\",members:{Tags:{shape:\"Sh\"}}}},LookupDeveloperIdentity:{input:{type:\"structure\",required:[\"IdentityPoolId\"],members:{IdentityPoolId:{},IdentityId:{},DeveloperUserIdentifier:{},MaxResults:{type:\"integer\"},NextToken:{}}},output:{type:\"structure\",members:{IdentityId:{},DeveloperUserIdentifierList:{type:\"list\",member:{}},NextToken:{}}}},MergeDeveloperIdentities:{input:{type:\"structure\",required:[\"SourceUserIdentifier\",\"DestinationUserIdentifier\",\"DeveloperProviderName\",\"IdentityPoolId\"],members:{SourceUserIdentifier:{},DestinationUserIdentifier:{},DeveloperProviderName:{},IdentityPoolId:{}}},output:{type:\"structure\",members:{IdentityId:{}}}},SetIdentityPoolRoles:{input:{type:\"structure\",required:[\"IdentityPoolId\",\"Roles\"],members:{IdentityPoolId:{},Roles:{shape:\"S1c\"},RoleMappings:{shape:\"S1e\"}}}},TagResource:{input:{type:\"structure\",required:[\"ResourceArn\",\"Tags\"],members:{ResourceArn:{},Tags:{shape:\"Sh\"}}},output:{type:\"structure\",members:{}}},UnlinkDeveloperIdentity:{input:{type:\"structure\",required:[\"IdentityId\",\"IdentityPoolId\",\"DeveloperProviderName\",\"DeveloperUserIdentifier\"],members:{IdentityId:{},IdentityPoolId:{},DeveloperProviderName:{},DeveloperUserIdentifier:{}}}},UnlinkIdentity:{input:{type:\"structure\",required:[\"IdentityId\",\"Logins\",\"LoginsToRemove\"],members:{IdentityId:{},Logins:{shape:\"S10\"},LoginsToRemove:{shape:\"Sw\"}}}},UntagResource:{input:{type:\"structure\",required:[\"ResourceArn\",\"TagKeys\"],members:{ResourceArn:{},TagKeys:{type:\"list\",member:{}}}},output:{type:\"structure\",members:{}}},UpdateIdentityPool:{input:{shape:\"Sk\"},output:{shape:\"Sk\"}}},shapes:{S5:{type:\"map\",key:{},value:{}},S9:{type:\"list\",member:{}},Sb:{type:\"list\",member:{type:\"structure\",members:{ProviderName:{},ClientId:{},ServerSideTokenCheck:{type:\"boolean\"}}}},Sg:{type:\"list\",member:{}},Sh:{type:\"map\",key:{},value:{}},Sk:{type:\"structure\",required:[\"IdentityPoolId\",\"IdentityPoolName\",\"AllowUnauthenticatedIdentities\"],members:{IdentityPoolId:{},IdentityPoolName:{},AllowUnauthenticatedIdentities:{type:\"boolean\"},AllowClassicFlow:{type:\"boolean\"},SupportedLoginProviders:{shape:\"S5\"},DeveloperProviderName:{},OpenIdConnectProviderARNs:{shape:\"S9\"},CognitoIdentityProviders:{shape:\"Sb\"},SamlProviderARNs:{shape:\"Sg\"},IdentityPoolTags:{shape:\"Sh\"}}},Sv:{type:\"structure\",members:{IdentityId:{},Logins:{shape:\"Sw\"},CreationDate:{type:\"timestamp\"},LastModifiedDate:{type:\"timestamp\"}}},Sw:{type:\"list\",member:{}},S10:{type:\"map\",key:{},value:{}},S1c:{type:\"map\",key:{},value:{}},S1e:{type:\"map\",key:{},value:{type:\"structure\",required:[\"Type\"],members:{Type:{},AmbiguousRoleResolution:{},RulesConfiguration:{type:\"structure\",required:[\"Rules\"],members:{Rules:{type:\"list\",member:{type:\"structure\",required:[\"Claim\",\"MatchType\",\"Value\",\"RoleARN\"],members:{Claim:{},MatchType:{},Value:{},RoleARN:{}}}}}}}}}}}},{}],2:[function(e,t,n){t.exports={pagination:{}}},{}],3:[function(e,t,n){t.exports={version:\"2.0\",metadata:{apiVersion:\"2018-09-07\",endpointPrefix:\"participant.connect\",jsonVersion:\"1.1\",protocol:\"rest-json\",serviceAbbreviation:\"Amazon Connect Participant\",serviceFullName:\"Amazon Connect Participant Service\",serviceId:\"ConnectParticipant\",signatureVersion:\"v4\",signingName:\"execute-api\",uid:\"connectparticipant-2018-09-07\"},operations:{CompleteAttachmentUpload:{http:{requestUri:\"/participant/complete-attachment-upload\"},input:{type:\"structure\",required:[\"AttachmentIds\",\"ClientToken\",\"ConnectionToken\"],members:{AttachmentIds:{type:\"list\",member:{}},ClientToken:{idempotencyToken:!0},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{}}},CreateParticipantConnection:{http:{requestUri:\"/participant/connection\"},input:{type:\"structure\",required:[\"Type\",\"ParticipantToken\"],members:{Type:{type:\"list\",member:{}},ParticipantToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{Websocket:{type:\"structure\",members:{Url:{},ConnectionExpiry:{}}},ConnectionCredentials:{type:\"structure\",members:{ConnectionToken:{},Expiry:{}}}}}},DisconnectParticipant:{http:{requestUri:\"/participant/disconnect\"},input:{type:\"structure\",required:[\"ConnectionToken\"],members:{ClientToken:{idempotencyToken:!0},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{}}},GetAttachment:{http:{requestUri:\"/participant/attachment\"},input:{type:\"structure\",required:[\"AttachmentId\",\"ConnectionToken\"],members:{AttachmentId:{},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{Url:{},UrlExpiry:{}}}},GetTranscript:{http:{requestUri:\"/participant/transcript\"},input:{type:\"structure\",required:[\"ConnectionToken\"],members:{ContactId:{},MaxResults:{type:\"integer\"},NextToken:{},ScanDirection:{},SortOrder:{},StartPosition:{type:\"structure\",members:{Id:{},AbsoluteTime:{},MostRecent:{type:\"integer\"}}},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{InitialContactId:{},Transcript:{type:\"list\",member:{type:\"structure\",members:{AbsoluteTime:{},Content:{},ContentType:{},Id:{},Type:{},ParticipantId:{},DisplayName:{},ParticipantRole:{},Attachments:{type:\"list\",member:{type:\"structure\",members:{ContentType:{},AttachmentId:{},AttachmentName:{},Status:{}}}}}}},NextToken:{}}}},SendEvent:{http:{requestUri:\"/participant/event\"},input:{type:\"structure\",required:[\"ContentType\",\"ConnectionToken\"],members:{ContentType:{},Content:{},ClientToken:{idempotencyToken:!0},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{Id:{},AbsoluteTime:{}}}},SendMessage:{http:{requestUri:\"/participant/message\"},input:{type:\"structure\",required:[\"ContentType\",\"Content\",\"ConnectionToken\"],members:{ContentType:{},Content:{},ClientToken:{idempotencyToken:!0},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{Id:{},AbsoluteTime:{}}}},StartAttachmentUpload:{http:{requestUri:\"/participant/start-attachment-upload\"},input:{type:\"structure\",required:[\"ContentType\",\"AttachmentSizeInBytes\",\"AttachmentName\",\"ClientToken\",\"ConnectionToken\"],members:{ContentType:{},AttachmentSizeInBytes:{type:\"long\"},AttachmentName:{},ClientToken:{idempotencyToken:!0},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{AttachmentId:{},UploadMetadata:{type:\"structure\",members:{Url:{},UrlExpiry:{},HeadersToInclude:{type:\"map\",key:{},value:{}}}}}}}},shapes:{}}},{}],4:[function(e,t,n){t.exports={pagination:{GetTranscript:{input_token:\"NextToken\",output_token:\"NextToken\",limit_key:\"MaxResults\"}}}},{}],5:[function(e,t,n){t.exports={acm:{name:\"ACM\",cors:!0},apigateway:{name:\"APIGateway\",cors:!0},applicationautoscaling:{prefix:\"application-autoscaling\",name:\"ApplicationAutoScaling\",cors:!0},appstream:{name:\"AppStream\"},autoscaling:{name:\"AutoScaling\",cors:!0},batch:{name:\"Batch\"},budgets:{name:\"Budgets\"},clouddirectory:{name:\"CloudDirectory\",versions:[\"2016-05-10*\"]},cloudformation:{name:\"CloudFormation\",cors:!0},cloudfront:{name:\"CloudFront\",versions:[\"2013-05-12*\",\"2013-11-11*\",\"2014-05-31*\",\"2014-10-21*\",\"2014-11-06*\",\"2015-04-17*\",\"2015-07-27*\",\"2015-09-17*\",\"2016-01-13*\",\"2016-01-28*\",\"2016-08-01*\",\"2016-08-20*\",\"2016-09-07*\",\"2016-09-29*\",\"2016-11-25*\",\"2017-03-25*\",\"2017-10-30*\",\"2018-06-18*\",\"2018-11-05*\",\"2019-03-26*\"],cors:!0},cloudhsm:{name:\"CloudHSM\",cors:!0},cloudsearch:{name:\"CloudSearch\"},cloudsearchdomain:{name:\"CloudSearchDomain\"},cloudtrail:{name:\"CloudTrail\",cors:!0},cloudwatch:{prefix:\"monitoring\",name:\"CloudWatch\",cors:!0},cloudwatchevents:{prefix:\"events\",name:\"CloudWatchEvents\",versions:[\"2014-02-03*\"],cors:!0},cloudwatchlogs:{prefix:\"logs\",name:\"CloudWatchLogs\",cors:!0},codebuild:{name:\"CodeBuild\",cors:!0},codecommit:{name:\"CodeCommit\",cors:!0},codedeploy:{name:\"CodeDeploy\",cors:!0},codepipeline:{name:\"CodePipeline\",cors:!0},cognitoidentity:{prefix:\"cognito-identity\",name:\"CognitoIdentity\",cors:!0},cognitoidentityserviceprovider:{prefix:\"cognito-idp\",name:\"CognitoIdentityServiceProvider\",cors:!0},cognitosync:{prefix:\"cognito-sync\",name:\"CognitoSync\",cors:!0},configservice:{prefix:\"config\",name:\"ConfigService\",cors:!0},cur:{name:\"CUR\",cors:!0},datapipeline:{name:\"DataPipeline\"},devicefarm:{name:\"DeviceFarm\",cors:!0},directconnect:{name:\"DirectConnect\",cors:!0},directoryservice:{prefix:\"ds\",name:\"DirectoryService\"},discovery:{name:\"Discovery\"},dms:{name:\"DMS\"},dynamodb:{name:\"DynamoDB\",cors:!0},dynamodbstreams:{prefix:\"streams.dynamodb\",name:\"DynamoDBStreams\",cors:!0},ec2:{name:\"EC2\",versions:[\"2013-06-15*\",\"2013-10-15*\",\"2014-02-01*\",\"2014-05-01*\",\"2014-06-15*\",\"2014-09-01*\",\"2014-10-01*\",\"2015-03-01*\",\"2015-04-15*\",\"2015-10-01*\",\"2016-04-01*\",\"2016-09-15*\"],cors:!0},ecr:{name:\"ECR\",cors:!0},ecs:{name:\"ECS\",cors:!0},efs:{prefix:\"elasticfilesystem\",name:\"EFS\",cors:!0},elasticache:{name:\"ElastiCache\",versions:[\"2012-11-15*\",\"2014-03-24*\",\"2014-07-15*\",\"2014-09-30*\"],cors:!0},elasticbeanstalk:{name:\"ElasticBeanstalk\",cors:!0},elb:{prefix:\"elasticloadbalancing\",name:\"ELB\",cors:!0},elbv2:{prefix:\"elasticloadbalancingv2\",name:\"ELBv2\",cors:!0},emr:{prefix:\"elasticmapreduce\",name:\"EMR\",cors:!0},es:{name:\"ES\"},elastictranscoder:{name:\"ElasticTranscoder\",cors:!0},firehose:{name:\"Firehose\",cors:!0},gamelift:{name:\"GameLift\",cors:!0},glacier:{name:\"Glacier\"},health:{name:\"Health\"},iam:{name:\"IAM\",cors:!0},importexport:{name:\"ImportExport\"},inspector:{name:\"Inspector\",versions:[\"2015-08-18*\"],cors:!0},iot:{name:\"Iot\",cors:!0},iotdata:{prefix:\"iot-data\",name:\"IotData\",cors:!0},kinesis:{name:\"Kinesis\",cors:!0},kinesisanalytics:{name:\"KinesisAnalytics\"},kms:{name:\"KMS\",cors:!0},lambda:{name:\"Lambda\",cors:!0},lexruntime:{prefix:\"runtime.lex\",name:\"LexRuntime\",cors:!0},lightsail:{name:\"Lightsail\"},machinelearning:{name:\"MachineLearning\",cors:!0},marketplacecommerceanalytics:{name:\"MarketplaceCommerceAnalytics\",cors:!0},marketplacemetering:{prefix:\"meteringmarketplace\",name:\"MarketplaceMetering\"},mturk:{prefix:\"mturk-requester\",name:\"MTurk\",cors:!0},mobileanalytics:{name:\"MobileAnalytics\",cors:!0},opsworks:{name:\"OpsWorks\",cors:!0},opsworkscm:{name:\"OpsWorksCM\"},organizations:{name:\"Organizations\"},pinpoint:{name:\"Pinpoint\"},polly:{name:\"Polly\",cors:!0},rds:{name:\"RDS\",versions:[\"2014-09-01*\"],cors:!0},redshift:{name:\"Redshift\",cors:!0},rekognition:{name:\"Rekognition\",cors:!0},resourcegroupstaggingapi:{name:\"ResourceGroupsTaggingAPI\"},route53:{name:\"Route53\",cors:!0},route53domains:{name:\"Route53Domains\",cors:!0},s3:{name:\"S3\",dualstackAvailable:!0,cors:!0},s3control:{name:\"S3Control\",dualstackAvailable:!0,xmlNoDefaultLists:!0},servicecatalog:{name:\"ServiceCatalog\",cors:!0},ses:{prefix:\"email\",name:\"SES\",cors:!0},shield:{name:\"Shield\"},simpledb:{prefix:\"sdb\",name:\"SimpleDB\"},sms:{name:\"SMS\"},snowball:{name:\"Snowball\"},sns:{name:\"SNS\",cors:!0},sqs:{name:\"SQS\",cors:!0},ssm:{name:\"SSM\",cors:!0},storagegateway:{name:\"StorageGateway\",cors:!0},stepfunctions:{prefix:\"states\",name:\"StepFunctions\"},sts:{name:\"STS\",cors:!0},support:{name:\"Support\"},swf:{name:\"SWF\"},xray:{name:\"XRay\",cors:!0},waf:{name:\"WAF\",cors:!0},wafregional:{prefix:\"waf-regional\",name:\"WAFRegional\"},workdocs:{name:\"WorkDocs\",cors:!0},workspaces:{name:\"WorkSpaces\"},codestar:{name:\"CodeStar\"},lexmodelbuildingservice:{prefix:\"lex-models\",name:\"LexModelBuildingService\",cors:!0},marketplaceentitlementservice:{prefix:\"entitlement.marketplace\",name:\"MarketplaceEntitlementService\"},athena:{name:\"Athena\"},greengrass:{name:\"Greengrass\"},dax:{name:\"DAX\"},migrationhub:{prefix:\"AWSMigrationHub\",name:\"MigrationHub\"},cloudhsmv2:{name:\"CloudHSMV2\"},glue:{name:\"Glue\"},mobile:{name:\"Mobile\"},pricing:{name:\"Pricing\",cors:!0},costexplorer:{prefix:\"ce\",name:\"CostExplorer\",cors:!0},mediaconvert:{name:\"MediaConvert\"},medialive:{name:\"MediaLive\"},mediapackage:{name:\"MediaPackage\"},mediastore:{name:\"MediaStore\"},mediastoredata:{prefix:\"mediastore-data\",name:\"MediaStoreData\",cors:!0},appsync:{name:\"AppSync\"},guardduty:{name:\"GuardDuty\"},mq:{name:\"MQ\"},comprehend:{name:\"Comprehend\",cors:!0},iotjobsdataplane:{prefix:\"iot-jobs-data\",name:\"IoTJobsDataPlane\"},kinesisvideoarchivedmedia:{prefix:\"kinesis-video-archived-media\",name:\"KinesisVideoArchivedMedia\",cors:!0},kinesisvideomedia:{prefix:\"kinesis-video-media\",name:\"KinesisVideoMedia\",cors:!0},kinesisvideo:{name:\"KinesisVideo\",cors:!0},sagemakerruntime:{prefix:\"runtime.sagemaker\",name:\"SageMakerRuntime\"},sagemaker:{name:\"SageMaker\"},translate:{name:\"Translate\",cors:!0},resourcegroups:{prefix:\"resource-groups\",name:\"ResourceGroups\",cors:!0},alexaforbusiness:{name:\"AlexaForBusiness\"},cloud9:{name:\"Cloud9\"},serverlessapplicationrepository:{prefix:\"serverlessrepo\",name:\"ServerlessApplicationRepository\"},servicediscovery:{name:\"ServiceDiscovery\"},workmail:{name:\"WorkMail\"},autoscalingplans:{prefix:\"autoscaling-plans\",name:\"AutoScalingPlans\"},transcribeservice:{prefix:\"transcribe\",name:\"TranscribeService\"},connect:{name:\"Connect\",cors:!0},acmpca:{prefix:\"acm-pca\",name:\"ACMPCA\"},fms:{name:\"FMS\"},secretsmanager:{name:\"SecretsManager\",cors:!0},iotanalytics:{name:\"IoTAnalytics\",cors:!0},iot1clickdevicesservice:{prefix:\"iot1click-devices\",name:\"IoT1ClickDevicesService\"},iot1clickprojects:{prefix:\"iot1click-projects\",name:\"IoT1ClickProjects\"},pi:{name:\"PI\"},neptune:{name:\"Neptune\"},mediatailor:{name:\"MediaTailor\"},eks:{name:\"EKS\"},macie:{name:\"Macie\"},dlm:{name:\"DLM\"},signer:{name:\"Signer\"},chime:{name:\"Chime\"},pinpointemail:{prefix:\"pinpoint-email\",name:\"PinpointEmail\"},ram:{name:\"RAM\"},route53resolver:{name:\"Route53Resolver\"},pinpointsmsvoice:{prefix:\"sms-voice\",name:\"PinpointSMSVoice\"},quicksight:{name:\"QuickSight\"},rdsdataservice:{prefix:\"rds-data\",name:\"RDSDataService\"},amplify:{name:\"Amplify\"},datasync:{name:\"DataSync\"},robomaker:{name:\"RoboMaker\"},transfer:{name:\"Transfer\"},globalaccelerator:{name:\"GlobalAccelerator\"},comprehendmedical:{name:\"ComprehendMedical\",cors:!0},kinesisanalyticsv2:{name:\"KinesisAnalyticsV2\"},mediaconnect:{name:\"MediaConnect\"},fsx:{name:\"FSx\"},securityhub:{name:\"SecurityHub\"},appmesh:{name:\"AppMesh\",versions:[\"2018-10-01*\"]},licensemanager:{prefix:\"license-manager\",name:\"LicenseManager\"},kafka:{name:\"Kafka\"},apigatewaymanagementapi:{name:\"ApiGatewayManagementApi\"},apigatewayv2:{name:\"ApiGatewayV2\"},docdb:{name:\"DocDB\"},backup:{name:\"Backup\"},worklink:{name:\"WorkLink\"},textract:{name:\"Textract\"},managedblockchain:{name:\"ManagedBlockchain\"},mediapackagevod:{prefix:\"mediapackage-vod\",name:\"MediaPackageVod\"},groundstation:{name:\"GroundStation\"},iotthingsgraph:{name:\"IoTThingsGraph\"},iotevents:{name:\"IoTEvents\"},ioteventsdata:{prefix:\"iotevents-data\",name:\"IoTEventsData\"},personalize:{name:\"Personalize\",cors:!0},personalizeevents:{prefix:\"personalize-events\",name:\"PersonalizeEvents\",cors:!0},personalizeruntime:{prefix:\"personalize-runtime\",name:\"PersonalizeRuntime\",cors:!0},applicationinsights:{prefix:\"application-insights\",name:\"ApplicationInsights\"},servicequotas:{prefix:\"service-quotas\",name:\"ServiceQuotas\"},ec2instanceconnect:{prefix:\"ec2-instance-connect\",name:\"EC2InstanceConnect\"},eventbridge:{name:\"EventBridge\"},lakeformation:{name:\"LakeFormation\"},forecastservice:{prefix:\"forecast\",name:\"ForecastService\",cors:!0},forecastqueryservice:{prefix:\"forecastquery\",name:\"ForecastQueryService\",cors:!0},qldb:{name:\"QLDB\"},qldbsession:{prefix:\"qldb-session\",name:\"QLDBSession\"},workmailmessageflow:{name:\"WorkMailMessageFlow\"},codestarnotifications:{prefix:\"codestar-notifications\",name:\"CodeStarNotifications\"},savingsplans:{name:\"SavingsPlans\"},sso:{name:\"SSO\"},ssooidc:{prefix:\"sso-oidc\",name:\"SSOOIDC\"},marketplacecatalog:{prefix:\"marketplace-catalog\",name:\"MarketplaceCatalog\"},dataexchange:{name:\"DataExchange\"},sesv2:{name:\"SESV2\"},migrationhubconfig:{prefix:\"migrationhub-config\",name:\"MigrationHubConfig\"},connectparticipant:{name:\"ConnectParticipant\"},appconfig:{name:\"AppConfig\"},iotsecuretunneling:{name:\"IoTSecureTunneling\"},wafv2:{name:\"WAFV2\"},elasticinference:{prefix:\"elastic-inference\",name:\"ElasticInference\"},imagebuilder:{name:\"Imagebuilder\"},schemas:{name:\"Schemas\"},accessanalyzer:{name:\"AccessAnalyzer\"},codegurureviewer:{prefix:\"codeguru-reviewer\",name:\"CodeGuruReviewer\"},codeguruprofiler:{name:\"CodeGuruProfiler\"},computeoptimizer:{prefix:\"compute-optimizer\",name:\"ComputeOptimizer\"},frauddetector:{name:\"FraudDetector\"},kendra:{name:\"Kendra\"},networkmanager:{name:\"NetworkManager\"},outposts:{name:\"Outposts\"},augmentedairuntime:{prefix:\"sagemaker-a2i-runtime\",name:\"AugmentedAIRuntime\"},ebs:{name:\"EBS\"},kinesisvideosignalingchannels:{prefix:\"kinesis-video-signaling\",name:\"KinesisVideoSignalingChannels\",cors:!0},detective:{name:\"Detective\"},codestarconnections:{prefix:\"codestar-connections\",name:\"CodeStarconnections\"},synthetics:{name:\"Synthetics\"},iotsitewise:{name:\"IoTSiteWise\"},macie2:{name:\"Macie2\"},codeartifact:{name:\"CodeArtifact\"},honeycode:{name:\"Honeycode\"},ivs:{name:\"IVS\"},braket:{name:\"Braket\"},identitystore:{name:\"IdentityStore\"},appflow:{name:\"Appflow\"},redshiftdata:{prefix:\"redshift-data\",name:\"RedshiftData\"},ssoadmin:{prefix:\"sso-admin\",name:\"SSOAdmin\"},timestreamquery:{prefix:\"timestream-query\",name:\"TimestreamQuery\"},timestreamwrite:{prefix:\"timestream-write\",name:\"TimestreamWrite\"},s3outposts:{name:\"S3Outposts\"}}},{}],6:[function(e,t,n){t.exports={version:\"2.0\",metadata:{apiVersion:\"2011-06-15\",endpointPrefix:\"sts\",globalEndpoint:\"sts.amazonaws.com\",protocol:\"query\",serviceAbbreviation:\"AWS STS\",serviceFullName:\"AWS Security Token Service\",serviceId:\"STS\",signatureVersion:\"v4\",uid:\"sts-2011-06-15\",xmlNamespace:\"https://sts.amazonaws.com/doc/2011-06-15/\"},operations:{AssumeRole:{input:{type:\"structure\",required:[\"RoleArn\",\"RoleSessionName\"],members:{RoleArn:{},RoleSessionName:{},PolicyArns:{shape:\"S4\"},Policy:{},DurationSeconds:{type:\"integer\"},Tags:{shape:\"S8\"},TransitiveTagKeys:{type:\"list\",member:{}},ExternalId:{},SerialNumber:{},TokenCode:{}}},output:{resultWrapper:\"AssumeRoleResult\",type:\"structure\",members:{Credentials:{shape:\"Sh\"},AssumedRoleUser:{shape:\"Sm\"},PackedPolicySize:{type:\"integer\"}}}},AssumeRoleWithSAML:{input:{type:\"structure\",required:[\"RoleArn\",\"PrincipalArn\",\"SAMLAssertion\"],members:{RoleArn:{},PrincipalArn:{},SAMLAssertion:{},PolicyArns:{shape:\"S4\"},Policy:{},DurationSeconds:{type:\"integer\"}}},output:{resultWrapper:\"AssumeRoleWithSAMLResult\",type:\"structure\",members:{Credentials:{shape:\"Sh\"},AssumedRoleUser:{shape:\"Sm\"},PackedPolicySize:{type:\"integer\"},Subject:{},SubjectType:{},Issuer:{},Audience:{},NameQualifier:{}}}},AssumeRoleWithWebIdentity:{input:{type:\"structure\",required:[\"RoleArn\",\"RoleSessionName\",\"WebIdentityToken\"],members:{RoleArn:{},RoleSessionName:{},WebIdentityToken:{},ProviderId:{},PolicyArns:{shape:\"S4\"},Policy:{},DurationSeconds:{type:\"integer\"}}},output:{resultWrapper:\"AssumeRoleWithWebIdentityResult\",type:\"structure\",members:{Credentials:{shape:\"Sh\"},SubjectFromWebIdentityToken:{},AssumedRoleUser:{shape:\"Sm\"},PackedPolicySize:{type:\"integer\"},Provider:{},Audience:{}}}},DecodeAuthorizationMessage:{input:{type:\"structure\",required:[\"EncodedMessage\"],members:{EncodedMessage:{}}},output:{resultWrapper:\"DecodeAuthorizationMessageResult\",type:\"structure\",members:{DecodedMessage:{}}}},GetAccessKeyInfo:{input:{type:\"structure\",required:[\"AccessKeyId\"],members:{AccessKeyId:{}}},output:{resultWrapper:\"GetAccessKeyInfoResult\",type:\"structure\",members:{Account:{}}}},GetCallerIdentity:{input:{type:\"structure\",members:{}},output:{resultWrapper:\"GetCallerIdentityResult\",type:\"structure\",members:{UserId:{},Account:{},Arn:{}}}},GetFederationToken:{input:{type:\"structure\",required:[\"Name\"],members:{Name:{},Policy:{},PolicyArns:{shape:\"S4\"},DurationSeconds:{type:\"integer\"},Tags:{shape:\"S8\"}}},output:{resultWrapper:\"GetFederationTokenResult\",type:\"structure\",members:{Credentials:{shape:\"Sh\"},FederatedUser:{type:\"structure\",required:[\"FederatedUserId\",\"Arn\"],members:{FederatedUserId:{},Arn:{}}},PackedPolicySize:{type:\"integer\"}}}},GetSessionToken:{input:{type:\"structure\",members:{DurationSeconds:{type:\"integer\"},SerialNumber:{},TokenCode:{}}},output:{resultWrapper:\"GetSessionTokenResult\",type:\"structure\",members:{Credentials:{shape:\"Sh\"}}}}},shapes:{S4:{type:\"list\",member:{type:\"structure\",members:{arn:{}}}},S8:{type:\"list\",member:{type:\"structure\",required:[\"Key\",\"Value\"],members:{Key:{},Value:{}}}},Sh:{type:\"structure\",required:[\"AccessKeyId\",\"SecretAccessKey\",\"SessionToken\",\"Expiration\"],members:{AccessKeyId:{},SecretAccessKey:{},SessionToken:{},Expiration:{type:\"timestamp\"}}},Sm:{type:\"structure\",required:[\"AssumedRoleId\",\"Arn\"],members:{AssumedRoleId:{},Arn:{}}}}}},{}],7:[function(e,t,n){arguments[4][2][0].apply(n,arguments)},{dup:2}],8:[function(e,t,n){e(\"../lib/node_loader\");var r=e(\"../lib/core\"),i=r.Service,o=r.apiLoader;o.services.cognitoidentity={},r.CognitoIdentity=i.defineService(\"cognitoidentity\",[\"2014-06-30\"]),e(\"../lib/services/cognitoidentity\"),Object.defineProperty(o.services.cognitoidentity,\"2014-06-30\",{get:function(){var t=e(\"../apis/cognito-identity-2014-06-30.min.json\");return t.paginators=e(\"../apis/cognito-identity-2014-06-30.paginators.json\").pagination,t},enumerable:!0,configurable:!0}),t.exports=r.CognitoIdentity},{\"../apis/cognito-identity-2014-06-30.min.json\":1,\"../apis/cognito-identity-2014-06-30.paginators.json\":2,\"../lib/core\":20,\"../lib/node_loader\":17,\"../lib/services/cognitoidentity\":62}],9:[function(e,t,n){e(\"../lib/node_loader\");var r=e(\"../lib/core\"),i=r.Service,o=r.apiLoader;o.services.sts={},r.STS=i.defineService(\"sts\",[\"2011-06-15\"]),e(\"../lib/services/sts\"),Object.defineProperty(o.services.sts,\"2011-06-15\",{get:function(){var t=e(\"../apis/sts-2011-06-15.min.json\");return t.paginators=e(\"../apis/sts-2011-06-15.paginators.json\").pagination,t},enumerable:!0,configurable:!0}),t.exports=r.STS},{\"../apis/sts-2011-06-15.min.json\":6,\"../apis/sts-2011-06-15.paginators.json\":7,\"../lib/core\":20,\"../lib/node_loader\":17,\"../lib/services/sts\":63}],10:[function(e,t,n){function r(e,t){if(!r.services.hasOwnProperty(e))throw new Error(\"InvalidService: Failed to load api for \"+e);return r.services[e][t]}r.services={},t.exports=r},{}],11:[function(e,t,n){var r=e(\"./browserHmac\"),i=e(\"./browserMd5\"),o=e(\"./browserSha1\"),s=e(\"./browserSha256\");t.exports={createHash:function(e){if(\"md5\"===(e=e.toLowerCase()))return new i;if(\"sha256\"===e)return new s;if(\"sha1\"===e)return new o;throw new Error(\"Hash algorithm \"+e+\" is not supported in the browser SDK\")},createHmac:function(e,t){if(\"md5\"===(e=e.toLowerCase()))return new r(i,t);if(\"sha256\"===e)return new r(s,t);if(\"sha1\"===e)return new r(o,t);throw new Error(\"HMAC algorithm \"+e+\" is not supported in the browser SDK\")},createSign:function(){throw new Error(\"createSign is not implemented in the browser\")}}},{\"./browserHmac\":13,\"./browserMd5\":14,\"./browserSha1\":15,\"./browserSha256\":16}],12:[function(e,t,n){var r=e(\"buffer/\").Buffer;\"undefined\"!=typeof ArrayBuffer&&void 0===ArrayBuffer.isView&&(ArrayBuffer.isView=function(e){return i.indexOf(Object.prototype.toString.call(e))>-1});var i=[\"[object Int8Array]\",\"[object Uint8Array]\",\"[object Uint8ClampedArray]\",\"[object Int16Array]\",\"[object Uint16Array]\",\"[object Int32Array]\",\"[object Uint32Array]\",\"[object Float32Array]\",\"[object Float64Array]\",\"[object DataView]\"];t.exports={isEmptyData:function(e){return\"string\"==typeof e?0===e.length:0===e.byteLength},convertToBuffer:function(e){return\"string\"==typeof e&&(e=new r(e,\"utf8\")),ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}}},{\"buffer/\":82}],13:[function(e,t,n){function r(e,t){this.hash=new e,this.outer=new e;var n=i(e,t),r=new Uint8Array(e.BLOCK_SIZE);r.set(n);for(var o=0;o<e.BLOCK_SIZE;o++)n[o]^=54,r[o]^=92;for(this.hash.update(n),this.outer.update(r),o=0;o<n.byteLength;o++)n[o]=0}function i(e,t){var n=o.convertToBuffer(t);if(n.byteLength>e.BLOCK_SIZE){var r=new e;r.update(n),n=r.digest()}var i=new Uint8Array(e.BLOCK_SIZE);return i.set(n),i}var o=e(\"./browserHashUtils\");t.exports=r,r.prototype.update=function(e){if(o.isEmptyData(e)||this.error)return this;try{this.hash.update(o.convertToBuffer(e))}catch(e){this.error=e}return this},r.prototype.digest=function(e){return this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest(e)}},{\"./browserHashUtils\":12}],14:[function(e,t,n){function r(){this.state=[1732584193,4023233417,2562383102,271733878],this.buffer=new DataView(new ArrayBuffer(p)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}function i(e,t,n,r,i,o){return((t=(t+e&4294967295)+(r+o&4294967295)&4294967295)<<i|t>>>32-i)+n&4294967295}function o(e,t,n,r,o,s,a){return i(t&n|~t&r,e,t,o,s,a)}function s(e,t,n,r,o,s,a){return i(t&r|n&~r,e,t,o,s,a)}function a(e,t,n,r,o,s,a){return i(t^n^r,e,t,o,s,a)}function c(e,t,n,r,o,s,a){return i(n^(t|~r),e,t,o,s,a)}var u=e(\"./browserHashUtils\"),l=e(\"buffer/\").Buffer,p=64;t.exports=r,r.BLOCK_SIZE=p,r.prototype.update=function(e){if(u.isEmptyData(e))return this;if(this.finished)throw new Error(\"Attempted to update an already finished hash.\");var t=u.convertToBuffer(e),n=0,r=t.byteLength;for(this.bytesHashed+=r;r>0;)this.buffer.setUint8(this.bufferLength++,t[n++]),r--,this.bufferLength===p&&(this.hashBuffer(),this.bufferLength=0);return this},r.prototype.digest=function(e){if(!this.finished){var t=this,n=t.buffer,r=t.bufferLength,i=8*t.bytesHashed;if(n.setUint8(this.bufferLength++,128),r%p>=p-8){for(var o=this.bufferLength;o<p;o++)n.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(o=this.bufferLength;o<p-8;o++)n.setUint8(o,0);n.setUint32(p-8,i>>>0,!0),n.setUint32(p-4,Math.floor(i/4294967296),!0),this.hashBuffer(),this.finished=!0}var s=new DataView(new ArrayBuffer(16));for(o=0;o<4;o++)s.setUint32(4*o,this.state[o],!0);var a=new l(s.buffer,s.byteOffset,s.byteLength);return e?a.toString(e):a},r.prototype.hashBuffer=function(){var e=this.buffer,t=this.state,n=t[0],r=t[1],i=t[2],u=t[3];n=o(n,r,i,u,e.getUint32(0,!0),7,3614090360),u=o(u,n,r,i,e.getUint32(4,!0),12,3905402710),i=o(i,u,n,r,e.getUint32(8,!0),17,606105819),r=o(r,i,u,n,e.getUint32(12,!0),22,3250441966),n=o(n,r,i,u,e.getUint32(16,!0),7,4118548399),u=o(u,n,r,i,e.getUint32(20,!0),12,1200080426),i=o(i,u,n,r,e.getUint32(24,!0),17,2821735955),r=o(r,i,u,n,e.getUint32(28,!0),22,4249261313),n=o(n,r,i,u,e.getUint32(32,!0),7,1770035416),u=o(u,n,r,i,e.getUint32(36,!0),12,2336552879),i=o(i,u,n,r,e.getUint32(40,!0),17,4294925233),r=o(r,i,u,n,e.getUint32(44,!0),22,2304563134),n=o(n,r,i,u,e.getUint32(48,!0),7,1804603682),u=o(u,n,r,i,e.getUint32(52,!0),12,4254626195),i=o(i,u,n,r,e.getUint32(56,!0),17,2792965006),n=s(n,r=o(r,i,u,n,e.getUint32(60,!0),22,1236535329),i,u,e.getUint32(4,!0),5,4129170786),u=s(u,n,r,i,e.getUint32(24,!0),9,3225465664),i=s(i,u,n,r,e.getUint32(44,!0),14,643717713),r=s(r,i,u,n,e.getUint32(0,!0),20,3921069994),n=s(n,r,i,u,e.getUint32(20,!0),5,3593408605),u=s(u,n,r,i,e.getUint32(40,!0),9,38016083),i=s(i,u,n,r,e.getUint32(60,!0),14,3634488961),r=s(r,i,u,n,e.getUint32(16,!0),20,3889429448),n=s(n,r,i,u,e.getUint32(36,!0),5,568446438),u=s(u,n,r,i,e.getUint32(56,!0),9,3275163606),i=s(i,u,n,r,e.getUint32(12,!0),14,4107603335),r=s(r,i,u,n,e.getUint32(32,!0),20,1163531501),n=s(n,r,i,u,e.getUint32(52,!0),5,2850285829),u=s(u,n,r,i,e.getUint32(8,!0),9,4243563512),i=s(i,u,n,r,e.getUint32(28,!0),14,1735328473),n=a(n,r=s(r,i,u,n,e.getUint32(48,!0),20,2368359562),i,u,e.getUint32(20,!0),4,4294588738),u=a(u,n,r,i,e.getUint32(32,!0),11,2272392833),i=a(i,u,n,r,e.getUint32(44,!0),16,1839030562),r=a(r,i,u,n,e.getUint32(56,!0),23,4259657740),n=a(n,r,i,u,e.getUint32(4,!0),4,2763975236),u=a(u,n,r,i,e.getUint32(16,!0),11,1272893353),i=a(i,u,n,r,e.getUint32(28,!0),16,4139469664),r=a(r,i,u,n,e.getUint32(40,!0),23,3200236656),n=a(n,r,i,u,e.getUint32(52,!0),4,681279174),u=a(u,n,r,i,e.getUint32(0,!0),11,3936430074),i=a(i,u,n,r,e.getUint32(12,!0),16,3572445317),r=a(r,i,u,n,e.getUint32(24,!0),23,76029189),n=a(n,r,i,u,e.getUint32(36,!0),4,3654602809),u=a(u,n,r,i,e.getUint32(48,!0),11,3873151461),i=a(i,u,n,r,e.getUint32(60,!0),16,530742520),n=c(n,r=a(r,i,u,n,e.getUint32(8,!0),23,3299628645),i,u,e.getUint32(0,!0),6,4096336452),u=c(u,n,r,i,e.getUint32(28,!0),10,1126891415),i=c(i,u,n,r,e.getUint32(56,!0),15,2878612391),r=c(r,i,u,n,e.getUint32(20,!0),21,4237533241),n=c(n,r,i,u,e.getUint32(48,!0),6,1700485571),u=c(u,n,r,i,e.getUint32(12,!0),10,2399980690),i=c(i,u,n,r,e.getUint32(40,!0),15,4293915773),r=c(r,i,u,n,e.getUint32(4,!0),21,2240044497),n=c(n,r,i,u,e.getUint32(32,!0),6,1873313359),u=c(u,n,r,i,e.getUint32(60,!0),10,4264355552),i=c(i,u,n,r,e.getUint32(24,!0),15,2734768916),r=c(r,i,u,n,e.getUint32(52,!0),21,1309151649),n=c(n,r,i,u,e.getUint32(16,!0),6,4149444226),u=c(u,n,r,i,e.getUint32(44,!0),10,3174756917),i=c(i,u,n,r,e.getUint32(8,!0),15,718787259),r=c(r,i,u,n,e.getUint32(36,!0),21,3951481745),t[0]=n+t[0]&4294967295,t[1]=r+t[1]&4294967295,t[2]=i+t[2]&4294967295,t[3]=u+t[3]&4294967295}},{\"./browserHashUtils\":12,\"buffer/\":82}],15:[function(e,t,n){function r(){this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=new Uint32Array(80),this.offset=0,this.shift=24,this.totalLength=0}var i=e(\"buffer/\").Buffer,o=e(\"./browserHashUtils\");new Uint32Array([1518500249,1859775393,-1894007588,-899497514]),Math.pow(2,53),t.exports=r,r.BLOCK_SIZE=64,r.prototype.update=function(e){if(this.finished)throw new Error(\"Attempted to update an already finished hash.\");if(o.isEmptyData(e))return this;var t=(e=o.convertToBuffer(e)).length;this.totalLength+=8*t;for(var n=0;n<t;n++)this.write(e[n]);return this},r.prototype.write=function(e){this.block[this.offset]|=(255&e)<<this.shift,this.shift?this.shift-=8:(this.offset++,this.shift=24),16===this.offset&&this.processBlock()},r.prototype.digest=function(e){this.write(128),(this.offset>14||14===this.offset&&this.shift<24)&&this.processBlock(),this.offset=14,this.shift=24,this.write(0),this.write(0),this.write(this.totalLength>0xffffffffff?this.totalLength/1099511627776:0),this.write(this.totalLength>4294967295?this.totalLength/4294967296:0);for(var t=24;t>=0;t-=8)this.write(this.totalLength>>t);var n=new i(20),r=new DataView(n.buffer);return r.setUint32(0,this.h0,!1),r.setUint32(4,this.h1,!1),r.setUint32(8,this.h2,!1),r.setUint32(12,this.h3,!1),r.setUint32(16,this.h4,!1),e?n.toString(e):n},r.prototype.processBlock=function(){for(var e=16;e<80;e++){var t=this.block[e-3]^this.block[e-8]^this.block[e-14]^this.block[e-16];this.block[e]=t<<1|t>>>31}var n,r,i=this.h0,o=this.h1,s=this.h2,a=this.h3,c=this.h4;for(e=0;e<80;e++){e<20?(n=a^o&(s^a),r=1518500249):e<40?(n=o^s^a,r=1859775393):e<60?(n=o&s|a&(o|s),r=2400959708):(n=o^s^a,r=3395469782);var u=(i<<5|i>>>27)+n+c+r+(0|this.block[e]);c=a,a=s,s=o<<30|o>>>2,o=i,i=u}for(this.h0=this.h0+i|0,this.h1=this.h1+o|0,this.h2=this.h2+s|0,this.h3=this.h3+a|0,this.h4=this.h4+c|0,this.offset=0,e=0;e<16;e++)this.block[e]=0}},{\"./browserHashUtils\":12,\"buffer/\":82}],16:[function(e,t,n){function r(){this.state=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}var i=e(\"buffer/\").Buffer,o=e(\"./browserHashUtils\"),s=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=Math.pow(2,53)-1;t.exports=r,r.BLOCK_SIZE=64,r.prototype.update=function(e){if(this.finished)throw new Error(\"Attempted to update an already finished hash.\");if(o.isEmptyData(e))return this;var t=0,n=(e=o.convertToBuffer(e)).byteLength;if(this.bytesHashed+=n,8*this.bytesHashed>a)throw new Error(\"Cannot hash more than 2^53 - 1 bits\");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,64===this.bufferLength&&(this.hashBuffer(),this.bufferLength=0);return this},r.prototype.digest=function(e){if(!this.finished){var t=8*this.bytesHashed,n=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(n.setUint8(this.bufferLength++,128),r%64>=56){for(var o=this.bufferLength;o<64;o++)n.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(o=this.bufferLength;o<56;o++)n.setUint8(o,0);n.setUint32(56,Math.floor(t/4294967296),!0),n.setUint32(60,t),this.hashBuffer(),this.finished=!0}var s=new i(32);for(o=0;o<8;o++)s[4*o]=this.state[o]>>>24&255,s[4*o+1]=this.state[o]>>>16&255,s[4*o+2]=this.state[o]>>>8&255,s[4*o+3]=this.state[o]>>>0&255;return e?s.toString(e):s},r.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],c=t[5],u=t[6],l=t[7],p=0;p<64;p++){if(p<16)this.temp[p]=(255&e[4*p])<<24|(255&e[4*p+1])<<16|(255&e[4*p+2])<<8|255&e[4*p+3];else{var d=this.temp[p-2],h=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,f=((d=this.temp[p-15])>>>7|d<<25)^(d>>>18|d<<14)^d>>>3;this.temp[p]=(h+this.temp[p-7]|0)+(f+this.temp[p-16]|0)}var m=(((a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7))+(a&c^~a&u)|0)+(l+(s[p]+this.temp[p]|0)|0)|0,g=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&r^n&i^r&i)|0;l=u,u=c,c=a,a=o+m|0,o=i,i=r,r=n,n=m+g|0}t[0]+=n,t[1]+=r,t[2]+=i,t[3]+=o,t[4]+=a,t[5]+=c,t[6]+=u,t[7]+=l}},{\"./browserHashUtils\":12,\"buffer/\":82}],17:[function(e,t,n){(function(n){(function(){var n=e(\"./util\");n.crypto.lib=e(\"./browserCryptoLib\"),n.Buffer=e(\"buffer/\").Buffer,n.url=e(\"url/\"),n.querystring=e(\"querystring/\"),n.realClock=e(\"./realclock/browserClock\"),n.environment=\"js\",n.createEventStream=e(\"./event-stream/buffered-create-event-stream\").createEventStream,n.isBrowser=function(){return!0},n.isNode=function(){return!1};var r=e(\"./core\");if(t.exports=r,e(\"./credentials\"),e(\"./credentials/credential_provider_chain\"),e(\"./credentials/temporary_credentials\"),e(\"./credentials/chainable_temporary_credentials\"),e(\"./credentials/web_identity_credentials\"),e(\"./credentials/cognito_identity_credentials\"),e(\"./credentials/saml_credentials\"),r.XML.Parser=e(\"./xml/browser_parser\"),e(\"./http/xhr\"),void 0===i)var i={browser:!0}}).call(this)}).call(this,e(\"_process\"))},{\"./browserCryptoLib\":11,\"./core\":20,\"./credentials\":21,\"./credentials/chainable_temporary_credentials\":22,\"./credentials/cognito_identity_credentials\":23,\"./credentials/credential_provider_chain\":24,\"./credentials/saml_credentials\":25,\"./credentials/temporary_credentials\":26,\"./credentials/web_identity_credentials\":27,\"./event-stream/buffered-create-event-stream\":29,\"./http/xhr\":37,\"./realclock/browserClock\":54,\"./util\":73,\"./xml/browser_parser\":74,_process:87,\"buffer/\":82,\"querystring/\":94,\"url/\":96}],18:[function(e,t,n){var r,i=e(\"./core\");e(\"./credentials\"),e(\"./credentials/credential_provider_chain\"),i.Config=i.util.inherit({constructor:function(e){void 0===e&&(e={}),e=this.extractCredentials(e),i.util.each.call(this,this.keys,(function(t,n){this.set(t,e[t],n)}))},getCredentials:function(e){function t(t){e(t,t?null:r.credentials)}function n(e,t){return new i.util.error(t||new Error,{code:\"CredentialsError\",message:e,name:\"CredentialsError\"})}var r=this;r.credentials?\"function\"==typeof r.credentials.get?r.credentials.get((function(e){e&&(e=n(\"Could not load credentials from \"+r.credentials.constructor.name,e)),t(e)})):function(){var e=null;r.credentials.accessKeyId&&r.credentials.secretAccessKey||(e=n(\"Missing credentials\")),t(e)}():r.credentialProvider?r.credentialProvider.resolve((function(e,i){e&&(e=n(\"Could not load credentials from any providers\",e)),r.credentials=i,t(e)})):t(n(\"No credentials to load\"))},update:function(e,t){t=t||!1,e=this.extractCredentials(e),i.util.each.call(this,e,(function(e,n){(t||Object.prototype.hasOwnProperty.call(this.keys,e)||i.Service.hasService(e))&&this.set(e,n)}))},loadFromPath:function(e){this.clear();var t=JSON.parse(i.util.readFileSync(e)),n=new i.FileSystemCredentials(e),r=new i.CredentialProviderChain;return r.providers.unshift(n),r.resolve((function(e,n){if(e)throw e;t.credentials=n})),this.constructor(t),this},clear:function(){i.util.each.call(this,this.keys,(function(e){delete this[e]})),this.set(\"credentials\",void 0),this.set(\"credentialProvider\",void 0)},set:function(e,t,n){void 0===t?(void 0===n&&(n=this.keys[e]),this[e]=\"function\"==typeof n?n.call(this):n):\"httpOptions\"===e&&this[e]?this[e]=i.util.merge(this[e],t):this[e]=t},keys:{credentials:null,credentialProvider:null,region:null,logger:null,apiVersions:{},apiVersion:null,endpoint:void 0,httpOptions:{timeout:12e4},maxRetries:void 0,maxRedirects:10,paramValidation:!0,sslEnabled:!0,s3ForcePathStyle:!1,s3BucketEndpoint:!1,s3DisableBodySigning:!0,s3UsEast1RegionalEndpoint:\"legacy\",s3UseArnRegion:void 0,computeChecksums:!0,convertResponseTypes:!0,correctClockSkew:!1,customUserAgent:null,dynamoDbCrc32:!0,systemClockOffset:0,signatureVersion:null,signatureCache:!0,retryDelayOptions:{},useAccelerateEndpoint:!1,clientSideMonitoring:!1,endpointDiscoveryEnabled:void 0,endpointCacheSize:1e3,hostPrefixEnabled:!0,stsRegionalEndpoints:\"legacy\"},extractCredentials:function(e){return e.accessKeyId&&e.secretAccessKey&&((e=i.util.copy(e)).credentials=new i.Credentials(e)),e},setPromisesDependency:function(e){r=e,null===e&&\"function\"==typeof Promise&&(r=Promise);var t=[i.Request,i.Credentials,i.CredentialProviderChain];i.S3&&(t.push(i.S3),i.S3.ManagedUpload&&t.push(i.S3.ManagedUpload)),i.util.addPromises(t,r)},getPromisesDependency:function(){return r}}),i.config=new i.Config},{\"./core\":20,\"./credentials\":21,\"./credentials/credential_provider_chain\":24}],19:[function(e,t,n){(function(n){(function(){function r(e,t){if(\"string\"==typeof e){if([\"legacy\",\"regional\"].indexOf(e.toLowerCase())>=0)return e.toLowerCase();throw i.util.error(new Error,t)}}var i=e(\"./core\");t.exports=function(e,t){var o;if((e=e||{})[t.clientConfig]&&(o=r(e[t.clientConfig],{code:\"InvalidConfiguration\",message:'invalid \"'+t.clientConfig+'\" configuration. Expect \"legacy\"  or \"regional\". Got \"'+e[t.clientConfig]+'\".'})))return o;if(!i.util.isNode())return o;if(Object.prototype.hasOwnProperty.call(n.env,t.env)&&(o=r(n.env[t.env],{code:\"InvalidEnvironmentalVariable\",message:\"invalid \"+t.env+' environmental variable. Expect \"legacy\"  or \"regional\". Got \"'+n.env[t.env]+'\".'})))return o;var s={};try{s=i.util.getProfilesFromSharedConfig(i.util.iniLoader)[n.env.AWS_PROFILE||i.util.defaultProfile]}catch(e){}return s&&Object.prototype.hasOwnProperty.call(s,t.sharedConfig)&&(o=r(s[t.sharedConfig],{code:\"InvalidConfiguration\",message:\"invalid \"+t.sharedConfig+' profile config. Expect \"legacy\"  or \"regional\". Got \"'+s[t.sharedConfig]+'\".'})),o}}).call(this)}).call(this,e(\"_process\"))},{\"./core\":20,_process:87}],20:[function(e,t,n){var r={util:e(\"./util\")};({}).toString(),t.exports=r,r.util.update(r,{VERSION:\"2.772.0\",Signers:{},Protocol:{Json:e(\"./protocol/json\"),Query:e(\"./protocol/query\"),Rest:e(\"./protocol/rest\"),RestJson:e(\"./protocol/rest_json\"),RestXml:e(\"./protocol/rest_xml\")},XML:{Builder:e(\"./xml/builder\"),Parser:null},JSON:{Builder:e(\"./json/builder\"),Parser:e(\"./json/parser\")},Model:{Api:e(\"./model/api\"),Operation:e(\"./model/operation\"),Shape:e(\"./model/shape\"),Paginator:e(\"./model/paginator\"),ResourceWaiter:e(\"./model/resource_waiter\")},apiLoader:e(\"./api_loader\"),EndpointCache:e(\"../vendor/endpoint-cache\").EndpointCache}),e(\"./sequential_executor\"),e(\"./service\"),e(\"./config\"),e(\"./http\"),e(\"./event_listeners\"),e(\"./request\"),e(\"./response\"),e(\"./resource_waiter\"),e(\"./signers/request_signer\"),e(\"./param_validator\"),r.events=new r.SequentialExecutor,r.util.memoizedProperty(r,\"endpointCache\",(function(){return new r.EndpointCache(r.config.endpointCacheSize)}),!0)},{\"../vendor/endpoint-cache\":105,\"./api_loader\":10,\"./config\":18,\"./event_listeners\":35,\"./http\":36,\"./json/builder\":38,\"./json/parser\":39,\"./model/api\":40,\"./model/operation\":42,\"./model/paginator\":43,\"./model/resource_waiter\":44,\"./model/shape\":45,\"./param_validator\":46,\"./protocol/json\":48,\"./protocol/query\":49,\"./protocol/rest\":50,\"./protocol/rest_json\":51,\"./protocol/rest_xml\":52,\"./request\":57,\"./resource_waiter\":58,\"./response\":59,\"./sequential_executor\":60,\"./service\":61,\"./signers/request_signer\":65,\"./util\":73,\"./xml/builder\":75}],21:[function(e,t,n){var r=e(\"./core\");r.Credentials=r.util.inherit({constructor:function(){if(r.util.hideProperties(this,[\"secretAccessKey\"]),this.expired=!1,this.expireTime=null,this.refreshCallbacks=[],1===arguments.length&&\"object\"==typeof arguments[0]){var e=arguments[0].credentials||arguments[0];this.accessKeyId=e.accessKeyId,this.secretAccessKey=e.secretAccessKey,this.sessionToken=e.sessionToken}else this.accessKeyId=arguments[0],this.secretAccessKey=arguments[1],this.sessionToken=arguments[2]},expiryWindow:15,needsRefresh:function(){var e=r.util.date.getDate().getTime(),t=new Date(e+1e3*this.expiryWindow);return!!(this.expireTime&&t>this.expireTime)||this.expired||!this.accessKeyId||!this.secretAccessKey},get:function(e){var t=this;this.needsRefresh()?this.refresh((function(n){n||(t.expired=!1),e&&e(n)})):e&&e()},refresh:function(e){this.expired=!1,e()},coalesceRefresh:function(e,t){var n=this;1===n.refreshCallbacks.push(e)&&n.load((function(e){r.util.arrayEach(n.refreshCallbacks,(function(n){t?n(e):r.util.defer((function(){n(e)}))})),n.refreshCallbacks.length=0}))},load:function(e){e()}}),r.Credentials.addPromisesToClass=function(e){this.prototype.getPromise=r.util.promisifyMethod(\"get\",e),this.prototype.refreshPromise=r.util.promisifyMethod(\"refresh\",e)},r.Credentials.deletePromisesFromClass=function(){delete this.prototype.getPromise,delete this.prototype.refreshPromise},r.util.addPromises(r.Credentials)},{\"./core\":20}],22:[function(e,t,n){var r=e(\"../core\"),i=e(\"../../clients/sts\");r.ChainableTemporaryCredentials=r.util.inherit(r.Credentials,{constructor:function(e){r.Credentials.call(this),e=e||{},this.errorCode=\"ChainableTemporaryCredentialsProviderFailure\",this.expired=!0,this.tokenCodeFn=null;var t=r.util.copy(e.params)||{};if(t.RoleArn&&(t.RoleSessionName=t.RoleSessionName||\"temporary-credentials\"),t.SerialNumber){if(!e.tokenCodeFn||\"function\"!=typeof e.tokenCodeFn)throw new r.util.error(new Error(\"tokenCodeFn must be a function when params.SerialNumber is given\"),{code:this.errorCode});this.tokenCodeFn=e.tokenCodeFn}var n=r.util.merge({params:t,credentials:e.masterCredentials||r.config.credentials},e.stsConfig||{});this.service=new i(n)},refresh:function(e){this.coalesceRefresh(e||r.util.fn.callback)},load:function(e){var t=this,n=t.service.config.params.RoleArn?\"assumeRole\":\"getSessionToken\";this.getTokenCode((function(r,i){var o={};r?e(r):(i&&(o.TokenCode=i),t.service[n](o,(function(n,r){n||t.service.credentialsFrom(r,t),e(n)})))}))},getTokenCode:function(e){var t=this;this.tokenCodeFn?this.tokenCodeFn(this.service.config.params.SerialNumber,(function(n,i){if(n){var o=n;return n instanceof Error&&(o=n.message),void e(r.util.error(new Error(\"Error fetching MFA token: \"+o),{code:t.errorCode}))}e(null,i)})):e(null)}})},{\"../../clients/sts\":9,\"../core\":20}],23:[function(e,t,n){var r=e(\"../core\"),i=e(\"../../clients/cognitoidentity\"),o=e(\"../../clients/sts\");r.CognitoIdentityCredentials=r.util.inherit(r.Credentials,{localStorageKey:{id:\"aws.cognito.identity-id.\",providers:\"aws.cognito.identity-providers.\"},constructor:function(e,t){r.Credentials.call(this),this.expired=!0,this.params=e,this.data=null,this._identityId=null,this._clientConfig=r.util.copy(t||{}),this.loadCachedId();var n=this;Object.defineProperty(this,\"identityId\",{get:function(){return n.loadCachedId(),n._identityId||n.params.IdentityId},set:function(e){n._identityId=e}})},refresh:function(e){this.coalesceRefresh(e||r.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.data=null,t._identityId=null,t.getId((function(n){n?(t.clearIdOnNotAuthorized(n),e(n)):t.params.RoleArn?t.getCredentialsFromSTS(e):t.getCredentialsForIdentity(e)}))},clearCachedId:function(){this._identityId=null,delete this.params.IdentityId;var e=this.params.IdentityPoolId,t=this.params.LoginId||\"\";delete this.storage[this.localStorageKey.id+e+t],delete this.storage[this.localStorageKey.providers+e+t]},clearIdOnNotAuthorized:function(e){\"NotAuthorizedException\"==e.code&&this.clearCachedId()},getId:function(e){var t=this;if(\"string\"==typeof t.params.IdentityId)return e(null,t.params.IdentityId);t.cognito.getId((function(n,r){!n&&r.IdentityId?(t.params.IdentityId=r.IdentityId,e(null,r.IdentityId)):e(n)}))},loadCredentials:function(e,t){e&&t&&(t.expired=!1,t.accessKeyId=e.Credentials.AccessKeyId,t.secretAccessKey=e.Credentials.SecretKey,t.sessionToken=e.Credentials.SessionToken,t.expireTime=e.Credentials.Expiration)},getCredentialsForIdentity:function(e){var t=this;t.cognito.getCredentialsForIdentity((function(n,r){n?t.clearIdOnNotAuthorized(n):(t.cacheId(r),t.data=r,t.loadCredentials(t.data,t)),e(n)}))},getCredentialsFromSTS:function(e){var t=this;t.cognito.getOpenIdToken((function(n,r){n?(t.clearIdOnNotAuthorized(n),e(n)):(t.cacheId(r),t.params.WebIdentityToken=r.Token,t.webIdentityCredentials.refresh((function(n){n||(t.data=t.webIdentityCredentials.data,t.sts.credentialsFrom(t.data,t)),e(n)})))}))},loadCachedId:function(){var e=this;if(r.util.isBrowser()&&!e.params.IdentityId){var t=e.getStorage(\"id\");if(t&&e.params.Logins){var n=Object.keys(e.params.Logins);0!==(e.getStorage(\"providers\")||\"\").split(\",\").filter((function(e){return-1!==n.indexOf(e)})).length&&(e.params.IdentityId=t)}else t&&(e.params.IdentityId=t)}},createClients:function(){var e=this._clientConfig;if(this.webIdentityCredentials=this.webIdentityCredentials||new r.WebIdentityCredentials(this.params,e),!this.cognito){var t=r.util.merge({},e);t.params=this.params,this.cognito=new i(t)}this.sts=this.sts||new o(e)},cacheId:function(e){this._identityId=e.IdentityId,this.params.IdentityId=this._identityId,r.util.isBrowser()&&(this.setStorage(\"id\",e.IdentityId),this.params.Logins&&this.setStorage(\"providers\",Object.keys(this.params.Logins).join(\",\")))},getStorage:function(e){return this.storage[this.localStorageKey[e]+this.params.IdentityPoolId+(this.params.LoginId||\"\")]},setStorage:function(e,t){try{this.storage[this.localStorageKey[e]+this.params.IdentityPoolId+(this.params.LoginId||\"\")]=t}catch(e){}},storage:function(){try{var e=r.util.isBrowser()&&null!==window.localStorage&&\"object\"==typeof window.localStorage?window.localStorage:{};return e[\"aws.test-storage\"]=\"foobar\",delete e[\"aws.test-storage\"],e}catch(e){return{}}}()})},{\"../../clients/cognitoidentity\":8,\"../../clients/sts\":9,\"../core\":20}],24:[function(e,t,n){var r=e(\"../core\");r.CredentialProviderChain=r.util.inherit(r.Credentials,{constructor:function(e){this.providers=e||r.CredentialProviderChain.defaultProviders.slice(0),this.resolveCallbacks=[]},resolve:function(e){var t=this;if(0===t.providers.length)return e(new Error(\"No providers\")),t;if(1===t.resolveCallbacks.push(e)){var n=0,i=t.providers.slice(0);!function e(o,s){if(!o&&s||n===i.length)return r.util.arrayEach(t.resolveCallbacks,(function(e){e(o,s)})),void(t.resolveCallbacks.length=0);var a=i[n++];(s=\"function\"==typeof a?a.call():a).get?s.get((function(t){e(t,t?null:s)})):e(null,s)}()}return t}}),r.CredentialProviderChain.defaultProviders=[],r.CredentialProviderChain.addPromisesToClass=function(e){this.prototype.resolvePromise=r.util.promisifyMethod(\"resolve\",e)},r.CredentialProviderChain.deletePromisesFromClass=function(){delete this.prototype.resolvePromise},r.util.addPromises(r.CredentialProviderChain)},{\"../core\":20}],25:[function(e,t,n){var r=e(\"../core\"),i=e(\"../../clients/sts\");r.SAMLCredentials=r.util.inherit(r.Credentials,{constructor:function(e){r.Credentials.call(this),this.expired=!0,this.params=e},refresh:function(e){this.coalesceRefresh(e||r.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.service.assumeRoleWithSAML((function(n,r){n||t.service.credentialsFrom(r,t),e(n)}))},createClients:function(){this.service=this.service||new i({params:this.params})}})},{\"../../clients/sts\":9,\"../core\":20}],26:[function(e,t,n){var r=e(\"../core\"),i=e(\"../../clients/sts\");r.TemporaryCredentials=r.util.inherit(r.Credentials,{constructor:function(e,t){r.Credentials.call(this),this.loadMasterCredentials(t),this.expired=!0,this.params=e||{},this.params.RoleArn&&(this.params.RoleSessionName=this.params.RoleSessionName||\"temporary-credentials\")},refresh:function(e){this.coalesceRefresh(e||r.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.masterCredentials.get((function(){t.service.config.credentials=t.masterCredentials,(t.params.RoleArn?t.service.assumeRole:t.service.getSessionToken).call(t.service,(function(n,r){n||t.service.credentialsFrom(r,t),e(n)}))}))},loadMasterCredentials:function(e){for(this.masterCredentials=e||r.config.credentials;this.masterCredentials.masterCredentials;)this.masterCredentials=this.masterCredentials.masterCredentials;\"function\"!=typeof this.masterCredentials.get&&(this.masterCredentials=new r.Credentials(this.masterCredentials))},createClients:function(){this.service=this.service||new i({params:this.params})}})},{\"../../clients/sts\":9,\"../core\":20}],27:[function(e,t,n){var r=e(\"../core\"),i=e(\"../../clients/sts\");r.WebIdentityCredentials=r.util.inherit(r.Credentials,{constructor:function(e,t){r.Credentials.call(this),this.expired=!0,this.params=e,this.params.RoleSessionName=this.params.RoleSessionName||\"web-identity\",this.data=null,this._clientConfig=r.util.copy(t||{})},refresh:function(e){this.coalesceRefresh(e||r.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.service.assumeRoleWithWebIdentity((function(n,r){t.data=null,n||(t.data=r,t.service.credentialsFrom(r,t)),e(n)}))},createClients:function(){if(!this.service){var e=r.util.merge({},this._clientConfig);e.params=this.params,this.service=new i(e)}}})},{\"../../clients/sts\":9,\"../core\":20}],28:[function(e,t,n){(function(n){(function(){function r(e){var t=e.service,n=t.api||{},r={};return t.config.region&&(r.region=t.config.region),n.serviceId&&(r.serviceId=n.serviceId),t.config.credentials.accessKeyId&&(r.accessKeyId=t.config.credentials.accessKeyId),r}function i(e,t,n){n&&null!=t&&\"structure\"===n.type&&n.required&&n.required.length>0&&h.arrayEach(n.required,(function(r){var o=n.members[r];if(!0===o.endpointDiscoveryId){var s=o.isLocationName?o.name:r;e[s]=String(t[r])}else i(e,t[r],o)}))}function o(e,t){var n={};return i(n,e.params,t),n}function s(e){var t=e.service,n=t.api,i=n.operations?n.operations[e.operation]:void 0,s=o(e,i?i.input:void 0),a=r(e);Object.keys(s).length>0&&(a=h.update(a,s),i&&(a.operation=i.name));var u=d.endpointCache.get(a);if(!u||1!==u.length||\"\"!==u[0].Address)if(u&&u.length>0)e.httpRequest.updateEndpoint(u[0].Address);else{var l=t.makeRequest(n.endpointOperation,{Operation:i.name,Identifiers:s});c(l),l.removeListener(\"validate\",d.EventListeners.Core.VALIDATE_PARAMETERS),l.removeListener(\"retry\",d.EventListeners.Core.RETRY_CHECK),d.endpointCache.put(a,[{Address:\"\",CachePeriodInMinutes:1}]),l.send((function(e,t){t&&t.Endpoints?d.endpointCache.put(a,t.Endpoints):e&&d.endpointCache.put(a,[{Address:\"\",CachePeriodInMinutes:1}])}))}}function a(e,t){var n=e.service,i=n.api,s=i.operations?i.operations[e.operation]:void 0,a=s?s.input:void 0,u=o(e,a),l=r(e);Object.keys(u).length>0&&(l=h.update(l,u),s&&(l.operation=s.name));var p=d.EndpointCache.getKeyString(l),f=d.endpointCache.get(p);if(f&&1===f.length&&\"\"===f[0].Address)return m[p]||(m[p]=[]),void m[p].push({request:e,callback:t});if(f&&f.length>0)e.httpRequest.updateEndpoint(f[0].Address),t();else{var g=n.makeRequest(i.endpointOperation,{Operation:s.name,Identifiers:u});g.removeListener(\"validate\",d.EventListeners.Core.VALIDATE_PARAMETERS),c(g),d.endpointCache.put(p,[{Address:\"\",CachePeriodInMinutes:60}]),g.send((function(n,r){if(n){if(e.response.error=h.error(n,{retryable:!1}),d.endpointCache.remove(l),m[p]){var i=m[p];h.arrayEach(i,(function(e){e.request.response.error=h.error(n,{retryable:!1}),e.callback()})),delete m[p]}}else r&&(d.endpointCache.put(p,r.Endpoints),e.httpRequest.updateEndpoint(r.Endpoints[0].Address),m[p])&&(i=m[p],h.arrayEach(i,(function(e){e.request.httpRequest.updateEndpoint(r.Endpoints[0].Address),e.callback()})),delete m[p]);t()}))}}function c(e){var t=e.service.api.apiVersion;t&&!e.httpRequest.headers[\"x-amz-api-version\"]&&(e.httpRequest.headers[\"x-amz-api-version\"]=t)}function u(e){var t=e.error,n=e.httpResponse;if(t&&(\"InvalidEndpointException\"===t.code||421===n.statusCode)){var i=e.request,s=i.service.api.operations||{},a=o(i,s[i.operation]?s[i.operation].input:void 0),c=r(i);Object.keys(a).length>0&&(c=h.update(c,a),s[i.operation]&&(c.operation=s[i.operation].name)),d.endpointCache.remove(c)}}function l(e){return[\"false\",\"0\"].indexOf(e)>=0}function p(e){var t=e.service||{};if(void 0!==t.config.endpointDiscoveryEnabled)return t.config.endpointDiscoveryEnabled;if(!h.isBrowser()){for(var r=0;r<f.length;r++){var i=f[r];if(Object.prototype.hasOwnProperty.call(n.env,i)){if(\"\"===n.env[i]||void 0===n.env[i])throw h.error(new Error,{code:\"ConfigurationException\",message:\"environmental variable \"+i+\" cannot be set to nothing\"});return!l(n.env[i])}}var o={};try{o=d.util.iniLoader?d.util.iniLoader.loadFrom({isConfig:!0,filename:n.env[d.util.sharedConfigFileEnv]}):{}}catch(e){}var s=o[n.env.AWS_PROFILE||d.util.defaultProfile]||{};if(Object.prototype.hasOwnProperty.call(s,\"endpoint_discovery_enabled\")){if(void 0===s.endpoint_discovery_enabled)throw h.error(new Error,{code:\"ConfigurationException\",message:\"config file entry 'endpoint_discovery_enabled' cannot be set to nothing\"});return!l(s.endpoint_discovery_enabled)}}}var d=e(\"./core\"),h=e(\"./util\"),f=[\"AWS_ENABLE_ENDPOINT_DISCOVERY\",\"AWS_ENDPOINT_DISCOVERY_ENABLED\"],m={};t.exports={discoverEndpoint:function(e,t){var n=e.service||{};if(function(e){if(e._originalConfig&&e._originalConfig.endpoint&&!0===e._originalConfig.endpointDiscoveryEnabled)throw h.error(new Error,{code:\"ConfigurationException\",message:\"Custom endpoint is supplied; endpointDiscoveryEnabled must not be true.\"});var t=d.config[e.serviceIdentifier]||{};return Boolean(d.config.endpoint||t.endpoint||e._originalConfig&&e._originalConfig.endpoint)}(n)||e.isPresigned())return t();var r=(n.api.operations||{})[e.operation],i=r?r.endpointDiscoveryRequired:\"NULL\",o=p(e),c=n.api.hasRequiredEndpointDiscovery;switch((o||c)&&e.httpRequest.appendToUserAgent(\"endpoint-discovery\"),i){case\"OPTIONAL\":(o||c)&&(s(e),e.addNamedListener(\"INVALIDATE_CACHED_ENDPOINTS\",\"extractError\",u)),t();break;case\"REQUIRED\":if(!1===o){e.response.error=h.error(new Error,{code:\"ConfigurationException\",message:\"Endpoint Discovery is disabled but \"+n.api.className+\".\"+e.operation+\"() requires it. Please check your configurations.\"}),t();break}e.addNamedListener(\"INVALIDATE_CACHED_ENDPOINTS\",\"extractError\",u),a(e,t);break;default:t()}},requiredDiscoverEndpoint:a,optionalDiscoverEndpoint:s,marshallCustomIdentifiers:o,getCacheKey:r,invalidateCachedEndpoint:u}}).call(this)}).call(this,e(\"_process\"))},{\"./core\":20,\"./util\":73,_process:87}],29:[function(e,t,n){var r=e(\"../event-stream/event-message-chunker\").eventMessageChunker,i=e(\"./parse-event\").parseEvent;t.exports={createEventStream:function(e,t,n){for(var o=r(e),s=[],a=0;a<o.length;a++)s.push(i(t,o[a],n));return s}}},{\"../event-stream/event-message-chunker\":30,\"./parse-event\":32}],30:[function(e,t,n){t.exports={eventMessageChunker:function(e){for(var t=[],n=0;n<e.length;){var r=e.readInt32BE(n),i=e.slice(n,r+n);n+=r,t.push(i)}return t}}},{}],31:[function(e,t,n){function r(e){if(8!==e.length)throw new Error(\"Int64 buffers must be exactly 8 bytes\");o.Buffer.isBuffer(e)||(e=s(e)),this.bytes=e}function i(e){for(var t=0;t<8;t++)e[t]^=255;for(t=7;t>-1&&0==++e[t];t--);}var o=e(\"../core\").util,s=o.buffer.toBuffer;r.fromNumber=function(e){if(e>0x8000000000000000||e<-0x8000000000000000)throw new Error(e+\" is too large (or, if negative, too small) to represent as an Int64\");for(var t=new Uint8Array(8),n=7,o=Math.abs(Math.round(e));n>-1&&o>0;n--,o/=256)t[n]=o;return e<0&&i(t),new r(t)},r.prototype.valueOf=function(){var e=this.bytes.slice(0),t=128&e[0];return t&&i(e),parseInt(e.toString(\"hex\"),16)*(t?-1:1)},r.prototype.toString=function(){return String(this.valueOf())},t.exports={Int64:r}},{\"../core\":20}],32:[function(e,t,n){var r=e(\"./parse-message\").parseMessage;t.exports={parseEvent:function(e,t,n){var i=r(t),o=i.headers[\":message-type\"];if(o){if(\"error\"===o.value)throw function(e){var t=e.headers[\":error-code\"],n=e.headers[\":error-message\"],r=new Error(n.value||n);return r.code=r.name=t.value||t,r}(i);if(\"event\"!==o.value)return}var s=i.headers[\":event-type\"],a=n.members[s.value];if(a){var c={},u=a.eventPayloadMemberName;if(u){var l=a.members[u];\"binary\"===l.type?c[u]=i.body:c[u]=e.parse(i.body.toString(),l)}for(var p=a.eventHeaderMemberNames,d=0;d<p.length;d++){var h=p[d];i.headers[h]&&(c[h]=a.members[h].toType(i.headers[h].value))}var f={};return f[s.value]=c,f}}}},{\"./parse-message\":33}],33:[function(e,t,n){function r(e){for(var t={},n=0;n<e.length;){var r=e.readUInt8(n++),o=e.slice(n,n+r).toString();switch(n+=r,e.readUInt8(n++)){case 0:t[o]={type:s,value:!0};break;case 1:t[o]={type:s,value:!1};break;case 2:t[o]={type:a,value:e.readInt8(n++)};break;case 3:t[o]={type:c,value:e.readInt16BE(n)},n+=2;break;case 4:t[o]={type:u,value:e.readInt32BE(n)},n+=4;break;case 5:t[o]={type:l,value:new i(e.slice(n,n+8))},n+=8;break;case 6:var m=e.readUInt16BE(n);n+=2,t[o]={type:p,value:e.slice(n,n+m)},n+=m;break;case 7:var g=e.readUInt16BE(n);n+=2,t[o]={type:d,value:e.slice(n,n+g).toString()},n+=g;break;case 8:t[o]={type:h,value:new Date(new i(e.slice(n,n+8)).valueOf())},n+=8;break;case 9:var v=e.slice(n,n+16).toString(\"hex\");n+=16,t[o]={type:f,value:v.substr(0,8)+\"-\"+v.substr(8,4)+\"-\"+v.substr(12,4)+\"-\"+v.substr(16,4)+\"-\"+v.substr(20)};break;default:throw new Error(\"Unrecognized header type tag\")}}return t}var i=e(\"./int64\").Int64,o=e(\"./split-message\").splitMessage,s=\"boolean\",a=\"byte\",c=\"short\",u=\"integer\",l=\"long\",p=\"binary\",d=\"string\",h=\"timestamp\",f=\"uuid\";t.exports={parseMessage:function(e){var t=o(e);return{headers:r(t.headers),body:t.body}}}},{\"./int64\":31,\"./split-message\":34}],34:[function(e,t,n){var r=e(\"../core\").util,i=r.buffer.toBuffer;t.exports={splitMessage:function(e){if(r.Buffer.isBuffer(e)||(e=i(e)),e.length<16)throw new Error(\"Provided message too short to accommodate event stream message overhead\");if(e.length!==e.readUInt32BE(0))throw new Error(\"Reported message length does not match received message length\");var t=e.readUInt32BE(8);if(t!==r.crypto.crc32(e.slice(0,8)))throw new Error(\"The prelude checksum specified in the message (\"+t+\") does not match the calculated CRC32 checksum.\");var n=e.readUInt32BE(e.length-4);if(n!==r.crypto.crc32(e.slice(0,e.length-4)))throw new Error(\"The message checksum did not match the expected value of \"+n);var o=12+e.readUInt32BE(4);return{headers:e.slice(12,o),body:e.slice(o,e.length-4)}}}},{\"../core\":20}],35:[function(e,t,n){var r=e(\"./core\"),i=e(\"./sequential_executor\"),o=e(\"./discover_endpoint\").discoverEndpoint;r.EventListeners={Core:{}},r.EventListeners={Core:(new i).addNamedListeners((function(e,t){t(\"VALIDATE_CREDENTIALS\",\"validate\",(function(e,t){if(!e.service.api.signatureVersion&&!e.service.config.signatureVersion)return t();e.service.config.getCredentials((function(n){n&&(e.response.error=r.util.error(n,{code:\"CredentialsError\",message:\"Missing credentials in config, if using AWS_CONFIG_FILE, set AWS_SDK_LOAD_CONFIG=1\"})),t()}))})),e(\"VALIDATE_REGION\",\"validate\",(function(e){if(!e.service.isGlobalEndpoint){var t=new RegExp(/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9])$/);e.service.config.region?t.test(e.service.config.region)||(e.response.error=r.util.error(new Error,{code:\"ConfigError\",message:\"Invalid region in config\"})):e.response.error=r.util.error(new Error,{code:\"ConfigError\",message:\"Missing region in config\"})}})),e(\"BUILD_IDEMPOTENCY_TOKENS\",\"validate\",(function(e){if(e.service.api.operations){var t=e.service.api.operations[e.operation];if(t){var n=t.idempotentMembers;if(n.length){for(var i=r.util.copy(e.params),o=0,s=n.length;o<s;o++)i[n[o]]||(i[n[o]]=r.util.uuid.v4());e.params=i}}}})),e(\"VALIDATE_PARAMETERS\",\"validate\",(function(e){if(e.service.api.operations){var t=e.service.api.operations[e.operation].input,n=e.service.config.paramValidation;new r.ParamValidator(n).validate(t,e.params)}})),t(\"COMPUTE_SHA256\",\"afterBuild\",(function(e,t){if(e.haltHandlersOnError(),e.service.api.operations){var n=e.service.api.operations[e.operation],i=n?n.authtype:\"\";if(!e.service.api.signatureVersion&&!i&&!e.service.config.signatureVersion)return t();if(e.service.getSignerClass(e)===r.Signers.V4){var o=e.httpRequest.body||\"\";if(i.indexOf(\"unsigned-body\")>=0)return e.httpRequest.headers[\"X-Amz-Content-Sha256\"]=\"UNSIGNED-PAYLOAD\",t();r.util.computeSha256(o,(function(n,r){n?t(n):(e.httpRequest.headers[\"X-Amz-Content-Sha256\"]=r,t())}))}else t()}})),e(\"SET_CONTENT_LENGTH\",\"afterBuild\",(function(e){var t=function(e){if(!e.service.api.operations)return\"\";var t=e.service.api.operations[e.operation];return t?t.authtype:\"\"}(e),n=r.util.getRequestPayloadShape(e);if(void 0===e.httpRequest.headers[\"Content-Length\"])try{var i=r.util.string.byteLength(e.httpRequest.body);e.httpRequest.headers[\"Content-Length\"]=i}catch(r){if(n&&n.isStreaming){if(n.requiresLength)throw r;if(t.indexOf(\"unsigned-body\")>=0)return void(e.httpRequest.headers[\"Transfer-Encoding\"]=\"chunked\");throw r}throw r}})),e(\"SET_HTTP_HOST\",\"afterBuild\",(function(e){e.httpRequest.headers.Host=e.httpRequest.endpoint.host})),e(\"RESTART\",\"restart\",(function(){var e=this.response.error;e&&e.retryable&&(this.httpRequest=new r.HttpRequest(this.service.endpoint,this.service.region),this.response.retryCount<this.service.config.maxRetries?this.response.retryCount++:this.response.error=null)})),t(\"DISCOVER_ENDPOINT\",\"sign\",o,!0),t(\"SIGN\",\"sign\",(function(e,t){var n=e.service,r=(e.service.api.operations||{})[e.operation],i=r?r.authtype:\"\";if(!n.api.signatureVersion&&!i&&!n.config.signatureVersion)return t();n.config.getCredentials((function(i,o){if(i)return e.response.error=i,t();try{var s=n.getSkewCorrectedDate(),a=new(n.getSignerClass(e))(e.httpRequest,n.getSigningName(),{signatureCache:n.config.signatureCache,operation:r,signatureVersion:n.api.signatureVersion});a.setServiceClientId(n._clientId),delete e.httpRequest.headers.Authorization,delete e.httpRequest.headers.Date,delete e.httpRequest.headers[\"X-Amz-Date\"],a.addAuthorization(o,s),e.signedAt=s}catch(t){e.response.error=t}t()}))})),e(\"VALIDATE_RESPONSE\",\"validateResponse\",(function(e){this.service.successfulResponse(e,this)?(e.data={},e.error=null):(e.data=null,e.error=r.util.error(new Error,{code:\"UnknownError\",message:\"An unknown error occurred.\"}))})),t(\"SEND\",\"send\",(function(e,t){function n(n){e.httpResponse.stream=n;var i=e.request.httpRequest.stream,o=e.request.service,s=o.api,a=e.request.operation,c=s.operations[a]||{};n.on(\"headers\",(function(i,s,a){if(e.request.emit(\"httpHeaders\",[i,s,e,a]),!e.httpResponse.streaming)if(2===r.HttpClient.streamsApiVersion){if(c.hasEventOutput&&o.successfulResponse(e))return e.request.emit(\"httpDone\"),void t();n.on(\"readable\",(function(){var t=n.read();null!==t&&e.request.emit(\"httpData\",[t,e])}))}else n.on(\"data\",(function(t){e.request.emit(\"httpData\",[t,e])}))})),n.on(\"end\",(function(){if(!i||!i.didCallback){if(2===r.HttpClient.streamsApiVersion&&c.hasEventOutput&&o.successfulResponse(e))return;e.request.emit(\"httpDone\"),t()}}))}function i(n){if(\"RequestAbortedError\"!==n.code){var i=\"TimeoutError\"===n.code?n.code:\"NetworkingError\";n=r.util.error(n,{code:i,region:e.request.httpRequest.region,hostname:e.request.httpRequest.endpoint.hostname,retryable:!0})}e.error=n,e.request.emit(\"httpError\",[e.error,e],(function(){t()}))}function o(){var t=r.HttpClient.getInstance(),o=e.request.service.config.httpOptions||{};try{!function(t){t.on(\"sendProgress\",(function(t){e.request.emit(\"httpUploadProgress\",[t,e])})),t.on(\"receiveProgress\",(function(t){e.request.emit(\"httpDownloadProgress\",[t,e])}))}(t.handleRequest(e.request.httpRequest,o,n,i))}catch(e){i(e)}}e.httpResponse._abortCallback=t,e.error=null,e.data=null,(e.request.service.getSkewCorrectedDate()-this.signedAt)/1e3>=600?this.emit(\"sign\",[this],(function(e){e?t(e):o()})):o()})),e(\"HTTP_HEADERS\",\"httpHeaders\",(function(e,t,n,i){n.httpResponse.statusCode=e,n.httpResponse.statusMessage=i,n.httpResponse.headers=t,n.httpResponse.body=r.util.buffer.toBuffer(\"\"),n.httpResponse.buffers=[],n.httpResponse.numBytes=0;var o=t.date||t.Date,s=n.request.service;if(o){var a=Date.parse(o);s.config.correctClockSkew&&s.isClockSkewed(a)&&s.applyClockOffset(a)}})),e(\"HTTP_DATA\",\"httpData\",(function(e,t){if(e){if(r.util.isNode()){t.httpResponse.numBytes+=e.length;var n=t.httpResponse.headers[\"content-length\"],i={loaded:t.httpResponse.numBytes,total:n};t.request.emit(\"httpDownloadProgress\",[i,t])}t.httpResponse.buffers.push(r.util.buffer.toBuffer(e))}})),e(\"HTTP_DONE\",\"httpDone\",(function(e){if(e.httpResponse.buffers&&e.httpResponse.buffers.length>0){var t=r.util.buffer.concat(e.httpResponse.buffers);e.httpResponse.body=t}delete e.httpResponse.numBytes,delete e.httpResponse.buffers})),e(\"FINALIZE_ERROR\",\"retry\",(function(e){e.httpResponse.statusCode&&(e.error.statusCode=e.httpResponse.statusCode,void 0===e.error.retryable&&(e.error.retryable=this.service.retryableError(e.error,this)))})),e(\"INVALIDATE_CREDENTIALS\",\"retry\",(function(e){if(e.error)switch(e.error.code){case\"RequestExpired\":case\"ExpiredTokenException\":case\"ExpiredToken\":e.error.retryable=!0,e.request.service.config.credentials.expired=!0}})),e(\"EXPIRED_SIGNATURE\",\"retry\",(function(e){var t=e.error;t&&\"string\"==typeof t.code&&\"string\"==typeof t.message&&t.code.match(/Signature/)&&t.message.match(/expired/)&&(e.error.retryable=!0)})),e(\"CLOCK_SKEWED\",\"retry\",(function(e){e.error&&this.service.clockSkewError(e.error)&&this.service.config.correctClockSkew&&(e.error.retryable=!0)})),e(\"REDIRECT\",\"retry\",(function(e){e.error&&e.error.statusCode>=300&&e.error.statusCode<400&&e.httpResponse.headers.location&&(this.httpRequest.endpoint=new r.Endpoint(e.httpResponse.headers.location),this.httpRequest.headers.Host=this.httpRequest.endpoint.host,e.error.redirect=!0,e.error.retryable=!0)})),e(\"RETRY_CHECK\",\"retry\",(function(e){e.error&&(e.error.redirect&&e.redirectCount<e.maxRedirects?e.error.retryDelay=0:e.retryCount<e.maxRetries&&(e.error.retryDelay=this.service.retryDelays(e.retryCount,e.error)||0))})),t(\"RESET_RETRY_STATE\",\"afterRetry\",(function(e,t){var n,r=!1;e.error&&(n=e.error.retryDelay||0,e.error.retryable&&e.retryCount<e.maxRetries?(e.retryCount++,r=!0):e.error.redirect&&e.redirectCount<e.maxRedirects&&(e.redirectCount++,r=!0)),r&&n>=0?(e.error=null,setTimeout(t,n)):t()}))})),CorePost:(new i).addNamedListeners((function(e){e(\"EXTRACT_REQUEST_ID\",\"extractData\",r.util.extractRequestId),e(\"EXTRACT_REQUEST_ID\",\"extractError\",r.util.extractRequestId),e(\"ENOTFOUND_ERROR\",\"httpError\",(function(e){if(\"NetworkingError\"===e.code&&function(e){return\"ENOTFOUND\"===e.errno||\"number\"==typeof e.errno&&\"function\"==typeof r.util.getSystemErrorName&&[\"EAI_NONAME\",\"EAI_NODATA\"].indexOf(r.util.getSystemErrorName(e.errno)>=0)}(e)){var t=\"Inaccessible host: `\"+e.hostname+\"'. This service may not be available in the `\"+e.region+\"' region.\";this.response.error=r.util.error(new Error(t),{code:\"UnknownEndpoint\",region:e.region,hostname:e.hostname,retryable:!0,originalError:e})}}))})),Logger:(new i).addNamedListeners((function(t){t(\"LOG_REQUEST\",\"complete\",(function(t){function n(e,t){if(!t)return t;if(e.isSensitive)return\"***SensitiveInformation***\";switch(e.type){case\"structure\":var i={};return r.util.each(t,(function(t,r){Object.prototype.hasOwnProperty.call(e.members,t)?i[t]=n(e.members[t],r):i[t]=r})),i;case\"list\":var o=[];return r.util.arrayEach(t,(function(t,r){o.push(n(e.member,t))})),o;case\"map\":var s={};return r.util.each(t,(function(t,r){s[t]=n(e.value,r)})),s;default:return t}}var i=t.request,o=i.service.config.logger;if(o){var s=function(){var s=(t.request.service.getSkewCorrectedDate().getTime()-i.startTime.getTime())/1e3,a=!!o.isTTY,c=t.httpResponse.statusCode,u=i.params;i.service.api.operations&&i.service.api.operations[i.operation]&&i.service.api.operations[i.operation].input&&(u=n(i.service.api.operations[i.operation].input,i.params));var l=e(\"util\").inspect(u,!0,null),p=\"\";return a&&(p+=\"\u001B[33m\"),p+=\"[AWS \"+i.service.serviceIdentifier+\" \"+c,p+=\" \"+s.toString()+\"s \"+t.retryCount+\" retries]\",a&&(p+=\"\u001B[0;1m\"),p+=\" \"+r.util.string.lowerFirst(i.operation),p+=\"(\"+l+\")\",a&&(p+=\"\u001B[0m\"),p}();\"function\"==typeof o.log?o.log(s):\"function\"==typeof o.write&&o.write(s+\"\\n\")}}))})),Json:(new i).addNamedListeners((function(t){var n=e(\"./protocol/json\");t(\"BUILD\",\"build\",n.buildRequest),t(\"EXTRACT_DATA\",\"extractData\",n.extractData),t(\"EXTRACT_ERROR\",\"extractError\",n.extractError)})),Rest:(new i).addNamedListeners((function(t){var n=e(\"./protocol/rest\");t(\"BUILD\",\"build\",n.buildRequest),t(\"EXTRACT_DATA\",\"extractData\",n.extractData),t(\"EXTRACT_ERROR\",\"extractError\",n.extractError)})),RestJson:(new i).addNamedListeners((function(t){var n=e(\"./protocol/rest_json\");t(\"BUILD\",\"build\",n.buildRequest),t(\"EXTRACT_DATA\",\"extractData\",n.extractData),t(\"EXTRACT_ERROR\",\"extractError\",n.extractError)})),RestXml:(new i).addNamedListeners((function(t){var n=e(\"./protocol/rest_xml\");t(\"BUILD\",\"build\",n.buildRequest),t(\"EXTRACT_DATA\",\"extractData\",n.extractData),t(\"EXTRACT_ERROR\",\"extractError\",n.extractError)})),Query:(new i).addNamedListeners((function(t){var n=e(\"./protocol/query\");t(\"BUILD\",\"build\",n.buildRequest),t(\"EXTRACT_DATA\",\"extractData\",n.extractData),t(\"EXTRACT_ERROR\",\"extractError\",n.extractError)}))}},{\"./core\":20,\"./discover_endpoint\":28,\"./protocol/json\":48,\"./protocol/query\":49,\"./protocol/rest\":50,\"./protocol/rest_json\":51,\"./protocol/rest_xml\":52,\"./sequential_executor\":60,util:99}],36:[function(e,t,n){var r=e(\"./core\"),i=r.util.inherit;r.Endpoint=i({constructor:function(e,t){if(r.util.hideProperties(this,[\"slashes\",\"auth\",\"hash\",\"search\",\"query\"]),null==e)throw new Error(\"Invalid endpoint: \"+e);if(\"string\"!=typeof e)return r.util.copy(e);e.match(/^http/)||(e=((t&&void 0!==t.sslEnabled?t.sslEnabled:r.config.sslEnabled)?\"https\":\"http\")+\"://\"+e),r.util.update(this,r.util.urlParse(e)),this.port?this.port=parseInt(this.port,10):this.port=\"https:\"===this.protocol?443:80}}),r.HttpRequest=i({constructor:function(e,t){e=new r.Endpoint(e),this.method=\"POST\",this.path=e.path||\"/\",this.headers={},this.body=\"\",this.endpoint=e,this.region=t,this._userAgent=\"\",this.setUserAgent()},setUserAgent:function(){this._userAgent=this.headers[this.getUserAgentHeaderName()]=r.util.userAgent()},getUserAgentHeaderName:function(){return(r.util.isBrowser()?\"X-Amz-\":\"\")+\"User-Agent\"},appendToUserAgent:function(e){\"string\"==typeof e&&e&&(this._userAgent+=\" \"+e),this.headers[this.getUserAgentHeaderName()]=this._userAgent},getUserAgent:function(){return this._userAgent},pathname:function(){return this.path.split(\"?\",1)[0]},search:function(){var e=this.path.split(\"?\",2)[1];return e?(e=r.util.queryStringParse(e),r.util.queryParamsToString(e)):\"\"},updateEndpoint:function(e){var t=new r.Endpoint(e);this.endpoint=t,this.path=t.path||\"/\",this.headers.Host&&(this.headers.Host=t.host)}}),r.HttpResponse=i({constructor:function(){this.statusCode=void 0,this.headers={},this.body=void 0,this.streaming=!1,this.stream=null},createUnbufferedStream:function(){return this.streaming=!0,this.stream}}),r.HttpClient=i({}),r.HttpClient.getInstance=function(){return void 0===this.singleton&&(this.singleton=new this),this.singleton}},{\"./core\":20}],37:[function(e,t,n){var r=e(\"../core\"),i=e(\"events\").EventEmitter;e(\"../http\"),r.XHRClient=r.util.inherit({handleRequest:function(e,t,n,o){var s=this,a=e.endpoint,c=new i,u=a.protocol+\"//\"+a.hostname;80!==a.port&&443!==a.port&&(u+=\":\"+a.port),u+=e.path;var l=new XMLHttpRequest,p=!1;e.stream=l,l.addEventListener(\"readystatechange\",(function(){try{if(0===l.status)return}catch(e){return}this.readyState>=this.HEADERS_RECEIVED&&!p&&(c.statusCode=l.status,c.headers=s.parseHeaders(l.getAllResponseHeaders()),c.emit(\"headers\",c.statusCode,c.headers,l.statusText),p=!0),this.readyState===this.DONE&&s.finishRequest(l,c)}),!1),l.upload.addEventListener(\"progress\",(function(e){c.emit(\"sendProgress\",e)})),l.addEventListener(\"progress\",(function(e){c.emit(\"receiveProgress\",e)}),!1),l.addEventListener(\"timeout\",(function(){o(r.util.error(new Error(\"Timeout\"),{code:\"TimeoutError\"}))}),!1),l.addEventListener(\"error\",(function(){o(r.util.error(new Error(\"Network Failure\"),{code:\"NetworkingError\"}))}),!1),l.addEventListener(\"abort\",(function(){o(r.util.error(new Error(\"Request aborted\"),{code:\"RequestAbortedError\"}))}),!1),n(c),l.open(e.method,u,!1!==t.xhrAsync),r.util.each(e.headers,(function(e,t){\"Content-Length\"!==e&&\"User-Agent\"!==e&&\"Host\"!==e&&l.setRequestHeader(e,t)})),t.timeout&&!1!==t.xhrAsync&&(l.timeout=t.timeout),t.xhrWithCredentials&&(l.withCredentials=!0);try{l.responseType=\"arraybuffer\"}catch(e){}try{e.body?l.send(e.body):l.send()}catch(t){if(!e.body||\"object\"!=typeof e.body.buffer)throw t;l.send(e.body.buffer)}return c},parseHeaders:function(e){var t={};return r.util.arrayEach(e.split(/\\r?\\n/),(function(e){var n=e.split(\":\",1)[0],r=e.substring(n.length+2);n.length>0&&(t[n.toLowerCase()]=r)})),t},finishRequest:function(e,t){var n;if(\"arraybuffer\"===e.responseType&&e.response){var i=e.response;n=new r.util.Buffer(i.byteLength);for(var o=new Uint8Array(i),s=0;s<n.length;++s)n[s]=o[s]}try{n||\"string\"!=typeof e.responseText||(n=new r.util.Buffer(e.responseText))}catch(e){}n&&t.emit(\"data\",n),t.emit(\"end\")}}),r.HttpClient.prototype=r.XHRClient.prototype,r.HttpClient.streamsApiVersion=1},{\"../core\":20,\"../http\":36,events:83}],38:[function(e,t,n){function r(){}function i(e,t){if(t&&null!=e)switch(t.type){case\"structure\":return function(e,t){var n={};return o.each(e,(function(e,r){var o=t.members[e];if(o){if(\"body\"!==o.location)return;var s=o.isLocationName?o.name:e,a=i(r,o);void 0!==a&&(n[s]=a)}})),n}(e,t);case\"map\":return function(e,t){var n={};return o.each(e,(function(e,r){var o=i(r,t.value);void 0!==o&&(n[e]=o)})),n}(e,t);case\"list\":return function(e,t){var n=[];return o.arrayEach(e,(function(e){var r=i(e,t.member);void 0!==r&&n.push(r)})),n}(e,t);default:return function(e,t){return t.toWireFormat(e)}(e,t)}}var o=e(\"../util\");r.prototype.build=function(e,t){return JSON.stringify(i(e,t))},t.exports=r},{\"../util\":73}],39:[function(e,t,n){function r(){}function i(e,t){if(t&&void 0!==e)switch(t.type){case\"structure\":return function(e,t){if(null!=e){var n={},r=t.members;return o.each(r,(function(t,r){var o=r.isLocationName?r.name:t;if(Object.prototype.hasOwnProperty.call(e,o)){var s=i(e[o],r);void 0!==s&&(n[t]=s)}})),n}}(e,t);case\"map\":return function(e,t){if(null!=e){var n={};return o.each(e,(function(e,r){var o=i(r,t.value);n[e]=void 0===o?null:o})),n}}(e,t);case\"list\":return function(e,t){if(null!=e){var n=[];return o.arrayEach(e,(function(e){var r=i(e,t.member);void 0===r?n.push(null):n.push(r)})),n}}(e,t);default:return function(e,t){return t.toType(e)}(e,t)}}var o=e(\"../util\");r.prototype.parse=function(e,t){return i(JSON.parse(e),t)},t.exports=r},{\"../util\":73}],40:[function(e,t,n){var r=e(\"./collection\"),i=e(\"./operation\"),o=e(\"./shape\"),s=e(\"./paginator\"),a=e(\"./resource_waiter\"),c=e(\"../../apis/metadata.json\"),u=e(\"../util\"),l=u.property,p=u.memoizedProperty;t.exports=function(e,t){var n=this;e=e||{},(t=t||{}).api=this,e.metadata=e.metadata||{};var d=t.serviceIdentifier;delete t.serviceIdentifier,l(this,\"isApi\",!0,!1),l(this,\"apiVersion\",e.metadata.apiVersion),l(this,\"endpointPrefix\",e.metadata.endpointPrefix),l(this,\"signingName\",e.metadata.signingName),l(this,\"globalEndpoint\",e.metadata.globalEndpoint),l(this,\"signatureVersion\",e.metadata.signatureVersion),l(this,\"jsonVersion\",e.metadata.jsonVersion),l(this,\"targetPrefix\",e.metadata.targetPrefix),l(this,\"protocol\",e.metadata.protocol),l(this,\"timestampFormat\",e.metadata.timestampFormat),l(this,\"xmlNamespaceUri\",e.metadata.xmlNamespace),l(this,\"abbreviation\",e.metadata.serviceAbbreviation),l(this,\"fullName\",e.metadata.serviceFullName),l(this,\"serviceId\",e.metadata.serviceId),d&&c[d]&&l(this,\"xmlNoDefaultLists\",c[d].xmlNoDefaultLists,!1),p(this,\"className\",(function(){var t=e.metadata.serviceAbbreviation||e.metadata.serviceFullName;return t?(\"ElasticLoadBalancing\"===(t=t.replace(/^Amazon|AWS\\s*|\\(.*|\\s+|\\W+/g,\"\"))&&(t=\"ELB\"),t):null})),l(this,\"operations\",new r(e.operations,t,(function(e,n){return new i(e,n,t)}),u.string.lowerFirst,(function(e,t){!0===t.endpointoperation&&l(n,\"endpointOperation\",u.string.lowerFirst(e)),t.endpointdiscovery&&!n.hasRequiredEndpointDiscovery&&l(n,\"hasRequiredEndpointDiscovery\",!0===t.endpointdiscovery.required)}))),l(this,\"shapes\",new r(e.shapes,t,(function(e,n){return o.create(n,t)}))),l(this,\"paginators\",new r(e.paginators,t,(function(e,n){return new s(e,n,t)}))),l(this,\"waiters\",new r(e.waiters,t,(function(e,n){return new a(e,n,t)}),u.string.lowerFirst)),t.documentation&&(l(this,\"documentation\",e.documentation),l(this,\"documentationUrl\",e.documentationUrl))}},{\"../../apis/metadata.json\":5,\"../util\":73,\"./collection\":41,\"./operation\":42,\"./paginator\":43,\"./resource_waiter\":44,\"./shape\":45}],41:[function(e,t,n){function r(e,t,n,r){i(this,r(e),(function(){return n(e,t)}))}var i=e(\"../util\").memoizedProperty;t.exports=function(e,t,n,i,o){for(var s in i=i||String,e)Object.prototype.hasOwnProperty.call(e,s)&&(r.call(this,s,e[s],n,i),o&&o(s,e[s]))}},{\"../util\":73}],42:[function(e,t,n){var r=e(\"./shape\"),i=e(\"../util\"),o=i.property,s=i.memoizedProperty;t.exports=function(e,t,n){var i=this;n=n||{},o(this,\"name\",t.name||e),o(this,\"api\",n.api,!1),t.http=t.http||{},o(this,\"endpoint\",t.endpoint),o(this,\"httpMethod\",t.http.method||\"POST\"),o(this,\"httpPath\",t.http.requestUri||\"/\"),o(this,\"authtype\",t.authtype||\"\"),o(this,\"endpointDiscoveryRequired\",t.endpointdiscovery?t.endpointdiscovery.required?\"REQUIRED\":\"OPTIONAL\":\"NULL\"),s(this,\"input\",(function(){return t.input?r.create(t.input,n):new r.create({type:\"structure\"},n)})),s(this,\"output\",(function(){return t.output?r.create(t.output,n):new r.create({type:\"structure\"},n)})),s(this,\"errors\",(function(){var e=[];if(!t.errors)return null;for(var i=0;i<t.errors.length;i++)e.push(r.create(t.errors[i],n));return e})),s(this,\"paginator\",(function(){return n.api.paginators[e]})),n.documentation&&(o(this,\"documentation\",t.documentation),o(this,\"documentationUrl\",t.documentationUrl)),s(this,\"idempotentMembers\",(function(){var e=[],t=i.input,n=t.members;if(!t.members)return e;for(var r in n)n.hasOwnProperty(r)&&!0===n[r].isIdempotent&&e.push(r);return e})),s(this,\"hasEventOutput\",(function(){return function(e){var t=e.members,n=e.payload;if(!e.members)return!1;if(n)return t[n].isEventStream;for(var r in t)if(!t.hasOwnProperty(r)&&!0===t[r].isEventStream)return!0;return!1}(i.output)}))}},{\"../util\":73,\"./shape\":45}],43:[function(e,t,n){var r=e(\"../util\").property;t.exports=function(e,t){r(this,\"inputToken\",t.input_token),r(this,\"limitKey\",t.limit_key),r(this,\"moreResults\",t.more_results),r(this,\"outputToken\",t.output_token),r(this,\"resultKey\",t.result_key)}},{\"../util\":73}],44:[function(e,t,n){var r=e(\"../util\"),i=r.property;t.exports=function(e,t,n){n=n||{},i(this,\"name\",e),i(this,\"api\",n.api,!1),t.operation&&i(this,\"operation\",r.string.lowerFirst(t.operation));var o=this;[\"type\",\"description\",\"delay\",\"maxAttempts\",\"acceptors\"].forEach((function(e){var n=t[e];n&&i(o,e,n)}))}},{\"../util\":73}],45:[function(e,t,n){function r(e,t,n){null!=n&&m.property.apply(this,arguments)}function i(e,t){e.constructor.prototype[t]||m.memoizedProperty.apply(this,arguments)}function o(e,t,n){t=t||{},r(this,\"shape\",e.shape),r(this,\"api\",t.api,!1),r(this,\"type\",e.type),r(this,\"enum\",e.enum),r(this,\"min\",e.min),r(this,\"max\",e.max),r(this,\"pattern\",e.pattern),r(this,\"location\",e.location||this.location||\"body\"),r(this,\"name\",this.name||e.xmlName||e.queryName||e.locationName||n),r(this,\"isStreaming\",e.streaming||this.isStreaming||!1),r(this,\"requiresLength\",e.requiresLength,!1),r(this,\"isComposite\",e.isComposite||!1),r(this,\"isShape\",!0,!1),r(this,\"isQueryName\",Boolean(e.queryName),!1),r(this,\"isLocationName\",Boolean(e.locationName),!1),r(this,\"isIdempotent\",!0===e.idempotencyToken),r(this,\"isJsonValue\",!0===e.jsonvalue),r(this,\"isSensitive\",!0===e.sensitive||e.prototype&&!0===e.prototype.sensitive),r(this,\"isEventStream\",Boolean(e.eventstream),!1),r(this,\"isEvent\",Boolean(e.event),!1),r(this,\"isEventPayload\",Boolean(e.eventpayload),!1),r(this,\"isEventHeader\",Boolean(e.eventheader),!1),r(this,\"isTimestampFormatSet\",Boolean(e.timestampFormat)||e.prototype&&!0===e.prototype.isTimestampFormatSet,!1),r(this,\"endpointDiscoveryId\",Boolean(e.endpointdiscoveryid),!1),r(this,\"hostLabel\",Boolean(e.hostLabel),!1),t.documentation&&(r(this,\"documentation\",e.documentation),r(this,\"documentationUrl\",e.documentationUrl)),e.xmlAttribute&&r(this,\"isXmlAttribute\",e.xmlAttribute||!1),r(this,\"defaultValue\",null),this.toWireFormat=function(e){return null==e?\"\":e},this.toType=function(e){return e}}function s(e){o.apply(this,arguments),r(this,\"isComposite\",!0),e.flattened&&r(this,\"flattened\",e.flattened||!1)}function a(e,t){var n=this,a=null,c=!this.isShape;s.apply(this,arguments),c&&(r(this,\"defaultValue\",(function(){return{}})),r(this,\"members\",{}),r(this,\"memberNames\",[]),r(this,\"required\",[]),r(this,\"isRequired\",(function(){return!1}))),e.members&&(r(this,\"members\",new f(e.members,t,(function(e,n){return o.create(n,t,e)}))),i(this,\"memberNames\",(function(){return e.xmlOrder||Object.keys(e.members)})),e.event&&(i(this,\"eventPayloadMemberName\",(function(){for(var e=n.members,t=n.memberNames,r=0,i=t.length;r<i;r++)if(e[t[r]].isEventPayload)return t[r]})),i(this,\"eventHeaderMemberNames\",(function(){for(var e=n.members,t=n.memberNames,r=[],i=0,o=t.length;i<o;i++)e[t[i]].isEventHeader&&r.push(t[i]);return r})))),e.required&&(r(this,\"required\",e.required),r(this,\"isRequired\",(function(t){if(!a){a={};for(var n=0;n<e.required.length;n++)a[e.required[n]]=!0}return a[t]}),!1,!0)),r(this,\"resultWrapper\",e.resultWrapper||null),e.payload&&r(this,\"payload\",e.payload),\"string\"==typeof e.xmlNamespace?r(this,\"xmlNamespaceUri\",e.xmlNamespace):\"object\"==typeof e.xmlNamespace&&(r(this,\"xmlNamespacePrefix\",e.xmlNamespace.prefix),r(this,\"xmlNamespaceUri\",e.xmlNamespace.uri))}function c(e,t){var n=this,a=!this.isShape;if(s.apply(this,arguments),a&&r(this,\"defaultValue\",(function(){return[]})),e.member&&i(this,\"member\",(function(){return o.create(e.member,t)})),this.flattened){var c=this.name;i(this,\"name\",(function(){return n.member.name||c}))}}function u(e,t){var n=!this.isShape;s.apply(this,arguments),n&&(r(this,\"defaultValue\",(function(){return{}})),r(this,\"key\",o.create({type:\"string\"},t)),r(this,\"value\",o.create({type:\"string\"},t))),e.key&&i(this,\"key\",(function(){return o.create(e.key,t)})),e.value&&i(this,\"value\",(function(){return o.create(e.value,t)}))}function l(){o.apply(this,arguments);var e=[\"rest-xml\",\"query\",\"ec2\"];this.toType=function(t){return t=this.api&&e.indexOf(this.api.protocol)>-1?t||\"\":t,this.isJsonValue?JSON.parse(t):t&&\"function\"==typeof t.toString?t.toString():t},this.toWireFormat=function(e){return this.isJsonValue?JSON.stringify(e):e}}function p(){o.apply(this,arguments),this.toType=function(e){var t=m.base64.decode(e);if(this.isSensitive&&m.isNode()&&\"function\"==typeof m.Buffer.alloc){var n=m.Buffer.alloc(t.length,t);t.fill(0),t=n}return t},this.toWireFormat=m.base64.encode}function d(){p.apply(this,arguments)}function h(){o.apply(this,arguments),this.toType=function(e){return\"boolean\"==typeof e?e:null==e?null:\"true\"===e}}var f=e(\"./collection\"),m=e(\"../util\");o.normalizedTypes={character:\"string\",double:\"float\",long:\"integer\",short:\"integer\",biginteger:\"integer\",bigdecimal:\"float\",blob:\"binary\"},o.types={structure:a,list:c,map:u,boolean:h,timestamp:function(e){var t=this;if(o.apply(this,arguments),e.timestampFormat)r(this,\"timestampFormat\",e.timestampFormat);else if(t.isTimestampFormatSet&&this.timestampFormat)r(this,\"timestampFormat\",this.timestampFormat);else if(\"header\"===this.location)r(this,\"timestampFormat\",\"rfc822\");else if(\"querystring\"===this.location)r(this,\"timestampFormat\",\"iso8601\");else if(this.api)switch(this.api.protocol){case\"json\":case\"rest-json\":r(this,\"timestampFormat\",\"unixTimestamp\");break;case\"rest-xml\":case\"query\":case\"ec2\":r(this,\"timestampFormat\",\"iso8601\")}this.toType=function(e){return null==e?null:\"function\"==typeof e.toUTCString?e:\"string\"==typeof e||\"number\"==typeof e?m.date.parseTimestamp(e):null},this.toWireFormat=function(e){return m.date.format(e,t.timestampFormat)}},float:function(){o.apply(this,arguments),this.toType=function(e){return null==e?null:parseFloat(e)},this.toWireFormat=this.toType},integer:function(){o.apply(this,arguments),this.toType=function(e){return null==e?null:parseInt(e,10)},this.toWireFormat=this.toType},string:l,base64:d,binary:p},o.resolve=function(e,t){if(e.shape){var n=t.api.shapes[e.shape];if(!n)throw new Error(\"Cannot find shape reference: \"+e.shape);return n}return null},o.create=function(e,t,n){if(e.isShape)return e;var r=o.resolve(e,t);if(r){var i=Object.keys(e);t.documentation||(i=i.filter((function(e){return!e.match(/documentation/)})));var s=function(){r.constructor.call(this,e,t,n)};return s.prototype=r,new s}e.type||(e.members?e.type=\"structure\":e.member?e.type=\"list\":e.key?e.type=\"map\":e.type=\"string\");var a=e.type;if(o.normalizedTypes[e.type]&&(e.type=o.normalizedTypes[e.type]),o.types[e.type])return new o.types[e.type](e,t,n);throw new Error(\"Unrecognized shape type: \"+a)},o.shapes={StructureShape:a,ListShape:c,MapShape:u,StringShape:l,BooleanShape:h,Base64Shape:d},t.exports=o},{\"../util\":73,\"./collection\":41}],46:[function(e,t,n){var r=e(\"./core\");r.ParamValidator=r.util.inherit({constructor:function(e){!0!==e&&void 0!==e||(e={min:!0}),this.validation=e},validate:function(e,t,n){if(this.errors=[],this.validateMember(e,t||{},n||\"params\"),this.errors.length>1){var i=this.errors.join(\"\\n* \");throw i=\"There were \"+this.errors.length+\" validation errors:\\n* \"+i,r.util.error(new Error(i),{code:\"MultipleValidationErrors\",errors:this.errors})}if(1===this.errors.length)throw this.errors[0];return!0},fail:function(e,t){this.errors.push(r.util.error(new Error(t),{code:e}))},validateStructure:function(e,t,n){this.validateType(t,n,[\"object\"],\"structure\");for(var r,i=0;e.required&&i<e.required.length;i++){null!=t[r=e.required[i]]||this.fail(\"MissingRequiredParameter\",\"Missing required key '\"+r+\"' in \"+n)}for(r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=t[r],s=e.members[r];if(void 0!==s){var a=[n,r].join(\".\");this.validateMember(s,o,a)}else this.fail(\"UnexpectedParameter\",\"Unexpected key '\"+r+\"' found in \"+n)}return!0},validateMember:function(e,t,n){switch(e.type){case\"structure\":return this.validateStructure(e,t,n);case\"list\":return this.validateList(e,t,n);case\"map\":return this.validateMap(e,t,n);default:return this.validateScalar(e,t,n)}},validateList:function(e,t,n){if(this.validateType(t,n,[Array])){this.validateRange(e,t.length,n,\"list member count\");for(var r=0;r<t.length;r++)this.validateMember(e.member,t[r],n+\"[\"+r+\"]\")}},validateMap:function(e,t,n){if(this.validateType(t,n,[\"object\"],\"map\")){var r=0;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(this.validateMember(e.key,i,n+\"[key='\"+i+\"']\"),this.validateMember(e.value,t[i],n+\"['\"+i+\"']\"),r++);this.validateRange(e,r,n,\"map member count\")}},validateScalar:function(e,t,n){switch(e.type){case null:case void 0:case\"string\":return this.validateString(e,t,n);case\"base64\":case\"binary\":return this.validatePayload(t,n);case\"integer\":case\"float\":return this.validateNumber(e,t,n);case\"boolean\":return this.validateType(t,n,[\"boolean\"]);case\"timestamp\":return this.validateType(t,n,[Date,/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$/,\"number\"],\"Date object, ISO-8601 string, or a UNIX timestamp\");default:return this.fail(\"UnkownType\",\"Unhandled type \"+e.type+\" for \"+n)}},validateString:function(e,t,n){var r=[\"string\"];e.isJsonValue&&(r=r.concat([\"number\",\"object\",\"boolean\"])),null!==t&&this.validateType(t,n,r)&&(this.validateEnum(e,t,n),this.validateRange(e,t.length,n,\"string length\"),this.validatePattern(e,t,n),this.validateUri(e,t,n))},validateUri:function(e,t,n){\"uri\"===e.location&&0===t.length&&this.fail(\"UriParameterError\",'Expected uri parameter to have length >= 1, but found \"'+t+'\" for '+n)},validatePattern:function(e,t,n){this.validation.pattern&&void 0!==e.pattern&&(new RegExp(e.pattern).test(t)||this.fail(\"PatternMatchError\",'Provided value \"'+t+'\" does not match regex pattern /'+e.pattern+\"/ for \"+n))},validateRange:function(e,t,n,r){this.validation.min&&void 0!==e.min&&t<e.min&&this.fail(\"MinRangeError\",\"Expected \"+r+\" >= \"+e.min+\", but found \"+t+\" for \"+n),this.validation.max&&void 0!==e.max&&t>e.max&&this.fail(\"MaxRangeError\",\"Expected \"+r+\" <= \"+e.max+\", but found \"+t+\" for \"+n)},validateEnum:function(e,t,n){this.validation.enum&&void 0!==e.enum&&-1===e.enum.indexOf(t)&&this.fail(\"EnumError\",\"Found string value of \"+t+\", but expected \"+e.enum.join(\"|\")+\" for \"+n)},validateType:function(e,t,n,i){if(null==e)return!1;for(var o=!1,s=0;s<n.length;s++){if(\"string\"==typeof n[s]){if(typeof e===n[s])return!0}else if(n[s]instanceof RegExp){if((e||\"\").toString().match(n[s]))return!0}else{if(e instanceof n[s])return!0;if(r.util.isType(e,n[s]))return!0;i||o||(n=n.slice()),n[s]=r.util.typeName(n[s])}o=!0}var a=i;a||(a=n.join(\", \").replace(/,([^,]+)$/,\", or$1\"));var c=a.match(/^[aeiou]/i)?\"n\":\"\";return this.fail(\"InvalidParameterType\",\"Expected \"+t+\" to be a\"+c+\" \"+a),!1},validateNumber:function(e,t,n){if(null!=t){if(\"string\"==typeof t){var r=parseFloat(t);r.toString()===t&&(t=r)}this.validateType(t,n,[\"number\"])&&this.validateRange(e,t,n,\"numeric value\")}},validatePayload:function(e,t){if(null!=e&&\"string\"!=typeof e&&(!e||\"number\"!=typeof e.byteLength)){if(r.util.isNode()){var n=r.util.stream.Stream;if(r.util.Buffer.isBuffer(e)||e instanceof n)return}else if(void 0!==typeof Blob&&e instanceof Blob)return;var i=[\"Buffer\",\"Stream\",\"File\",\"Blob\",\"ArrayBuffer\",\"DataView\"];if(e)for(var o=0;o<i.length;o++){if(r.util.isType(e,i[o]))return;if(r.util.typeName(e.constructor)===i[o])return}this.fail(\"InvalidParameterType\",\"Expected \"+t+\" to be a string, Buffer, Stream, Blob, or typed array object\")}}})},{\"./core\":20}],47:[function(e,t,n){var r=e(\"../util\"),i=e(\"../core\");t.exports={populateHostPrefix:function(e){if(!e.service.config.hostPrefixEnabled)return e;var t=e.service.api.operations[e.operation];if(function(e){var t=e.service.api,n=t.operations[e.operation],i=t.endpointOperation&&t.endpointOperation===r.string.lowerFirst(n.name);return\"NULL\"!==n.endpointDiscoveryRequired||!0===i}(e))return e;if(t.endpoint&&t.endpoint.hostPrefix){var n=function(e,t,n){return r.each(n.members,(function(n,i){if(!0===i.hostLabel){if(\"string\"!=typeof t[n]||\"\"===t[n])throw r.error(new Error,{message:\"Parameter \"+n+\" should be a non-empty string.\",code:\"InvalidParameter\"});var o=new RegExp(\"\\\\{\"+n+\"\\\\}\",\"g\");e=e.replace(o,t[n])}})),e}(t.endpoint.hostPrefix,e.params,t.input);(function(e,t){e.host&&(e.host=t+e.host),e.hostname&&(e.hostname=t+e.hostname)})(e.httpRequest.endpoint,n),function(e){var t=e.split(\".\"),n=/^[a-zA-Z0-9]{1}$|^[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9]$/;r.arrayEach(t,(function(e){if(!e.length||e.length<1||e.length>63)throw r.error(new Error,{code:\"ValidationError\",message:\"Hostname label length should be between 1 to 63 characters, inclusive.\"});if(!n.test(e))throw i.util.error(new Error,{code:\"ValidationError\",message:e+\" is not hostname compatible.\"})}))}(e.httpRequest.endpoint.hostname)}return e}}},{\"../core\":20,\"../util\":73}],48:[function(e,t,n){var r=e(\"../util\"),i=e(\"../json/builder\"),o=e(\"../json/parser\"),s=e(\"./helpers\").populateHostPrefix;t.exports={buildRequest:function(e){var t=e.httpRequest,n=e.service.api,r=n.targetPrefix+\".\"+n.operations[e.operation].name,o=n.jsonVersion||\"1.0\",a=n.operations[e.operation].input,c=new i;1===o&&(o=\"1.0\"),t.body=c.build(e.params||{},a),t.headers[\"Content-Type\"]=\"application/x-amz-json-\"+o,t.headers[\"X-Amz-Target\"]=r,s(e)},extractError:function(e){var t={},n=e.httpResponse;if(t.code=n.headers[\"x-amzn-errortype\"]||\"UnknownError\",\"string\"==typeof t.code&&(t.code=t.code.split(\":\")[0]),n.body.length>0)try{var i=JSON.parse(n.body.toString()),o=i.__type||i.code||i.Code;o&&(t.code=o.split(\"#\").pop()),\"RequestEntityTooLarge\"===t.code?t.message=\"Request body must be less than 1 MB\":t.message=i.message||i.Message||null}catch(i){t.statusCode=n.statusCode,t.message=n.statusMessage}else t.statusCode=n.statusCode,t.message=n.statusCode.toString();e.error=r.error(new Error,t)},extractData:function(e){var t=e.httpResponse.body.toString()||\"{}\";if(!1===e.request.service.config.convertResponseTypes)e.data=JSON.parse(t);else{var n=e.request.service.api.operations[e.request.operation].output||{},r=new o;e.data=r.parse(t,n)}}}},{\"../json/builder\":38,\"../json/parser\":39,\"../util\":73,\"./helpers\":47}],49:[function(e,t,n){var r=e(\"../core\"),i=e(\"../util\"),o=e(\"../query/query_param_serializer\"),s=e(\"../model/shape\"),a=e(\"./helpers\").populateHostPrefix;t.exports={buildRequest:function(e){var t=e.service.api.operations[e.operation],n=e.httpRequest;n.headers[\"Content-Type\"]=\"application/x-www-form-urlencoded; charset=utf-8\",n.params={Version:e.service.api.apiVersion,Action:t.name},(new o).serialize(e.params,t.input,(function(e,t){n.params[e]=t})),n.body=i.queryParamsToString(n.params),a(e)},extractError:function(e){var t,n=e.httpResponse.body.toString();if(n.match(\"<UnknownOperationException\"))t={Code:\"UnknownOperation\",Message:\"Unknown operation \"+e.request.operation};else try{t=(new r.XML.Parser).parse(n)}catch(n){t={Code:e.httpResponse.statusCode,Message:e.httpResponse.statusMessage}}t.requestId&&!e.requestId&&(e.requestId=t.requestId),t.Errors&&(t=t.Errors),t.Error&&(t=t.Error),t.Code?e.error=i.error(new Error,{code:t.Code,message:t.Message}):e.error=i.error(new Error,{code:e.httpResponse.statusCode,message:null})},extractData:function(e){var t=e.request,n=t.service.api.operations[t.operation].output||{},o=n;if(o.resultWrapper){var a=s.create({type:\"structure\"});a.members[o.resultWrapper]=n,a.memberNames=[o.resultWrapper],i.property(n,\"name\",n.resultWrapper),n=a}var c=new r.XML.Parser;if(n&&n.members&&!n.members._XAMZRequestId){var u=s.create({type:\"string\"},{api:{protocol:\"query\"}},\"requestId\");n.members._XAMZRequestId=u}var l=c.parse(e.httpResponse.body.toString(),n);e.requestId=l._XAMZRequestId||l.requestId,l._XAMZRequestId&&delete l._XAMZRequestId,o.resultWrapper&&l[o.resultWrapper]&&(i.update(l,l[o.resultWrapper]),delete l[o.resultWrapper]),e.data=l}}},{\"../core\":20,\"../model/shape\":45,\"../query/query_param_serializer\":53,\"../util\":73,\"./helpers\":47}],50:[function(e,t,n){function r(e,t,n,r){var o=[e,t].join(\"/\");o=o.replace(/\\/+/g,\"/\");var s={},a=!1;if(i.each(n.members,(function(e,t){var n=r[e];if(null!=n)if(\"uri\"===t.location){var c=new RegExp(\"\\\\{\"+t.name+\"(\\\\+)?\\\\}\");o=o.replace(c,(function(e,t){return(t?i.uriEscapePath:i.uriEscape)(String(n))}))}else\"querystring\"===t.location&&(a=!0,\"list\"===t.type?s[t.name]=n.map((function(e){return i.uriEscape(t.member.toWireFormat(e).toString())})):\"map\"===t.type?i.each(n,(function(e,t){Array.isArray(t)?s[e]=t.map((function(e){return i.uriEscape(String(e))})):s[e]=i.uriEscape(String(t))})):s[t.name]=i.uriEscape(t.toWireFormat(n).toString()))})),a){o+=o.indexOf(\"?\")>=0?\"&\":\"?\";var c=[];i.arrayEach(Object.keys(s).sort(),(function(e){Array.isArray(s[e])||(s[e]=[s[e]]);for(var t=0;t<s[e].length;t++)c.push(i.uriEscape(String(e))+\"=\"+s[e][t])})),o+=c.join(\"&\")}return o}var i=e(\"../util\"),o=e(\"./helpers\").populateHostPrefix;t.exports={buildRequest:function(e){(function(e){e.httpRequest.method=e.service.api.operations[e.operation].httpMethod})(e),function(e){var t=e.service.api.operations[e.operation],n=t.input,i=r(e.httpRequest.endpoint.path,t.httpPath,n,e.params);e.httpRequest.path=i}(e),function(e){var t=e.service.api.operations[e.operation];i.each(t.input.members,(function(t,n){var r=e.params[t];null!=r&&(\"headers\"===n.location&&\"map\"===n.type?i.each(r,(function(t,r){e.httpRequest.headers[n.name+t]=r})):\"header\"===n.location&&(r=n.toWireFormat(r).toString(),n.isJsonValue&&(r=i.base64.encode(r)),e.httpRequest.headers[n.name]=r))}))}(e),o(e)},extractError:function(){},extractData:function(e){var t=e.request,n={},r=e.httpResponse,o=t.service.api.operations[t.operation].output,s={};i.each(r.headers,(function(e,t){s[e.toLowerCase()]=t})),i.each(o.members,(function(e,t){var o=(t.name||e).toLowerCase();if(\"headers\"===t.location&&\"map\"===t.type){n[e]={};var a=t.isLocationName?t.name:\"\",c=new RegExp(\"^\"+a+\"(.+)\",\"i\");i.each(r.headers,(function(t,r){var i=t.match(c);null!==i&&(n[e][i[1]]=r)}))}else if(\"header\"===t.location){if(void 0!==s[o]){var u=t.isJsonValue?i.base64.decode(s[o]):s[o];n[e]=t.toType(u)}}else\"statusCode\"===t.location&&(n[e]=parseInt(r.statusCode,10))})),e.data=n},generateURI:r}},{\"../util\":73,\"./helpers\":47}],51:[function(e,t,n){function r(e,t){if(e.service.api.operations[e.operation].input,!e.httpRequest.headers[\"Content-Type\"]){var n=t?\"binary/octet-stream\":\"application/json\";e.httpRequest.headers[\"Content-Type\"]=n}}var i=e(\"../util\"),o=e(\"./rest\"),s=e(\"./json\"),a=e(\"../json/builder\"),c=e(\"../json/parser\");t.exports={buildRequest:function(e){o.buildRequest(e),[\"HEAD\",\"DELETE\"].indexOf(e.httpRequest.method)<0&&function(e){var t=new a,n=e.service.api.operations[e.operation].input;if(n.payload){var i,o=n.members[n.payload];if(void 0===(i=e.params[n.payload]))return;\"structure\"===o.type?(e.httpRequest.body=t.build(i,o),r(e)):(e.httpRequest.body=i,(\"binary\"===o.type||o.isStreaming)&&r(e,!0))}else{var s=t.build(e.params,n);\"{}\"===s&&\"GET\"===e.httpRequest.method||(e.httpRequest.body=s),r(e)}}(e)},extractError:function(e){s.extractError(e)},extractData:function(e){o.extractData(e);var t=e.request,n=t.service.api.operations[t.operation],r=t.service.api.operations[t.operation].output||{};if(n.hasEventOutput,r.payload){var a=r.members[r.payload],u=e.httpResponse.body;if(a.isEventStream)l=new c,e.data[payload]=i.createEventStream(2===AWS.HttpClient.streamsApiVersion?e.httpResponse.stream:u,l,a);else if(\"structure\"===a.type||\"list\"===a.type){var l=new c;e.data[r.payload]=l.parse(u,a)}else\"binary\"===a.type||a.isStreaming?e.data[r.payload]=u:e.data[r.payload]=a.toType(u)}else{var p=e.data;s.extractData(e),e.data=i.merge(p,e.data)}}}},{\"../json/builder\":38,\"../json/parser\":39,\"../util\":73,\"./json\":48,\"./rest\":50}],52:[function(e,t,n){var r=e(\"../core\"),i=e(\"../util\"),o=e(\"./rest\");t.exports={buildRequest:function(e){o.buildRequest(e),[\"GET\",\"HEAD\"].indexOf(e.httpRequest.method)<0&&function(e){var t=e.service.api.operations[e.operation].input,n=new r.XML.Builder,o=e.params,s=t.payload;if(s){var a=t.members[s];if(void 0===(o=o[s]))return;if(\"structure\"===a.type){var c=a.name;e.httpRequest.body=n.toXML(o,a,c,!0)}else e.httpRequest.body=o}else e.httpRequest.body=n.toXML(o,t,t.name||t.shape||i.string.upperFirst(e.operation)+\"Request\")}(e)},extractError:function(e){var t;o.extractError(e);try{t=(new r.XML.Parser).parse(e.httpResponse.body.toString())}catch(n){t={Code:e.httpResponse.statusCode,Message:e.httpResponse.statusMessage}}t.Errors&&(t=t.Errors),t.Error&&(t=t.Error),t.Code?e.error=i.error(new Error,{code:t.Code,message:t.Message}):e.error=i.error(new Error,{code:e.httpResponse.statusCode,message:null})},extractData:function(e){o.extractData(e);var t,n=e.request,s=e.httpResponse.body,a=n.service.api.operations[n.operation],c=a.output,u=(a.hasEventOutput,c.payload);if(u){var l=c.members[u];l.isEventStream?(t=new r.XML.Parser,e.data[u]=i.createEventStream(2===r.HttpClient.streamsApiVersion?e.httpResponse.stream:e.httpResponse.body,t,l)):\"structure\"===l.type?(t=new r.XML.Parser,e.data[u]=t.parse(s.toString(),l)):\"binary\"===l.type||l.isStreaming?e.data[u]=s:e.data[u]=l.toType(s)}else if(s.length>0){var p=(t=new r.XML.Parser).parse(s.toString(),c);i.update(e.data,p)}}}},{\"../core\":20,\"../util\":73,\"./rest\":50}],53:[function(e,t,n){function r(){}function i(e){return e.isQueryName||\"ec2\"!==e.api.protocol?e.name:e.name[0].toUpperCase()+e.name.substr(1)}function o(e,t,n,r){a.each(n.members,(function(n,o){var a=t[n];if(null!=a){var c=i(o);s(c=e?e+\".\"+c:c,a,o,r)}}))}function s(e,t,n,r){null!=t&&(\"structure\"===n.type?o(e,t,n,r):\"list\"===n.type?function(e,t,n,r){var o=n.member||{};0!==t.length?a.arrayEach(t,(function(t,a){var c=\".\"+(a+1);if(\"ec2\"===n.api.protocol)c+=\"\";else if(n.flattened){if(o.name){var u=e.split(\".\");u.pop(),u.push(i(o)),e=u.join(\".\")}}else c=\".\"+(o.name?o.name:\"member\")+c;s(e+c,t,o,r)})):r.call(this,e,null)}(e,t,n,r):\"map\"===n.type?function(e,t,n,r){var i=1;a.each(t,(function(t,o){var a=(n.flattened?\".\":\".entry.\")+i+++\".\",c=a+(n.key.name||\"key\"),u=a+(n.value.name||\"value\");s(e+c,t,n.key,r),s(e+u,o,n.value,r)}))}(e,t,n,r):r(e,n.toWireFormat(t).toString()))}var a=e(\"../util\");r.prototype.serialize=function(e,t,n){o(\"\",e,t,n)},t.exports=r},{\"../util\":73}],54:[function(e,t,n){t.exports={now:function(){return\"undefined\"!=typeof performance&&\"function\"==typeof performance.now?performance.now():Date.now()}}},{}],55:[function(e,t,n){function r(e,t){i.each(t,(function(t,n){\"globalEndpoint\"!==t&&(void 0!==e.config[t]&&null!==e.config[t]||(e.config[t]=n))}))}var i=e(\"./util\"),o=e(\"./region_config_data.json\");t.exports={configureEndpoint:function(e){for(var t=function(e){var t=e.config.region,n=function(e){if(!e)return null;var t=e.split(\"-\");return t.length<3?null:t.slice(0,t.length-2).join(\"-\")+\"-*\"}(t),r=e.api.endpointPrefix;return[[t,r],[n,r],[t,\"*\"],[n,\"*\"],[\"*\",r],[\"*\",\"*\"]].map((function(e){return e[0]&&e[1]?e.join(\"/\"):null}))}(e),n=0;n<t.length;n++){var s=t[n];if(s&&Object.prototype.hasOwnProperty.call(o.rules,s)){var a=o.rules[s];return\"string\"==typeof a&&(a=o.patterns[a]),e.config.useDualstack&&i.isDualstackAvailable(e)&&((a=i.copy(a)).endpoint=a.endpoint.replace(/{service}\\.({region}\\.)?/,\"{service}.dualstack.{region}.\")),e.isGlobalEndpoint=!!a.globalEndpoint,a.signingRegion&&(e.signingRegion=a.signingRegion),a.signatureVersion||(a.signatureVersion=\"v4\"),void r(e,a)}}},getEndpointSuffix:function(e){for(var t={\"^(us|eu|ap|sa|ca|me)\\\\-\\\\w+\\\\-\\\\d+$\":\"amazonaws.com\",\"^cn\\\\-\\\\w+\\\\-\\\\d+$\":\"amazonaws.com.cn\",\"^us\\\\-gov\\\\-\\\\w+\\\\-\\\\d+$\":\"amazonaws.com\",\"^us\\\\-iso\\\\-\\\\w+\\\\-\\\\d+$\":\"c2s.ic.gov\",\"^us\\\\-isob\\\\-\\\\w+\\\\-\\\\d+$\":\"sc2s.sgov.gov\"},n=Object.keys(t),r=0;r<n.length;r++){var i=RegExp(n[r]),o=t[n[r]];if(i.test(e))return o}return\"amazonaws.com\"}}},{\"./region_config_data.json\":56,\"./util\":73}],56:[function(e,t,n){t.exports={rules:{\"*/*\":{endpoint:\"{service}.{region}.amazonaws.com\"},\"cn-*/*\":{endpoint:\"{service}.{region}.amazonaws.com.cn\"},\"us-iso-*/*\":{endpoint:\"{service}.{region}.c2s.ic.gov\"},\"us-isob-*/*\":{endpoint:\"{service}.{region}.sc2s.sgov.gov\"},\"*/budgets\":\"globalSSL\",\"*/cloudfront\":\"globalSSL\",\"*/sts\":\"globalSSL\",\"*/importexport\":{endpoint:\"{service}.amazonaws.com\",signatureVersion:\"v2\",globalEndpoint:!0},\"*/route53\":\"globalSSL\",\"cn-*/route53\":{endpoint:\"{service}.amazonaws.com.cn\",globalEndpoint:!0,signingRegion:\"cn-northwest-1\"},\"us-gov-*/route53\":\"globalGovCloud\",\"*/waf\":\"globalSSL\",\"*/iam\":\"globalSSL\",\"cn-*/iam\":{endpoint:\"{service}.cn-north-1.amazonaws.com.cn\",globalEndpoint:!0,signingRegion:\"cn-north-1\"},\"us-gov-*/iam\":\"globalGovCloud\",\"us-gov-*/sts\":{endpoint:\"{service}.{region}.amazonaws.com\"},\"us-gov-west-1/s3\":\"s3signature\",\"us-west-1/s3\":\"s3signature\",\"us-west-2/s3\":\"s3signature\",\"eu-west-1/s3\":\"s3signature\",\"ap-southeast-1/s3\":\"s3signature\",\"ap-southeast-2/s3\":\"s3signature\",\"ap-northeast-1/s3\":\"s3signature\",\"sa-east-1/s3\":\"s3signature\",\"us-east-1/s3\":{endpoint:\"{service}.amazonaws.com\",signatureVersion:\"s3\"},\"us-east-1/sdb\":{endpoint:\"{service}.amazonaws.com\",signatureVersion:\"v2\"},\"*/sdb\":{endpoint:\"{service}.{region}.amazonaws.com\",signatureVersion:\"v2\"}},patterns:{globalSSL:{endpoint:\"https://{service}.amazonaws.com\",globalEndpoint:!0,signingRegion:\"us-east-1\"},globalGovCloud:{endpoint:\"{service}.us-gov.amazonaws.com\",globalEndpoint:!0,signingRegion:\"us-gov-west-1\"},s3signature:{endpoint:\"{service}.{region}.amazonaws.com\",signatureVersion:\"s3\"}}}},{}],57:[function(e,t,n){(function(t){(function(){var n=e(\"./core\"),r=e(\"./state_machine\"),i=n.util.inherit,o=n.util.domain,s=e(\"jmespath\"),a={success:1,error:1,complete:1},c=new r;c.setupStates=function(){var e=function(e,t){var n=this;n._haltHandlersOnError=!1,n.emit(n._asm.currentState,(function(e){if(e)if(function(e){return Object.prototype.hasOwnProperty.call(a,e._asm.currentState)}(n)){if(!(o&&n.domain instanceof o.Domain))throw e;e.domainEmitter=n,e.domain=n.domain,e.domainThrown=!1,n.domain.emit(\"error\",e)}else n.response.error=e,t(e);else t(n.response.error)}))};this.addState(\"validate\",\"build\",\"error\",e),this.addState(\"build\",\"afterBuild\",\"restart\",e),this.addState(\"afterBuild\",\"sign\",\"restart\",e),this.addState(\"sign\",\"send\",\"retry\",e),this.addState(\"retry\",\"afterRetry\",\"afterRetry\",e),this.addState(\"afterRetry\",\"sign\",\"error\",e),this.addState(\"send\",\"validateResponse\",\"retry\",e),this.addState(\"validateResponse\",\"extractData\",\"extractError\",e),this.addState(\"extractError\",\"extractData\",\"retry\",e),this.addState(\"extractData\",\"success\",\"retry\",e),this.addState(\"restart\",\"build\",\"error\",e),this.addState(\"success\",\"complete\",\"complete\",e),this.addState(\"error\",\"complete\",\"complete\",e),this.addState(\"complete\",null,null,e)},c.setupStates(),n.Request=i({constructor:function(e,t,i){var s=e.endpoint,a=e.config.region,u=e.config.customUserAgent;e.isGlobalEndpoint&&(a=e.signingRegion?e.signingRegion:\"us-east-1\"),this.domain=o&&o.active,this.service=e,this.operation=t,this.params=i||{},this.httpRequest=new n.HttpRequest(s,a),this.httpRequest.appendToUserAgent(u),this.startTime=e.getSkewCorrectedDate(),this.response=new n.Response(this),this._asm=new r(c.states,\"validate\"),this._haltHandlersOnError=!1,n.SequentialExecutor.call(this),this.emit=this.emitEvent},send:function(e){return e&&(this.httpRequest.appendToUserAgent(\"callback\"),this.on(\"complete\",(function(t){e.call(t,t.error,t.data)}))),this.runTo(),this.response},build:function(e){return this.runTo(\"send\",e)},runTo:function(e,t){return this._asm.runTo(e,t,this),this},abort:function(){return this.removeAllListeners(\"validateResponse\"),this.removeAllListeners(\"extractError\"),this.on(\"validateResponse\",(function(e){e.error=n.util.error(new Error(\"Request aborted by user\"),{code:\"RequestAbortedError\",retryable:!1})})),this.httpRequest.stream&&!this.httpRequest.stream.didCallback&&(this.httpRequest.stream.abort(),this.httpRequest._abortCallback?this.httpRequest._abortCallback():this.removeAllListeners(\"send\")),this},eachPage:function(e){e=n.util.fn.makeAsync(e,3),this.on(\"complete\",(function t(r){e.call(r,r.error,r.data,(function(i){!1!==i&&(r.hasNextPage()?r.nextPage().on(\"complete\",t).send():e.call(r,null,null,n.util.fn.noop))}))})).send()},eachItem:function(e){var t=this;this.eachPage((function(r,i){if(r)return e(r,null);if(null===i)return e(null,null);var o=t.service.paginationConfig(t.operation).resultKey;Array.isArray(o)&&(o=o[0]);var a=s.search(i,o),c=!0;return n.util.arrayEach(a,(function(t){if(!1===(c=e(null,t)))return n.util.abort})),c}))},isPageable:function(){return!!this.service.paginationConfig(this.operation)},createReadStream:function(){var e=n.util.stream,r=this,i=null;return 2===n.HttpClient.streamsApiVersion?(i=new e.PassThrough,t.nextTick((function(){r.send()}))):((i=new e.Stream).readable=!0,i.sent=!1,i.on(\"newListener\",(function(e){i.sent||\"data\"!==e||(i.sent=!0,t.nextTick((function(){r.send()})))}))),this.on(\"error\",(function(e){i.emit(\"error\",e)})),this.on(\"httpHeaders\",(function(t,o,s){if(t<300){r.removeListener(\"httpData\",n.EventListeners.Core.HTTP_DATA),r.removeListener(\"httpError\",n.EventListeners.Core.HTTP_ERROR),r.on(\"httpError\",(function(e){s.error=e,s.error.retryable=!1}));var a,c=!1;if(\"HEAD\"!==r.httpRequest.method&&(a=parseInt(o[\"content-length\"],10)),void 0!==a&&!isNaN(a)&&a>=0){c=!0;var u=0}var l=function(){c&&u!==a?i.emit(\"error\",n.util.error(new Error(\"Stream content length mismatch. Received \"+u+\" of \"+a+\" bytes.\"),{code:\"StreamContentLengthMismatch\"})):2===n.HttpClient.streamsApiVersion?i.end():i.emit(\"end\")},p=s.httpResponse.createUnbufferedStream();if(2===n.HttpClient.streamsApiVersion)if(c){var d=new e.PassThrough;d._write=function(t){return t&&t.length&&(u+=t.length),e.PassThrough.prototype._write.apply(this,arguments)},d.on(\"end\",l),i.on(\"error\",(function(e){c=!1,p.unpipe(d),d.emit(\"end\"),d.end()})),p.pipe(d).pipe(i,{end:!1})}else p.pipe(i);else c&&p.on(\"data\",(function(e){e&&e.length&&(u+=e.length)})),p.on(\"data\",(function(e){i.emit(\"data\",e)})),p.on(\"end\",l);p.on(\"error\",(function(e){c=!1,i.emit(\"error\",e)}))}})),i},emitEvent:function(e,t,r){\"function\"==typeof t&&(r=t,t=null),r||(r=function(){}),t||(t=this.eventParameters(e,this.response)),n.SequentialExecutor.prototype.emit.call(this,e,t,(function(e){e&&(this.response.error=e),r.call(this,e)}))},eventParameters:function(e){switch(e){case\"restart\":case\"validate\":case\"sign\":case\"build\":case\"afterValidate\":case\"afterBuild\":return[this];case\"error\":return[this.response.error,this.response];default:return[this.response]}},presign:function(e,t){return t||\"function\"!=typeof e||(t=e,e=null),(new n.Signers.Presign).sign(this.toGet(),e,t)},isPresigned:function(){return Object.prototype.hasOwnProperty.call(this.httpRequest.headers,\"presigned-expires\")},toUnauthenticated:function(){return this._unAuthenticated=!0,this.removeListener(\"validate\",n.EventListeners.Core.VALIDATE_CREDENTIALS),this.removeListener(\"sign\",n.EventListeners.Core.SIGN),this},toGet:function(){return\"query\"!==this.service.api.protocol&&\"ec2\"!==this.service.api.protocol||(this.removeListener(\"build\",this.buildAsGet),this.addListener(\"build\",this.buildAsGet)),this},buildAsGet:function(e){e.httpRequest.method=\"GET\",e.httpRequest.path=e.service.endpoint.path+\"?\"+e.httpRequest.body,e.httpRequest.body=\"\",delete e.httpRequest.headers[\"Content-Length\"],delete e.httpRequest.headers[\"Content-Type\"]},haltHandlersOnError:function(){this._haltHandlersOnError=!0}}),n.Request.addPromisesToClass=function(e){this.prototype.promise=function(){var t=this;return this.httpRequest.appendToUserAgent(\"promise\"),new e((function(e,n){t.on(\"complete\",(function(t){t.error?n(t.error):e(Object.defineProperty(t.data||{},\"$response\",{value:t}))})),t.runTo()}))}},n.Request.deletePromisesFromClass=function(){delete this.prototype.promise},n.util.addPromises(n.Request),n.util.mixin(n.Request,n.SequentialExecutor)}).call(this)}).call(this,e(\"_process\"))},{\"./core\":20,\"./state_machine\":72,_process:87,jmespath:86}],58:[function(e,t,n){function r(e){var t=e.request._waiter,n=t.config.acceptors,r=!1,i=\"retry\";n.forEach((function(n){if(!r){var o=t.matchers[n.matcher];o&&o(e,n.expected,n.argument)&&(r=!0,i=n.state)}})),!r&&e.error&&(i=\"failure\"),\"success\"===i?t.setSuccess(e):t.setError(e,\"retry\"===i)}var i=e(\"./core\"),o=i.util.inherit,s=e(\"jmespath\");i.ResourceWaiter=o({constructor:function(e,t){this.service=e,this.state=t,this.loadWaiterConfig(this.state)},service:null,state:null,config:null,matchers:{path:function(e,t,n){try{var r=s.search(e.data,n)}catch(e){return!1}return s.strictDeepEqual(r,t)},pathAll:function(e,t,n){try{var r=s.search(e.data,n)}catch(e){return!1}Array.isArray(r)||(r=[r]);var i=r.length;if(!i)return!1;for(var o=0;o<i;o++)if(!s.strictDeepEqual(r[o],t))return!1;return!0},pathAny:function(e,t,n){try{var r=s.search(e.data,n)}catch(e){return!1}Array.isArray(r)||(r=[r]);for(var i=r.length,o=0;o<i;o++)if(s.strictDeepEqual(r[o],t))return!0;return!1},status:function(e,t){var n=e.httpResponse.statusCode;return\"number\"==typeof n&&n===t},error:function(e,t){return\"string\"==typeof t&&e.error?t===e.error.code:t===!!e.error}},listeners:(new i.SequentialExecutor).addNamedListeners((function(e){e(\"RETRY_CHECK\",\"retry\",(function(e){var t=e.request._waiter;e.error&&\"ResourceNotReady\"===e.error.code&&(e.error.retryDelay=1e3*(t.config.delay||0))})),e(\"CHECK_OUTPUT\",\"extractData\",r),e(\"CHECK_ERROR\",\"extractError\",r)})),wait:function(e,t){\"function\"==typeof e&&(t=e,e=void 0),e&&e.$waiter&&(\"number\"==typeof(e=i.util.copy(e)).$waiter.delay&&(this.config.delay=e.$waiter.delay),\"number\"==typeof e.$waiter.maxAttempts&&(this.config.maxAttempts=e.$waiter.maxAttempts),delete e.$waiter);var n=this.service.makeRequest(this.config.operation,e);return n._waiter=this,n.response.maxRetries=this.config.maxAttempts,n.addListeners(this.listeners),t&&n.send(t),n},setSuccess:function(e){e.error=null,e.data=e.data||{},e.request.removeAllListeners(\"extractData\")},setError:function(e,t){e.data=null,e.error=i.util.error(e.error||new Error,{code:\"ResourceNotReady\",message:\"Resource is not in the state \"+this.state,retryable:t})},loadWaiterConfig:function(e){if(!this.service.api.waiters[e])throw new i.util.error(new Error,{code:\"StateNotFoundError\",message:\"State \"+e+\" not found.\"});this.config=i.util.copy(this.service.api.waiters[e])}})},{\"./core\":20,jmespath:86}],59:[function(e,t,n){var r=e(\"./core\"),i=r.util.inherit,o=e(\"jmespath\");r.Response=i({constructor:function(e){this.request=e,this.data=null,this.error=null,this.retryCount=0,this.redirectCount=0,this.httpResponse=new r.HttpResponse,e&&(this.maxRetries=e.service.numRetries(),this.maxRedirects=e.service.config.maxRedirects)},nextPage:function(e){var t,n=this.request.service,i=this.request.operation;try{t=n.paginationConfig(i,!0)}catch(e){this.error=e}if(!this.hasNextPage()){if(e)e(this.error,null);else if(this.error)throw this.error;return null}var o=r.util.copy(this.request.params);if(this.nextPageTokens){var s=t.inputToken;\"string\"==typeof s&&(s=[s]);for(var a=0;a<s.length;a++)o[s[a]]=this.nextPageTokens[a];return n.makeRequest(this.request.operation,o,e)}return e?e(null,null):null},hasNextPage:function(){return this.cacheNextPageTokens(),!!this.nextPageTokens||void 0===this.nextPageTokens&&void 0},cacheNextPageTokens:function(){if(Object.prototype.hasOwnProperty.call(this,\"nextPageTokens\"))return this.nextPageTokens;this.nextPageTokens=void 0;var e=this.request.service.paginationConfig(this.request.operation);if(!e)return this.nextPageTokens;if(this.nextPageTokens=null,e.moreResults&&!o.search(this.data,e.moreResults))return this.nextPageTokens;var t=e.outputToken;return\"string\"==typeof t&&(t=[t]),r.util.arrayEach.call(this,t,(function(e){var t=o.search(this.data,e);t&&(this.nextPageTokens=this.nextPageTokens||[],this.nextPageTokens.push(t))})),this.nextPageTokens}})},{\"./core\":20,jmespath:86}],60:[function(e,t,n){var r=e(\"./core\");r.SequentialExecutor=r.util.inherit({constructor:function(){this._events={}},listeners:function(e){return this._events[e]?this._events[e].slice(0):[]},on:function(e,t,n){return this._events[e]?n?this._events[e].unshift(t):this._events[e].push(t):this._events[e]=[t],this},onAsync:function(e,t,n){return t._isAsync=!0,this.on(e,t,n)},removeListener:function(e,t){var n=this._events[e];if(n){for(var r=n.length,i=-1,o=0;o<r;++o)n[o]===t&&(i=o);i>-1&&n.splice(i,1)}return this},removeAllListeners:function(e){return e?delete this._events[e]:this._events={},this},emit:function(e,t,n){n||(n=function(){});var r=this.listeners(e),i=r.length;return this.callListeners(r,t,n),i>0},callListeners:function(e,t,n,i){function o(i){if(i&&(a=r.util.error(a||new Error,i),s._haltHandlersOnError))return n.call(s,a);s.callListeners(e,t,n,a)}for(var s=this,a=i||null;e.length>0;){var c=e.shift();if(c._isAsync)return void c.apply(s,t.concat([o]));try{c.apply(s,t)}catch(e){a=r.util.error(a||new Error,e)}if(a&&s._haltHandlersOnError)return void n.call(s,a)}n.call(s,a)},addListeners:function(e){var t=this;return e._events&&(e=e._events),r.util.each(e,(function(e,n){\"function\"==typeof n&&(n=[n]),r.util.arrayEach(n,(function(n){t.on(e,n)}))})),t},addNamedListener:function(e,t,n,r){return this[e]=n,this.addListener(t,n,r),this},addNamedAsyncListener:function(e,t,n,r){return n._isAsync=!0,this.addNamedListener(e,t,n,r)},addNamedListeners:function(e){var t=this;return e((function(){t.addNamedListener.apply(t,arguments)}),(function(){t.addNamedAsyncListener.apply(t,arguments)})),this}}),r.SequentialExecutor.prototype.addListener=r.SequentialExecutor.prototype.on,t.exports=r.SequentialExecutor},{\"./core\":20}],61:[function(e,t,n){(function(n){(function(){var r=e(\"./core\"),i=e(\"./model/api\"),o=e(\"./region_config\"),s=r.util.inherit,a=0;r.Service=s({constructor:function(e){if(!this.loadServiceClass)throw r.util.error(new Error,\"Service must be constructed with `new' operator\");var t=this.loadServiceClass(e||{});if(t){var n=r.util.copy(e),i=new t(e);return Object.defineProperty(i,\"_originalConfig\",{get:function(){return n},enumerable:!1,configurable:!0}),i._clientId=++a,i}this.initialize(e)},initialize:function(e){var t=r.config[this.serviceIdentifier];if(this.config=new r.Config(r.config),t&&this.config.update(t,!0),e&&this.config.update(e,!0),this.validateService(),this.config.endpoint||o.configureEndpoint(this),this.config.endpoint=this.endpointFromTemplate(this.config.endpoint),this.setEndpoint(this.config.endpoint),r.SequentialExecutor.call(this),r.Service.addDefaultMonitoringListeners(this),(this.config.clientSideMonitoring||r.Service._clientSideMonitoring)&&this.publisher){var i=this.publisher;this.addNamedListener(\"PUBLISH_API_CALL\",\"apiCall\",(function(e){n.nextTick((function(){i.eventHandler(e)}))})),this.addNamedListener(\"PUBLISH_API_ATTEMPT\",\"apiCallAttempt\",(function(e){n.nextTick((function(){i.eventHandler(e)}))}))}},validateService:function(){},loadServiceClass:function(e){var t=e;if(r.util.isEmpty(this.api)){if(t.apiConfig)return r.Service.defineServiceApi(this.constructor,t.apiConfig);if(this.constructor.services){(t=new r.Config(r.config)).update(e,!0);var n=t.apiVersions[this.constructor.serviceIdentifier];return n=n||t.apiVersion,this.getLatestServiceClass(n)}return null}return null},getLatestServiceClass:function(e){return e=this.getLatestServiceVersion(e),null===this.constructor.services[e]&&r.Service.defineServiceApi(this.constructor,e),this.constructor.services[e]},getLatestServiceVersion:function(e){if(!this.constructor.services||0===this.constructor.services.length)throw new Error(\"No services defined on \"+this.constructor.serviceIdentifier);if(e?r.util.isType(e,Date)&&(e=r.util.date.iso8601(e).split(\"T\")[0]):e=\"latest\",Object.hasOwnProperty(this.constructor.services,e))return e;for(var t=Object.keys(this.constructor.services).sort(),n=null,i=t.length-1;i>=0;i--)if(\"*\"!==t[i][t[i].length-1]&&(n=t[i]),t[i].substr(0,10)<=e)return n;throw new Error(\"Could not find \"+this.constructor.serviceIdentifier+\" API to satisfy version constraint `\"+e+\"'\")},api:{},defaultRetryCount:3,customizeRequests:function(e){if(e){if(\"function\"!=typeof e)throw new Error(\"Invalid callback type '\"+typeof e+\"' provided in customizeRequests\");this.customRequestHandler=e}else this.customRequestHandler=null},makeRequest:function(e,t,n){if(\"function\"==typeof t&&(n=t,t=null),t=t||{},this.config.params){var i=this.api.operations[e];i&&(t=r.util.copy(t),r.util.each(this.config.params,(function(e,n){i.input.members[e]&&(void 0!==t[e]&&null!==t[e]||(t[e]=n))})))}var o=new r.Request(this,e,t);return this.addAllRequestListeners(o),this.attachMonitoringEmitter(o),n&&o.send(n),o},makeUnauthenticatedRequest:function(e,t,n){\"function\"==typeof t&&(n=t,t={});var r=this.makeRequest(e,t).toUnauthenticated();return n?r.send(n):r},waitFor:function(e,t,n){return new r.ResourceWaiter(this,e).wait(t,n)},addAllRequestListeners:function(e){for(var t=[r.events,r.EventListeners.Core,this.serviceInterface(),r.EventListeners.CorePost],n=0;n<t.length;n++)t[n]&&e.addListeners(t[n]);this.config.paramValidation||e.removeListener(\"validate\",r.EventListeners.Core.VALIDATE_PARAMETERS),this.config.logger&&e.addListeners(r.EventListeners.Logger),this.setupRequestListeners(e),\"function\"==typeof this.constructor.prototype.customRequestHandler&&this.constructor.prototype.customRequestHandler(e),Object.prototype.hasOwnProperty.call(this,\"customRequestHandler\")&&\"function\"==typeof this.customRequestHandler&&this.customRequestHandler(e)},apiCallEvent:function(e){var t=e.service.api.operations[e.operation],n={Type:\"ApiCall\",Api:t?t.name:e.operation,Version:1,Service:e.service.api.serviceId||e.service.api.endpointPrefix,Region:e.httpRequest.region,MaxRetriesExceeded:0,UserAgent:e.httpRequest.getUserAgent()},r=e.response;if(r.httpResponse.statusCode&&(n.FinalHttpStatusCode=r.httpResponse.statusCode),r.error){var i=r.error;r.httpResponse.statusCode>299?(i.code&&(n.FinalAwsException=i.code),i.message&&(n.FinalAwsExceptionMessage=i.message)):((i.code||i.name)&&(n.FinalSdkException=i.code||i.name),i.message&&(n.FinalSdkExceptionMessage=i.message))}return n},apiAttemptEvent:function(e){var t=e.service.api.operations[e.operation],n={Type:\"ApiCallAttempt\",Api:t?t.name:e.operation,Version:1,Service:e.service.api.serviceId||e.service.api.endpointPrefix,Fqdn:e.httpRequest.endpoint.hostname,UserAgent:e.httpRequest.getUserAgent()},r=e.response;return r.httpResponse.statusCode&&(n.HttpStatusCode=r.httpResponse.statusCode),!e._unAuthenticated&&e.service.config.credentials&&e.service.config.credentials.accessKeyId&&(n.AccessKey=e.service.config.credentials.accessKeyId),r.httpResponse.headers?(e.httpRequest.headers[\"x-amz-security-token\"]&&(n.SessionToken=e.httpRequest.headers[\"x-amz-security-token\"]),r.httpResponse.headers[\"x-amzn-requestid\"]&&(n.XAmznRequestId=r.httpResponse.headers[\"x-amzn-requestid\"]),r.httpResponse.headers[\"x-amz-request-id\"]&&(n.XAmzRequestId=r.httpResponse.headers[\"x-amz-request-id\"]),r.httpResponse.headers[\"x-amz-id-2\"]&&(n.XAmzId2=r.httpResponse.headers[\"x-amz-id-2\"]),n):n},attemptFailEvent:function(e){var t=this.apiAttemptEvent(e),n=e.response,r=n.error;return n.httpResponse.statusCode>299?(r.code&&(t.AwsException=r.code),r.message&&(t.AwsExceptionMessage=r.message)):((r.code||r.name)&&(t.SdkException=r.code||r.name),r.message&&(t.SdkExceptionMessage=r.message)),t},attachMonitoringEmitter:function(e){var t,n,i,o,s,a,c=0,u=this;e.on(\"validate\",(function(){o=r.util.realClock.now(),a=Date.now()}),!0),e.on(\"sign\",(function(){n=r.util.realClock.now(),t=Date.now(),s=e.httpRequest.region,c++}),!0),e.on(\"validateResponse\",(function(){i=Math.round(r.util.realClock.now()-n)})),e.addNamedListener(\"API_CALL_ATTEMPT\",\"success\",(function(){var n=u.apiAttemptEvent(e);n.Timestamp=t,n.AttemptLatency=i>=0?i:0,n.Region=s,u.emit(\"apiCallAttempt\",[n])})),e.addNamedListener(\"API_CALL_ATTEMPT_RETRY\",\"retry\",(function(){var o=u.attemptFailEvent(e);o.Timestamp=t,i=i||Math.round(r.util.realClock.now()-n),o.AttemptLatency=i>=0?i:0,o.Region=s,u.emit(\"apiCallAttempt\",[o])})),e.addNamedListener(\"API_CALL\",\"complete\",(function(){var t=u.apiCallEvent(e);if(t.AttemptCount=c,!(t.AttemptCount<=0)){t.Timestamp=a;var n=Math.round(r.util.realClock.now()-o);t.Latency=n>=0?n:0;var i=e.response;i.error&&i.error.retryable&&\"number\"==typeof i.retryCount&&\"number\"==typeof i.maxRetries&&i.retryCount>=i.maxRetries&&(t.MaxRetriesExceeded=1),u.emit(\"apiCall\",[t])}}))},setupRequestListeners:function(e){},getSigningName:function(){return this.api.signingName||this.api.endpointPrefix},getSignerClass:function(e){var t,n=null,i=\"\";return e&&(i=(n=(e.service.api.operations||{})[e.operation]||null)?n.authtype:\"\"),t=this.config.signatureVersion?this.config.signatureVersion:\"v4\"===i||\"v4-unsigned-body\"===i?\"v4\":this.api.signatureVersion,r.Signers.RequestSigner.getVersion(t)},serviceInterface:function(){switch(this.api.protocol){case\"ec2\":case\"query\":return r.EventListeners.Query;case\"json\":return r.EventListeners.Json;case\"rest-json\":return r.EventListeners.RestJson;case\"rest-xml\":return r.EventListeners.RestXml}if(this.api.protocol)throw new Error(\"Invalid service `protocol' \"+this.api.protocol+\" in API config\")},successfulResponse:function(e){return e.httpResponse.statusCode<300},numRetries:function(){return void 0!==this.config.maxRetries?this.config.maxRetries:this.defaultRetryCount},retryDelays:function(e,t){return r.util.calculateRetryDelay(e,this.config.retryDelayOptions,t)},retryableError:function(e){return!!this.timeoutError(e)||!!this.networkingError(e)||!!this.expiredCredentialsError(e)||!!this.throttledError(e)||e.statusCode>=500},networkingError:function(e){return\"NetworkingError\"===e.code},timeoutError:function(e){return\"TimeoutError\"===e.code},expiredCredentialsError:function(e){return\"ExpiredTokenException\"===e.code},clockSkewError:function(e){switch(e.code){case\"RequestTimeTooSkewed\":case\"RequestExpired\":case\"InvalidSignatureException\":case\"SignatureDoesNotMatch\":case\"AuthFailure\":case\"RequestInTheFuture\":return!0;default:return!1}},getSkewCorrectedDate:function(){return new Date(Date.now()+this.config.systemClockOffset)},applyClockOffset:function(e){e&&(this.config.systemClockOffset=e-Date.now())},isClockSkewed:function(e){if(e)return Math.abs(this.getSkewCorrectedDate().getTime()-e)>=3e5},throttledError:function(e){if(429===e.statusCode)return!0;switch(e.code){case\"ProvisionedThroughputExceededException\":case\"Throttling\":case\"ThrottlingException\":case\"RequestLimitExceeded\":case\"RequestThrottled\":case\"RequestThrottledException\":case\"TooManyRequestsException\":case\"TransactionInProgressException\":case\"EC2ThrottledException\":return!0;default:return!1}},endpointFromTemplate:function(e){if(\"string\"!=typeof e)return e;return e.replace(/\\{service\\}/g,this.api.endpointPrefix).replace(/\\{region\\}/g,this.config.region).replace(/\\{scheme\\}/g,this.config.sslEnabled?\"https\":\"http\")},setEndpoint:function(e){this.endpoint=new r.Endpoint(e,this.config)},paginationConfig:function(e,t){var n=this.api.operations[e].paginator;if(!n){if(t){var i=new Error;throw r.util.error(i,\"No pagination configuration for \"+e)}return null}return n}}),r.util.update(r.Service,{defineMethods:function(e){r.util.each(e.prototype.api.operations,(function(t){e.prototype[t]||(\"none\"===e.prototype.api.operations[t].authtype?e.prototype[t]=function(e,n){return this.makeUnauthenticatedRequest(t,e,n)}:e.prototype[t]=function(e,n){return this.makeRequest(t,e,n)})}))},defineService:function(e,t,n){r.Service._serviceMap[e]=!0,Array.isArray(t)||(n=t,t=[]);var i=s(r.Service,n||{});if(\"string\"==typeof e){r.Service.addVersions(i,t);var o=i.serviceIdentifier||e;i.serviceIdentifier=o}else i.prototype.api=e,r.Service.defineMethods(i);if(r.SequentialExecutor.call(this.prototype),!this.prototype.publisher&&r.util.clientSideMonitoring){var a=r.util.clientSideMonitoring.Publisher,c=(0,r.util.clientSideMonitoring.configProvider)();this.prototype.publisher=new a(c),c.enabled&&(r.Service._clientSideMonitoring=!0)}return r.SequentialExecutor.call(i.prototype),r.Service.addDefaultMonitoringListeners(i.prototype),i},addVersions:function(e,t){Array.isArray(t)||(t=[t]),e.services=e.services||{};for(var n=0;n<t.length;n++)void 0===e.services[t[n]]&&(e.services[t[n]]=null);e.apiVersions=Object.keys(e.services).sort()},defineServiceApi:function(e,t,n){function o(t){t.isApi?a.prototype.api=t:a.prototype.api=new i(t,{serviceIdentifier:e.serviceIdentifier})}var a=s(e,{serviceIdentifier:e.serviceIdentifier});if(\"string\"==typeof t){if(n)o(n);else try{o(r.apiLoader(e.serviceIdentifier,t))}catch(n){throw r.util.error(n,{message:\"Could not find API configuration \"+e.serviceIdentifier+\"-\"+t})}Object.prototype.hasOwnProperty.call(e.services,t)||(e.apiVersions=e.apiVersions.concat(t).sort()),e.services[t]=a}else o(t);return r.Service.defineMethods(a),a},hasService:function(e){return Object.prototype.hasOwnProperty.call(r.Service._serviceMap,e)},addDefaultMonitoringListeners:function(e){e.addNamedListener(\"MONITOR_EVENTS_BUBBLE\",\"apiCallAttempt\",(function(t){var n=Object.getPrototypeOf(e);n._events&&n.emit(\"apiCallAttempt\",[t])})),e.addNamedListener(\"CALL_EVENTS_BUBBLE\",\"apiCall\",(function(t){var n=Object.getPrototypeOf(e);n._events&&n.emit(\"apiCall\",[t])}))},_serviceMap:{}}),r.util.mixin(r.Service,r.SequentialExecutor),t.exports=r.Service}).call(this)}).call(this,e(\"_process\"))},{\"./core\":20,\"./model/api\":40,\"./region_config\":55,_process:87}],62:[function(e,t,n){var r=e(\"../core\");r.util.update(r.CognitoIdentity.prototype,{getOpenIdToken:function(e,t){return this.makeUnauthenticatedRequest(\"getOpenIdToken\",e,t)},getId:function(e,t){return this.makeUnauthenticatedRequest(\"getId\",e,t)},getCredentialsForIdentity:function(e,t){return this.makeUnauthenticatedRequest(\"getCredentialsForIdentity\",e,t)}})},{\"../core\":20}],63:[function(e,t,n){var r=e(\"../core\"),i=e(\"../config_regional_endpoint\");r.util.update(r.STS.prototype,{credentialsFrom:function(e,t){return e?(t||(t=new r.TemporaryCredentials),t.expired=!1,t.accessKeyId=e.Credentials.AccessKeyId,t.secretAccessKey=e.Credentials.SecretAccessKey,t.sessionToken=e.Credentials.SessionToken,t.expireTime=e.Credentials.Expiration,t):null},assumeRoleWithWebIdentity:function(e,t){return this.makeUnauthenticatedRequest(\"assumeRoleWithWebIdentity\",e,t)},assumeRoleWithSAML:function(e,t){return this.makeUnauthenticatedRequest(\"assumeRoleWithSAML\",e,t)},setupRequestListeners:function(e){e.addListener(\"validate\",this.optInRegionalEndpoint,!0)},optInRegionalEndpoint:function(e){var t=e.service,n=t.config;if(n.stsRegionalEndpoints=i(t._originalConfig,{env:\"AWS_STS_REGIONAL_ENDPOINTS\",sharedConfig:\"sts_regional_endpoints\",clientConfig:\"stsRegionalEndpoints\"}),\"regional\"===n.stsRegionalEndpoints&&t.isGlobalEndpoint){if(!n.region)throw r.util.error(new Error,{code:\"ConfigError\",message:\"Missing region in config\"});var o=n.endpoint.indexOf(\".amazonaws.com\"),s=n.endpoint.substring(0,o)+\".\"+n.region+n.endpoint.substring(o);e.httpRequest.updateEndpoint(s),e.httpRequest.region=n.region}}})},{\"../config_regional_endpoint\":19,\"../core\":20}],64:[function(e,t,n){function r(e){var t=e.httpRequest.headers[a],n=e.service.getSignerClass(e);if(delete e.httpRequest.headers[\"User-Agent\"],delete e.httpRequest.headers[\"X-Amz-User-Agent\"],n===o.Signers.V4){if(t>604800)throw o.util.error(new Error,{code:\"InvalidExpiryTime\",message:\"Presigning does not support expiry time greater than a week with SigV4 signing.\",retryable:!1});e.httpRequest.headers[a]=t}else{if(n!==o.Signers.S3)throw o.util.error(new Error,{message:\"Presigning only supports S3 or SigV4 signing.\",code:\"UnsupportedSigner\",retryable:!1});var r=e.service?e.service.getSkewCorrectedDate():o.util.date.getDate();e.httpRequest.headers[a]=parseInt(o.util.date.unixTimestamp(r)+t,10).toString()}}function i(e){var t=e.httpRequest.endpoint,n=o.util.urlParse(e.httpRequest.path),r={};n.search&&(r=o.util.queryStringParse(n.search.substr(1)));var i=e.httpRequest.headers.Authorization.split(\" \");if(\"AWS\"===i[0])i=i[1].split(\":\"),r.Signature=i.pop(),r.AWSAccessKeyId=i.join(\":\"),o.util.each(e.httpRequest.headers,(function(e,t){e===a&&(e=\"Expires\"),0===e.indexOf(\"x-amz-meta-\")&&(delete r[e],e=e.toLowerCase()),r[e]=t})),delete e.httpRequest.headers[a],delete r.Authorization,delete r.Host;else if(\"AWS4-HMAC-SHA256\"===i[0]){i.shift();var s=i.join(\" \").match(/Signature=(.*?)(?:,|\\s|\\r?\\n|$)/)[1];r[\"X-Amz-Signature\"]=s,delete r.Expires}t.pathname=n.pathname,t.search=o.util.queryParamsToString(r)}var o=e(\"../core\"),s=o.util.inherit,a=\"presigned-expires\";o.Signers.Presign=s({sign:function(e,t,n){if(e.httpRequest.headers[a]=t||3600,e.on(\"build\",r),e.on(\"sign\",i),e.removeListener(\"afterBuild\",o.EventListeners.Core.SET_CONTENT_LENGTH),e.removeListener(\"afterBuild\",o.EventListeners.Core.COMPUTE_SHA256),e.emit(\"beforePresign\",[e]),!n){if(e.build(),e.response.error)throw e.response.error;return o.util.urlFormat(e.httpRequest.endpoint)}e.build((function(){this.response.error?n(this.response.error):n(null,o.util.urlFormat(e.httpRequest.endpoint))}))}}),t.exports=o.Signers.Presign},{\"../core\":20}],65:[function(e,t,n){var r=e(\"../core\"),i=r.util.inherit;r.Signers.RequestSigner=i({constructor:function(e){this.request=e},setServiceClientId:function(e){this.serviceClientId=e},getServiceClientId:function(){return this.serviceClientId}}),r.Signers.RequestSigner.getVersion=function(e){switch(e){case\"v2\":return r.Signers.V2;case\"v3\":return r.Signers.V3;case\"s3v4\":case\"v4\":return r.Signers.V4;case\"s3\":return r.Signers.S3;case\"v3https\":return r.Signers.V3Https}throw new Error(\"Unknown signing version \"+e)},e(\"./v2\"),e(\"./v3\"),e(\"./v3https\"),e(\"./v4\"),e(\"./s3\"),e(\"./presign\")},{\"../core\":20,\"./presign\":64,\"./s3\":66,\"./v2\":67,\"./v3\":68,\"./v3https\":69,\"./v4\":70}],66:[function(e,t,n){var r=e(\"../core\"),i=r.util.inherit;r.Signers.S3=i(r.Signers.RequestSigner,{subResources:{acl:1,accelerate:1,analytics:1,cors:1,lifecycle:1,delete:1,inventory:1,location:1,logging:1,metrics:1,notification:1,partNumber:1,policy:1,requestPayment:1,replication:1,restore:1,tagging:1,torrent:1,uploadId:1,uploads:1,versionId:1,versioning:1,versions:1,website:1},responseHeaders:{\"response-content-type\":1,\"response-content-language\":1,\"response-expires\":1,\"response-cache-control\":1,\"response-content-disposition\":1,\"response-content-encoding\":1},addAuthorization:function(e,t){this.request.headers[\"presigned-expires\"]||(this.request.headers[\"X-Amz-Date\"]=r.util.date.rfc822(t)),e.sessionToken&&(this.request.headers[\"x-amz-security-token\"]=e.sessionToken);var n=this.sign(e.secretAccessKey,this.stringToSign()),i=\"AWS \"+e.accessKeyId+\":\"+n;this.request.headers.Authorization=i},stringToSign:function(){var e=this.request,t=[];t.push(e.method),t.push(e.headers[\"Content-MD5\"]||\"\"),t.push(e.headers[\"Content-Type\"]||\"\"),t.push(e.headers[\"presigned-expires\"]||\"\");var n=this.canonicalizedAmzHeaders();return n&&t.push(n),t.push(this.canonicalizedResource()),t.join(\"\\n\")},canonicalizedAmzHeaders:function(){var e=[];r.util.each(this.request.headers,(function(t){t.match(/^x-amz-/i)&&e.push(t)})),e.sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:1}));var t=[];return r.util.arrayEach.call(this,e,(function(e){t.push(e.toLowerCase()+\":\"+String(this.request.headers[e]))})),t.join(\"\\n\")},canonicalizedResource:function(){var e=this.request,t=e.path.split(\"?\"),n=t[0],i=t[1],o=\"\";if(e.virtualHostedBucket&&(o+=\"/\"+e.virtualHostedBucket),o+=n,i){var s=[];r.util.arrayEach.call(this,i.split(\"&\"),(function(e){var t=e.split(\"=\")[0],n=e.split(\"=\")[1];if(this.subResources[t]||this.responseHeaders[t]){var r={name:t};void 0!==n&&(this.subResources[t]?r.value=n:r.value=decodeURIComponent(n)),s.push(r)}})),s.sort((function(e,t){return e.name<t.name?-1:1})),s.length&&(i=[],r.util.arrayEach(s,(function(e){void 0===e.value?i.push(e.name):i.push(e.name+\"=\"+e.value)})),o+=\"?\"+i.join(\"&\"))}return o},sign:function(e,t){return r.util.crypto.hmac(e,t,\"base64\",\"sha1\")}}),t.exports=r.Signers.S3},{\"../core\":20}],67:[function(e,t,n){var r=e(\"../core\"),i=r.util.inherit;r.Signers.V2=i(r.Signers.RequestSigner,{addAuthorization:function(e,t){t||(t=r.util.date.getDate());var n=this.request;n.params.Timestamp=r.util.date.iso8601(t),n.params.SignatureVersion=\"2\",n.params.SignatureMethod=\"HmacSHA256\",n.params.AWSAccessKeyId=e.accessKeyId,e.sessionToken&&(n.params.SecurityToken=e.sessionToken),delete n.params.Signature,n.params.Signature=this.signature(e),n.body=r.util.queryParamsToString(n.params),n.headers[\"Content-Length\"]=n.body.length},signature:function(e){return r.util.crypto.hmac(e.secretAccessKey,this.stringToSign(),\"base64\")},stringToSign:function(){var e=[];return e.push(this.request.method),e.push(this.request.endpoint.host.toLowerCase()),e.push(this.request.pathname()),e.push(r.util.queryParamsToString(this.request.params)),e.join(\"\\n\")}}),t.exports=r.Signers.V2},{\"../core\":20}],68:[function(e,t,n){var r=e(\"../core\"),i=r.util.inherit;r.Signers.V3=i(r.Signers.RequestSigner,{addAuthorization:function(e,t){var n=r.util.date.rfc822(t);this.request.headers[\"X-Amz-Date\"]=n,e.sessionToken&&(this.request.headers[\"x-amz-security-token\"]=e.sessionToken),this.request.headers[\"X-Amzn-Authorization\"]=this.authorization(e,n)},authorization:function(e){return\"AWS3 AWSAccessKeyId=\"+e.accessKeyId+\",Algorithm=HmacSHA256,SignedHeaders=\"+this.signedHeaders()+\",Signature=\"+this.signature(e)},signedHeaders:function(){var e=[];return r.util.arrayEach(this.headersToSign(),(function(t){e.push(t.toLowerCase())})),e.sort().join(\";\")},canonicalHeaders:function(){var e=this.request.headers,t=[];return r.util.arrayEach(this.headersToSign(),(function(n){t.push(n.toLowerCase().trim()+\":\"+String(e[n]).trim())})),t.sort().join(\"\\n\")+\"\\n\"},headersToSign:function(){var e=[];return r.util.each(this.request.headers,(function(t){(\"Host\"===t||\"Content-Encoding\"===t||t.match(/^X-Amz/i))&&e.push(t)})),e},signature:function(e){return r.util.crypto.hmac(e.secretAccessKey,this.stringToSign(),\"base64\")},stringToSign:function(){var e=[];return e.push(this.request.method),e.push(\"/\"),e.push(\"\"),e.push(this.canonicalHeaders()),e.push(this.request.body),r.util.crypto.sha256(e.join(\"\\n\"))}}),t.exports=r.Signers.V3},{\"../core\":20}],69:[function(e,t,n){var r=e(\"../core\"),i=r.util.inherit;e(\"./v3\"),r.Signers.V3Https=i(r.Signers.V3,{authorization:function(e){return\"AWS3-HTTPS AWSAccessKeyId=\"+e.accessKeyId+\",Algorithm=HmacSHA256,Signature=\"+this.signature(e)},stringToSign:function(){return this.request.headers[\"X-Amz-Date\"]}}),t.exports=r.Signers.V3Https},{\"../core\":20,\"./v3\":68}],70:[function(e,t,n){var r=e(\"../core\"),i=e(\"./v4_credentials\"),o=r.util.inherit;r.Signers.V4=o(r.Signers.RequestSigner,{constructor:function(e,t,n){r.Signers.RequestSigner.call(this,e),this.serviceName=t,n=n||{},this.signatureCache=\"boolean\"!=typeof n.signatureCache||n.signatureCache,this.operation=n.operation,this.signatureVersion=n.signatureVersion},algorithm:\"AWS4-HMAC-SHA256\",addAuthorization:function(e,t){var n=r.util.date.iso8601(t).replace(/[:\\-]|\\.\\d{3}/g,\"\");this.isPresigned()?this.updateForPresigned(e,n):this.addHeaders(e,n),this.request.headers.Authorization=this.authorization(e,n)},addHeaders:function(e,t){this.request.headers[\"X-Amz-Date\"]=t,e.sessionToken&&(this.request.headers[\"x-amz-security-token\"]=e.sessionToken)},updateForPresigned:function(e,t){var n=this.credentialString(t),i={\"X-Amz-Date\":t,\"X-Amz-Algorithm\":this.algorithm,\"X-Amz-Credential\":e.accessKeyId+\"/\"+n,\"X-Amz-Expires\":this.request.headers[\"presigned-expires\"],\"X-Amz-SignedHeaders\":this.signedHeaders()};e.sessionToken&&(i[\"X-Amz-Security-Token\"]=e.sessionToken),this.request.headers[\"Content-Type\"]&&(i[\"Content-Type\"]=this.request.headers[\"Content-Type\"]),this.request.headers[\"Content-MD5\"]&&(i[\"Content-MD5\"]=this.request.headers[\"Content-MD5\"]),this.request.headers[\"Cache-Control\"]&&(i[\"Cache-Control\"]=this.request.headers[\"Cache-Control\"]),r.util.each.call(this,this.request.headers,(function(e,t){if(\"presigned-expires\"!==e&&this.isSignableHeader(e)){var n=e.toLowerCase();0===n.indexOf(\"x-amz-meta-\")?i[n]=t:0===n.indexOf(\"x-amz-\")&&(i[e]=t)}}));var o=this.request.path.indexOf(\"?\")>=0?\"&\":\"?\";this.request.path+=o+r.util.queryParamsToString(i)},authorization:function(e,t){var n=[],r=this.credentialString(t);return n.push(this.algorithm+\" Credential=\"+e.accessKeyId+\"/\"+r),n.push(\"SignedHeaders=\"+this.signedHeaders()),n.push(\"Signature=\"+this.signature(e,t)),n.join(\", \")},signature:function(e,t){var n=i.getSigningKey(e,t.substr(0,8),this.request.region,this.serviceName,this.signatureCache);return r.util.crypto.hmac(n,this.stringToSign(t),\"hex\")},stringToSign:function(e){var t=[];return t.push(\"AWS4-HMAC-SHA256\"),t.push(e),t.push(this.credentialString(e)),t.push(this.hexEncodedHash(this.canonicalString())),t.join(\"\\n\")},canonicalString:function(){var e=[],t=this.request.pathname();return\"s3\"!==this.serviceName&&\"s3v4\"!==this.signatureVersion&&(t=r.util.uriEscapePath(t)),e.push(this.request.method),e.push(t),e.push(this.request.search()),e.push(this.canonicalHeaders()+\"\\n\"),e.push(this.signedHeaders()),e.push(this.hexEncodedBodyHash()),e.join(\"\\n\")},canonicalHeaders:function(){var e=[];r.util.each.call(this,this.request.headers,(function(t,n){e.push([t,n])})),e.sort((function(e,t){return e[0].toLowerCase()<t[0].toLowerCase()?-1:1}));var t=[];return r.util.arrayEach.call(this,e,(function(e){var n=e[0].toLowerCase();if(this.isSignableHeader(n)){var i=e[1];if(null==i||\"function\"!=typeof i.toString)throw r.util.error(new Error(\"Header \"+n+\" contains invalid value\"),{code:\"InvalidHeader\"});t.push(n+\":\"+this.canonicalHeaderValues(i.toString()))}})),t.join(\"\\n\")},canonicalHeaderValues:function(e){return e.replace(/\\s+/g,\" \").replace(/^\\s+|\\s+$/g,\"\")},signedHeaders:function(){var e=[];return r.util.each.call(this,this.request.headers,(function(t){t=t.toLowerCase(),this.isSignableHeader(t)&&e.push(t)})),e.sort().join(\";\")},credentialString:function(e){return i.createScope(e.substr(0,8),this.request.region,this.serviceName)},hexEncodedHash:function(e){return r.util.crypto.sha256(e,\"hex\")},hexEncodedBodyHash:function(){var e=this.request;return this.isPresigned()&&\"s3\"===this.serviceName&&!e.body?\"UNSIGNED-PAYLOAD\":e.headers[\"X-Amz-Content-Sha256\"]?e.headers[\"X-Amz-Content-Sha256\"]:this.hexEncodedHash(this.request.body||\"\")},unsignableHeaders:[\"authorization\",\"content-type\",\"content-length\",\"user-agent\",\"presigned-expires\",\"expect\",\"x-amzn-trace-id\"],isSignableHeader:function(e){return 0===e.toLowerCase().indexOf(\"x-amz-\")||this.unsignableHeaders.indexOf(e)<0},isPresigned:function(){return!!this.request.headers[\"presigned-expires\"]}}),t.exports=r.Signers.V4},{\"../core\":20,\"./v4_credentials\":71}],71:[function(e,t,n){var r=e(\"../core\"),i={},o=[];t.exports={createScope:function(e,t,n){return[e.substr(0,8),t,n,\"aws4_request\"].join(\"/\")},getSigningKey:function(e,t,n,s,a){var c=[r.util.crypto.hmac(e.secretAccessKey,e.accessKeyId,\"base64\"),t,n,s].join(\"_\");if((a=!1!==a)&&c in i)return i[c];var u=r.util.crypto.hmac(\"AWS4\"+e.secretAccessKey,t,\"buffer\"),l=r.util.crypto.hmac(u,n,\"buffer\"),p=r.util.crypto.hmac(l,s,\"buffer\"),d=r.util.crypto.hmac(p,\"aws4_request\",\"buffer\");return a&&(i[c]=d,o.push(c),o.length>50&&delete i[o.shift()]),d},emptyCache:function(){i={},o=[]}}},{\"../core\":20}],72:[function(e,t,n){function r(e,t){this.currentState=t||null,this.states=e||{}}r.prototype.runTo=function(e,t,n,r){\"function\"==typeof e&&(r=n,n=t,t=e,e=null);var i=this,o=i.states[i.currentState];o.fn.call(n||i,r,(function(r){if(r){if(!o.fail)return t?t.call(n,r):null;i.currentState=o.fail}else{if(!o.accept)return t?t.call(n):null;i.currentState=o.accept}if(i.currentState===e)return t?t.call(n,r):null;i.runTo(e,t,n,r)}))},r.prototype.addState=function(e,t,n,r){return\"function\"==typeof t?(r=t,t=null,n=null):\"function\"==typeof n&&(r=n,n=null),this.currentState||(this.currentState=e),this.states[e]={accept:t,fail:n,fn:r},this},t.exports=r},{}],73:[function(e,t,n){(function(n,r){(function(){var i,o={environment:\"nodejs\",engine:function(){if(o.isBrowser()&&\"undefined\"!=typeof navigator)return navigator.userAgent;var e=n.platform+\"/\"+n.version;return n.env.AWS_EXECUTION_ENV&&(e+=\" exec-env/\"+n.env.AWS_EXECUTION_ENV),e},userAgent:function(){var t=o.environment,n=\"aws-sdk-\"+t+\"/\"+e(\"./core\").VERSION;return\"nodejs\"===t&&(n+=\" \"+o.engine()),n},uriEscape:function(e){var t=encodeURIComponent(e);return(t=t.replace(/[^A-Za-z0-9_.~\\-%]+/g,escape)).replace(/[*]/g,(function(e){return\"%\"+e.charCodeAt(0).toString(16).toUpperCase()}))},uriEscapePath:function(e){var t=[];return o.arrayEach(e.split(\"/\"),(function(e){t.push(o.uriEscape(e))})),t.join(\"/\")},urlParse:function(e){return o.url.parse(e)},urlFormat:function(e){return o.url.format(e)},queryStringParse:function(e){return o.querystring.parse(e)},queryParamsToString:function(e){var t=[],n=o.uriEscape,r=Object.keys(e).sort();return o.arrayEach(r,(function(r){var i=e[r],s=n(r),a=s+\"=\";if(Array.isArray(i)){var c=[];o.arrayEach(i,(function(e){c.push(n(e))})),a=s+\"=\"+c.sort().join(\"&\"+s+\"=\")}else null!=i&&(a=s+\"=\"+n(i));t.push(a)})),t.join(\"&\")},readFileSync:function(t){return o.isBrowser()?null:e(\"fs\").readFileSync(t,\"utf-8\")},base64:{encode:function(e){if(\"number\"==typeof e)throw o.error(new Error(\"Cannot base64 encode number \"+e));return null==e?e:o.buffer.toBuffer(e).toString(\"base64\")},decode:function(e){if(\"number\"==typeof e)throw o.error(new Error(\"Cannot base64 decode number \"+e));return null==e?e:o.buffer.toBuffer(e,\"base64\")}},buffer:{toBuffer:function(e,t){return\"function\"==typeof o.Buffer.from&&o.Buffer.from!==Uint8Array.from?o.Buffer.from(e,t):new o.Buffer(e,t)},alloc:function(e,t,n){if(\"number\"!=typeof e)throw new Error(\"size passed to alloc must be a number.\");if(\"function\"==typeof o.Buffer.alloc)return o.Buffer.alloc(e,t,n);var r=new o.Buffer(e);return void 0!==t&&\"function\"==typeof r.fill&&r.fill(t,void 0,void 0,n),r},toStream:function(e){o.Buffer.isBuffer(e)||(e=o.buffer.toBuffer(e));var t=new o.stream.Readable,n=0;return t._read=function(r){if(n>=e.length)return t.push(null);var i=n+r;i>e.length&&(i=e.length),t.push(e.slice(n,i)),n=i},t},concat:function(e){var t,n,r=0,i=0;for(t=0;t<e.length;t++)r+=e[t].length;for(n=o.buffer.alloc(r),t=0;t<e.length;t++)e[t].copy(n,i),i+=e[t].length;return n}},string:{byteLength:function(t){if(null==t)return 0;if(\"string\"==typeof t&&(t=o.buffer.toBuffer(t)),\"number\"==typeof t.byteLength)return t.byteLength;if(\"number\"==typeof t.length)return t.length;if(\"number\"==typeof t.size)return t.size;if(\"string\"==typeof t.path)return e(\"fs\").lstatSync(t.path).size;throw o.error(new Error(\"Cannot determine length of \"+t),{object:t})},upperFirst:function(e){return e[0].toUpperCase()+e.substr(1)},lowerFirst:function(e){return e[0].toLowerCase()+e.substr(1)}},ini:{parse:function(e){var t,n={};return o.arrayEach(e.split(/\\r?\\n/),(function(e){var r=(e=e.split(/(^|\\s)[;#]/)[0]).match(/^\\s*\\[([^\\[\\]]+)\\]\\s*$/);if(r)t=r[1];else if(t){var i=e.match(/^\\s*(.+?)\\s*=\\s*(.+?)\\s*$/);i&&(n[t]=n[t]||{},n[t][i[1]]=i[2])}})),n}},fn:{noop:function(){},callback:function(e){if(e)throw e},makeAsync:function(e,t){return t&&t<=e.length?e:function(){var t=Array.prototype.slice.call(arguments,0);t.pop()(e.apply(null,t))}}},date:{getDate:function(){return i||(i=e(\"./core\")),i.config.systemClockOffset?new Date((new Date).getTime()+i.config.systemClockOffset):new Date},iso8601:function(e){return void 0===e&&(e=o.date.getDate()),e.toISOString().replace(/\\.\\d{3}Z$/,\"Z\")},rfc822:function(e){return void 0===e&&(e=o.date.getDate()),e.toUTCString()},unixTimestamp:function(e){return void 0===e&&(e=o.date.getDate()),e.getTime()/1e3},from:function(e){return\"number\"==typeof e?new Date(1e3*e):new Date(e)},format:function(e,t){return t||(t=\"iso8601\"),o.date[t](o.date.from(e))},parseTimestamp:function(e){if(\"number\"==typeof e)return new Date(1e3*e);if(e.match(/^\\d+$/))return new Date(1e3*e);if(e.match(/^\\d{4}/))return new Date(e);if(e.match(/^\\w{3},/))return new Date(e);throw o.error(new Error(\"unhandled timestamp format: \"+e),{code:\"TimestampParserError\"})}},crypto:{crc32Table:[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],crc32:function(e){var t=o.crypto.crc32Table,n=-1;\"string\"==typeof e&&(e=o.buffer.toBuffer(e));for(var r=0;r<e.length;r++)n=n>>>8^t[255&(n^e.readUInt8(r))];return(-1^n)>>>0},hmac:function(e,t,n,r){return n||(n=\"binary\"),\"buffer\"===n&&(n=void 0),r||(r=\"sha256\"),\"string\"==typeof t&&(t=o.buffer.toBuffer(t)),o.crypto.lib.createHmac(r,e).update(t).digest(n)},md5:function(e,t,n){return o.crypto.hash(\"md5\",e,t,n)},sha256:function(e,t,n){return o.crypto.hash(\"sha256\",e,t,n)},hash:function(e,t,n,r){var i=o.crypto.createHash(e);n||(n=\"binary\"),\"buffer\"===n&&(n=void 0),\"string\"==typeof t&&(t=o.buffer.toBuffer(t));var s=o.arraySliceFn(t),a=o.Buffer.isBuffer(t);if(o.isBrowser()&&\"undefined\"!=typeof ArrayBuffer&&t&&t.buffer instanceof ArrayBuffer&&(a=!0),r&&\"object\"==typeof t&&\"function\"==typeof t.on&&!a)t.on(\"data\",(function(e){i.update(e)})),t.on(\"error\",(function(e){r(e)})),t.on(\"end\",(function(){r(null,i.digest(n))}));else{if(!r||!s||a||\"undefined\"==typeof FileReader){o.isBrowser()&&\"object\"==typeof t&&!a&&(t=new o.Buffer(new Uint8Array(t)));var c=i.update(t).digest(n);return r&&r(null,c),c}var u=0,l=new FileReader;l.onerror=function(){r(new Error(\"Failed to read data.\"))},l.onload=function(){var e=new o.Buffer(new Uint8Array(l.result));i.update(e),u+=e.length,l._continueReading()},l._continueReading=function(){if(u>=t.size)r(null,i.digest(n));else{var e=u+524288;e>t.size&&(e=t.size),l.readAsArrayBuffer(s.call(t,u,e))}},l._continueReading()}},toHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((\"0\"+e.charCodeAt(n).toString(16)).substr(-2,2));return t.join(\"\")},createHash:function(e){return o.crypto.lib.createHash(e)}},abort:{},each:function(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t.call(this,n,e[n])===o.abort)break},arrayEach:function(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t.call(this,e[n],parseInt(n,10))===o.abort)break},update:function(e,t){return o.each(t,(function(t,n){e[t]=n})),e},merge:function(e,t){return o.update(o.copy(e),t)},copy:function(e){if(null==e)return e;var t={};for(var n in e)t[n]=e[n];return t},isEmpty:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},arraySliceFn:function(e){var t=e.slice||e.webkitSlice||e.mozSlice;return\"function\"==typeof t?t:null},isType:function(e,t){return\"function\"==typeof t&&(t=o.typeName(t)),Object.prototype.toString.call(e)===\"[object \"+t+\"]\"},typeName:function(e){if(Object.prototype.hasOwnProperty.call(e,\"name\"))return e.name;var t=e.toString(),n=t.match(/^\\s*function (.+)\\(/);return n?n[1]:t},error:function(e,t){var n=null;return\"string\"==typeof e.message&&\"\"!==e.message&&(\"string\"==typeof t||t&&t.message)&&((n=o.copy(e)).message=e.message),e.message=e.message||null,\"string\"==typeof t?e.message=t:\"object\"==typeof t&&null!==t&&(o.update(e,t),t.message&&(e.message=t.message),(t.code||t.name)&&(e.code=t.code||t.name),t.stack&&(e.stack=t.stack)),\"function\"==typeof Object.defineProperty&&(Object.defineProperty(e,\"name\",{writable:!0,enumerable:!1}),Object.defineProperty(e,\"message\",{enumerable:!0})),e.name=String(t&&t.name||e.name||e.code||\"Error\"),e.time=new Date,n&&(e.originalError=n),e},inherit:function(e,t){var n=null;if(void 0===t)t=e,e=Object,n={};else{var r=function(){};r.prototype=e.prototype,n=new r}return t.constructor===Object&&(t.constructor=function(){if(e!==Object)return e.apply(this,arguments)}),t.constructor.prototype=n,o.update(t.constructor.prototype,t),t.constructor.__super__=e,t.constructor},mixin:function(){for(var e=arguments[0],t=1;t<arguments.length;t++)for(var n in arguments[t].prototype){var r=arguments[t].prototype[n];\"constructor\"!==n&&(e.prototype[n]=r)}return e},hideProperties:function(e,t){\"function\"==typeof Object.defineProperty&&o.arrayEach(t,(function(t){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0})}))},property:function(e,t,n,r,i){var o={configurable:!0,enumerable:void 0===r||r};\"function\"!=typeof n||i?(o.value=n,o.writable=!0):o.get=n,Object.defineProperty(e,t,o)},memoizedProperty:function(e,t,n,r){var i=null;o.property(e,t,(function(){return null===i&&(i=n()),i}),r)},hoistPayloadMember:function(e){var t=e.request,n=t.operation,r=t.service.api.operations[n],i=r.output;if(i.payload&&!r.hasEventOutput){var s=i.members[i.payload],a=e.data[i.payload];\"structure\"===s.type&&o.each(a,(function(t,n){o.property(e.data,t,n,!1)}))}},computeSha256:function(t,n){if(o.isNode()){var r=o.stream.Stream,i=e(\"fs\");if(\"function\"==typeof r&&t instanceof r){if(\"string\"!=typeof t.path)return n(new Error(\"Non-file stream objects are not supported with SigV4\"));var s={};\"number\"==typeof t.start&&(s.start=t.start),\"number\"==typeof t.end&&(s.end=t.end),t=i.createReadStream(t.path,s)}}o.crypto.sha256(t,\"hex\",(function(e,t){e?n(e):n(null,t)}))},isClockSkewed:function(e){if(e)return o.property(i.config,\"isClockSkewed\",Math.abs((new Date).getTime()-e)>=3e5,!1),i.config.isClockSkewed},applyClockOffset:function(e){e&&(i.config.systemClockOffset=e-(new Date).getTime())},extractRequestId:function(e){var t=e.httpResponse.headers[\"x-amz-request-id\"]||e.httpResponse.headers[\"x-amzn-requestid\"];!t&&e.data&&e.data.ResponseMetadata&&(t=e.data.ResponseMetadata.RequestId),t&&(e.requestId=t),e.error&&(e.error.requestId=t)},addPromises:function(e,t){var n=!1;void 0===t&&i&&i.config&&(t=i.config.getPromisesDependency()),void 0===t&&\"undefined\"!=typeof Promise&&(t=Promise),\"function\"!=typeof t&&(n=!0),Array.isArray(e)||(e=[e]);for(var r=0;r<e.length;r++){var o=e[r];n?o.deletePromisesFromClass&&o.deletePromisesFromClass():o.addPromisesToClass&&o.addPromisesToClass(t)}},promisifyMethod:function(e,t){return function(){var n=this,r=Array.prototype.slice.call(arguments);return new t((function(t,i){r.push((function(e,n){e?i(e):t(n)})),n[e].apply(n,r)}))}},isDualstackAvailable:function(t){if(!t)return!1;var n=e(\"../apis/metadata.json\");return\"string\"!=typeof t&&(t=t.serviceIdentifier),!(\"string\"!=typeof t||!n.hasOwnProperty(t)||!n[t].dualstackAvailable)},calculateRetryDelay:function(e,t,n){t||(t={});var r=t.customBackoff||null;if(\"function\"==typeof r)return r(e,n);var i=\"number\"==typeof t.base?t.base:100;return Math.random()*(Math.pow(2,e)*i)},handleRequestWithRetries:function(e,t,n){t||(t={});var r=i.HttpClient.getInstance(),s=t.httpOptions||{},a=0,c=function(e){var r=t.maxRetries||0;if(e&&\"TimeoutError\"===e.code&&(e.retryable=!0),e&&e.retryable&&a<r){var i=o.calculateRetryDelay(a,t.retryDelayOptions,e);if(i>=0)return a++,void setTimeout(u,i+(e.retryAfter||0))}n(e)},u=function(){var t=\"\";r.handleRequest(e,s,(function(e){e.on(\"data\",(function(e){t+=e.toString()})),e.on(\"end\",(function(){var r=e.statusCode;if(r<300)n(null,t);else{var i=1e3*parseInt(e.headers[\"retry-after\"],10)||0,s=o.error(new Error,{statusCode:r,retryable:r>=500||429===r});i&&s.retryable&&(s.retryAfter=i),c(s)}}))}),c)};i.util.defer(u)},uuid:{v4:function(){return e(\"uuid\").v4()}},convertPayloadToString:function(e){var t=e.request,n=t.operation,r=t.service.api.operations[n].output||{};r.payload&&e.data[r.payload]&&(e.data[r.payload]=e.data[r.payload].toString())},defer:function(e){\"object\"==typeof n&&\"function\"==typeof n.nextTick?n.nextTick(e):\"function\"==typeof r?r(e):setTimeout(e,0)},getRequestPayloadShape:function(e){var t=e.service.api.operations;if(t){var n=(t||{})[e.operation];if(n&&n.input&&n.input.payload)return n.input.members[n.input.payload]}},getProfilesFromSharedConfig:function(e,t){function r(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++)e[r[n]]=t[r[n]];return e}var i={},s={};n.env[o.configOptInEnv]&&(s=e.loadFrom({isConfig:!0,filename:n.env[o.sharedConfigFileEnv]}));for(var a=e.loadFrom({filename:t||n.env[o.configOptInEnv]&&n.env[o.sharedCredentialsFileEnv]}),c=0,u=Object.keys(s);c<u.length;c++)i[u[c]]=r(i[u[c]]||{},s[u[c]]);for(c=0,u=Object.keys(a);c<u.length;c++)i[u[c]]=r(i[u[c]]||{},a[u[c]]);return i},ARN:{validate:function(e){return e&&0===e.indexOf(\"arn:\")&&e.split(\":\").length>=6},parse:function(e){var t=e.split(\":\");return{partition:t[1],service:t[2],region:t[3],accountId:t[4],resource:t.slice(5).join(\":\")}},build:function(e){if(void 0===e.service||void 0===e.region||void 0===e.accountId||void 0===e.resource)throw o.error(new Error(\"Input ARN object is invalid\"));return\"arn:\"+(e.partition||\"aws\")+\":\"+e.service+\":\"+e.region+\":\"+e.accountId+\":\"+e.resource}},defaultProfile:\"default\",configOptInEnv:\"AWS_SDK_LOAD_CONFIG\",sharedCredentialsFileEnv:\"AWS_SHARED_CREDENTIALS_FILE\",sharedConfigFileEnv:\"AWS_CONFIG_FILE\",imdsDisabledEnv:\"AWS_EC2_METADATA_DISABLED\"};t.exports=o}).call(this)}).call(this,e(\"_process\"),e(\"timers\").setImmediate)},{\"../apis/metadata.json\":5,\"./core\":20,_process:87,fs:81,timers:95,uuid:100}],74:[function(e,t,n){function r(){}function i(e,t){for(var n=e.getElementsByTagName(t),r=0,i=n.length;r<i;r++)if(n[r].parentNode===e)return n[r]}function o(e,t){switch(t||(t={}),t.type){case\"structure\":return s(e,t);case\"map\":return function(e,t){for(var n={},r=t.key.name||\"key\",s=t.value.name||\"value\",a=t.flattened?t.name:\"entry\",c=e.firstElementChild;c;){if(c.nodeName===a){var u=i(c,r).textContent,l=i(c,s);n[u]=o(l,t.value)}c=c.nextElementSibling}return n}(e,t);case\"list\":return function(e,t){for(var n=[],r=t.flattened?t.name:t.member.name||\"member\",i=e.firstElementChild;i;)i.nodeName===r&&n.push(o(i,t.member)),i=i.nextElementSibling;return n}(e,t);case void 0:case null:return function(e){if(null==e)return\"\";if(!e.firstElementChild)return null===e.parentNode.parentNode?{}:0===e.childNodes.length?\"\":e.textContent;for(var t={type:\"structure\",members:{}},n=e.firstElementChild;n;){var r=n.nodeName;Object.prototype.hasOwnProperty.call(t.members,r)?t.members[r].type=\"list\":t.members[r]={name:r},n=n.nextElementSibling}return s(e,t)}(e);default:return function(e,t){if(e.getAttribute){var n=e.getAttribute(\"encoding\");\"base64\"===n&&(t=new c.create({type:n}))}var r=e.textContent;return\"\"===r&&(r=null),\"function\"==typeof t.toType?t.toType(r):r}(e,t)}}function s(e,t){var n={};return null===e||a.each(t.members,(function(r,s){if(s.isXmlAttribute){if(Object.prototype.hasOwnProperty.call(e.attributes,s.name)){var a=e.attributes[s.name].value;n[r]=o({textContent:a},s)}}else{var c=s.flattened?e:i(e,s.name);c?n[r]=o(c,s):s.flattened||\"list\"!==s.type||t.api.xmlNoDefaultLists||(n[r]=s.defaultValue)}})),n}var a=e(\"../util\"),c=e(\"../model/shape\");r.prototype.parse=function(e,t){if(\"\"===e.replace(/^\\s+/,\"\"))return{};var n,r;try{if(window.DOMParser){try{n=(new DOMParser).parseFromString(e,\"text/xml\")}catch(e){throw a.error(new Error(\"Parse error in document\"),{originalError:e,code:\"XMLParserError\",retryable:!0})}if(null===n.documentElement)throw a.error(new Error(\"Cannot parse empty document.\"),{code:\"XMLParserError\",retryable:!0});var s=n.getElementsByTagName(\"parsererror\")[0];if(s&&(s.parentNode===n||\"body\"===s.parentNode.nodeName||s.parentNode.parentNode===n||\"body\"===s.parentNode.parentNode.nodeName)){var c=s.getElementsByTagName(\"div\")[0]||s;throw a.error(new Error(c.textContent||\"Parser error in document\"),{code:\"XMLParserError\",retryable:!0})}}else{if(!window.ActiveXObject)throw new Error(\"Cannot load XML parser\");if((n=new window.ActiveXObject(\"Microsoft.XMLDOM\")).async=!1,!n.loadXML(e))throw a.error(new Error(\"Parse error in document\"),{code:\"XMLParserError\",retryable:!0})}}catch(e){r=e}if(n&&n.documentElement&&!r){var u=o(n.documentElement,t),l=i(n.documentElement,\"ResponseMetadata\");return l&&(u.ResponseMetadata=o(l,{})),u}if(r)throw a.error(r||new Error,{code:\"XMLParserError\",retryable:!0});return{}},t.exports=r},{\"../model/shape\":45,\"../util\":73}],75:[function(e,t,n){function r(){}function i(e,t,n){switch(n.type){case\"structure\":return function(e,t,n){s.arrayEach(n.memberNames,(function(r){var s=n.members[r];if(\"body\"===s.location){var c=t[r],u=s.name;if(null!=c)if(s.isXmlAttribute)e.addAttribute(u,c);else if(s.flattened)i(e,c,s);else{var l=new a(u);e.addChildNode(l),o(l,s),i(l,c,s)}}}))}(e,t,n);case\"map\":return function(e,t,n){var r=n.key.name||\"key\",o=n.value.name||\"value\";s.each(t,(function(t,s){var c=new a(n.flattened?n.name:\"entry\");e.addChildNode(c);var u=new a(r),l=new a(o);c.addChildNode(u),c.addChildNode(l),i(u,t,n.key),i(l,s,n.value)}))}(e,t,n);case\"list\":return function(e,t,n){n.flattened?s.arrayEach(t,(function(t){var r=n.member.name||n.name,o=new a(r);e.addChildNode(o),i(o,t,n.member)})):s.arrayEach(t,(function(t){var r=n.member.name||\"member\",o=new a(r);e.addChildNode(o),i(o,t,n.member)}))}(e,t,n);default:return function(e,t,n){e.addChildNode(new c(n.toWireFormat(t)))}(e,t,n)}}function o(e,t,n){var r,i=\"xmlns\";t.xmlNamespaceUri?(r=t.xmlNamespaceUri,t.xmlNamespacePrefix&&(i+=\":\"+t.xmlNamespacePrefix)):n&&t.api.xmlNamespaceUri&&(r=t.api.xmlNamespaceUri),r&&e.addAttribute(i,r)}var s=e(\"../util\"),a=e(\"./xml-node\").XmlNode,c=e(\"./xml-text\").XmlText;r.prototype.toXML=function(e,t,n,r){var s=new a(n);return o(s,t,!0),i(s,e,t),s.children.length>0||r?s.toString():\"\"},t.exports=r},{\"../util\":73,\"./xml-node\":78,\"./xml-text\":79}],76:[function(e,t,n){t.exports={escapeAttribute:function(e){return e.replace(/&/g,\"&amp;\").replace(/'/g,\"&apos;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\")}}},{}],77:[function(e,t,n){t.exports={escapeElement:function(e){return e.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\")}}},{}],78:[function(e,t,n){function r(e,t){void 0===t&&(t=[]),this.name=e,this.children=t,this.attributes={}}var i=e(\"./escape-attribute\").escapeAttribute;r.prototype.addAttribute=function(e,t){return this.attributes[e]=t,this},r.prototype.addChildNode=function(e){return this.children.push(e),this},r.prototype.removeAttribute=function(e){return delete this.attributes[e],this},r.prototype.toString=function(){for(var e=Boolean(this.children.length),t=\"<\"+this.name,n=this.attributes,r=0,o=Object.keys(n);r<o.length;r++){var s=o[r],a=n[s];null!=a&&(t+=\" \"+s+'=\"'+i(\"\"+a)+'\"')}return t+(e?\">\"+this.children.map((function(e){return e.toString()})).join(\"\")+\"</\"+this.name+\">\":\"/>\")},t.exports={XmlNode:r}},{\"./escape-attribute\":76}],79:[function(e,t,n){function r(e){this.value=e}var i=e(\"./escape-element\").escapeElement;r.prototype.toString=function(){return i(\"\"+this.value)},t.exports={XmlText:r}},{\"./escape-element\":77}],80:[function(e,t,n){\"use strict\";function r(e){var t=e.length;if(t%4>0)throw new Error(\"Invalid string. Length must be a multiple of 4\");var n=e.indexOf(\"=\");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function i(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}function o(e,t,n){for(var r,o=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(i(r));return o.join(\"\")}n.byteLength=function(e){var t=r(e),n=t[0],i=t[1];return 3*(n+i)/4-i},n.toByteArray=function(e){var t,n,i=r(e),o=i[0],s=i[1],u=new c(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),l=0,p=s>0?o-4:o;for(n=0;n<p;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;return 2===s&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,u[l++]=255&t),1===s&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t),u},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,i=[],a=0,c=n-r;a<c;a+=16383)i.push(o(e,a,a+16383>c?c:a+16383));return 1===r?(t=e[n-1],i.push(s[t>>2]+s[t<<4&63]+\"==\")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+\"=\")),i.join(\"\")};for(var s=[],a=[],c=\"undefined\"!=typeof Uint8Array?Uint8Array:Array,u=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",l=0,p=u.length;l<p;++l)s[l]=u[l],a[u.charCodeAt(l)]=l;a[\"-\".charCodeAt(0)]=62,a[\"_\".charCodeAt(0)]=63},{}],81:[function(e,t,n){},{}],82:[function(e,t,r){(function(t,n){(function(){\"use strict\";function n(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(n()<t)throw new RangeError(\"Invalid typed array length\");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=o.prototype:(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,n){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,n);if(\"number\"==typeof e){if(\"string\"==typeof t)throw new Error(\"If encoding is specified then the first argument must be a string\");return c(this,e)}return s(this,e,t,n)}function s(e,t,n,r){if(\"number\"==typeof t)throw new TypeError('\"value\" argument must not be a number');return\"undefined\"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError(\"'offset' is out of bounds\");if(t.byteLength<n+(r||0))throw new RangeError(\"'length' is out of bounds\");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),o.TYPED_ARRAY_SUPPORT?(e=t).__proto__=o.prototype:e=u(e,t),e}(e,t,n,r):\"string\"==typeof t?function(e,t,n){if(\"string\"==typeof n&&\"\"!==n||(n=\"utf8\"),!o.isEncoding(n))throw new TypeError('\"encoding\" must be a valid string encoding');var r=0|p(t,n),s=(e=i(e,r)).write(t,n);return s!==r&&(e=e.slice(0,s)),e}(e,t,n):function(e,t){if(o.isBuffer(t)){var n=0|l(t.length);return 0===(e=i(e,n)).length||t.copy(e,0,0,n),e}if(t){if(\"undefined\"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||\"length\"in t)return\"number\"!=typeof t.length||function(e){return e!=e}(t.length)?i(e,0):u(e,t);if(\"Buffer\"===t.type&&F(t.data))return u(e,t.data)}throw new TypeError(\"First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.\")}(e,t)}function a(e){if(\"number\"!=typeof e)throw new TypeError('\"size\" argument must be a number');if(e<0)throw new RangeError('\"size\" argument must not be negative')}function c(e,t){if(a(t),e=i(e,t<0?0:0|l(t)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function u(e,t){var n=t.length<0?0:0|l(t.length);e=i(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function l(e){if(e>=n())throw new RangeError(\"Attempt to allocate Buffer larger than maximum size: 0x\"+n().toString(16)+\" bytes\");return 0|e}function p(e,t){if(o.isBuffer(e))return e.length;if(\"undefined\"!=typeof ArrayBuffer&&\"function\"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;\"string\"!=typeof e&&(e=\"\"+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case\"ascii\":case\"latin1\":case\"binary\":return n;case\"utf8\":case\"utf-8\":case void 0:return D(e).length;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return 2*n;case\"hex\":return n>>>1;case\"base64\":return U(e).length;default:if(r)return D(e).length;t=(\"\"+t).toLowerCase(),r=!0}}function d(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return\"\";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return\"\";if((n>>>=0)<=(t>>>=0))return\"\";for(e||(e=\"utf8\");;)switch(e){case\"hex\":return I(this,t,n);case\"utf8\":case\"utf-8\":return C(this,t,n);case\"ascii\":return T(this,t,n);case\"latin1\":case\"binary\":return k(this,t,n);case\"base64\":return E(this,t,n);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return _(this,t,n);default:if(r)throw new TypeError(\"Unknown encoding: \"+e);e=(e+\"\").toLowerCase(),r=!0}}function h(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function f(e,t,n,r,i){if(0===e.length)return-1;if(\"string\"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if(\"string\"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,i);if(\"number\"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&\"function\"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,i);throw new TypeError(\"val must be string, number or Buffer\")}function m(e,t,n,r,i){function o(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var s,a=1,c=e.length,u=t.length;if(void 0!==r&&(\"ucs2\"===(r=String(r).toLowerCase())||\"ucs-2\"===r||\"utf16le\"===r||\"utf-16le\"===r)){if(e.length<2||t.length<2)return-1;a=2,c/=2,u/=2,n/=2}if(i){var l=-1;for(s=n;s<c;s++)if(o(e,s)===o(t,-1===l?0:s-l)){if(-1===l&&(l=s),s-l+1===u)return l*a}else-1!==l&&(s-=s-l),l=-1}else for(n+u>c&&(n=c-u),s=n;s>=0;s--){for(var p=!0,d=0;d<u;d++)if(o(e,s+d)!==o(t,d)){p=!1;break}if(p)return s}return-1}function g(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError(\"Invalid hex string\");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function v(e,t,n,r){return q(D(t,e.length-n),e,n,r)}function y(e,t,n,r){return q(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function b(e,t,n,r){return y(e,t,n,r)}function w(e,t,n,r){return q(U(t),e,n,r)}function S(e,t,n,r){return q(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=(n=e.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function E(e,t,n){return 0===t&&n===e.length?j.fromByteArray(e):j.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,c,u=e[i],l=null,p=u>239?4:u>223?3:u>191?2:1;if(i+p<=n)switch(p){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,p=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=p}return function(e){var t=e.length;if(t<=B)return String.fromCharCode.apply(String,e);for(var n=\"\",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=B));return n}(r)}function T(e,t,n){var r=\"\";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function k(e,t,n){var r=\"\";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function I(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i=\"\",o=t;o<n;++o)i+=P(e[o]);return i}function _(e,t,n){for(var r=e.slice(t,n),i=\"\",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function x(e,t,n){if(e%1!=0||e<0)throw new RangeError(\"offset is not uint\");if(e+t>n)throw new RangeError(\"Trying to access beyond buffer length\")}function A(e,t,n,r,i,s){if(!o.isBuffer(e))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('\"value\" argument is out of bounds');if(n+r>e.length)throw new RangeError(\"Index out of range\")}function R(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function L(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function O(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError(\"Index out of range\");if(n<0)throw new RangeError(\"Index out of range\")}function N(e,t,n,r,i){return i||O(e,0,n,4),W.write(e,t,n,r,23,4),n+4}function M(e,t,n,r,i){return i||O(e,0,n,8),W.write(e,t,n,r,52,8),n+8}function P(e){return e<16?\"0\"+e.toString(16):e.toString(16)}function D(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error(\"Invalid code point\");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function U(e){return j.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\\s+|\\s+$/g,\"\")}(e).replace(z,\"\")).length<2)return\"\";for(;e.length%4!=0;)e+=\"=\";return e}(e))}function q(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}var j=e(\"base64-js\"),W=e(\"ieee754\"),F=e(\"isarray\");r.Buffer=o,r.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},r.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&\"function\"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),r.kMaxLength=n(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,n){return s(null,e,t,n)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,\"undefined\"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,n){return function(e,t,n,r){return a(t),t<=0?i(e,t):void 0!==n?\"string\"==typeof r?i(e,t).fill(n,r):i(e,t).fill(n):i(e,t)}(null,e,t,n)},o.allocUnsafe=function(e){return c(null,e)},o.allocUnsafeSlow=function(e){return c(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError(\"Arguments must be Buffers\");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},o.concat=function(e,t){if(!F(e))throw new TypeError('\"list\" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=o.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!o.isBuffer(s))throw new TypeError('\"list\" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},o.byteLength=p,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError(\"Buffer size must be a multiple of 16-bits\");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError(\"Buffer size must be a multiple of 32-bits\");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError(\"Buffer size must be a multiple of 64-bits\");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?\"\":0===arguments.length?C(this,0,e):d.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e=\"\",t=r.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString(\"hex\",0,t).match(/.{2}/g).join(\" \"),this.length>t&&(e+=\" ... \")),\"<Buffer \"+e+\">\"},o.prototype.compare=function(e,t,n,r,i){if(!o.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError(\"out of range index\");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var s=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),c=Math.min(s,a),u=this.slice(r,i),l=e.slice(t,n),p=0;p<c;++p)if(u[p]!==l[p]){s=u[p],a=l[p];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return f(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return f(this,e,t,n,!1)},o.prototype.write=function(e,t,n,r){if(void 0===t)r=\"utf8\",n=this.length,t=0;else if(void 0===n&&\"string\"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error(\"Buffer.write(string, encoding, offset[, length]) is no longer supported\");t|=0,isFinite(n)?(n|=0,void 0===r&&(r=\"utf8\")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError(\"Attempt to write outside buffer bounds\");r||(r=\"utf8\");for(var o=!1;;)switch(r){case\"hex\":return g(this,e,t,n);case\"utf8\":case\"utf-8\":return v(this,e,t,n);case\"ascii\":return y(this,e,t,n);case\"latin1\":case\"binary\":return b(this,e,t,n);case\"base64\":return w(this,e,t,n);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return S(this,e,t,n);default:if(o)throw new TypeError(\"Unknown encoding: \"+r);r=(\"\"+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}};var B=4096;o.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),o.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=o.prototype;else{var i=t-e;n=new o(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+e]}return n},o.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},o.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},o.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),W.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),W.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),W.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),W.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||A(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||A(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);A(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},o.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);A(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return M(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return M(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError(\"targetStart out of bounds\");if(n<0||n>=this.length)throw new RangeError(\"sourceStart out of bounds\");if(r<0)throw new RangeError(\"sourceEnd out of bounds\");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,s=r-n;if(this===e&&n<t&&t<r)for(i=s-1;i>=0;--i)e[i+t]=this[i+n];else if(s<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),t);return s},o.prototype.fill=function(e,t,n,r){if(\"string\"==typeof e){if(\"string\"==typeof t?(r=t,t=0,n=this.length):\"string\"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&\"string\"!=typeof r)throw new TypeError(\"encoding must be a string\");if(\"string\"==typeof r&&!o.isEncoding(r))throw new TypeError(\"Unknown encoding: \"+r)}else\"number\"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError(\"Out of range index\");if(n<=t)return this;var s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),\"number\"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var a=o.isBuffer(e)?e:D(new o(e,r).toString()),c=a.length;for(s=0;s<n-t;++s)this[s+t]=a[s%c]}return this};var z=/[^+\\/0-9A-Za-z-_]/g}).call(this)}).call(this,void 0!==n.g?n.g:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer)},{\"base64-js\":80,buffer:82,ieee754:84,isarray:85}],83:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return\"function\"==typeof e}function o(e){return\"object\"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!function(e){return\"number\"==typeof e}(e)||e<0||isNaN(e))throw TypeError(\"n must be a positive number\");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,a,c,u;if(this._events||(this._events={}),\"error\"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified \"error\" event. ('+t+\")\");throw l.context=t,l}if(s(n=this._events[e]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(o(n))for(a=Array.prototype.slice.call(arguments,1),r=(u=n.slice()).length,c=0;c<r;c++)u[c].apply(this,a);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError(\"listener must be a function\");return this._events||(this._events={}),this._events.newListener&&this.emit(\"newListener\",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error(\"(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.\",this._events[e].length),\"function\"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError(\"listener must be a function\");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,s,a;if(!i(t))throw TypeError(\"listener must be a function\");if(!this._events||!this._events[e])return this;if(s=(n=this._events[e]).length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit(\"removeListener\",e,t);else if(o(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit(\"removeListener\",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)\"removeListener\"!==t&&this.removeAllListeners(t);return this.removeAllListeners(\"removeListener\"),this._events={},this}if(i(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],84:[function(e,t,n){n.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,p=n?i-1:0,d=n?-1:1,h=e[t+p];for(p+=d,o=h&(1<<-l)-1,h>>=-l,l+=a;l>0;o=256*o+e[t+p],p+=d,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+p],p+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,r),o-=u}return(h?-1:1)*s*Math.pow(2,o-r)},n.write=function(e,t,n,r,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,p=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+p>=1?d/c:d*Math.pow(2,1-p))*c>=2&&(s++,c/=2),s+p>=l?(a=0,s=l):s+p>=1?(a=(t*c-1)*Math.pow(2,i),s+=p):(a=t*Math.pow(2,p-1)*Math.pow(2,i),s=0));i>=8;e[n+h]=255&a,h+=f,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+h]=255&s,h+=f,s/=256,u-=8);e[n+h-f]|=128*m}},{}],85:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return\"[object Array]\"==r.call(e)}},{}],86:[function(e,t,n){!function(e){\"use strict\";function t(e){return null!==e&&\"[object Array]\"===Object.prototype.toString.call(e)}function n(e){return null!==e&&\"[object Object]\"===Object.prototype.toString.call(e)}function r(e,i){if(e===i)return!0;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(i))return!1;if(!0===t(e)){if(e.length!==i.length)return!1;for(var o=0;o<e.length;o++)if(!1===r(e[o],i[o]))return!1;return!0}if(!0===n(e)){var s={};for(var a in e)if(hasOwnProperty.call(e,a)){if(!1===r(e[a],i[a]))return!1;s[a]=!0}for(var c in i)if(hasOwnProperty.call(i,c)&&!0!==s[c])return!1;return!0}return!1}function i(e){if(\"\"===e||!1===e||null===e)return!0;if(t(e)&&0===e.length)return!0;if(n(e)){for(var r in e)if(e.hasOwnProperty(r))return!1;return!0}return!1}function o(e){return e>=\"a\"&&e<=\"z\"||e>=\"A\"&&e<=\"Z\"||\"_\"===e}function s(e){return e>=\"0\"&&e<=\"9\"||\"-\"===e}function a(e){return e>=\"a\"&&e<=\"z\"||e>=\"A\"&&e<=\"Z\"||e>=\"0\"&&e<=\"9\"||\"_\"===e}function c(){}function u(){}function l(e){this.runtime=e}function p(e){this._interpreter=e,this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[h]}]},avg:{_func:this._functionAvg,_signature:[{types:[b]}]},ceil:{_func:this._functionCeil,_signature:[{types:[h]}]},contains:{_func:this._functionContains,_signature:[{types:[m,g]},{types:[f]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[m]},{types:[m]}]},floor:{_func:this._functionFloor,_signature:[{types:[h]}]},length:{_func:this._functionLength,_signature:[{types:[m,g,v]}]},map:{_func:this._functionMap,_signature:[{types:[y]},{types:[g]}]},max:{_func:this._functionMax,_signature:[{types:[b,w]}]},merge:{_func:this._functionMerge,_signature:[{types:[v],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[g]},{types:[y]}]},sum:{_func:this._functionSum,_signature:[{types:[b]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[m]},{types:[m]}]},min:{_func:this._functionMin,_signature:[{types:[b,w]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[g]},{types:[y]}]},type:{_func:this._functionType,_signature:[{types:[f]}]},keys:{_func:this._functionKeys,_signature:[{types:[v]}]},values:{_func:this._functionValues,_signature:[{types:[v]}]},sort:{_func:this._functionSort,_signature:[{types:[w,b]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[g]},{types:[y]}]},join:{_func:this._functionJoin,_signature:[{types:[m]},{types:[w]}]},reverse:{_func:this._functionReverse,_signature:[{types:[m,g]}]},to_array:{_func:this._functionToArray,_signature:[{types:[f]}]},to_string:{_func:this._functionToString,_signature:[{types:[f]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[f]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[f],variadic:!0}]}}}var d;d=\"function\"==typeof String.prototype.trimLeft?function(e){return e.trimLeft()}:function(e){return e.match(/^\\s*(.*)/)[1]};var h=0,f=1,m=2,g=3,v=4,y=6,b=8,w=9,S={\".\":\"Dot\",\"*\":\"Star\",\",\":\"Comma\",\":\":\"Colon\",\"{\":\"Lbrace\",\"}\":\"Rbrace\",\"]\":\"Rbracket\",\"(\":\"Lparen\",\")\":\"Rparen\",\"@\":\"Current\"},E={\"<\":!0,\">\":!0,\"=\":!0,\"!\":!0},C={\" \":!0,\"\\t\":!0,\"\\n\":!0};c.prototype={tokenize:function(e){var t,n,r,i=[];for(this._current=0;this._current<e.length;)if(o(e[this._current]))t=this._current,n=this._consumeUnquotedIdentifier(e),i.push({type:\"UnquotedIdentifier\",value:n,start:t});else if(void 0!==S[e[this._current]])i.push({type:S[e[this._current]],value:e[this._current],start:this._current}),this._current++;else if(s(e[this._current]))r=this._consumeNumber(e),i.push(r);else if(\"[\"===e[this._current])r=this._consumeLBracket(e),i.push(r);else if('\"'===e[this._current])t=this._current,n=this._consumeQuotedIdentifier(e),i.push({type:\"QuotedIdentifier\",value:n,start:t});else if(\"'\"===e[this._current])t=this._current,n=this._consumeRawStringLiteral(e),i.push({type:\"Literal\",value:n,start:t});else if(\"`\"===e[this._current]){t=this._current;var a=this._consumeLiteral(e);i.push({type:\"Literal\",value:a,start:t})}else if(void 0!==E[e[this._current]])i.push(this._consumeOperator(e));else if(void 0!==C[e[this._current]])this._current++;else if(\"&\"===e[this._current])t=this._current,this._current++,\"&\"===e[this._current]?(this._current++,i.push({type:\"And\",value:\"&&\",start:t})):i.push({type:\"Expref\",value:\"&\",start:t});else{if(\"|\"!==e[this._current]){var c=new Error(\"Unknown character:\"+e[this._current]);throw c.name=\"LexerError\",c}t=this._current,this._current++,\"|\"===e[this._current]?(this._current++,i.push({type:\"Or\",value:\"||\",start:t})):i.push({type:\"Pipe\",value:\"|\",start:t})}return i},_consumeUnquotedIdentifier:function(e){var t=this._current;for(this._current++;this._current<e.length&&a(e[this._current]);)this._current++;return e.slice(t,this._current)},_consumeQuotedIdentifier:function(e){var t=this._current;this._current++;for(var n=e.length;'\"'!==e[this._current]&&this._current<n;){var r=this._current;\"\\\\\"!==e[r]||\"\\\\\"!==e[r+1]&&'\"'!==e[r+1]?r++:r+=2,this._current=r}return this._current++,JSON.parse(e.slice(t,this._current))},_consumeRawStringLiteral:function(e){var t=this._current;this._current++;for(var n=e.length;\"'\"!==e[this._current]&&this._current<n;){var r=this._current;\"\\\\\"!==e[r]||\"\\\\\"!==e[r+1]&&\"'\"!==e[r+1]?r++:r+=2,this._current=r}return this._current++,e.slice(t+1,this._current-1).replace(\"\\\\'\",\"'\")},_consumeNumber:function(e){var t=this._current;this._current++;for(var n=e.length;s(e[this._current])&&this._current<n;)this._current++;return{type:\"Number\",value:parseInt(e.slice(t,this._current)),start:t}},_consumeLBracket:function(e){var t=this._current;return this._current++,\"?\"===e[this._current]?(this._current++,{type:\"Filter\",value:\"[?\",start:t}):\"]\"===e[this._current]?(this._current++,{type:\"Flatten\",value:\"[]\",start:t}):{type:\"Lbracket\",value:\"[\",start:t}},_consumeOperator:function(e){var t=this._current,n=e[t];return this._current++,\"!\"===n?\"=\"===e[this._current]?(this._current++,{type:\"NE\",value:\"!=\",start:t}):{type:\"Not\",value:\"!\",start:t}:\"<\"===n?\"=\"===e[this._current]?(this._current++,{type:\"LTE\",value:\"<=\",start:t}):{type:\"LT\",value:\"<\",start:t}:\">\"===n?\"=\"===e[this._current]?(this._current++,{type:\"GTE\",value:\">=\",start:t}):{type:\"GT\",value:\">\",start:t}:\"=\"===n&&\"=\"===e[this._current]?(this._current++,{type:\"EQ\",value:\"==\",start:t}):void 0},_consumeLiteral:function(e){this._current++;for(var t,n=this._current,r=e.length;\"`\"!==e[this._current]&&this._current<r;){var i=this._current;\"\\\\\"!==e[i]||\"\\\\\"!==e[i+1]&&\"`\"!==e[i+1]?i++:i+=2,this._current=i}var o=d(e.slice(n,this._current));return o=o.replace(\"\\\\`\",\"`\"),t=this._looksLikeJSON(o)?JSON.parse(o):JSON.parse('\"'+o+'\"'),this._current++,t},_looksLikeJSON:function(e){if(\"\"===e)return!1;if('[{\"'.indexOf(e[0])>=0)return!0;if([\"true\",\"false\",\"null\"].indexOf(e)>=0)return!0;if(!(\"-0123456789\".indexOf(e[0])>=0))return!1;try{return JSON.parse(e),!0}catch(e){return!1}}};var T={EOF:0,UnquotedIdentifier:0,QuotedIdentifier:0,Rbracket:0,Rparen:0,Comma:0,Rbrace:0,Number:0,Current:0,Expref:0,Pipe:1,Or:2,And:3,EQ:5,GT:5,LT:5,GTE:5,LTE:5,NE:5,Flatten:9,Star:20,Filter:21,Dot:40,Not:45,Lbrace:50,Lbracket:55,Lparen:60};u.prototype={parse:function(e){this._loadTokens(e),this.index=0;var t=this.expression(0);if(\"EOF\"!==this._lookahead(0)){var n=this._lookaheadToken(0),r=new Error(\"Unexpected token type: \"+n.type+\", value: \"+n.value);throw r.name=\"ParserError\",r}return t},_loadTokens:function(e){var t=(new c).tokenize(e);t.push({type:\"EOF\",value:\"\",start:e.length}),this.tokens=t},expression:function(e){var t=this._lookaheadToken(0);this._advance();for(var n=this.nud(t),r=this._lookahead(0);e<T[r];)this._advance(),n=this.led(r,n),r=this._lookahead(0);return n},_lookahead:function(e){return this.tokens[this.index+e].type},_lookaheadToken:function(e){return this.tokens[this.index+e]},_advance:function(){this.index++},nud:function(e){var t,n;switch(e.type){case\"Literal\":return{type:\"Literal\",value:e.value};case\"UnquotedIdentifier\":return{type:\"Field\",name:e.value};case\"QuotedIdentifier\":var r={type:\"Field\",name:e.value};if(\"Lparen\"===this._lookahead(0))throw new Error(\"Quoted identifier not allowed for function names.\");return r;case\"Not\":return{type:\"NotExpression\",children:[t=this.expression(T.Not)]};case\"Star\":return t=null,{type:\"ValueProjection\",children:[{type:\"Identity\"},t=\"Rbracket\"===this._lookahead(0)?{type:\"Identity\"}:this._parseProjectionRHS(T.Star)]};case\"Filter\":return this.led(e.type,{type:\"Identity\"});case\"Lbrace\":return this._parseMultiselectHash();case\"Flatten\":return{type:\"Projection\",children:[{type:\"Flatten\",children:[{type:\"Identity\"}]},t=this._parseProjectionRHS(T.Flatten)]};case\"Lbracket\":return\"Number\"===this._lookahead(0)||\"Colon\"===this._lookahead(0)?(t=this._parseIndexExpression(),this._projectIfSlice({type:\"Identity\"},t)):\"Star\"===this._lookahead(0)&&\"Rbracket\"===this._lookahead(1)?(this._advance(),this._advance(),{type:\"Projection\",children:[{type:\"Identity\"},t=this._parseProjectionRHS(T.Star)]}):this._parseMultiselectList();case\"Current\":return{type:\"Current\"};case\"Expref\":return{type:\"ExpressionReference\",children:[n=this.expression(T.Expref)]};case\"Lparen\":for(var i=[];\"Rparen\"!==this._lookahead(0);)\"Current\"===this._lookahead(0)?(n={type:\"Current\"},this._advance()):n=this.expression(0),i.push(n);return this._match(\"Rparen\"),i[0];default:this._errorToken(e)}},led:function(e,t){var n;switch(e){case\"Dot\":var r=T.Dot;return\"Star\"!==this._lookahead(0)?{type:\"Subexpression\",children:[t,n=this._parseDotRHS(r)]}:(this._advance(),{type:\"ValueProjection\",children:[t,n=this._parseProjectionRHS(r)]});case\"Pipe\":return{type:\"Pipe\",children:[t,n=this.expression(T.Pipe)]};case\"Or\":return{type:\"OrExpression\",children:[t,n=this.expression(T.Or)]};case\"And\":return{type:\"AndExpression\",children:[t,n=this.expression(T.And)]};case\"Lparen\":for(var i,o=t.name,s=[];\"Rparen\"!==this._lookahead(0);)\"Current\"===this._lookahead(0)?(i={type:\"Current\"},this._advance()):i=this.expression(0),\"Comma\"===this._lookahead(0)&&this._match(\"Comma\"),s.push(i);return this._match(\"Rparen\"),{type:\"Function\",name:o,children:s};case\"Filter\":var a=this.expression(0);return this._match(\"Rbracket\"),{type:\"FilterProjection\",children:[t,n=\"Flatten\"===this._lookahead(0)?{type:\"Identity\"}:this._parseProjectionRHS(T.Filter),a]};case\"Flatten\":return{type:\"Projection\",children:[{type:\"Flatten\",children:[t]},this._parseProjectionRHS(T.Flatten)]};case\"EQ\":case\"NE\":case\"GT\":case\"GTE\":case\"LT\":case\"LTE\":return this._parseComparator(t,e);case\"Lbracket\":var c=this._lookaheadToken(0);return\"Number\"===c.type||\"Colon\"===c.type?(n=this._parseIndexExpression(),this._projectIfSlice(t,n)):(this._match(\"Star\"),this._match(\"Rbracket\"),{type:\"Projection\",children:[t,n=this._parseProjectionRHS(T.Star)]});default:this._errorToken(this._lookaheadToken(0))}},_match:function(e){if(this._lookahead(0)!==e){var t=this._lookaheadToken(0),n=new Error(\"Expected \"+e+\", got: \"+t.type);throw n.name=\"ParserError\",n}this._advance()},_errorToken:function(e){var t=new Error(\"Invalid token (\"+e.type+'): \"'+e.value+'\"');throw t.name=\"ParserError\",t},_parseIndexExpression:function(){if(\"Colon\"===this._lookahead(0)||\"Colon\"===this._lookahead(1))return this._parseSliceExpression();var e={type:\"Index\",value:this._lookaheadToken(0).value};return this._advance(),this._match(\"Rbracket\"),e},_projectIfSlice:function(e,t){var n={type:\"IndexExpression\",children:[e,t]};return\"Slice\"===t.type?{type:\"Projection\",children:[n,this._parseProjectionRHS(T.Star)]}:n},_parseSliceExpression:function(){for(var e=[null,null,null],t=0,n=this._lookahead(0);\"Rbracket\"!==n&&t<3;){if(\"Colon\"===n)t++,this._advance();else{if(\"Number\"!==n){var r=this._lookahead(0),i=new Error(\"Syntax error, unexpected token: \"+r.value+\"(\"+r.type+\")\");throw i.name=\"Parsererror\",i}e[t]=this._lookaheadToken(0).value,this._advance()}n=this._lookahead(0)}return this._match(\"Rbracket\"),{type:\"Slice\",children:e}},_parseComparator:function(e,t){return{type:\"Comparator\",name:t,children:[e,this.expression(T[t])]}},_parseDotRHS:function(e){var t=this._lookahead(0);return[\"UnquotedIdentifier\",\"QuotedIdentifier\",\"Star\"].indexOf(t)>=0?this.expression(e):\"Lbracket\"===t?(this._match(\"Lbracket\"),this._parseMultiselectList()):\"Lbrace\"===t?(this._match(\"Lbrace\"),this._parseMultiselectHash()):void 0},_parseProjectionRHS:function(e){var t;if(T[this._lookahead(0)]<10)t={type:\"Identity\"};else if(\"Lbracket\"===this._lookahead(0))t=this.expression(e);else if(\"Filter\"===this._lookahead(0))t=this.expression(e);else{if(\"Dot\"!==this._lookahead(0)){var n=this._lookaheadToken(0),r=new Error(\"Sytanx error, unexpected token: \"+n.value+\"(\"+n.type+\")\");throw r.name=\"ParserError\",r}this._match(\"Dot\"),t=this._parseDotRHS(e)}return t},_parseMultiselectList:function(){for(var e=[];\"Rbracket\"!==this._lookahead(0);){var t=this.expression(0);if(e.push(t),\"Comma\"===this._lookahead(0)&&(this._match(\"Comma\"),\"Rbracket\"===this._lookahead(0)))throw new Error(\"Unexpected token Rbracket\")}return this._match(\"Rbracket\"),{type:\"MultiSelectList\",children:e}},_parseMultiselectHash:function(){for(var e,t,n,r=[],i=[\"UnquotedIdentifier\",\"QuotedIdentifier\"];;){if(e=this._lookaheadToken(0),i.indexOf(e.type)<0)throw new Error(\"Expecting an identifier token, got: \"+e.type);if(t=e.value,this._advance(),this._match(\"Colon\"),n={type:\"KeyValuePair\",name:t,value:this.expression(0)},r.push(n),\"Comma\"===this._lookahead(0))this._match(\"Comma\");else if(\"Rbrace\"===this._lookahead(0)){this._match(\"Rbrace\");break}}return{type:\"MultiSelectHash\",children:r}}},l.prototype={search:function(e,t){return this.visit(e,t)},visit:function(e,o){var s,a,c,u,l,p,d,h,f;switch(e.type){case\"Field\":return null===o?null:n(o)?void 0===(p=o[e.name])?null:p:null;case\"Subexpression\":for(c=this.visit(e.children[0],o),f=1;f<e.children.length;f++)if(null===(c=this.visit(e.children[1],c)))return null;return c;case\"IndexExpression\":case\"Pipe\":return d=this.visit(e.children[0],o),this.visit(e.children[1],d);case\"Index\":if(!t(o))return null;var m=e.value;return m<0&&(m=o.length+m),void 0===(c=o[m])&&(c=null),c;case\"Slice\":if(!t(o))return null;var g=e.children.slice(0),v=this.computeSliceParams(o.length,g),y=v[0],b=v[1],w=v[2];if(c=[],w>0)for(f=y;f<b;f+=w)c.push(o[f]);else for(f=y;f>b;f+=w)c.push(o[f]);return c;case\"Projection\":var S=this.visit(e.children[0],o);if(!t(S))return null;for(h=[],f=0;f<S.length;f++)null!==(a=this.visit(e.children[1],S[f]))&&h.push(a);return h;case\"ValueProjection\":if(!n(S=this.visit(e.children[0],o)))return null;h=[];var E=function(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;r++)n.push(e[t[r]]);return n}(S);for(f=0;f<E.length;f++)null!==(a=this.visit(e.children[1],E[f]))&&h.push(a);return h;case\"FilterProjection\":if(!t(S=this.visit(e.children[0],o)))return null;var C=[],T=[];for(f=0;f<S.length;f++)i(s=this.visit(e.children[2],S[f]))||C.push(S[f]);for(var k=0;k<C.length;k++)null!==(a=this.visit(e.children[1],C[k]))&&T.push(a);return T;case\"Comparator\":switch(u=this.visit(e.children[0],o),l=this.visit(e.children[1],o),e.name){case\"EQ\":c=r(u,l);break;case\"NE\":c=!r(u,l);break;case\"GT\":c=u>l;break;case\"GTE\":c=u>=l;break;case\"LT\":c=u<l;break;case\"LTE\":c=u<=l;break;default:throw new Error(\"Unknown comparator: \"+e.name)}return c;case\"Flatten\":var I=this.visit(e.children[0],o);if(!t(I))return null;var _=[];for(f=0;f<I.length;f++)t(a=I[f])?_.push.apply(_,a):_.push(a);return _;case\"Identity\":case\"Current\":return o;case\"MultiSelectList\":if(null===o)return null;for(h=[],f=0;f<e.children.length;f++)h.push(this.visit(e.children[f],o));return h;case\"MultiSelectHash\":if(null===o)return null;var x;for(h={},f=0;f<e.children.length;f++)h[(x=e.children[f]).name]=this.visit(x.value,o);return h;case\"OrExpression\":return i(s=this.visit(e.children[0],o))&&(s=this.visit(e.children[1],o)),s;case\"AndExpression\":return!0===i(u=this.visit(e.children[0],o))?u:this.visit(e.children[1],o);case\"NotExpression\":return i(u=this.visit(e.children[0],o));case\"Literal\":return e.value;case\"Function\":var A=[];for(f=0;f<e.children.length;f++)A.push(this.visit(e.children[f],o));return this.runtime.callFunction(e.name,A);case\"ExpressionReference\":var R=e.children[0];return R.jmespathType=\"Expref\",R;default:throw new Error(\"Unknown node type: \"+e.type)}},computeSliceParams:function(e,t){var n=t[0],r=t[1],i=t[2],o=[null,null,null];if(null===i)i=1;else if(0===i){var s=new Error(\"Invalid slice, step cannot be 0\");throw s.name=\"RuntimeError\",s}var a=i<0;return n=null===n?a?e-1:0:this.capSliceRange(e,n,i),r=null===r?a?-1:e:this.capSliceRange(e,r,i),o[0]=n,o[1]=r,o[2]=i,o},capSliceRange:function(e,t,n){return t<0?(t+=e)<0&&(t=n<0?-1:0):t>=e&&(t=n<0?e-1:e),t}},p.prototype={callFunction:function(e,t){var n=this.functionTable[e];if(void 0===n)throw new Error(\"Unknown function: \"+e+\"()\");return this._validateArgs(e,t,n._signature),n._func.call(this,t)},_validateArgs:function(e,t,n){var r;if(n[n.length-1].variadic){if(t.length<n.length)throw r=1===n.length?\" argument\":\" arguments\",new Error(\"ArgumentError: \"+e+\"() takes at least\"+n.length+r+\" but received \"+t.length)}else if(t.length!==n.length)throw r=1===n.length?\" argument\":\" arguments\",new Error(\"ArgumentError: \"+e+\"() takes \"+n.length+r+\" but received \"+t.length);for(var i,o,s,a=0;a<n.length;a++){s=!1,i=n[a].types,o=this._getTypeName(t[a]);for(var c=0;c<i.length;c++)if(this._typeMatches(o,i[c],t[a])){s=!0;break}if(!s)throw new Error(\"TypeError: \"+e+\"() expected argument \"+(a+1)+\" to be type \"+i+\" but received type \"+o+\" instead.\")}},_typeMatches:function(e,t,n){if(t===f)return!0;if(t!==w&&t!==b&&t!==g)return e===t;if(t===g)return e===g;if(e===g){var r;t===b?r=h:t===w&&(r=m);for(var i=0;i<n.length;i++)if(!this._typeMatches(this._getTypeName(n[i]),r,n[i]))return!1;return!0}},_getTypeName:function(e){switch(Object.prototype.toString.call(e)){case\"[object String]\":return m;case\"[object Number]\":return h;case\"[object Array]\":return g;case\"[object Boolean]\":return 5;case\"[object Null]\":return 7;case\"[object Object]\":return\"Expref\"===e.jmespathType?y:v}},_functionStartsWith:function(e){return 0===e[0].lastIndexOf(e[1])},_functionEndsWith:function(e){var t=e[0],n=e[1];return-1!==t.indexOf(n,t.length-n.length)},_functionReverse:function(e){if(this._getTypeName(e[0])===m){for(var t=e[0],n=\"\",r=t.length-1;r>=0;r--)n+=t[r];return n}var i=e[0].slice(0);return i.reverse(),i},_functionAbs:function(e){return Math.abs(e[0])},_functionCeil:function(e){return Math.ceil(e[0])},_functionAvg:function(e){for(var t=0,n=e[0],r=0;r<n.length;r++)t+=n[r];return t/n.length},_functionContains:function(e){return e[0].indexOf(e[1])>=0},_functionFloor:function(e){return Math.floor(e[0])},_functionLength:function(e){return n(e[0])?Object.keys(e[0]).length:e[0].length},_functionMap:function(e){for(var t=[],n=this._interpreter,r=e[0],i=e[1],o=0;o<i.length;o++)t.push(n.visit(r,i[o]));return t},_functionMerge:function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];for(var i in r)t[i]=r[i]}return t},_functionMax:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===h)return Math.max.apply(Math,e[0]);for(var t=e[0],n=t[0],r=1;r<t.length;r++)n.localeCompare(t[r])<0&&(n=t[r]);return n}return null},_functionMin:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===h)return Math.min.apply(Math,e[0]);for(var t=e[0],n=t[0],r=1;r<t.length;r++)t[r].localeCompare(n)<0&&(n=t[r]);return n}return null},_functionSum:function(e){for(var t=0,n=e[0],r=0;r<n.length;r++)t+=n[r];return t},_functionType:function(e){switch(this._getTypeName(e[0])){case h:return\"number\";case m:return\"string\";case g:return\"array\";case v:return\"object\";case 5:return\"boolean\";case y:return\"expref\";case 7:return\"null\"}},_functionKeys:function(e){return Object.keys(e[0])},_functionValues:function(e){for(var t=e[0],n=Object.keys(t),r=[],i=0;i<n.length;i++)r.push(t[n[i]]);return r},_functionJoin:function(e){var t=e[0];return e[1].join(t)},_functionToArray:function(e){return this._getTypeName(e[0])===g?e[0]:[e[0]]},_functionToString:function(e){return this._getTypeName(e[0])===m?e[0]:JSON.stringify(e[0])},_functionToNumber:function(e){var t,n=this._getTypeName(e[0]);return n===h?e[0]:n!==m||(t=+e[0],isNaN(t))?null:t},_functionNotNull:function(e){for(var t=0;t<e.length;t++)if(7!==this._getTypeName(e[t]))return e[t];return null},_functionSort:function(e){var t=e[0].slice(0);return t.sort(),t},_functionSortBy:function(e){var t=e[0].slice(0);if(0===t.length)return t;var n=this._interpreter,r=e[1],i=this._getTypeName(n.visit(r,t[0]));if([h,m].indexOf(i)<0)throw new Error(\"TypeError\");for(var o=this,s=[],a=0;a<t.length;a++)s.push([a,t[a]]);s.sort((function(e,t){var s=n.visit(r,e[1]),a=n.visit(r,t[1]);if(o._getTypeName(s)!==i)throw new Error(\"TypeError: expected \"+i+\", received \"+o._getTypeName(s));if(o._getTypeName(a)!==i)throw new Error(\"TypeError: expected \"+i+\", received \"+o._getTypeName(a));return s>a?1:s<a?-1:e[0]-t[0]}));for(var c=0;c<s.length;c++)t[c]=s[c][1];return t},_functionMaxBy:function(e){for(var t,n,r=e[1],i=e[0],o=this.createKeyFunction(r,[h,m]),s=-1/0,a=0;a<i.length;a++)(n=o(i[a]))>s&&(s=n,t=i[a]);return t},_functionMinBy:function(e){for(var t,n,r=e[1],i=e[0],o=this.createKeyFunction(r,[h,m]),s=1/0,a=0;a<i.length;a++)(n=o(i[a]))<s&&(s=n,t=i[a]);return t},createKeyFunction:function(e,t){var n=this,r=this._interpreter;return function(i){var o=r.visit(e,i);if(t.indexOf(n._getTypeName(o))<0){var s=\"TypeError: expected one of \"+t+\", received \"+n._getTypeName(o);throw new Error(s)}return o}}},e.tokenize=function(e){return(new c).tokenize(e)},e.compile=function(e){return(new u).parse(e)},e.search=function(e,t){var n=new u,r=new p,i=new l(r);r._interpreter=i;var o=n.parse(t);return i.search(o,e)},e.strictDeepEqual=r}(void 0===n?this.jmespath={}:n)},{}],87:[function(e,t,n){function r(){throw new Error(\"setTimeout has not been defined\")}function i(){throw new Error(\"clearTimeout has not been defined\")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function s(){m&&h&&(m=!1,h.length?f=h.concat(f):g=-1,f.length&&a())}function a(){if(!m){var e=o(s);m=!0;for(var t=f.length;t;){for(h=f,f=[];++g<t;)h&&h[g].run();g=-1,t=f.length}h=null,m=!1,function(e){if(p===clearTimeout)return clearTimeout(e);if((p===i||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var l,p,d=t.exports={};!function(){try{l=\"function\"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{p=\"function\"==typeof clearTimeout?clearTimeout:i}catch(e){p=i}}();var h,f=[],m=!1,g=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new c(e,t)),1!==f.length||m||o(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},d.title=\"browser\",d.browser=!0,d.env={},d.argv=[],d.version=\"\",d.versions={},d.on=u,d.addListener=u,d.once=u,d.off=u,d.removeListener=u,d.removeAllListeners=u,d.emit=u,d.prependListener=u,d.prependOnceListener=u,d.listeners=function(e){return[]},d.binding=function(e){throw new Error(\"process.binding is not supported\")},d.cwd=function(){return\"/\"},d.chdir=function(e){throw new Error(\"process.chdir is not supported\")},d.umask=function(){return 0}},{}],88:[function(i,o,s){(function(i){(function(){!function(a){function c(e){throw RangeError(P[e])}function u(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function l(e,t){var n=e.split(\"@\"),r=\"\";return n.length>1&&(r=n[0]+\"@\",e=n[1]),r+u((e=e.replace(M,\".\")).split(\".\"),t).join(\".\")}function p(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function d(e){return u(e,(function(e){var t=\"\";return e>65535&&(t+=q((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+q(e)})).join(\"\")}function h(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:T}function f(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function m(e,t,n){var r=0;for(e=n?U(e/x):e>>1,e+=U(e/t);e>D*I>>1;r+=T)e=U(e/D);return U(r+(D+1)*e/(e+_))}function g(e){var t,n,r,i,o,s,a,u,l,p,f=[],g=e.length,v=0,y=R,b=A;for((n=e.lastIndexOf(L))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&c(\"not-basic\"),f.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<g;){for(o=v,s=1,a=T;i>=g&&c(\"invalid-input\"),((u=h(e.charCodeAt(i++)))>=T||u>U((C-v)/s))&&c(\"overflow\"),v+=u*s,!(u<(l=a<=b?k:a>=b+I?I:a-b));a+=T)s>U(C/(p=T-l))&&c(\"overflow\"),s*=p;b=m(v-o,t=f.length+1,0==o),U(v/t)>C-y&&c(\"overflow\"),y+=U(v/t),v%=t,f.splice(v++,0,y)}return d(f)}function v(e){var t,n,r,i,o,s,a,u,l,d,h,g,v,y,b,w=[];for(g=(e=p(e)).length,t=R,n=0,o=A,s=0;s<g;++s)(h=e[s])<128&&w.push(q(h));for(r=i=w.length,i&&w.push(L);r<g;){for(a=C,s=0;s<g;++s)(h=e[s])>=t&&h<a&&(a=h);for(a-t>U((C-n)/(v=r+1))&&c(\"overflow\"),n+=(a-t)*v,t=a,s=0;s<g;++s)if((h=e[s])<t&&++n>C&&c(\"overflow\"),h==t){for(u=n,l=T;!(u<(d=l<=o?k:l>=o+I?I:l-o));l+=T)b=u-d,y=T-d,w.push(q(f(d+b%y,0))),u=U(b/y);w.push(q(f(u,0))),o=m(n,v,r==i),n=0,++r}++n,++t}return w.join(\"\")}var y=\"object\"==typeof s&&s&&!s.nodeType&&s,b=\"object\"==typeof o&&o&&!o.nodeType&&o,w=\"object\"==typeof i&&i;w.global!==w&&w.window!==w&&w.self!==w||(a=w);var S,E,C=2147483647,T=36,k=1,I=26,_=38,x=700,A=72,R=128,L=\"-\",O=/^xn--/,N=/[^\\x20-\\x7E]/,M=/[\\x2E\\u3002\\uFF0E\\uFF61]/g,P={overflow:\"Overflow: input needs wider integers to process\",\"not-basic\":\"Illegal input >= 0x80 (not a basic code point)\",\"invalid-input\":\"Invalid input\"},D=T-k,U=Math.floor,q=String.fromCharCode;if(S={version:\"1.3.2\",ucs2:{decode:p,encode:d},decode:g,encode:v,toASCII:function(e){return l(e,(function(e){return N.test(e)?\"xn--\"+v(e):e}))},toUnicode:function(e){return l(e,(function(e){return O.test(e)?g(e.slice(4).toLowerCase()):e}))}},n.amdO)void 0===(r=function(){return S}.call(t,n,t,e))||(e.exports=r);else if(y&&b)if(o.exports==y)b.exports=S;else for(E in S)S.hasOwnProperty(E)&&(y[E]=S[E]);else a.punycode=S}(this)}).call(this)}).call(this,void 0!==n.g?n.g:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],89:[function(e,t,n){\"use strict\";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,o){t=t||\"&\",n=n||\"=\";var s={};if(\"string\"!=typeof e||0===e.length)return s;var a=/\\+/g;e=e.split(t);var c=1e3;o&&\"number\"==typeof o.maxKeys&&(c=o.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var l=0;l<u;++l){var p,d,h,f,m=e[l].replace(a,\"%20\"),g=m.indexOf(n);g>=0?(p=m.substr(0,g),d=m.substr(g+1)):(p=m,d=\"\"),h=decodeURIComponent(p),f=decodeURIComponent(d),r(s,h)?i(s[h])?s[h].push(f):s[h]=[s[h],f]:s[h]=f}return s};var i=Array.isArray||function(e){return\"[object Array]\"===Object.prototype.toString.call(e)}},{}],90:[function(e,t,n){\"use strict\";function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var i=function(e){switch(typeof e){case\"string\":return e;case\"boolean\":return e?\"true\":\"false\";case\"number\":return isFinite(e)?e:\"\";default:return\"\"}};t.exports=function(e,t,n,a){return t=t||\"&\",n=n||\"=\",null===e&&(e=void 0),\"object\"==typeof e?r(s(e),(function(s){var a=encodeURIComponent(i(s))+n;return o(e[s])?r(e[s],(function(e){return a+encodeURIComponent(i(e))})).join(t):a+encodeURIComponent(i(e[s]))})).join(t):a?encodeURIComponent(i(a))+n+encodeURIComponent(i(e)):\"\"};var o=Array.isArray||function(e){return\"[object Array]\"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],91:[function(e,t,n){\"use strict\";n.decode=n.parse=e(\"./decode\"),n.encode=n.stringify=e(\"./encode\")},{\"./decode\":89,\"./encode\":90}],92:[function(e,t,n){\"use strict\";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,i){t=t||\"&\",n=n||\"=\";var o={};if(\"string\"!=typeof e||0===e.length)return o;var s=/\\+/g;e=e.split(t);var a=1e3;i&&\"number\"==typeof i.maxKeys&&(a=i.maxKeys);var c=e.length;a>0&&c>a&&(c=a);for(var u=0;u<c;++u){var l,p,d,h,f=e[u].replace(s,\"%20\"),m=f.indexOf(n);m>=0?(l=f.substr(0,m),p=f.substr(m+1)):(l=f,p=\"\"),d=decodeURIComponent(l),h=decodeURIComponent(p),r(o,d)?Array.isArray(o[d])?o[d].push(h):o[d]=[o[d],h]:o[d]=h}return o}},{}],93:[function(e,t,n){\"use strict\";var r=function(e){switch(typeof e){case\"string\":return e;case\"boolean\":return e?\"true\":\"false\";case\"number\":return isFinite(e)?e:\"\";default:return\"\"}};t.exports=function(e,t,n,i){return t=t||\"&\",n=n||\"=\",null===e&&(e=void 0),\"object\"==typeof e?Object.keys(e).map((function(i){var o=encodeURIComponent(r(i))+n;return Array.isArray(e[i])?e[i].map((function(e){return o+encodeURIComponent(r(e))})).join(t):o+encodeURIComponent(r(e[i]))})).join(t):i?encodeURIComponent(r(i))+n+encodeURIComponent(r(e)):\"\"}},{}],94:[function(e,t,n){arguments[4][91][0].apply(n,arguments)},{\"./decode\":92,\"./encode\":93,dup:91}],95:[function(e,t,n){(function(t,r){(function(){function i(e,t){this._id=e,this._clearFn=t}var o=e(\"process/browser.js\").nextTick,s=Function.prototype.apply,a=Array.prototype.slice,c={},u=0;n.setTimeout=function(){return new i(s.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new i(s.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n.setImmediate=\"function\"==typeof t?t:function(e){var t=u++,r=!(arguments.length<2)&&a.call(arguments,1);return c[t]=!0,o((function(){c[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))})),t},n.clearImmediate=\"function\"==typeof r?r:function(e){delete c[e]}}).call(this)}).call(this,e(\"timers\").setImmediate,e(\"timers\").clearImmediate)},{\"process/browser.js\":87,timers:95}],96:[function(e,t,n){function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,n){if(e&&s(e)&&e instanceof r)return e;var i=new r;return i.parse(e,t,n),i}function o(e){return\"string\"==typeof e}function s(e){return\"object\"==typeof e&&null!==e}function a(e){return null===e}var c=e(\"punycode\");n.parse=i,n.resolve=function(e,t){return i(e,!1,!0).resolve(t)},n.resolveObject=function(e,t){return e?i(e,!1,!0).resolveObject(t):t},n.format=function(e){return o(e)&&(e=i(e)),e instanceof r?e.format():r.prototype.format.call(e)},n.Url=r;var u=/^([a-z0-9.+-]+:)/i,l=/:[0-9]*$/,p=[\"{\",\"}\",\"|\",\"\\\\\",\"^\",\"`\"].concat([\"<\",\">\",'\"',\"`\",\" \",\"\\r\",\"\\n\",\"\\t\"]),d=[\"'\"].concat(p),h=[\"%\",\"/\",\"?\",\";\",\"#\"].concat(d),f=[\"/\",\"?\",\"#\"],m=/^[a-z0-9A-Z_-]{0,63}$/,g=/^([a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,\"javascript:\":!0},y={javascript:!0,\"javascript:\":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,\"http:\":!0,\"https:\":!0,\"ftp:\":!0,\"gopher:\":!0,\"file:\":!0},w=e(\"querystring\");r.prototype.parse=function(e,t,n){if(!o(e))throw new TypeError(\"Parameter 'url' must be a string, not \"+typeof e);var r=e;r=r.trim();var i=u.exec(r);if(i){var s=(i=i[0]).toLowerCase();this.protocol=s,r=r.substr(i.length)}if(n||i||r.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)){var a=\"//\"===r.substr(0,2);!a||i&&y[i]||(r=r.substr(2),this.slashes=!0)}if(!y[i]&&(a||i&&!b[i])){for(var l=-1,p=0;p<f.length;p++)-1!==(C=r.indexOf(f[p]))&&(-1===l||C<l)&&(l=C);var S,E;for(-1!==(E=-1===l?r.lastIndexOf(\"@\"):r.lastIndexOf(\"@\",l))&&(S=r.slice(0,E),r=r.slice(E+1),this.auth=decodeURIComponent(S)),l=-1,p=0;p<h.length;p++){var C;-1!==(C=r.indexOf(h[p]))&&(-1===l||C<l)&&(l=C)}-1===l&&(l=r.length),this.host=r.slice(0,l),r=r.slice(l),this.parseHost(),this.hostname=this.hostname||\"\";var T=\"[\"===this.hostname[0]&&\"]\"===this.hostname[this.hostname.length-1];if(!T)for(var k=this.hostname.split(/\\./),I=(p=0,k.length);p<I;p++){var _=k[p];if(_&&!_.match(m)){for(var x=\"\",A=0,R=_.length;A<R;A++)_.charCodeAt(A)>127?x+=\"x\":x+=_[A];if(!x.match(m)){var L=k.slice(0,p),O=k.slice(p+1),N=_.match(g);N&&(L.push(N[1]),O.unshift(N[2])),O.length&&(r=\"/\"+O.join(\".\")+r),this.hostname=L.join(\".\");break}}}if(this.hostname.length>255?this.hostname=\"\":this.hostname=this.hostname.toLowerCase(),!T){var M=this.hostname.split(\".\"),P=[];for(p=0;p<M.length;++p){var D=M[p];P.push(D.match(/[^A-Za-z0-9_-]/)?\"xn--\"+c.encode(D):D)}this.hostname=P.join(\".\")}var U=this.port?\":\"+this.port:\"\",q=this.hostname||\"\";this.host=q+U,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),\"/\"!==r[0]&&(r=\"/\"+r))}if(!v[s])for(p=0,I=d.length;p<I;p++){var j=d[p],W=encodeURIComponent(j);W===j&&(W=escape(j)),r=r.split(j).join(W)}var F=r.indexOf(\"#\");-1!==F&&(this.hash=r.substr(F),r=r.slice(0,F));var B=r.indexOf(\"?\");return-1!==B?(this.search=r.substr(B),this.query=r.substr(B+1),t&&(this.query=w.parse(this.query)),r=r.slice(0,B)):t&&(this.search=\"\",this.query={}),r&&(this.pathname=r),b[s]&&this.hostname&&!this.pathname&&(this.pathname=\"/\"),(this.pathname||this.search)&&(U=this.pathname||\"\",D=this.search||\"\",this.path=U+D),this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||\"\";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,\":\"),e+=\"@\");var t=this.protocol||\"\",n=this.pathname||\"\",r=this.hash||\"\",i=!1,o=\"\";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(\":\")?this.hostname:\"[\"+this.hostname+\"]\"),this.port&&(i+=\":\"+this.port)),this.query&&s(this.query)&&Object.keys(this.query).length&&(o=w.stringify(this.query));var a=this.search||o&&\"?\"+o||\"\";return t&&\":\"!==t.substr(-1)&&(t+=\":\"),this.slashes||(!t||b[t])&&!1!==i?(i=\"//\"+(i||\"\"),n&&\"/\"!==n.charAt(0)&&(n=\"/\"+n)):i||(i=\"\"),r&&\"#\"!==r.charAt(0)&&(r=\"#\"+r),a&&\"?\"!==a.charAt(0)&&(a=\"?\"+a),n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})),t+i+n+(a=a.replace(\"#\",\"%23\"))+r},r.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(o(e)){var t=new r;t.parse(e,!1,!0),e=t}var n=new r;if(Object.keys(this).forEach((function(e){n[e]=this[e]}),this),n.hash=e.hash,\"\"===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol)return Object.keys(e).forEach((function(t){\"protocol\"!==t&&(n[t]=e[t])})),b[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname=\"/\"),n.href=n.format(),n;if(e.protocol&&e.protocol!==n.protocol){if(!b[e.protocol])return Object.keys(e).forEach((function(t){n[t]=e[t]})),n.href=n.format(),n;if(n.protocol=e.protocol,e.host||y[e.protocol])n.pathname=e.pathname;else{for(var i=(e.pathname||\"\").split(\"/\");i.length&&!(e.host=i.shift()););e.host||(e.host=\"\"),e.hostname||(e.hostname=\"\"),\"\"!==i[0]&&i.unshift(\"\"),i.length<2&&i.unshift(\"\"),n.pathname=i.join(\"/\")}if(n.search=e.search,n.query=e.query,n.host=e.host||\"\",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var s=n.pathname||\"\",c=n.search||\"\";n.path=s+c}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var u=n.pathname&&\"/\"===n.pathname.charAt(0),l=e.host||e.pathname&&\"/\"===e.pathname.charAt(0),p=l||u||n.host&&e.pathname,d=p,h=n.pathname&&n.pathname.split(\"/\")||[],f=(i=e.pathname&&e.pathname.split(\"/\")||[],n.protocol&&!b[n.protocol]);if(f&&(n.hostname=\"\",n.port=null,n.host&&(\"\"===h[0]?h[0]=n.host:h.unshift(n.host)),n.host=\"\",e.protocol&&(e.hostname=null,e.port=null,e.host&&(\"\"===i[0]?i[0]=e.host:i.unshift(e.host)),e.host=null),p=p&&(\"\"===i[0]||\"\"===h[0])),l)n.host=e.host||\"\"===e.host?e.host:n.host,n.hostname=e.hostname||\"\"===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,h=i;else if(i.length)h||(h=[]),h.pop(),h=h.concat(i),n.search=e.search,n.query=e.query;else if(!function(e){return null==e}(e.search))return f&&(n.hostname=n.host=h.shift(),(S=!!(n.host&&n.host.indexOf(\"@\")>0)&&n.host.split(\"@\"))&&(n.auth=S.shift(),n.host=n.hostname=S.shift())),n.search=e.search,n.query=e.query,a(n.pathname)&&a(n.search)||(n.path=(n.pathname?n.pathname:\"\")+(n.search?n.search:\"\")),n.href=n.format(),n;if(!h.length)return n.pathname=null,n.search?n.path=\"/\"+n.search:n.path=null,n.href=n.format(),n;for(var m=h.slice(-1)[0],g=(n.host||e.host)&&(\".\"===m||\"..\"===m)||\"\"===m,v=0,w=h.length;w>=0;w--)\".\"==(m=h[w])?h.splice(w,1):\"..\"===m?(h.splice(w,1),v++):v&&(h.splice(w,1),v--);if(!p&&!d)for(;v--;v)h.unshift(\"..\");!p||\"\"===h[0]||h[0]&&\"/\"===h[0].charAt(0)||h.unshift(\"\"),g&&\"/\"!==h.join(\"/\").substr(-1)&&h.push(\"\");var S,E=\"\"===h[0]||h[0]&&\"/\"===h[0].charAt(0);return f&&(n.hostname=n.host=E?\"\":h.length?h.shift():\"\",(S=!!(n.host&&n.host.indexOf(\"@\")>0)&&n.host.split(\"@\"))&&(n.auth=S.shift(),n.host=n.hostname=S.shift())),(p=p||n.host&&h.length)&&!E&&h.unshift(\"\"),h.length?n.pathname=h.join(\"/\"):(n.pathname=null,n.path=null),a(n.pathname)&&a(n.search)||(n.path=(n.pathname?n.pathname:\"\")+(n.search?n.search:\"\")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=l.exec(e);t&&(\":\"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:88,querystring:91}],97:[function(e,t,n){\"function\"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],98:[function(e,t,n){t.exports=function(e){return e&&\"object\"==typeof e&&\"function\"==typeof e.copy&&\"function\"==typeof e.fill&&\"function\"==typeof e.readUInt8}},{}],99:[function(e,t,r){(function(t,n){(function(){function i(e,t){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(t)?n.showHidden=t:t&&r._extend(n,t),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),a(n,e,n.depth)}function o(e,t){var n=i.styles[t];return n?\"\u001B[\"+i.colors[n][0]+\"m\"+e+\"\u001B[\"+i.colors[n][1]+\"m\":e}function s(e,t){return e}function a(e,t,n){if(e.customInspect&&t&&S(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return m(i)||(i=a(e,i,n)),i}var o=c(e,t);if(o)return o;var s=Object.keys(t),d=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),w(t)&&(s.indexOf(\"message\")>=0||s.indexOf(\"description\")>=0))return u(t);if(0===s.length){if(S(t)){var h=t.name?\": \"+t.name:\"\";return e.stylize(\"[Function\"+h+\"]\",\"special\")}if(v(t))return e.stylize(RegExp.prototype.toString.call(t),\"regexp\");if(b(t))return e.stylize(Date.prototype.toString.call(t),\"date\");if(w(t))return u(t)}var f,g=\"\",y=!1,E=[\"{\",\"}\"];return p(t)&&(y=!0,E=[\"[\",\"]\"]),S(t)&&(g=\" [Function\"+(t.name?\": \"+t.name:\"\")+\"]\"),v(t)&&(g=\" \"+RegExp.prototype.toString.call(t)),b(t)&&(g=\" \"+Date.prototype.toUTCString.call(t)),w(t)&&(g=\" \"+u(t)),0!==s.length||y&&0!=t.length?n<0?v(t)?e.stylize(RegExp.prototype.toString.call(t),\"regexp\"):e.stylize(\"[Object]\",\"special\"):(e.seen.push(t),f=y?function(e,t,n,r,i){for(var o=[],s=0,a=t.length;s<a;++s)k(t,String(s))?o.push(l(e,t,n,r,String(s),!0)):o.push(\"\");return i.forEach((function(i){i.match(/^\\d+$/)||o.push(l(e,t,n,r,i,!0))})),o}(e,t,n,d,s):s.map((function(r){return l(e,t,n,d,r,y)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf(\"\\n\"),e+t.replace(/\\u001b\\[\\d\\d?m/g,\"\").length+1}),0)>60?n[0]+(\"\"===t?\"\":t+\"\\n \")+\" \"+e.join(\",\\n  \")+\" \"+n[1]:n[0]+t+\" \"+e.join(\", \")+\" \"+n[1]}(f,g,E)):E[0]+g+E[1]}function c(e,t){if(g(t))return e.stylize(\"undefined\",\"undefined\");if(m(t)){var n=\"'\"+JSON.stringify(t).replace(/^\"|\"$/g,\"\").replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"')+\"'\";return e.stylize(n,\"string\")}return f(t)?e.stylize(\"\"+t,\"number\"):d(t)?e.stylize(\"\"+t,\"boolean\"):h(t)?e.stylize(\"null\",\"null\"):void 0}function u(e){return\"[\"+Error.prototype.toString.call(e)+\"]\"}function l(e,t,n,r,i,o){var s,c,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?c=u.set?e.stylize(\"[Getter/Setter]\",\"special\"):e.stylize(\"[Getter]\",\"special\"):u.set&&(c=e.stylize(\"[Setter]\",\"special\")),k(r,i)||(s=\"[\"+i+\"]\"),c||(e.seen.indexOf(u.value)<0?(c=h(n)?a(e,u.value,null):a(e,u.value,n-1)).indexOf(\"\\n\")>-1&&(c=o?c.split(\"\\n\").map((function(e){return\"  \"+e})).join(\"\\n\").substr(2):\"\\n\"+c.split(\"\\n\").map((function(e){return\"   \"+e})).join(\"\\n\")):c=e.stylize(\"[Circular]\",\"special\")),g(s)){if(o&&i.match(/^\\d+$/))return c;(s=JSON.stringify(\"\"+i)).match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,\"name\")):(s=s.replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"').replace(/(^\"|\"$)/g,\"'\"),s=e.stylize(s,\"string\"))}return s+\": \"+c}function p(e){return Array.isArray(e)}function d(e){return\"boolean\"==typeof e}function h(e){return null===e}function f(e){return\"number\"==typeof e}function m(e){return\"string\"==typeof e}function g(e){return void 0===e}function v(e){return y(e)&&\"[object RegExp]\"===E(e)}function y(e){return\"object\"==typeof e&&null!==e}function b(e){return y(e)&&\"[object Date]\"===E(e)}function w(e){return y(e)&&(\"[object Error]\"===E(e)||e instanceof Error)}function S(e){return\"function\"==typeof e}function E(e){return Object.prototype.toString.call(e)}function C(e){return e<10?\"0\"+e.toString(10):e.toString(10)}function T(){var e=new Date,t=[C(e.getHours()),C(e.getMinutes()),C(e.getSeconds())].join(\":\");return[e.getDate(),A[e.getMonth()],t].join(\" \")}function k(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var I=/%[sdj%]/g;r.format=function(e){if(!m(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(\" \")}n=1;for(var r=arguments,o=r.length,s=String(e).replace(I,(function(e){if(\"%%\"===e)return\"%\";if(n>=o)return e;switch(e){case\"%s\":return String(r[n++]);case\"%d\":return Number(r[n++]);case\"%j\":try{return JSON.stringify(r[n++])}catch(e){return\"[Circular]\"}default:return e}})),a=r[n];n<o;a=r[++n])h(a)||!y(a)?s+=\" \"+a:s+=\" \"+i(a);return s},r.deprecate=function(e,i){if(g(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var _,x={};r.debuglog=function(e){if(g(_)&&(_=t.env.NODE_DEBUG||\"\"),e=e.toUpperCase(),!x[e])if(new RegExp(\"\\\\b\"+e+\"\\\\b\",\"i\").test(_)){var n=t.pid;x[e]=function(){var t=r.format.apply(r,arguments);console.error(\"%s %d: %s\",e,n,t)}}else x[e]=function(){};return x[e]},r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:\"cyan\",number:\"yellow\",boolean:\"yellow\",undefined:\"grey\",null:\"bold\",string:\"green\",date:\"magenta\",regexp:\"red\"},r.isArray=p,r.isBoolean=d,r.isNull=h,r.isNullOrUndefined=function(e){return null==e},r.isNumber=f,r.isString=m,r.isSymbol=function(e){return\"symbol\"==typeof e},r.isUndefined=g,r.isRegExp=v,r.isObject=y,r.isDate=b,r.isError=w,r.isFunction=S,r.isPrimitive=function(e){return null===e||\"boolean\"==typeof e||\"number\"==typeof e||\"string\"==typeof e||\"symbol\"==typeof e||void 0===e},r.isBuffer=e(\"./support/isBuffer\");var A=[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];r.log=function(){console.log(\"%s - %s\",T(),r.format.apply(r,arguments))},r.inherits=e(\"inherits\"),r._extend=function(e,t){if(!t||!y(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this)}).call(this,e(\"_process\"),void 0!==n.g?n.g:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./support/isBuffer\":98,_process:87,inherits:97}],100:[function(e,t,n){var r=e(\"./v1\"),i=e(\"./v4\"),o=i;o.v1=r,o.v4=i,t.exports=o},{\"./v1\":103,\"./v4\":104}],101:[function(e,t,n){for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var n=t||0,i=r;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],\"-\",i[e[n++]],i[e[n++]],\"-\",i[e[n++]],i[e[n++]],\"-\",i[e[n++]],i[e[n++]],\"-\",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join(\"\")}},{}],102:[function(e,t,n){var r=\"undefined\"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||\"undefined\"!=typeof msCrypto&&\"function\"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var i=new Uint8Array(16);t.exports=function(){return r(i),i}}else{var o=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},{}],103:[function(e,t,n){var r,i,o=e(\"./lib/rng\"),s=e(\"./lib/bytesToUuid\"),a=0,c=0;t.exports=function(e,t,n){var u=t&&n||0,l=t||[],p=(e=e||{}).node||r,d=void 0!==e.clockseq?e.clockseq:i;if(null==p||null==d){var h=o();null==p&&(p=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==d&&(d=i=16383&(h[6]<<8|h[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,g=f-a+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(d=d+1&16383),(g<0||f>a)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");a=f,c=m,i=d;var v=(1e4*(268435455&(f+=122192928e5))+m)%4294967296;l[u++]=v>>>24&255,l[u++]=v>>>16&255,l[u++]=v>>>8&255,l[u++]=255&v;var y=f/4294967296*1e4&268435455;l[u++]=y>>>8&255,l[u++]=255&y,l[u++]=y>>>24&15|16,l[u++]=y>>>16&255,l[u++]=d>>>8|128,l[u++]=255&d;for(var b=0;b<6;++b)l[u+b]=p[b];return t||s(l)}},{\"./lib/bytesToUuid\":101,\"./lib/rng\":102}],104:[function(e,t,n){var r=e(\"./lib/rng\"),i=e(\"./lib/bytesToUuid\");t.exports=function(e,t,n){var o=t&&n||0;\"string\"==typeof e&&(t=\"binary\"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},{\"./lib/bytesToUuid\":101,\"./lib/rng\":102}],105:[function(e,t,n){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0});var r=e(\"./utils/LRU\"),i=function(){function e(e){void 0===e&&(e=1e3),this.maxSize=e,this.cache=new r.LRUCache(e)}return Object.defineProperty(e.prototype,\"size\",{get:function(){return this.cache.length},enumerable:!0,configurable:!0}),e.prototype.put=function(t,n){var r=\"string\"!=typeof t?e.getKeyString(t):t,i=this.populateValue(n);this.cache.put(r,i)},e.prototype.get=function(t){var n=\"string\"!=typeof t?e.getKeyString(t):t,r=Date.now(),i=this.cache.get(n);if(i)for(var o=0;o<i.length;o++)if(i[o].Expire<r)return void this.cache.remove(n);return i},e.getKeyString=function(e){for(var t=[],n=Object.keys(e).sort(),r=0;r<n.length;r++){var i=n[r];void 0!==e[i]&&t.push(e[i])}return t.join(\" \")},e.prototype.populateValue=function(e){var t=Date.now();return e.map((function(e){return{Address:e.Address||\"\",Expire:t+60*(e.CachePeriodInMinutes||1)*1e3}}))},e.prototype.empty=function(){this.cache.empty()},e.prototype.remove=function(t){var n=\"string\"!=typeof t?e.getKeyString(t):t;this.cache.remove(n)},e}();n.EndpointCache=i},{\"./utils/LRU\":106}],106:[function(e,t,n){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0});var r=function(e,t){this.key=e,this.value=t},i=function(){function e(e){if(this.nodeMap={},this.size=0,\"number\"!=typeof e||e<1)throw new Error(\"Cache size can only be positive number\");this.sizeLimit=e}return Object.defineProperty(e.prototype,\"length\",{get:function(){return this.size},enumerable:!0,configurable:!0}),e.prototype.prependToList=function(e){this.headerNode?(this.headerNode.prev=e,e.next=this.headerNode):this.tailNode=e,this.headerNode=e,this.size++},e.prototype.removeFromTail=function(){if(this.tailNode){var e=this.tailNode,t=e.prev;return t&&(t.next=void 0),e.prev=void 0,this.tailNode=t,this.size--,e}},e.prototype.detachFromList=function(e){this.headerNode===e&&(this.headerNode=e.next),this.tailNode===e&&(this.tailNode=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.next=void 0,e.prev=void 0,this.size--},e.prototype.get=function(e){if(this.nodeMap[e]){var t=this.nodeMap[e];return this.detachFromList(t),this.prependToList(t),t.value}},e.prototype.remove=function(e){if(this.nodeMap[e]){var t=this.nodeMap[e];this.detachFromList(t),delete this.nodeMap[e]}},e.prototype.put=function(e,t){if(this.nodeMap[e])this.remove(e);else if(this.size===this.sizeLimit){var n=this.removeFromTail().key;delete this.nodeMap[n]}var i=new r(e,t);this.nodeMap[e]=i,this.prependToList(i)},e.prototype.empty=function(){for(var e=Object.keys(this.nodeMap),t=0;t<e.length;t++){var n=e[t],r=this.nodeMap[n];this.detachFromList(r),delete this.nodeMap[n]}},e}();n.LRUCache=i},{}],107:[function(e,t,n){e(\"./browser_loader\");var r=e(\"./core\");\"undefined\"!=typeof window&&(window.AWS=r),void 0!==t&&(t.exports=r),\"undefined\"!=typeof self&&(self.AWS=r),Object.prototype.hasOwnProperty.call(r,\"ConnectParticipant\")||(r.apiLoader.services.connectparticipant={},r.ConnectParticipant=r.Service.defineService(\"connectparticipant\",[\"2018-09-07\"])),r.apiLoader.services.connectparticipant[\"2018-09-07\"]=e(\"../apis/connectparticipant-2018-09-07.min\"),r.apiLoader.services.connectparticipant[\"2018-09-07\"].paginators=e(\"../apis/connectparticipant-2018-09-07.paginators\").pagination,Object.prototype.hasOwnProperty.call(r,\"STS\")||(r.apiLoader.services.sts={},r.STS=r.Service.defineService(\"sts\",[\"2011-06-15\"]),e(\"./services/sts\"))},{\"../apis/connectparticipant-2018-09-07.min\":3,\"../apis/connectparticipant-2018-09-07.paginators\":4,\"../apis/sts-2011-06-15.min\":6,\"./browser_loader\":17,\"./core\":20,\"./services/sts\":63}]},{},[107])},975:(e,t,n)=>{var r;!function(){\"use strict\";var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\\x25]+/,modulo:/^\\x25{2}/,placeholder:/^\\x25(?:([1-9]\\d*)\\$|\\(([^)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\\d]*)/i,key_access:/^\\.([a-z_][a-z_\\d]*)/i,index_access:/^\\[(\\d+)\\]/,sign:/^[+-]/};function o(e){return a(u(e),arguments)}function s(e,t){return o.apply(null,[e].concat(t||[]))}function a(e,t){var n,r,s,a,c,u,l,p,d,h=1,f=e.length,m=\"\";for(r=0;r<f;r++)if(\"string\"==typeof e[r])m+=e[r];else if(\"object\"==typeof e[r]){if((a=e[r]).keys)for(n=t[h],s=0;s<a.keys.length;s++){if(null==n)throw new Error(o('[sprintf] Cannot access property \"%s\" of undefined value \"%s\"',a.keys[s],a.keys[s-1]));n=n[a.keys[s]]}else n=a.param_no?t[a.param_no]:t[h++];if(i.not_type.test(a.type)&&i.not_primitive.test(a.type)&&n instanceof Function&&(n=n()),i.numeric_arg.test(a.type)&&\"number\"!=typeof n&&isNaN(n))throw new TypeError(o(\"[sprintf] expecting number but found %T\",n));switch(i.number.test(a.type)&&(p=n>=0),a.type){case\"b\":n=parseInt(n,10).toString(2);break;case\"c\":n=String.fromCharCode(parseInt(n,10));break;case\"d\":case\"i\":n=parseInt(n,10);break;case\"j\":n=JSON.stringify(n,null,a.width?parseInt(a.width):0);break;case\"e\":n=a.precision?parseFloat(n).toExponential(a.precision):parseFloat(n).toExponential();break;case\"f\":n=a.precision?parseFloat(n).toFixed(a.precision):parseFloat(n);break;case\"g\":n=a.precision?String(Number(n.toPrecision(a.precision))):parseFloat(n);break;case\"o\":n=(parseInt(n,10)>>>0).toString(8);break;case\"s\":n=String(n),n=a.precision?n.substring(0,a.precision):n;break;case\"t\":n=String(!!n),n=a.precision?n.substring(0,a.precision):n;break;case\"T\":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=a.precision?n.substring(0,a.precision):n;break;case\"u\":n=parseInt(n,10)>>>0;break;case\"v\":n=n.valueOf(),n=a.precision?n.substring(0,a.precision):n;break;case\"x\":n=(parseInt(n,10)>>>0).toString(16);break;case\"X\":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}i.json.test(a.type)?m+=n:(!i.number.test(a.type)||p&&!a.sign?d=\"\":(d=p?\"+\":\"-\",n=n.toString().replace(i.sign,\"\")),u=a.pad_char?\"0\"===a.pad_char?\"0\":a.pad_char.charAt(1):\" \",l=a.width-(d+n).length,c=a.width&&l>0?u.repeat(l):\"\",m+=a.align?d+n+c:\"0\"===u?d+c+n:c+d+n)}return m}var c=Object.create(null);function u(e){if(c[e])return c[e];for(var t,n=e,r=[],o=0;n;){if(null!==(t=i.text.exec(n)))r.push(t[0]);else if(null!==(t=i.modulo.exec(n)))r.push(\"%\");else{if(null===(t=i.placeholder.exec(n)))throw new SyntaxError(\"[sprintf] unexpected placeholder\");if(t[2]){o|=1;var s=[],a=t[2],u=[];if(null===(u=i.key.exec(a)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");for(s.push(u[1]);\"\"!==(a=a.substring(u[0].length));)if(null!==(u=i.key_access.exec(a)))s.push(u[1]);else{if(null===(u=i.index_access.exec(a)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");s.push(u[1])}t[2]=s}else o|=2;if(3===o)throw new Error(\"[sprintf] mixing positional and named placeholders is not (yet) supported\");r.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return c[e]=r}t.sprintf=o,t.vsprintf=s,\"undefined\"!=typeof window&&(window.sprintf=o,window.vsprintf=s,void 0===(r=function(){return{sprintf:o,vsprintf:s}}.call(t,n,t,e))||(e.exports=r))}()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.amdO={},n.g=function(){if(\"object\"==typeof globalThis)return globalThis;try{return this||new Function(\"return this\")()}catch(e){if(\"object\"==typeof window)return window}}(),(()=>{\"use strict\";class e extends Error{constructor(e){super(e),this.name=\"ValueError\"}}class t extends Error{constructor(e){super(e),this.name=\"UnImplementedMethod\"}}class r extends Error{constructor(e,t){super(e),this.name=\"IllegalArgument\",this.argument=t}}Error,Error;var i=new class{update(e){var t=e||{};this.stage=t.stage||this.stage||\"prod\",this.region=t.region||this.region||\"us-west-2\",this.endpointOverride=t.endpoint||this.endpointOverride,this.reconnect=!1!==t.reconnect}getRegion(){return this.region}getEndpointOverride(){return this.endpointOverride}updateStageRegion(e){e&&(this.stage=e.stage||this.stage,this.region=e.region||this.region)}getStage(){return this.stage}},o={AGENT:\"AGENT\",CUSTOMER:\"CUSTOMER\"},s=\"API\",a=\"SendMessage\",c=\"SendAttachment\",u=\"DownloadAttachment\",l=\"SendEvent\",p=\"GetTranscript\",d=\"DisconnectParticipant\",h=\"CreateParticipantConnection\",f=\"InitWebsocket\",m=\"INCOMING_MESSAGE\",g=\"INCOMING_TYPING\",v=\"CONNECTION_ESTABLISHED\",y=\"CONNECTION_BROKEN\",b=\"CHAT_ENDED\",w={textPlain:\"text/plain\",textMarkdown:\"text/markdown\",textCsv:\"text/csv\",applicationDoc:\"application/msword\",applicationDocx:\"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",applicationPdf:\"application/pdf\",applicationPpt:\"application/vnd.ms-powerpoint\",applicationPptx:\"application/vnd.openxmlformats-officedocument.presentationml.presentation\",applicationXls:\"application/vnd.ms-excel\",applicationXlsx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",imageJpg:\"image/jpeg\",imagePng:\"image/png\",audioWav:\"audio/wav\",audioXWav:\"audio/x-wav\",audioVndWave:\"audio/vnd.wave\",connectionAcknowledged:\"application/vnd.amazonaws.connect.event.connection.acknowledged\",typing:\"application/vnd.amazonaws.connect.event.typing\",participantJoined:\"application/vnd.amazonaws.connect.event.participant.joined\",participantLeft:\"application/vnd.amazonaws.connect.event.participant.left\",participantActive:\"application/vnd.amazonaws.connect.event.participant.active\",participantInactive:\"application/vnd.amazonaws.connect.event.participant.inactive\",transferSucceeded:\"application/vnd.amazonaws.connect.event.transfer.succeeded\",transferFailed:\"application/vnd.amazonaws.connect.event.transfer.failed\",chatEnded:\"application/vnd.amazonaws.connect.event.chat.ended\",interactiveMessage:\"application/vnd.amazonaws.connect.message.interactive\"},S=3540,E=n(975),C={assertTrue:function(t,n){if(!t)throw new e(n)},assertNotNull:function(e,t){return C.assertTrue(null!==e&&void 0!==typeof e,(0,E.sprintf)(\"%s must be provided\",t||\"A value\")),e},now:function(){return(new Date).getTime()},isString:function(e){return\"string\"==typeof e},randomId:function(){return(0,E.sprintf)(\"%s-%s\",C.now(),Math.random().toString(36).slice(2))},assertIsNonEmptyString:function(e,t){if(!e||\"string\"!=typeof e)throw new r(t+\" is not a non-empty string!\")},assertIsList:function(e,t){if(!Array.isArray(e))throw new r(t+\" is not an array\")},assertIsEnum:function(e,t,n){var i;for(i=0;i<t.length;i++)if(t[i]===e)return;throw new r(n+\" passed (\"+e+\") is not valid. Allowed values are: \"+t)},makeEnum:function(e){var t={};return e.forEach((function(e){var n=e.replace(/\\.?([a-z]+)_?/g,(function(e,t){return t.toUpperCase()+\"_\"})).replace(/_$/,\"\");t[n]=e})),t},contains:function(e,t){return e instanceof Array?null!==C.find(e,(function(e){return e===t})):t in e},find:function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n];return null},containsValue:function(e,t){return e instanceof Array?null!==C.find(e,(function(e){return e===t})):null!==C.find(C.values(e),(function(e){return e===t}))},isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},values:function(e){var t=[];for(var n in C.assertNotNull(e,\"map\"),e)t.push(e[n]);return t},isObject:function(e){return!(\"object\"!=typeof e||null===e)},assertIsObject:function(e,t){if(!C.isObject(e))throw new r(t+\" is not an object!\")},delay:e=>new Promise((t=>setTimeout(t,e))),asyncWhileInterval:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=new Date;return t(r)?e(r).catch((i=>{var s=Math.max(0,n-(new Date).valueOf()+o.valueOf());return C.delay(s).then((()=>C.asyncWhileInterval(e,t,n,r+1,i)))})):Promise.reject(i||new Error(\"async while aborted\"))},isAttachmentContentType:function(e){return e===w.applicationPdf||e===w.imageJpg||e===w.imagePng||e===w.applicationDoc||e===w.applicationXls||e===w.applicationPpt||e===w.textCsv||e===w.audioWav}};const T=C;var k={DEBUG:10,INFO:20,WARN:30,ERROR:40,ADVANCED_LOG:50},I=new class{constructor(){this.updateLoggerConfig()}writeToClientLogger(e,t,n){if(this.hasClientLogger()){var r=function(e){switch(e){case 10:return\"DEBUG\";case 20:return\"INFO\";case 30:return\"WARN\";case 40:return\"ERROR\";case 50:return\"ADVANCED_LOG\"}}(e);switch(e){case k.DEBUG:return this._clientLogger.debug(r,t,n)||t;case k.INFO:return this._clientLogger.info(r,t,n)||t;case k.WARN:return this._clientLogger.warn(r,t,n)||t;case k.ERROR:return this._clientLogger.error(r,t,n)||t;case k.ADVANCED_LOG:return this._advancedLogWriter&&this._clientLogger[this._advancedLogWriter]&&this._clientLogger[this._advancedLogWriter](r,t,n)||t}}}isLevelEnabled(e){return e>=this._level}hasClientLogger(){return null!==this._clientLogger}getLogger(){return new x(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}updateLoggerConfig(e){var t=e||{};this._level=t.level||k.INFO,this._advancedLogWriter=\"warn\",function(e,t){var n=t&&Object.keys(t);if(n&&-1===n.indexOf(e))return console.error(\"customizedLogger: incorrect value for loggerConfig:advancedLogWriter; use valid values from list \".concat(n,\" but used \").concat(e)),!1;var r=[\"warn\",\"info\",\"debug\",\"log\"];return!e||-1!==r.indexOf(e)||(console.error(\"incorrect value for loggerConfig:advancedLogWriter; use valid values from list \".concat(r,\" but used \").concat(e)),!1)}(t.advancedLogWriter,t.customizedLogger)&&(this._advancedLogWriter=t.advancedLogWriter),t.customizedLogger&&\"object\"==typeof t.customizedLogger&&(this.useClientLogger=!0),this._clientLogger=this.selectLogger(t)}selectLogger(e){return e.customizedLogger&&\"object\"==typeof e.customizedLogger?e.customizedLogger:e.useDefaultLogger?A():null}};class _{debug(){}info(){}warn(){}error(){}}class x extends _{constructor(e){super(),this.options=e||{}}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(k.DEBUG,t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(k.INFO,t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(k.WARN,t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(k.ERROR,t)}advancedLog(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(k.ADVANCED_LOG,t)}_shouldLog(e){return I.hasClientLogger()&&I.isLevelEnabled(e)}_writeToClientLogger(e,t){return I.writeToClientLogger(e,t,this.options.logMetaData)}_log(e,t){if(this._shouldLog(e)){var n=I.useClientLogger?t:this._convertToSingleStatement(t);return this._writeToClientLogger(e,n)}}_convertToSingleStatement(e){var t=new Date(Date.now()).toISOString(),n=\"[\".concat(t,\"]\");this.options&&(this.options.prefix?n+=\" \"+this.options.prefix+\":\":n+=\"\");for(var r=0;r<e.length;r++){var i=e[r];n+=\" \"+this._convertToString(i)}return n}_convertToString(e){try{if(!e)return\"\";if(T.isString(e))return e;if(T.isObject(e)&&T.isFunction(e.toString)){var t=e.toString();if(\"[object Object]\"!==t)return t}return JSON.stringify(e)}catch(t){return console.error(\"Error while converting argument to string\",e,t),\"\"}}}var A=()=>{var e=new _;return e.debug=console.debug.bind(window.console),e.info=console.info.bind(window.console),e.warn=console.warn.bind(window.console),e.error=console.error.bind(window.console),e};function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(228);class N extends class{sendMessage(e,n,r){throw new t(\"sendTextMessage in ChatClient\")}sendAttachment(e,n,r){throw new t(\"sendAttachment in ChatClient\")}downloadAttachment(e,n){throw new t(\"downloadAttachment in ChatClient\")}disconnectParticipant(e){throw new t(\"disconnectParticipant in ChatClient\")}sendEvent(e,n,r){throw new t(\"sendEvent in ChatClient\")}createParticipantConnection(e,n){throw new t(\"createParticipantConnection in ChatClient\")}}{constructor(e){super();var t=new AWS.Credentials(\"\",\"\"),n=new AWS.Config({region:e.region,endpoint:e.endpoint,credentials:t});this.chatClient=new AWS.ConnectParticipant(n),this.invokeUrl=e.endpoint,this.logger=I.getLogger({prefix:\"Amazon-Connect-ChatJS-ChatClient\",logMetaData:e.logMetaData})}createParticipantConnection(e,t){var n=this,r={Type:t,ParticipantToken:e},i=n.chatClient.createParticipantConnection(r);return n._sendRequest(i).then((e=>{var t,r;return null===(t=n.logger.info(\"Successfully create connection request\"))||void 0===t||null===(r=t.sendInternalLogToServer)||void 0===r||r.call(t),e})).catch((e=>{var t,r;return null===(t=n.logger.error(\"Error when creating connection request \",e))||void 0===t||null===(r=t.sendInternalLogToServer)||void 0===r||r.call(t),Promise.reject(e)}))}disconnectParticipant(e){var t=this,n={ConnectionToken:e},r=t.chatClient.disconnectParticipant(n);return t._sendRequest(r).then((e=>{var n,r;return null===(n=t.logger.info(\"Successfully disconnect participant\"))||void 0===n||null===(r=n.sendInternalLogToServer)||void 0===r||r.call(n),e})).catch((e=>{var n,r;return null===(n=t.logger.error(\"Error when disconnecting participant \",e))||void 0===n||null===(r=n.sendInternalLogToServer)||void 0===r||r.call(n),Promise.reject(e)}))}getTranscript(e,t){var n={MaxResults:t.maxResults,NextToken:t.nextToken,ScanDirection:t.scanDirection,SortOrder:t.sortOrder,StartPosition:{Id:t.startPosition.id,AbsoluteTime:t.startPosition.absoluteTime,MostRecent:t.startPosition.mostRecent},ConnectionToken:e};t.contactId&&(n.ContactId=t.contactId);var r=this.chatClient.getTranscript(n);return this._sendRequest(r).then((e=>(this.logger.info(\"Successfully get transcript\"),e))).catch((e=>(this.logger.error(\"Get transcript error\",e),Promise.reject(e))))}sendMessage(e,t,n){var r={Content:t,ContentType:n,ConnectionToken:e},i=this.chatClient.sendMessage(r);return this._sendRequest(i).then((e=>{var t,n={id:null===(t=e.data)||void 0===t?void 0:t.Id,contentType:r.ContentType};return this.logger.debug(\"Successfully send message\",n),e})).catch((e=>(this.logger.error(\"Send message error\",e,{contentType:r.ContentType}),Promise.reject(e))))}sendAttachment(e,t,n){var r=this,i={ContentType:t.type,AttachmentName:t.name,AttachmentSizeInBytes:t.size,ConnectionToken:e},o=r.chatClient.startAttachmentUpload(i),s={contentType:t.type,size:t.size};return r._sendRequest(o).then((n=>r._uploadToS3(t,n.data.UploadMetadata).then((()=>{var t,i={AttachmentIds:[n.data.AttachmentId],ConnectionToken:e};this.logger.debug(\"Successfully upload attachment\",L(L({},s),{},{attachmentId:null===(t=n.data)||void 0===t?void 0:t.AttachmentId}));var o=r.chatClient.completeAttachmentUpload(i);return r._sendRequest(o)})))).catch((e=>(this.logger.error(\"Upload attachment error\",e,s),Promise.reject(e))))}_uploadToS3(e,t){return fetch(t.Url,{method:\"PUT\",headers:t.HeadersToInclude,body:e})}downloadAttachment(e,t){var n=this,r={AttachmentId:t,ConnectionToken:e},i={attachmentId:t},o=n.chatClient.getAttachment(r);return n._sendRequest(o).then((e=>(this.logger.debug(\"Successfully download attachment\",i),n._downloadUrl(e.data.Url)))).catch((e=>(this.logger.error(\"Download attachment error\",e,i),Promise.reject(e))))}_downloadUrl(e){return fetch(e).then((e=>e.blob())).catch((e=>Promise.reject(e)))}sendEvent(e,t,n){var r={ConnectionToken:e,ContentType:t,Content:n},i=this.chatClient.sendEvent(r),o={contentType:t};return this._sendRequest(i).then((e=>{var t;return this.logger.debug(\"Successfully send event\",L(L({},o),{},{id:null===(t=e.data)||void 0===t?void 0:t.Id})),e})).catch((e=>(this.logger.error(\"Send event error\",e,o),Promise.reject(e))))}_sendRequest(e){return new Promise(((t,n)=>{e.on(\"success\",(function(e){t(e)})).on(\"error\",(function(e){var t={type:e.code,message:e.message,stack:e.stack?e.stack.split(\"\\n\"):[]};n(t)})).send()}))}}var M=new class{constructor(){this.clientCache={}}getCachedClient(e,t){var n=Object.assign({},e),r=e.region||i.getRegion()||\"us-west-2\";if(n.region=r,t.region=r,this.clientCache[r])return this.clientCache[r];var o=this._createAwsClient(n,t);return this.clientCache[r]=o,o}_createAwsClient(e,t){var n=e.region,r=i.getEndpointOverride(),o=\"https://participant.connect.\".concat(n,\".amazonaws.com\");return r&&(o=r),new N({endpoint:o,region:n,logMetaData:t})}};class P extends class{validateNewControllerDetails(e){return!0}validateSendMessage(e){if(!T.isString(e.message))throw new r(e.message+\"is not a valid message\");this.validateContentType(e.contentType)}validateContentType(e){T.assertIsEnum(e,Object.values(w),\"contentType\")}validateConnectChat(e){return!0}validateLogger(e){T.assertIsObject(e,\"logger\"),[\"debug\",\"info\",\"warn\",\"error\"].forEach((t=>{if(!T.isFunction(e[t]))throw new r(t+\" should be a valid function on the passed logger object!\")}))}validateSendEvent(e){this.validateContentType(e.contentType)}validateGetMessages(e){return!0}}{validateChatDetails(e,t){if(T.assertIsObject(e,\"chatDetails\"),t===o.AGENT&&!T.isFunction(e.getConnectionToken))throw new r(\"getConnectionToken was not a function\",e.getConnectionToken);if(T.assertIsNonEmptyString(e.contactId,\"chatDetails.contactId\"),T.assertIsNonEmptyString(e.participantId,\"chatDetails.participantId\"),t===o.CUSTOMER){if(!e.participantToken)throw new r(\"participantToken was not provided for a customer session type\",e.participantToken);T.assertIsNonEmptyString(e.participantToken,\"chatDetails.participantToken\")}}validateInitiateChatResponse(){return!0}normalizeChatDetails(e){var t={};return t.contactId=e.ContactId||e.contactId,t.participantId=e.ParticipantId||e.participantId,t.initialContactId=e.InitialContactId||e.initialContactId||t.contactId||t.ContactId,t.getConnectionToken=e.getConnectionToken||e.GetConnectionToken,(e.participantToken||e.ParticipantToken)&&(t.participantToken=e.ParticipantToken||e.participantToken),this.validateChatDetails(t),t}}var D=\"NeverStarted\",U=\"Starting\",q=\"Connected\",j=\"ConnectionLost\",W=\"Ended\",F=\"ConnectionLost\",B=\"ConnectionGained\",z=\"Ended\",H=\"IncomingMessage\",V=\"<<all>>\",G=function(e,t,n){this.subMap=e,this.id=T.randomId(),this.eventName=t,this.f=n};G.prototype.unsubscribe=function(){this.subMap.unsubscribe(this.eventName,this.id)};var K=function(){this.subIdMap={},this.subEventNameMap={}};K.prototype.subscribe=function(e,t){var n=new G(this,e,t);this.subIdMap[n.id]=n;var r=this.subEventNameMap[e]||[];return r.push(n),this.subEventNameMap[e]=r,()=>n.unsubscribe()},K.prototype.unsubscribe=function(e,t){T.contains(this.subEventNameMap,e)&&(this.subEventNameMap[e]=this.subEventNameMap[e].filter((function(e){return e.id!==t})),this.subEventNameMap[e].length<1&&delete this.subEventNameMap[e]),T.contains(this.subIdMap,t)&&delete this.subIdMap[t]},K.prototype.getAllSubscriptions=function(){return T.values(this.subEventNameMap).reduce((function(e,t){return e.concat(t)}),[])},K.prototype.getSubscriptions=function(e){return this.subEventNameMap[e]||[]};var X=function(e){var t=e||{};this.subMap=new K,this.logEvents=t.logEvents||!1};X.prototype.subscribe=function(e,t){return T.assertNotNull(e,\"eventName\"),T.assertNotNull(t,\"f\"),T.assertTrue(T.isFunction(t),\"f must be a function\"),this.subMap.subscribe(e,t)},X.prototype.subscribeAll=function(e){return T.assertNotNull(e,\"f\"),T.assertTrue(T.isFunction(e),\"f must be a function\"),this.subMap.subscribe(V,e)},X.prototype.getSubscriptions=function(e){return this.subMap.getSubscriptions(e)},X.prototype.trigger=function(e,t){T.assertNotNull(e,\"eventName\");var n=this,r=this.subMap.getSubscriptions(V),i=this.subMap.getSubscriptions(e);r.concat(i).forEach((function(r){try{r.f(t||null,e,n)}catch(e){}}))},X.prototype.triggerAsync=function(e,t){setTimeout((()=>this.trigger(e,t)),0)},X.prototype.bridge=function(){var e=this;return function(t,n){e.trigger(n,t)}},X.prototype.unsubscribeAll=function(){this.subMap.getAllSubscriptions().forEach((function(e){e.unsubscribe()}))};var J=\"Category\",Y=new class{constructor(){this.widgetType=\"CustomChatWidget\",this.logger=I.getLogger({prefix:\"ChatJS-csmService\"}),this.csmInitialized=!1,this.metricsToBePublished=[],this.loadCsmScriptAndExecute()}loadCsmScriptAndExecute(){try{var e=document.createElement(\"script\");e.type=\"text/javascript\",e.innerHTML=\"(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  csm.EVENT_TYPE = {\\n    LOG: 'LOG',\\n    METRIC: 'METRIC',\\n    CONFIG: 'CONFIG',\\n    WORKFLOW_EVENT: 'WORKFLOW_EVENT',\\n    CUSTOM: 'CUSTOM',\\n    CLOSE: 'CLOSE',\\n    SET_AUTH: 'SET_AUTH',\\n    SET_CONFIG: 'SET_CONFIG',\\n  };\\n\\n  csm.UNIT = {\\n    COUNT: 'Count',\\n    SECONDS: 'Seconds',\\n    MILLISECONDS: 'Milliseconds',\\n    MICROSECONDS: 'Microseconds',\\n  };\\n})();\\n\\n(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  const MAX_METRIC_DIMENSIONS = 10;\\n\\n  /** ********* Dimension Classes ***********/\\n\\n  const Dimension = function(name, value) {\\n    csm.Util.assertExist(name, 'name');\\n    csm.Util.assertExist(value, 'value');\\n\\n    this.name = name;\\n    this.value = value == null ? 'null' : (value === '' ? ' ' : value.toString());\\n  };\\n\\n\\n  /** ********* Metric Classes ***********/\\n\\n  const Metric = function(metricName, unit, value, dedupeOptions) {\\n    csm.Util.assertExist(metricName, 'metricName');\\n    csm.Util.assertExist(value, 'value');\\n    csm.Util.assertExist(unit, 'unit');\\n    csm.Util.assertTrue(csm.Util.isValidUnit(unit));\\n    if (dedupeOptions) {\\n      csm.Util.assertInObject(dedupeOptions, 'dedupeOptions', 'dedupeIntervalMs');\\n    }\\n\\n    this.metricName = metricName;\\n    this.unit = unit;\\n    this.value = value;\\n    this.timestamp = new Date();\\n    this.dimensions = csm.globalDimensions ? csm.Util.deepCopy(csm.globalDimensions): [];\\n    this.namespace = csm.configuration.namespace;\\n    this.dedupeOptions = dedupeOptions; // optional. { dedupeIntervalMs: (int; required), context: (string; optional) }\\n\\n    // Currently, CloudWatch can't aggregate metrics by a subset of dimensions.\\n    // To bypass this limitation, we introduce the optional dimensions concept to CSM.\\n    // The CSM metric publisher will publish a default metric without optional dimension\\n    // For each optional dimension, the CSM metric publisher publishes an extra metric with that dimension.\\n    this.optionalDimensions = csm.globalOptionalDimensions ? csm.Util.deepCopy(csm.globalOptionalDimensions): [];\\n  };\\n\\n  Metric.prototype.addDimension = function(name, value) {\\n    this._addDimensionHelper(this.dimensions, name, value);\\n  };\\n\\n  Metric.prototype.addOptionalDimension = function(name, value) {\\n    this._addDimensionHelper(this.optionalDimensions, name, value);\\n  };\\n\\n  Metric.prototype._addDimensionHelper = function(targetDimensions, name, value) {\\n    // CloudWatch metric allows maximum 10 dimensions\\n    // http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/CloudWatch.html#putMetricData-property\\n    if ((this.dimensions.length + this.optionalDimensions.length) >= MAX_METRIC_DIMENSIONS) {\\n      throw new csm.ExceedDimensionLimitException(name);\\n    }\\n\\n    const existing = targetDimensions.find(function(dimension) {\\n      return dimension.name === name;\\n    });\\n\\n    if (existing) {\\n      existing.value = value == null ? 'null' : (value === '' ? ' ' : value.toString());\\n    } else {\\n      targetDimensions.push(new Dimension(name, value));\\n    }\\n  };\\n\\n\\n  /** ********* Telemetry Classes ***********/\\n\\n  const WorkflowEvent = function(params) {\\n    this.timestamp = params.timestamp || new Date().getTime();\\n    this.workflowType = params.workflow.type;\\n    this.instanceId = params.workflow.instanceId;\\n    this.userId = params.userId;\\n    this.organizationId = params.organizationId;\\n    this.accountId = params.accountId;\\n    this.event = params.event;\\n    this.appName = params.appName;\\n    this.data = [];\\n\\n    // Convert 'data' map into the KeyValuePairList structure expected by the Lambda API\\n    for (const key in params.data) {\\n      if (Object.prototype.hasOwnProperty.call(params.data, key)) {\\n        this.data.push({'key': key, 'value': params.data[key]});\\n      }\\n    }\\n  };\\n\\n  /** ********* Exceptions ***********/\\n\\n  const NullOrUndefinedException = function(paramName) {\\n    this.name = 'NullOrUndefinedException';\\n    this.message = paramName + ' is null or undefined. ';\\n  };\\n  NullOrUndefinedException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const AssertTrueException = function() {\\n    this.name = 'AssertTrueException';\\n    this.message = 'Assertion failed. ';\\n  };\\n  AssertTrueException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const ExceedDimensionLimitException = function(dimensionName) {\\n    this.name = 'ExceedDimensionLimitException';\\n    this.message = 'Could not add dimension \\\\'' + dimensionName + '\\\\'. Metric has maximum 10 dimensions. ';\\n  };\\n  ExceedDimensionLimitException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const InitializationException = function() {\\n    this.name = 'InitializationException';\\n    this.message = 'Initialization failed. ';\\n  };\\n  InitializationException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n\\n  csm.Dimension = Dimension;\\n  csm.Metric = Metric;\\n  csm.WorkflowEvent = WorkflowEvent;\\n  csm.NullOrUndefinedException = NullOrUndefinedException;\\n  csm.AssertTrueException = AssertTrueException;\\n  csm.InitializationException = InitializationException;\\n  csm.ExceedDimensionLimitException = ExceedDimensionLimitException;\\n})();\\n\\n(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  const validTimeUnits = [csm.UNIT.SECONDS, csm.UNIT.MILLISECONDS, csm.UNIT.MICROSECONDS];\\n  const validUnits = validTimeUnits.concat(csm.UNIT.COUNT);\\n\\n  const Util = {\\n    assertExist: function(value, paramName) {\\n      if (value === null || value === undefined) {\\n        throw new csm.NullOrUndefinedException(paramName);\\n      }\\n    },\\n    assertTrue: function(value) {\\n      if (!value) {\\n        throw new csm.AssertTrueException();\\n      }\\n    },\\n    assertInObject: function(obj, objName, key) {\\n      if (obj === null || obj === undefined || typeof obj !== 'object') {\\n        throw new csm.NullOrUndefinedException(objName);\\n      }\\n      if (key === null || key === undefined || !obj[key]) {\\n        throw new csm.NullOrUndefinedException(`${objName}[${key}]`);\\n      }\\n    },\\n    isValidUnit: function(unit) {\\n      return validUnits.includes(unit);\\n    },\\n    isValidTimeUnit: function(unit) {\\n      return validTimeUnits.includes(unit);\\n    },\\n    isEmpty: function(value) {\\n      if (value !== null && typeof val === 'object') {\\n        return Objects.keys(value).length === 0;\\n      }\\n      return !value;\\n    },\\n    deepCopy: function(obj) {\\n      // NOTE: this will fail if obj has a circular reference\\n      return JSON.parse(JSON.stringify(obj));\\n    },\\n\\n    /**\\n     * This function is used before setting the page location for default metrics and logs,\\n     * and the APIs that set page location\\n     * Can be overridden by calling csm.API.setPageLocationTransformer(function(){})\\n     * @param {string}        pathname path for page location\\n     * @return {string}       pathname provided\\n     */\\n    pageLocationTransformer: function(pathname) {\\n      return pathname;\\n    },\\n\\n    /**\\n     * As of now, our service public claims only support for Firefox and Chrome\\n     * Reference https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent\\n     *\\n     * This function will only return firefox, chrome and others\\n     *\\n     * Best practice as indicated in MDN, \\\"Avoiding user agent detection\\\"\\n     */\\n    getBrowserDetails: function() {\\n      const userAgent = window.navigator.userAgent;\\n      const details = {};\\n      if (userAgent.includes('Firefox') && !userAgent.includes('Seamonkey')) {\\n        details.name = 'Firefox';\\n        details.version = getBrowserVersion('Firefox');\\n      } else if (userAgent.includes('Chrome') && !userAgent.includes('Chromium')) {\\n        details.name = 'Chrome';\\n        details.version = getBrowserVersion('Chrome');\\n      }\\n    },\\n\\n    randomId: function() {\\n      return new Date().getTime() + '-' + Math.random().toString(36).slice(2);\\n    },\\n\\n    getOrigin: function() {\\n      return document.location.origin;\\n    },\\n\\n    getReferrerUrl: function() {\\n      const referrer = document.referrer || '';\\n      return this.getURLOrigin(referrer);\\n    },\\n\\n    getWindowParent: function() {\\n      let parentLocation = '';\\n      try {\\n        parentLocation = window.parent.location.href;\\n      } catch (e) {\\n        parentLocation = '';\\n      }\\n      return parentLocation;\\n    },\\n\\n    getURLOrigin: function(urlValue) {\\n      let origin = '';\\n      const originArray = urlValue.split( '/' );\\n      if (originArray.length >= 3) {\\n        const protocol = originArray[0];\\n        const host = originArray[2];\\n        origin = protocol + '//' + host;\\n      }\\n      return origin;\\n    },\\n\\n  };\\n\\n  const getBrowserVersion = function(browserName) {\\n    const userAgent = window.navigator.userAgent;\\n    const browserNameIndex = userAgent.indexOf(browserName);\\n    const nextSpaceIndex = userAgent.indexOf(' ', browserNameIndex);\\n    if (nextSpaceIndex === -1) {\\n      return userAgent.substring(browserNameIndex + browserName.length + 1, userAgent.length);\\n    } else {\\n      return userAgent.substring(browserNameIndex + browserName.length + 1, nextSpaceIndex);\\n    }\\n  };\\n\\n  csm.Util = Util;\\n})();\\n\\n(function() {\\n  const global = window;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  csm.globalDimensions = []; // These dimensions are added to all captured metrics.\\n  csm.globalOptionalDimensions = [];\\n  csm.initFailureDimensions = [];\\n\\n  const API = {\\n    getWorkflow: function(workflowType, instanceId, data) {\\n      return csm.workflow(workflowType, instanceId, data);\\n    },\\n\\n    addMetric: function(metric) {\\n      csm.Util.assertExist(metric, 'metric');\\n      csm.putMetric(metric);\\n    },\\n\\n    addMetricWithDedupe: function(metric, dedupeIntervalMs, context) {\\n      csm.Util.assertExist(metric, 'metric');\\n      csm.Util.assertExist(metric, 'dedupeIntervalMs');\\n      // context is optional; if present it will only dedupe on metrics with the same context. ex.) tabId\\n      metric.dedupeOptions = {dedupeIntervalMs, context: context || 'global'};\\n      csm.putMetric(metric);\\n    },\\n\\n    addCount: function(metricName, count) {\\n      csm.Util.assertExist(metricName, 'metricName');\\n      csm.Util.assertExist(count, 'count');\\n\\n      const metric = new csm.Metric(metricName, csm.UNIT.COUNT, count);\\n      csm.putMetric(metric);\\n    },\\n\\n    addCountWithPageLocation: function(metricName) {\\n      csm.Util.assertExist(metricName, 'metricName');\\n\\n      const metric = new csm.Metric(metricName, csm.UNIT.COUNT, 1.0);\\n      metric.addDimension('WindowLocation', csm.Util.pageLocationTransformer(window.location.pathname));\\n      csm.putMetric(metric);\\n    },\\n\\n    addError: function(metricName, count) {\\n      csm.Util.assertExist(metricName, 'metricName');\\n\\n      if (count === undefined || count == null) {\\n        count = 1.0;\\n      }\\n      const metric = new csm.Metric(metricName, csm.UNIT.COUNT, count);\\n      metric.addDimension('Metric', 'Error');\\n      csm.putMetric(metric);\\n    },\\n\\n    addSuccess: function(metricName) {\\n      API.addError(metricName, 0);\\n    },\\n\\n    addTime: function(metricName, time, unit) {\\n      csm.Util.assertExist(metricName, 'metricName');\\n      csm.Util.assertExist(time, 'time');\\n\\n      let timeUnit = csm.UNIT.MILLISECONDS;\\n      if (unit && csm.Util.isValidTimeUnit(unit)) {\\n        timeUnit = unit;\\n      }\\n      const metric = new csm.Metric(metricName, timeUnit, time);\\n      metric.addDimension('Metric', 'Time');\\n      csm.putMetric(metric);\\n    },\\n\\n    addTimeWithPageLocation: function(metricName, time, unit) {\\n      csm.Util.assertExist(metricName, 'metricName');\\n      csm.Util.assertExist(time, 'time');\\n\\n      let timeUnit = csm.UNIT.MILLISECONDS;\\n      if (unit && csm.Util.isValidTimeUnit(unit)) {\\n        timeUnit = unit;\\n      }\\n      const metric = new csm.Metric(metricName, timeUnit, time);\\n      metric.addDimension('WindowLocation', csm.Util.pageLocationTransformer(window.location.pathname));\\n      csm.putMetric(metric);\\n    },\\n\\n    pageReady: function() {\\n      if (window.performance && window.performance.now) {\\n        const pageLoadTime = window.performance.now();\\n        const metric = new csm.Metric('PageReadyLatency', csm.UNIT.MILLISECONDS, pageLoadTime);\\n        metric.addDimension('WindowLocation', csm.Util.pageLocationTransformer(window.location.pathname));\\n        csm.putMetric(metric);\\n      }\\n    },\\n\\n    setPageLocationTransformer: function(transformFunc) {\\n      csm.Util.assertExist(transformFunc, 'transformFunc');\\n      csm.Util.assertTrue((typeof transformFunc) === 'function');\\n      csm.Util.pageLocationTransformer = transformFunc;\\n    },\\n\\n    setGlobalDimensions: function(dimensions) {\\n      csm.Util.assertExist(dimensions, 'dimensions');\\n      csm.globalDimensions = dimensions;\\n    },\\n\\n    setGlobalOptionalDimensions: function(dimensions) {\\n      csm.Util.assertExist(dimensions, 'dimensions');\\n      csm.globalOptionalDimensions = dimensions;\\n    },\\n\\n    setInitFailureDimensions: function(dimensions) {\\n      csm.Util.assertExist(dimensions, 'dimensions');\\n      csm.initFailureDimensions = dimensions;\\n    },\\n\\n    putCustom: function(endpoint, headers, data) {\\n      csm.Util.assertExist(data, 'data');\\n      csm.Util.assertExist(endpoint, 'endpoint');\\n      csm.Util.assertExist(headers, 'headers');\\n      csm.putCustom(endpoint, headers, data);\\n    },\\n\\n    setAuthParams: function(authParams) {\\n      csm.setAuthParams(authParams);\\n    },\\n\\n    setConfig: function(key, value) {\\n      csm.Util.assertExist(key, 'key');\\n      csm.Util.assertExist(value, 'value');\\n      if (!csm.configuration[key]) {\\n        csm.setConfig(key, value); // set configuration variables such as accountId, instanceId, userId\\n      }\\n    },\\n  };\\n\\n  csm.API = API;\\n})();\\n\\n(function() {\\n  const global = window;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  const WORKFLOW_KEY_PREFIX = 'csm.workflow';\\n\\n  /**\\n   * Calculates the local storage key used to store a workflow of the specified type.\\n   * @param {string} type of workflow\\n   * @return {string} storage key\\n   */\\n  const getWorkflowKeyForType = function(type) {\\n    return [\\n      WORKFLOW_KEY_PREFIX,\\n      type,\\n    ].join('.');\\n  };\\n\\n  /**\\n   * Constructor for new Workflow objects.\\n   *\\n   * If you need to be able to share a workflow across tabs, it is recommended\\n   * to use \\\"csm.workflow\\\" to create/hydrate your workflows instead.\\n   * @param {string} type of workflow\\n   * @param {string} instanceId of workflow\\n   * @param {JSON} data blob associated with workflow\\n   */\\n  const Workflow = function(type, instanceId, data) {\\n    this.type = type;\\n    this.instanceId = instanceId || csm.Util.randomId();\\n    this.instanceSpecified = instanceId || false;\\n    this.eventMap = {};\\n    this.data = data || {};\\n\\n    // Merge global dimensions into the data map.\\n    const dimensionData = {};\\n    csm.globalDimensions.forEach(function(dimension) {\\n      dimensionData[dimension.name] = dimension.value;\\n    });\\n    csm.globalOptionalDimensions.forEach(function(dimension) {\\n      dimensionData[dimension.name] = dimension.value;\\n    });\\n    this.data = this._mergeData(dimensionData);\\n  };\\n\\n  /**\\n   * Create a new workflow or rehydrate an existing shared workflow.\\n   *\\n   * @param {string} type The type of workflow to be created.\\n   * @param {string} instanceId The instanceId of the workflow.  If not provided, it will be\\n   *      assigned a random ID and will not be automatically saved to local storage.\\n   *      If provided, we will attempt to load an existing workflow of the same type\\n   *      from local storage and rehydrate it.\\n   * @param {JSON} data An optional map of key/value pairs to be added as data to every\\n   *      workflow event created with this workflow.\\n   * @return {Workflow} workflow event\\n   * NOTE: Only one workflow of each type can be stored at the same time, to avoid\\n   *       overloading localStorage with unused workflow records.\\n   */\\n  csm.workflow = function(type, instanceId, data) {\\n    let workflow = new Workflow(type, instanceId, data);\\n\\n    if (instanceId) {\\n      const savedWorkflow = csm._loadWorkflow(type);\\n      if (savedWorkflow && savedWorkflow.instanceId === instanceId) {\\n        workflow = savedWorkflow;\\n        workflow.addData(data || {});\\n      }\\n    }\\n\\n    return workflow;\\n  };\\n\\n  csm._loadWorkflow = function(type) {\\n    let workflow = null;\\n    const workflowJson = localStorage.getItem(getWorkflowKeyForType(type));\\n    const workflowStruct = workflowJson ? JSON.parse(workflowJson) : null;\\n    if (workflowStruct) {\\n      workflow = new Workflow(type, workflowStruct.instanceId);\\n      workflow.eventMap = workflowStruct.eventMap;\\n    }\\n    return workflow;\\n  };\\n\\n  /**\\n   * Creates a new workflow event and returns it.  Then this workflow event is sent upstream\\n   * to the CSMSharedWorker where it is provided to the backend.\\n   *\\n   * If an instanceId was specified when the workflow was created, this will also save the workflow\\n   * and all of its events to localStorage.\\n   *\\n   * @param {string} event The name of the event that occurred.\\n   * @param {JSON} data An optional free-form key attribute pair of metadata items that will be stored\\n   *      and reported backstream with the workflow event.\\n   * @return {WorkflowEvent} workflowEvent\\n   */\\n  Workflow.prototype.event = function(event, data) {\\n    const mergedData = this._mergeData(data || {});\\n    const workflowEvent = new csm.WorkflowEvent({\\n      workflow: this,\\n      event: event,\\n      data: mergedData,\\n      userId: csm.configuration.userId || '',\\n      organizationId: csm.configuration.organizationId || '',\\n      accountId: csm.configuration.accountId || '',\\n      appName: csm.configuration.namespace || '',\\n    });\\n    csm.putWorkflowEvent(workflowEvent);\\n    this.eventMap[event] = workflowEvent;\\n    if (this.instanceSpecified) {\\n      this.save();\\n    }\\n    return workflowEvent;\\n  };\\n\\n  /**\\n   * Creates a new workflow event and returns it, if the same event is not happened in ths past\\n   * dedupeIntervalMs milliseconds.\\n   * @param {string} event The name of the event that occurred.\\n   * @param {JSON} data An optional free-form key attribute pair of metadata items that will be stored\\n   * and reported backstream with the workflow event.\\n   * @param {int} dedupeIntervalMs defaults to 200 MS\\n   * @return {WorkflowEvent} workflowEvent\\n   */\\n  Workflow.prototype.eventWithDedupe = function(event, data, dedupeIntervalMs) {\\n    const pastEvent = this.getPastEvent(event);\\n    const now = new Date().getTime();\\n    const interval = dedupeIntervalMs || 200;\\n\\n    // Crafting the expected workflow event data result\\n    const mergedData = this._mergeData(data);\\n    const expectedData = [];\\n    for (const key in mergedData) {\\n      if (Object.prototype.hasOwnProperty.call(mergedData, key)) {\\n        expectedData.push({'key': key, 'value': mergedData[key]});\\n      }\\n    }\\n\\n    // Deduplicate same events that happened within interval\\n    if (!pastEvent || (pastEvent && JSON.stringify(pastEvent.data) !== JSON.stringify(expectedData)) ||\\n        (pastEvent && (now - pastEvent.timestamp > interval))) {\\n      return this.event(event, data);\\n    }\\n    return null;\\n  };\\n\\n  /**\\n   * Get a past event if it exists in this workflow, otherwise returns null.\\n   * This can be helpful to emit metrics in real time based on the differences\\n   * between workflow event timestamps, especially for workflows shared across tabs.\\n   * @param {string} event key to see if workflow exists for this event\\n   * @return {WorkflowEvent} workflow event retrieved\\n   */\\n  Workflow.prototype.getPastEvent = function(event) {\\n    return event in this.eventMap ? this.eventMap[event] : null;\\n  };\\n\\n  /**\\n   * Save the workflow to local storage. This only happens automatically when an\\n   * instanceId is specified on workflow creation, however if this method is called\\n   * explicitly by the client, the randomly generated workflow instance id can be\\n   * used to retrieve the workflow later and automatic save on events will be enabled.\\n   */\\n  Workflow.prototype.save = function() {\\n    this.instanceSpecified = true;\\n    localStorage.setItem(getWorkflowKeyForType(this.type), JSON.stringify(this));\\n  };\\n\\n  /**\\n   * Remove this workflow if it is the saved instance for this workflow type in localStorage.\\n   */\\n  Workflow.prototype.close = function() {\\n    const storedWorkflow = csm._loadWorkflow(this.type);\\n    if (storedWorkflow && storedWorkflow.instanceId === this.instanceId) {\\n      localStorage.removeItem(getWorkflowKeyForType(this.type));\\n    }\\n  };\\n\\n  Workflow.prototype.addData = function(data) {\\n    for (const key in data) {\\n      if (Object.prototype.hasOwnProperty.call(data, key)) {\\n        this.data[key] = data[key];\\n      }\\n    }\\n  };\\n\\n  Workflow.prototype._mergeData = function(data) {\\n    const mergedData = {};\\n    let key = null;\\n    for (key in this.data) {\\n      if (Object.prototype.hasOwnProperty.call(this.data, key)) {\\n        mergedData[key] = this.data[key] == null ? 'null' : (this.data[key] === '' ? ' ' : this.data[key].toString());\\n      }\\n    }\\n    for (key in data) {\\n      if (Object.prototype.hasOwnProperty.call(data, key)) {\\n        mergedData[key] = data[key] == null ? 'null' : (data[key] === '' ? ' ' : data[key].toString());\\n      }\\n    }\\n    return mergedData;\\n  };\\n})();\\n\\n(function() {\\n  const global = window;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  let worker = null;\\n  let portId = null;\\n\\n  const MAX_INIT_MILLISECONDS = 5000;\\n  const preInitTaskQueue = [];\\n  csm.configuration = {};\\n\\n  /**\\n   * Initialize CSM variables\\n   * @param {object} params for CSM\\n   * @params.namespace Define your metric namespace used in CloudWatch metrics\\n   * @params.sharedWorkerUrl Specify the relative url to the connect-csm-worker.js file in your service\\n   * @params.endpoint Specify an LDAS endpoint to use.\\n   * @params.dryRunMode When CSM is initialized with dry run mode, it won't actually publish metrics.\\n   * @params.defaultMetrics Enable default metrics. Default to false.\\n   */\\n  csm.initCSM = function(params) {\\n    csm.Util.assertExist(params.namespace, 'namespace');\\n    csm.Util.assertExist(params.sharedWorkerUrl, 'sharedWorkerUrl');\\n    csm.Util.assertExist(params.endpoint, 'endpoint');\\n\\n    try {\\n      console.log('Starting csm shared worker with', params.sharedWorkerUrl);\\n      worker = new SharedWorker(params.sharedWorkerUrl, 'CSM_SharedWorker');\\n      worker.port.start();\\n    } catch (e) {\\n      console.log('Failed to initialize csm shared worker with', params.sharedWorkerUrl);\\n      console.log(e.message);\\n    }\\n\\n    /**\\n     * Configure shared worker\\n     */\\n    csm.configuration = {\\n      namespace: params.namespace,\\n      userId: params.userId || '',\\n      accountId: params.accountId || '',\\n      organizationId: params.organizationId || '',\\n      endpointUrl: params.endpoint || null,\\n      batchSettings: params.batchSettings || null,\\n      addPageVisibilityDimension: params.addPageVisibilityDimension || false,\\n      addUrlDataDimensions: params.addUrlDataDimensions || false,\\n      dryRunMode: params.dryRunMode || false, // When csm is in dryRunMode it won't actually publish metrics to CSM\\n    };\\n\\n    postEventToWorker(csm.EVENT_TYPE.CONFIG, csm.configuration);\\n\\n    /**\\n     * Receive message from shared worker\\n     * @param {MessageEvent} messageEvent from shared worker\\n     */\\n    worker.port.onmessage = function(messageEvent) {\\n      const messageType = messageEvent.data.type;\\n      onMessageFromWorker(messageType, messageEvent.data);\\n    };\\n\\n    /**\\n     * Inform shared worker window closed\\n     */\\n    global.onbeforeunload = function() {\\n      worker.port.postMessage(\\n          {\\n            type: csm.EVENT_TYPE.CLOSE,\\n            portId: portId,\\n          },\\n      );\\n    };\\n\\n    /**\\n     * Check if initialization success\\n     */\\n    global.setTimeout(function() {\\n      if (!isCSMInitialized()) {\\n        console.log('[FATAL] CSM initialization failed! Please make sure the sharedWorkerUrl is reachable.');\\n      }\\n    }, MAX_INIT_MILLISECONDS);\\n\\n    // Emit out of the box metrics\\n    if (params.defaultMetrics) {\\n      emitDefaultMetrics();\\n    }\\n  };\\n  // Final processing before sending to SharedWorker\\n  const processMetric = function(metric) {\\n    if (csm.configuration.addPageVisibilityDimension && document.visibilityState) {\\n      metric.addOptionalDimension('VisibilityState', document.visibilityState);\\n    }\\n  };\\n\\n  const processWorkflowEvent = function(event) {\\n    if (csm.configuration.addUrlDataDimensions) {\\n      event.data.push({'key': 'ReferrerUrl', 'value': csm.Util.getReferrerUrl()});\\n      event.data.push({'key': 'Origin', 'value': csm.Util.getOrigin()});\\n      event.data.push({'key': 'WindowParent', 'value': csm.Util.getWindowParent()});\\n    }\\n    if (['initFailure', 'initializationLatencyInfo'].includes(event.event)) {\\n      csm.initFailureDimensions.forEach((dimension) => {\\n        Object.keys(dimension).forEach((key) => {\\n          event.data.push({'key': key, 'value': dimension[key]});\\n        });\\n      });\\n    }\\n    return event;\\n  };\\n\\n  csm.putMetric = function(metric) {\\n    processMetric(metric);\\n    postEventToWorker(csm.EVENT_TYPE.METRIC, metric);\\n  };\\n\\n  csm.putLog = function(log) {\\n    postEventToWorker(csm.EVENT_TYPE.LOG, log);\\n  };\\n\\n  csm.putWorkflowEvent = function(event) {\\n    const processedEvent = processWorkflowEvent(event);\\n    postEventToWorker(csm.EVENT_TYPE.WORKFLOW_EVENT, processedEvent);\\n  };\\n\\n  csm.putCustom = function(endpoint, headers, data) {\\n    postEventToWorker(csm.EVENT_TYPE.CUSTOM, data, endpoint, headers);\\n  };\\n\\n  csm.setAuthParams = function(authParams) {\\n    postEventToWorker(csm.EVENT_TYPE.SET_AUTH, authParams);\\n  };\\n\\n  csm.setConfig = function(key, value) {\\n    csm.configuration[key] = value;\\n    postEventToWorker(csm.EVENT_TYPE.SET_CONFIG, {key, value});\\n  };\\n  /** **********************  PRIVATE METHODS  ************************/\\n\\n  const onMessageFromWorker = function(messageType, data) {\\n    if (messageType === csm.EVENT_TYPE.CONFIG) {\\n      portId = data.portId;\\n      onCSMInitialized();\\n    }\\n  };\\n\\n  const onCSMInitialized = function() {\\n    // Purge the preInitTaskQueue\\n    preInitTaskQueue.forEach(function(task) {\\n      postEventToWorker(task.type, task.message, task.endpoint, task.headers);\\n    });\\n\\n    // TODO:  Capture on errors and publish log to shared worker\\n    /**\\n            window.onerror = function(message, fileName, lineNumber, columnNumber, errorstack) {\\n                var log = new csm.Log(message, fileName, lineNumber, columnNumber, errorstack.stack);\\n                csm.putLog(log);\\n            };\\n        */\\n  };\\n\\n  /**\\n   * Emit out of the box metrics automatically\\n   *\\n   * TODO allow configuration\\n   */\\n  const emitDefaultMetrics = function() {\\n    window.addEventListener('load', function() {\\n      // loadEventEnd is avaliable after the onload function finished\\n      // https://www.w3.org/TR/navigation-timing-2/#processing-model\\n      // https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming\\n      global.setTimeout(function() {\\n        try {\\n          const perfData = window.performance.getEntriesByType('navigation')[0];\\n          const pageLoadTime = perfData.loadEventEnd - perfData.startTime;\\n          const connectTime = perfData.responseEnd - perfData.requestStart;\\n          const domRenderTime = perfData.domComplete - perfData.domInteractive;\\n          csm.API.addCountWithPageLocation('PageLoad');\\n          csm.API.addTimeWithPageLocation('PageLoadTime', pageLoadTime);\\n          csm.API.addTimeWithPageLocation('ConnectTime', connectTime);\\n          csm.API.addTimeWithPageLocation('DomRenderTime', domRenderTime);\\n        } catch (err) {\\n          console.log('Error emitting default metrics', err);\\n        }\\n      }, 0);\\n    });\\n  };\\n\\n  /**\\n   * Try posting message to shared worker\\n   * If shared worker hasn't been initialized, put the task to queue to be clean up once initialized\\n   * @param {csm.EVENT_TYPE} eventType for CSM\\n   * @param {object} message event following type of eventType\\n   * @param {string} [endpoint] optional parameter for putCustom function (put any data to specified endpoint)\\n   * @param {object} [headers] optional parameter for putCustom function\\n   */\\n  const postEventToWorker = function(eventType, message, endpoint, headers) {\\n    if (eventType === csm.EVENT_TYPE.CONFIG || isCSMInitialized()) {\\n      worker.port.postMessage(\\n          {\\n            type: eventType,\\n            portId: portId,\\n            message: message,\\n            endpoint: endpoint,\\n            headers: headers,\\n          },\\n      );\\n    } else {\\n      preInitTaskQueue.push({\\n        type: eventType,\\n        message: message,\\n        endpoint: endpoint,\\n        headers: headers,\\n      });\\n    }\\n  };\\n\\n  const isCSMInitialized = function() {\\n    return portId !== null;\\n  };\\n})()\",document.head.appendChild(e)}catch(e){this.logger.error(\"Load csm script error: \",e)}}initializeCSM(){if(!this.csmInitialized){var e=i.getRegion(),t=\"(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  csm.EVENT_TYPE = {\\n    LOG: 'LOG',\\n    METRIC: 'METRIC',\\n    CONFIG: 'CONFIG',\\n    WORKFLOW_EVENT: 'WORKFLOW_EVENT',\\n    CUSTOM: 'CUSTOM',\\n    CLOSE: 'CLOSE',\\n    SET_AUTH: 'SET_AUTH',\\n    SET_CONFIG: 'SET_CONFIG',\\n  };\\n\\n  csm.UNIT = {\\n    COUNT: 'Count',\\n    SECONDS: 'Seconds',\\n    MILLISECONDS: 'Milliseconds',\\n    MICROSECONDS: 'Microseconds',\\n  };\\n})();\\n\\n(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  const MAX_METRIC_DIMENSIONS = 10;\\n\\n  /** ********* Dimension Classes ***********/\\n\\n  const Dimension = function(name, value) {\\n    csm.Util.assertExist(name, 'name');\\n    csm.Util.assertExist(value, 'value');\\n\\n    this.name = name;\\n    this.value = value == null ? 'null' : (value === '' ? ' ' : value.toString());\\n  };\\n\\n\\n  /** ********* Metric Classes ***********/\\n\\n  const Metric = function(metricName, unit, value, dedupeOptions) {\\n    csm.Util.assertExist(metricName, 'metricName');\\n    csm.Util.assertExist(value, 'value');\\n    csm.Util.assertExist(unit, 'unit');\\n    csm.Util.assertTrue(csm.Util.isValidUnit(unit));\\n    if (dedupeOptions) {\\n      csm.Util.assertInObject(dedupeOptions, 'dedupeOptions', 'dedupeIntervalMs');\\n    }\\n\\n    this.metricName = metricName;\\n    this.unit = unit;\\n    this.value = value;\\n    this.timestamp = new Date();\\n    this.dimensions = csm.globalDimensions ? csm.Util.deepCopy(csm.globalDimensions): [];\\n    this.namespace = csm.configuration.namespace;\\n    this.dedupeOptions = dedupeOptions; // optional. { dedupeIntervalMs: (int; required), context: (string; optional) }\\n\\n    // Currently, CloudWatch can't aggregate metrics by a subset of dimensions.\\n    // To bypass this limitation, we introduce the optional dimensions concept to CSM.\\n    // The CSM metric publisher will publish a default metric without optional dimension\\n    // For each optional dimension, the CSM metric publisher publishes an extra metric with that dimension.\\n    this.optionalDimensions = csm.globalOptionalDimensions ? csm.Util.deepCopy(csm.globalOptionalDimensions): [];\\n  };\\n\\n  Metric.prototype.addDimension = function(name, value) {\\n    this._addDimensionHelper(this.dimensions, name, value);\\n  };\\n\\n  Metric.prototype.addOptionalDimension = function(name, value) {\\n    this._addDimensionHelper(this.optionalDimensions, name, value);\\n  };\\n\\n  Metric.prototype._addDimensionHelper = function(targetDimensions, name, value) {\\n    // CloudWatch metric allows maximum 10 dimensions\\n    // http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/CloudWatch.html#putMetricData-property\\n    if ((this.dimensions.length + this.optionalDimensions.length) >= MAX_METRIC_DIMENSIONS) {\\n      throw new csm.ExceedDimensionLimitException(name);\\n    }\\n\\n    const existing = targetDimensions.find(function(dimension) {\\n      return dimension.name === name;\\n    });\\n\\n    if (existing) {\\n      existing.value = value == null ? 'null' : (value === '' ? ' ' : value.toString());\\n    } else {\\n      targetDimensions.push(new Dimension(name, value));\\n    }\\n  };\\n\\n\\n  /** ********* Telemetry Classes ***********/\\n\\n  const WorkflowEvent = function(params) {\\n    this.timestamp = params.timestamp || new Date().getTime();\\n    this.workflowType = params.workflow.type;\\n    this.instanceId = params.workflow.instanceId;\\n    this.userId = params.userId;\\n    this.organizationId = params.organizationId;\\n    this.accountId = params.accountId;\\n    this.event = params.event;\\n    this.appName = params.appName;\\n    this.data = [];\\n\\n    // Convert 'data' map into the KeyValuePairList structure expected by the Lambda API\\n    for (const key in params.data) {\\n      if (Object.prototype.hasOwnProperty.call(params.data, key)) {\\n        this.data.push({'key': key, 'value': params.data[key]});\\n      }\\n    }\\n  };\\n\\n  /** ********* Exceptions ***********/\\n\\n  const NullOrUndefinedException = function(paramName) {\\n    this.name = 'NullOrUndefinedException';\\n    this.message = paramName + ' is null or undefined. ';\\n  };\\n  NullOrUndefinedException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const AssertTrueException = function() {\\n    this.name = 'AssertTrueException';\\n    this.message = 'Assertion failed. ';\\n  };\\n  AssertTrueException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const ExceedDimensionLimitException = function(dimensionName) {\\n    this.name = 'ExceedDimensionLimitException';\\n    this.message = 'Could not add dimension ' + dimensionName + ' . Metric has maximum 10 dimensions. ';\\n  };\\n  ExceedDimensionLimitException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const InitializationException = function() {\\n    this.name = 'InitializationException';\\n    this.message = 'Initialization failed. ';\\n  };\\n  InitializationException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n\\n  csm.Dimension = Dimension;\\n  csm.Metric = Metric;\\n  csm.WorkflowEvent = WorkflowEvent;\\n  csm.NullOrUndefinedException = NullOrUndefinedException;\\n  csm.AssertTrueException = AssertTrueException;\\n  csm.InitializationException = InitializationException;\\n  csm.ExceedDimensionLimitException = ExceedDimensionLimitException;\\n})();\\n\\n(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  const validTimeUnits = [csm.UNIT.SECONDS, csm.UNIT.MILLISECONDS, csm.UNIT.MICROSECONDS];\\n  const validUnits = validTimeUnits.concat(csm.UNIT.COUNT);\\n\\n  const Util = {\\n    assertExist: function(value, paramName) {\\n      if (value === null || value === undefined) {\\n        throw new csm.NullOrUndefinedException(paramName);\\n      }\\n    },\\n    assertTrue: function(value) {\\n      if (!value) {\\n        throw new csm.AssertTrueException();\\n      }\\n    },\\n    assertInObject: function(obj, objName, key) {\\n      if (obj === null || obj === undefined || typeof obj !== 'object') {\\n        throw new csm.NullOrUndefinedException(objName);\\n      }\\n      if (key === null || key === undefined || !obj[key]) {\\n        throw new csm.NullOrUndefinedException(`${objName}[${key}]`);\\n      }\\n    },\\n    isValidUnit: function(unit) {\\n      return validUnits.includes(unit);\\n    },\\n    isValidTimeUnit: function(unit) {\\n      return validTimeUnits.includes(unit);\\n    },\\n    isEmpty: function(value) {\\n      if (value !== null && typeof val === 'object') {\\n        return Objects.keys(value).length === 0;\\n      }\\n      return !value;\\n    },\\n    deepCopy: function(obj) {\\n      // NOTE: this will fail if obj has a circular reference\\n      return JSON.parse(JSON.stringify(obj));\\n    },\\n\\n    /**\\n     * This function is used before setting the page location for default metrics and logs,\\n     * and the APIs that set page location\\n     * Can be overridden by calling csm.API.setPageLocationTransformer(function(){})\\n     * @param {string}        pathname path for page location\\n     * @return {string}       pathname provided\\n     */\\n    pageLocationTransformer: function(pathname) {\\n      return pathname;\\n    },\\n\\n    /**\\n     * As of now, our service public claims only support for Firefox and Chrome\\n     * Reference https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent\\n     *\\n     * This function will only return firefox, chrome and others\\n     *\\n     * Best practice as indicated in MDN, \\\"Avoiding user agent detection\\\"\\n     */\\n    getBrowserDetails: function() {\\n      const userAgent = window.navigator.userAgent;\\n      const details = {};\\n      if (userAgent.includes('Firefox') && !userAgent.includes('Seamonkey')) {\\n        details.name = 'Firefox';\\n        details.version = getBrowserVersion('Firefox');\\n      } else if (userAgent.includes('Chrome') && !userAgent.includes('Chromium')) {\\n        details.name = 'Chrome';\\n        details.version = getBrowserVersion('Chrome');\\n      }\\n    },\\n\\n    randomId: function() {\\n      return new Date().getTime() + '-' + Math.random().toString(36).slice(2);\\n    },\\n\\n    getOrigin: function() {\\n      return document.location.origin;\\n    },\\n\\n    getReferrerUrl: function() {\\n      const referrer = document.referrer || '';\\n      return this.getURLOrigin(referrer);\\n    },\\n\\n    getWindowParent: function() {\\n      let parentLocation = '';\\n      try {\\n        parentLocation = window.parent.location.href;\\n      } catch (e) {\\n        parentLocation = '';\\n      }\\n      return parentLocation;\\n    },\\n\\n    getURLOrigin: function(urlValue) {\\n      let origin = '';\\n      const originArray = urlValue.split( '/' );\\n      if (originArray.length >= 3) {\\n        const protocol = originArray[0];\\n        const host = originArray[2];\\n        origin = protocol + '//' + host;\\n      }\\n      return origin;\\n    },\\n\\n  };\\n\\n  const getBrowserVersion = function(browserName) {\\n    const userAgent = window.navigator.userAgent;\\n    const browserNameIndex = userAgent.indexOf(browserName);\\n    const nextSpaceIndex = userAgent.indexOf(' ', browserNameIndex);\\n    if (nextSpaceIndex === -1) {\\n      return userAgent.substring(browserNameIndex + browserName.length + 1, userAgent.length);\\n    } else {\\n      return userAgent.substring(browserNameIndex + browserName.length + 1, nextSpaceIndex);\\n    }\\n  };\\n\\n  csm.Util = Util;\\n})();\\n\\n(function() {\\n  const XHR_DONE_READY_STATE = 4; // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState\\n\\n  const global = self;\\n  const configuration = {};\\n  const batchSettings = {\\n    maxMetricsSize: 30,\\n    maxWorkflowEventsSize: 30,\\n    putMetricsIntervalMs: 30000,\\n    putWorkflowEventsIntervalMs: 2000,\\n  };\\n  const metricLists = {}; // metricList per CloudWatch Namespace\\n  const metricMap = {};\\n  const ports = {};\\n  let workflowEvents = {workflowEventList: []};\\n\\n  // SharedWorker wiki:  https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker\\n  onconnect = function(connectEvent) {\\n    const port = connectEvent.ports[0];\\n\\n    port.onmessage = function(event) {\\n      const data = event.data;\\n      const messageType = data.type;\\n      const message = data.message;\\n      const endpoint = data.endpoint;\\n      const headers = data.headers;\\n\\n      if (data.portId && !(data.portId in ports)) {\\n        // This could happen when a user tries to close a tab which has a pop up alert to confirm closing,\\n        // and the user decides to cancel closing\\n        // This triggers before unload event while the tab or window is not closed actually\\n        ports[data.portId] = port;\\n      }\\n\\n      const {METRIC, WORKFLOW_EVENT, CUSTOM, CONFIG, SET_AUTH, SET_CONFIG, CLOSE} = csm.EVENT_TYPE;\\n      switch (messageType) {\\n        case METRIC: {\\n          csm.Util.assertInObject(message, 'message', 'namespace');\\n          const namespace = message.namespace;\\n          if (shouldDedupe(message)) break;\\n          addMetricEventToMap(message);\\n          if (metricLists[namespace]) {\\n            metricLists[namespace].push(message);\\n          } else {\\n            metricLists[namespace] = [message];\\n          }\\n          if (metricLists[namespace].length >= batchSettings.maxMetricsSize) {\\n            putMetricsForNamespace(namespace);\\n          }\\n          break;\\n        }\\n        case WORKFLOW_EVENT: {\\n          workflowEvents.workflowEventList.push(message);\\n          if (workflowEvents.length >= batchSettings.maxWorkflowEventsSize) {\\n            putWorkflowEvents();\\n          }\\n          break;\\n        }\\n        case CUSTOM: {\\n          putCustom(endpoint, headers, message);\\n          break;\\n        }\\n        case CONFIG: {\\n          const portId = Object.keys(ports).length + 1; // portId starts from 1\\n          ports[portId] = port;\\n          for (const setting of Object.keys(message)) {\\n            if (!csm.Util.isEmpty(message[setting])) {\\n              configuration[setting] = message[setting];\\n            }\\n          }\\n\\n          // set optional batch settings\\n          if (configuration.batchSettings) {\\n            for (const setting of Object.keys(configuration.batchSettings)) {\\n              batchSettings[setting] = configuration.batchSettings[setting];\\n            }\\n          }\\n          // send metrics and workflow events at set intervals\\n          putMetrics();\\n          putWorkflowEvents();\\n          global.setInterval(putMetrics, batchSettings.putMetricsIntervalMs);\\n          global.setInterval(putWorkflowEvents, batchSettings.putWorkflowEventsIntervalMs);\\n\\n          port.postMessage(\\n              {\\n                type: csm.EVENT_TYPE.CONFIG,\\n                portId: portId,\\n              },\\n          );\\n          break;\\n        }\\n        case SET_AUTH: {\\n          configuration.authParams = message;\\n          authenticate();\\n          break;\\n        }\\n        case SET_CONFIG: {\\n          configuration[message.key] = message.value;\\n          break;\\n        }\\n        case CLOSE: {\\n          delete ports[data.portId];\\n          if (Object.keys(ports).length === 0) {\\n            putMetrics();\\n            putWorkflowEvents();\\n          }\\n          break;\\n        }\\n        default:\\n          break;\\n      }\\n    };\\n  };\\n\\n  const shouldDedupe = function(metric) {\\n    try {\\n      const pastMetric = getPastMetricEvent(metric);\\n      return pastMetric && metric.dedupeOptions &&\\n        (metric.timestamp - pastMetric.timestamp < metric.dedupeOptions.dedupeIntervalMs);\\n    } catch (err) {\\n      console.error('Error in shouldDedupe', err);\\n      return false;\\n    }\\n  };\\n\\n  const getPastMetricEvent = function(metric) {\\n    try {\\n      return metricMap[getMetricEventKey(metric)];\\n    } catch (err) {\\n      // ignore err - no previous metrics found\\n      return null;\\n    }\\n  };\\n\\n  const addMetricEventToMap = function(metric) {\\n    try {\\n      metricMap[getMetricEventKey(metric)] = metric;\\n    } catch (err) {\\n      console.error('Failed to add event to metricMap', err);\\n    }\\n    csm.metricMap = metricMap;\\n  };\\n\\n  const getMetricEventKey = function(metric) {\\n    const {namespace, metricName, unit, dedupeOptions} = metric;\\n    let context = 'global';\\n    if (dedupeOptions && dedupeOptions.context) {\\n      context = dedupeOptions.context;\\n    }\\n    return `${namespace}-${metricName}-${unit}-${context}`;\\n  };\\n\\n  const authenticate = function() {\\n    postRequest(configuration.endpointUrl + '/auth', {authParams: configuration.authParams},\\n        {\\n          success: function(response) {\\n            if (response && response.jwtToken) {\\n              configuration.authParams.jwtToken = response.jwtToken;\\n            }\\n          },\\n          failure: function(response) {\\n            broadcastMessage('[ERROR] csm auth failed!');\\n            broadcastMessage('Response : ' + response);\\n          },\\n        }, {'x-api-key': 'auth-method-level-key'});\\n  };\\n\\n  /**\\n   * Put metrics to service when:\\n   * a) metricList size is at maxMetricsSize\\n   * b) every putMetricsIntervalMs time if the metricList is not empty\\n   * c) worker is closed\\n   *\\n   * Timer is reset, and metricList emptied after each putMetrics call\\n   */\\n  const putMetrics = function() {\\n    for (const namespace of Object.keys(metricLists)) {\\n      putMetricsForNamespace(namespace);\\n    }\\n  };\\n\\n  const putMetricsForNamespace = function(namespace) {\\n    csm.Util.assertInObject(metricLists, 'metricLists', namespace);\\n    const metricList = metricLists[namespace];\\n\\n    if (metricList.length > 0 && !configuration.dryRunMode && configuration.endpointUrl) {\\n      postRequest(configuration.endpointUrl + '/put-metrics', {\\n        metricNamespace: namespace,\\n        metricList: metricList,\\n        authParams: configuration.authParams,\\n        accountId: configuration.accountId,\\n        organizationId: configuration.organizationId,\\n        agentResourceId: configuration.userId,\\n      }, {\\n        success: function(response) {\\n          if (response) {\\n            broadcastMessage('PutMetrics response : ' + response);\\n            if (response.unsetToken) {\\n              delete configuration.authParams.jwtToken;\\n              authenticate();\\n            }\\n          }\\n        },\\n        failure: function(response) {\\n          broadcastMessage('[ERROR] Put metrics to service failed! ');\\n        },\\n      });\\n    }\\n    metricLists[namespace] = [];\\n  };\\n\\n  /**\\n   * Put metrics to service every two seconds if there are events to be put.\\n   */\\n  const putWorkflowEvents = function() {\\n    if (workflowEvents.workflowEventList.length > 0 && !configuration.dryRunMode && configuration.endpointUrl) {\\n      workflowEvents.authParams = configuration.authParams;\\n      postRequest(configuration.endpointUrl + '/put-workflow-events', workflowEvents,\\n          {\\n            success: function(response) {\\n              if (response) {\\n                if (response.workflowEventList && response.workflowEventList.length > 0) {\\n                  broadcastMessage('[WARN] There are ' + response.length + ' workflow events that failed to publish');\\n                  broadcastMessage('Response : ' + response);\\n                }\\n                if (response.unsetToken) {\\n                  delete configuration.authParams.jwtToken;\\n                  authenticate();\\n                }\\n              }\\n            },\\n            failure: function(response) {\\n              broadcastMessage('[ERROR] Put workflow events to service failed! ');\\n            },\\n          });\\n    }\\n\\n    workflowEvents = {workflowEventList: []};\\n  };\\n\\n  /**\\n   * Put data to custom endpoint on demand\\n   * @param {string} endpoint\\n   * @param {object} headers\\n   * @param {object} data to send to endpoint\\n   */\\n  const putCustom = function(endpoint, headers, data) {\\n    if (!configuration.dryRunMode && endpoint && data) {\\n      postRequest(endpoint, data, {\\n        success: function(response) {\\n          if (response) {\\n            broadcastMessage('Response : ' + response);\\n          }\\n        },\\n        failure: function(response) {\\n          broadcastMessage('[ERROR] Failed to put custom data! ');\\n        },\\n      }, headers);\\n    }\\n  };\\n\\n  /**\\n   * Broadcast message to all tabs\\n   * @param {string} message to post to all the tabs\\n   */\\n  const broadcastMessage = function(message) {\\n    for (const portId in ports) {\\n      if (Object.prototype.hasOwnProperty.call(ports, portId)) {\\n        ports[portId].postMessage(message);\\n      }\\n    }\\n  };\\n\\n  const postRequest = function(url, data, callbacks, headers) {\\n    csm.Util.assertExist(url, 'url');\\n    csm.Util.assertExist(data, 'data');\\n\\n    callbacks = callbacks || {};\\n    callbacks.success = callbacks.success || function() {};\\n    callbacks.failure = callbacks.failure || function() {};\\n\\n    const request = new XMLHttpRequest(); // new HttpRequest instance\\n    request.onreadystatechange = function() {\\n      const errorList = request.response ? JSON.parse(request.response): [];\\n      if (request.readyState === XHR_DONE_READY_STATE) { // request finished and response is ready\\n        if (request.status === 200) {\\n          callbacks.success(errorList);\\n        } else {\\n          broadcastMessage('AJAX request failed with status: ' + request.status);\\n          callbacks.failure(errorList);\\n        }\\n      }\\n    };\\n\\n    request.open('POST', url);\\n    if (headers && typeof headers === 'object') {\\n      Object.keys(headers).forEach((header) => request.setRequestHeader(header, headers[header]));\\n    } else {\\n      request.setRequestHeader('Content-Type', 'application/json');\\n    }\\n    request.send(JSON.stringify(data));\\n  };\\n})()\".replace(/\\\\/g,\"\"),n=URL.createObjectURL(new Blob([t],{type:\"text/javascript\"})),r=(e=>\"https://ieluqbvv.telemetry.connect.\".concat(e,\".amazonaws.com/prod\"))(e),o={endpoint:r,namespace:\"chat-widget\",sharedWorkerUrl:n};csm.initCSM(o),this.logger.info(\"CSMService is initialized in \".concat(e)),this.csmInitialized=!0,this.metricsToBePublished&&(this.metricsToBePublished.forEach((e=>{csm.API.addMetric(e)})),this.metricsToBePublished=null)}}updateCsmConfig(e){this.widgetType=e.widgetType||this.widgetType}getDefaultDimensions(){return[{name:\"WidgetType\",value:this.widgetType}]}addMetric(e){this.csmInitialized?csm.API.addMetric(e):this.metricsToBePublished&&(this.metricsToBePublished.push(e),this.logger.info(\"CSMService is not initialized yet. Adding metrics to queue to be published once CSMService is initialized\"))}setDimensions(e,t){t.forEach((t=>{e.addDimension(t.name,t.value)}))}addLatencyMetric(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=new csm.Metric(e,csm.UNIT.MILLISECONDS,t),o=[...this.getDefaultDimensions(),{name:\"Metric\",value:\"Latency\"},{name:J,value:n},...r];this.setDimensions(i,o),this.addMetric(i),this.logger.debug(\"Successfully published latency API metrics for method \".concat(e))}addLatencyMetricWithStartTime(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=(new Date).getTime()-t;this.addLatencyMetric(e,i,n,r),this.logger.debug(\"Successfully published latency API metrics for method \".concat(e))}addCountAndErrorMetric(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=[...this.getDefaultDimensions(),{name:J,value:t},...r],o=new csm.Metric(e,csm.UNIT.COUNT,1);this.setDimensions(o,[...i,{name:\"Metric\",value:\"Count\"}]);var s=n?1:0,a=new csm.Metric(e,csm.UNIT.COUNT,s);this.setDimensions(a,[...i,{name:\"Metric\",value:\"Error\"}]),this.addMetric(o),this.addMetric(a),this.logger.debug(\"Successfully published count and error metrics for method \".concat(e))}addCountMetric(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[...this.getDefaultDimensions(),{name:J,value:t},{name:\"Metric\",value:\"Count\"},...n],i=new csm.Metric(e,csm.UNIT.COUNT,1);this.setDimensions(i,r),this.addMetric(i),this.logger.debug(\"Successfully published count metrics for method \".concat(e))}};class ${constructor(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.chatClient=t,this.participantToken=e||null,this.connectionDetails=null,this.connectionToken=null,this.connectionTokenExpiry=null,this.sessionType=n,this.getConnectionToken=r}getFetchedConnectionToken(){return this.connectionToken}getConnectionTokenExpiry(){return this.connectionTokenExpiry}getConnectionDetails(){return this.connectionDetails}fetchConnectionDetails(){return this._fetchConnectionDetails().then((()=>this.connectionDetails))}fetchConnectionToken(){return this._fetchConnectionDetails().then((()=>this.connectionToken))}_handleCreateParticipantConnectionResponse(e){this.connectionDetails={url:e.Websocket.Url,expiry:e.Websocket.ConnectionExpiry,transportLifeTimeInSeconds:S},this.connectionToken=e.ConnectionCredentials.ConnectionToken,this.connectionTokenExpiry=e.ConnectionCredentials.Expiry}_handleGetConnectionTokenResponse(e){this.connectionDetails={url:null,expiry:null},this.connectionToken=e.participantToken,this.connectionTokenExpiry=e.expiry}_callCreateParticipantConnection(){var e=(new Date).getTime();return this.chatClient.createParticipantConnection(this.participantToken,[\"WEBSOCKET\",\"CONNECTION_CREDENTIALS\"]).then((t=>{this._handleCreateParticipantConnectionResponse(t.data),Y.addLatencyMetricWithStartTime(h,e,s),Y.addCountAndErrorMetric(h,s,!1)})).catch((t=>(Y.addLatencyMetricWithStartTime(h,e,s),Y.addCountAndErrorMetric(h,s,!0),Promise.reject({reason:\"Failed to fetch connectionDetails with createParticipantConnection\",_debug:t}))))}_fetchConnectionDetails(){return this.sessionType===o.CUSTOMER?this._callCreateParticipantConnection():this.sessionType===o.AGENT?this.getConnectionToken().then((e=>this._handleGetConnectionTokenResponse(e.chatTokenTransport))).catch((()=>this._callCreateParticipantConnection())):Promise.reject({reason:\"Failed to fetch connectionDetails.\",_debug:new r(\"Failed to fetch connectionDetails.\")})}}n.g.connect=n.g.connect||{};var Q=connect.WebSocketManager;!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=9)}([function(e,t){function n(t){return e.exports=n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,\"prototype\",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){n.d(t,\"a\",(function(){return ne}));var r=n(0),i=n.n(r),o=n(5),s=\"AMZ_WEB_SOCKET_MANAGER:\",a=\"Network offline\",c=\"Network online, connecting to WebSocket server\",u=\"Network offline, ignoring this getWebSocketConnConfig request\",l=\"Heartbeat response not received\",p=\"Failed to send heartbeat since WebSocket is not open\",d=\"WebSocket connection established!\",h=\"WebSocket connection is closed\",f=\"WebSocketManager Error, error_event: \",m=\"Scheduling WebSocket reinitialization, after delay \",g=\"WebSocket URL cannot be used to establish connection\",v=\"WebSocket Initialization failed - Terminating and cleaning subscriptions\",y=\"Fetching new WebSocket connection configuration\",b=\"Successfully fetched webSocket connection configuration\",w=\"Failed to fetch webSocket connection configuration\",S=\"Retrying fetching new WebSocket connection configuration\",E=\"Initializing Websocket Manager\",C=\"WebSocketManager Message Error\",T=\"Message received for topic \",k=\"Invalid incoming message\",I=\"aws/subscribe\",_=\"aws/heartbeat\",x=\"disconnected\",A={assertTrue:function(e,t){if(!e)throw new Error(t)},assertNotNull:function(e,t){return A.assertTrue(null!==e&&void 0!==i()(e),Object(o.sprintf)(\"%s must be provided\",t||\"A value\")),e},isNonEmptyString:function(e){return\"string\"==typeof e&&e.length>0},assertIsList:function(e,t){if(!Array.isArray(e))throw new Error(t+\" is not an array\")},isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},isObject:function(e){return!(\"object\"!==i()(e)||null===e)},isString:function(e){return\"string\"==typeof e},isNumber:function(e){return\"number\"==typeof e}},R=new RegExp(\"^(wss://)\\\\w*\");A.validWSUrl=function(e){return R.test(e)},A.getSubscriptionResponse=function(e,t,n){return{topic:e,content:{status:t?\"success\":\"failure\",topics:n}}},A.assertIsObject=function(e,t){if(!A.isObject(e))throw new Error(t+\" is not an object!\")},A.addJitter=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t=Math.min(t,1);var n=Math.random()>.5?1:-1;return Math.floor(e+n*e*Math.random()*t)},A.isNetworkOnline=function(){return navigator.onLine},A.isNetworkFailure=function(e){return!(!e._debug||!e._debug.type)&&\"NetworkingError\"===e._debug.type};var L=A,O=n(6),N=n.n(O),M=n(7),P=n.n(M),D=n(3),U=n.n(D),q=n(8),j=n.n(q),W=n(1),F=n.n(W),B=n(2),z=n.n(B);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){j()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=function(){function e(){F()(this,e)}return z()(e,[{key:\"debug\",value:function(e){}},{key:\"info\",value:function(e){}},{key:\"warn\",value:function(e){}},{key:\"error\",value:function(e){}},{key:\"advancedLog\",value:function(e){}}]),e}(),K=s,X={DEBUG:10,INFO:20,WARN:30,ERROR:40,ADVANCED_LOG:50},J=function(){function e(t){F()(this,e),this.logMetaData=t,this.updateLoggerConfig()}return z()(e,[{key:\"hasLogMetaData\",value:function(){return!!this.logMetaData}},{key:\"writeToClientLogger\",value:function(e,t){if(this.hasClientLogger()){var n=function(e){switch(e){case 10:return\"DEBUG\";case 20:return\"INFO\";case 30:return\"WARN\";case 40:return\"ERROR\";case 50:return\"ADVANCED_LOG\"}}(e);switch(e){case X.DEBUG:return this._clientLogger.debug(n,t,this.logMetaData)||t;case X.INFO:return this._clientLogger.info(n,t,this.logMetaData)||t;case X.WARN:return this._clientLogger.warn(n,t,this.logMetaData)||t;case X.ERROR:return this._clientLogger.error(n,t,this.logMetaData)||t;case X.ADVANCED_LOG:return this._advancedLogWriter?this._clientLogger[this._advancedLogWriter](n,t,this.logMetaData)||t:\"\"}}}},{key:\"isLevelEnabled\",value:function(e){return e>=this._level}},{key:\"hasClientLogger\",value:function(){return null!==this._clientLogger}},{key:\"getLogger\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.prefix||K;return e.logMetaData&&this.setLogMetaData(e.logMetaData),this.logMetaData||console.info(\"*********Missing required option: WebSocketManager:logMetaData**********\"),new $(this,V({prefix:t,logMetaData:this.logMetaData},e))}},{key:\"setLogMetaData\",value:function(e){this.logMetaData=e}},{key:\"updateLoggerConfig\",value:function(e){var t=e||{};this._level=t.level||X.INFO,this._advancedLogWriter=\"warn\",t.advancedLogWriter&&(this._advancedLogWriter=t.advancedLogWriter),t.customizedLogger&&\"object\"===i()(t.customizedLogger)&&(this.useClientLogger=!0),this._clientLogger=t.logger||this.selectLogger(t),this._logsDestination=\"NULL\",t.debug&&(this._logsDestination=\"DEBUG\"),t.logger&&(this._logsDestination=\"CLIENT_LOGGER\")}},{key:\"selectLogger\",value:function(e){return e.customizedLogger&&\"object\"===i()(e.customizedLogger)?e.customizedLogger:e.useDefaultLogger?Q():null}}]),e}(),Y=function(){function e(){F()(this,e)}return z()(e,[{key:\"debug\",value:function(){}},{key:\"info\",value:function(){}},{key:\"warn\",value:function(){}},{key:\"error\",value:function(){}},{key:\"advancedLog\",value:function(){}}]),e}(),$=function(e){N()(n,e);var t=function(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var i=U()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P()(this,n)}}(n);function n(e,r){var i;return F()(this,n),(i=t.call(this)).options=r||{},i.prefix=r.prefix||K,i.logManager=e,i}return z()(n,[{key:\"debug\",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(X.DEBUG,t)}},{key:\"info\",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(X.INFO,t)}},{key:\"warn\",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(X.WARN,t)}},{key:\"error\",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(X.ERROR,t)}},{key:\"advancedLog\",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(X.ADVANCED_LOG,t)}},{key:\"_shouldLog\",value:function(e){return this.logManager.hasClientLogger()&&this.logManager.isLevelEnabled(e)}},{key:\"_writeToClientLogger\",value:function(e,t){return this.logManager.writeToClientLogger(e,t)}},{key:\"_log\",value:function(e,t){if(this._shouldLog(e)){var n=this.logManager.useClientLogger?t:this._convertToSingleStatement(t);return this._writeToClientLogger(e,n)}}},{key:\"_convertToSingleStatement\",value:function(e){var t=new Date(Date.now()).toISOString(),n=\"[\".concat(t,\"]\");this.prefix&&(n+=this.prefix+\" \"),this.options&&(this.options.prefix?n+=\" \"+this.options.prefix+\":\":n+=\"\");for(var r=0;r<e.length;r++){var i=e[r];n+=this._convertToString(i)+\" \"}return n}},{key:\"_convertToString\",value:function(e){try{if(!e)return\"\";if(L.isString(e))return e;if(L.isObject(e)&&L.isFunction(e.toString)){var t=e.toString();if(\"[object Object]\"!==t)return t}return JSON.stringify(e)}catch(t){return console.error(\"Error while converting argument to string\",e,t),\"\"}}}]),n}(Y),Q=function(){var e=new Y;return e.debug=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.debug.apply(window.console,[].concat(t))},e.info=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.info.apply(window.console,[].concat(t))},e.warn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.warn.apply(window.console,[].concat(t))},e.error=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error.apply(window.console,[].concat(t))},e},Z=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;F()(this,e),this.numAttempts=0,this.executor=t,this.hasActiveReconnection=!1,this.defaultRetry=n}return z()(e,[{key:\"retry\",value:function(){var e=this;this.hasActiveReconnection||(this.hasActiveReconnection=!0,setTimeout((function(){e._execute()}),this._getDelay()))}},{key:\"_execute\",value:function(){this.hasActiveReconnection=!1,this.executor(),this.numAttempts++}},{key:\"connected\",value:function(){this.numAttempts=0}},{key:\"_getDelay\",value:function(){var e=Math.pow(2,this.numAttempts)*this.defaultRetry;return e<=3e4?e:3e4}},{key:\"getIsConnected\",value:function(){return!this.numAttempts}}]),e}(),ee=null,te=function(){var e=ee.getLogger({prefix:s}),t=L.isNetworkOnline(),n={primary:null,secondary:null},r={reconnectWebSocket:!0,websocketInitFailed:!1,exponentialBackOffTime:1e3,exponentialTimeoutHandle:null,lifeTimeTimeoutHandle:null,webSocketInitCheckerTimeoutId:null,connState:null},i={connectWebSocketRetryCount:0,connectionAttemptStartTime:null,noOpenConnectionsTimestamp:null},o={pendingResponse:!1,intervalHandle:null},A={initFailure:new Set,getWebSocketTransport:null,subscriptionUpdate:new Set,subscriptionFailure:new Set,topic:new Map,allMessage:new Set,connectionGain:new Set,connectionLost:new Set,connectionOpen:new Set,connectionClose:new Set},R={connConfig:null,promiseHandle:null,promiseCompleted:!0},O={subscribed:new Set,pending:new Set,subscriptionHistory:new Set},N={responseCheckIntervalId:null,requestCompleted:!0,reSubscribeIntervalId:null,consecutiveFailedSubscribeAttempts:0,consecutiveNoResponseRequest:0},M=new Z((function(){se()})),P=new Set([I,\"aws/unsubscribe\",_]),D=setInterval((function(){if(t!==L.isNetworkOnline()){if(!(t=L.isNetworkOnline()))return e.advancedLog(a),void ue(e.info(a));var n=z();t&&(!n||W(n,WebSocket.CLOSING)||W(n,WebSocket.CLOSED))&&(e.advancedLog(c),ue(e.info(c)),se())}}),250),U=function(t,n){t.forEach((function(t){try{t(n)}catch(t){ue(e.error(\"Error executing callback\",t))}}))},q=function(e){if(null===e)return\"NULL\";switch(e.readyState){case WebSocket.CONNECTING:return\"CONNECTING\";case WebSocket.OPEN:return\"OPEN\";case WebSocket.CLOSING:return\"CLOSING\";case WebSocket.CLOSED:return\"CLOSED\";default:return\"UNDEFINED\"}},j=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\";ue(e.debug(\"[\"+t+\"] Primary WebSocket: \"+q(n.primary)+\" | Secondary WebSocket: \"+q(n.secondary)))},W=function(e,t){return e&&e.readyState===t},F=function(e){return W(e,WebSocket.OPEN)},B=function(e){return null===e||void 0===e.readyState||W(e,WebSocket.CLOSED)},z=function(){return null!==n.secondary?n.secondary:n.primary},H=function(){return F(z())},V=function(){if(o.pendingResponse)return e.advancedLog(l),ue(e.warn(l)),clearInterval(o.intervalHandle),o.pendingResponse=!1,void se();H()?(ue(e.debug(\"Sending heartbeat\")),z().send(ie(_)),o.pendingResponse=!0):(e.advancedLog(p),ue(e.warn(p)),j(\"sendHeartBeat\"),se())},G=function(){e.advancedLog(\"Reset Websocket state\"),r.exponentialBackOffTime=1e3,o.pendingResponse=!1,r.reconnectWebSocket=!0,clearTimeout(r.lifeTimeTimeoutHandle),clearInterval(o.intervalHandle),clearTimeout(r.exponentialTimeoutHandle),clearTimeout(r.webSocketInitCheckerTimeoutId)},K=function(){N.consecutiveFailedSubscribeAttempts=0,N.consecutiveNoResponseRequest=0,clearInterval(N.responseCheckIntervalId),clearInterval(N.reSubscribeIntervalId)},X=function(){i.connectWebSocketRetryCount=0,i.connectionAttemptStartTime=null,i.noOpenConnectionsTimestamp=null},J=function(){M.connected();try{e.advancedLog(d),ue(e.info(d)),j(\"webSocketOnOpen\"),null!==r.connState&&r.connState!==x||U(A.connectionGain),r.connState=\"connected\";var t=Date.now();U(A.connectionOpen,{connectWebSocketRetryCount:i.connectWebSocketRetryCount,connectionAttemptStartTime:i.connectionAttemptStartTime,noOpenConnectionsTimestamp:i.noOpenConnectionsTimestamp,connectionEstablishedTime:t,timeToConnect:t-i.connectionAttemptStartTime,timeWithoutConnection:i.noOpenConnectionsTimestamp?t-i.noOpenConnectionsTimestamp:null}),X(),G(),z().openTimestamp=Date.now(),0===O.subscribed.size&&F(n.secondary)&&te(n.primary,\"[Primary WebSocket] Closing WebSocket\"),(O.subscribed.size>0||O.pending.size>0)&&(F(n.secondary)&&ue(e.info(\"Subscribing secondary websocket to topics of primary websocket\")),O.subscribed.forEach((function(e){O.subscriptionHistory.add(e),O.pending.add(e)})),O.subscribed.clear(),Q()),V(),o.intervalHandle=setInterval(V,1e4);var s=1e3*R.connConfig.webSocketTransport.transportLifeTimeInSeconds;ue(e.debug(\"Scheduling WebSocket manager reconnection, after delay \"+s+\" ms\")),r.lifeTimeTimeoutHandle=setTimeout((function(){ue(e.debug(\"Starting scheduled WebSocket manager reconnection\")),se()}),s)}catch(t){ue(e.error(\"Error after establishing WebSocket connection\",t))}},Y=function(t){j(\"webSocketOnError\"),e.advancedLog(f,JSON.stringify(t)),ue(e.error(f,JSON.stringify(t))),M.getIsConnected()?se():M.retry()},$=function(t){var r=JSON.parse(t.data);switch(r.topic){case I:if(ue(e.debug(\"Subscription Message received from webSocket server\",t.data)),N.requestCompleted=!0,N.consecutiveNoResponseRequest=0,\"success\"===r.content.status)N.consecutiveFailedSubscribeAttempts=0,r.content.topics.forEach((function(e){O.subscriptionHistory.delete(e),O.pending.delete(e),O.subscribed.add(e)})),0===O.subscriptionHistory.size?F(n.secondary)&&(ue(e.info(\"Successfully subscribed secondary websocket to all topics of primary websocket\")),te(n.primary,\"[Primary WebSocket] Closing WebSocket\")):Q(),U(A.subscriptionUpdate,r);else{if(clearInterval(N.reSubscribeIntervalId),++N.consecutiveFailedSubscribeAttempts,5===N.consecutiveFailedSubscribeAttempts)return U(A.subscriptionFailure,r),void(N.consecutiveFailedSubscribeAttempts=0);N.reSubscribeIntervalId=setInterval((function(){Q()}),500)}break;case _:ue(e.debug(\"Heartbeat response received\")),o.pendingResponse=!1;break;default:if(r.topic){if(e.advancedLog(T,r.topic),ue(e.debug(T+r.topic)),F(n.primary)&&F(n.secondary)&&0===O.subscriptionHistory.size&&this===n.primary)return void ue(e.warn(\"Ignoring Message for Topic \"+r.topic+\", to avoid duplicates\"));if(0===A.allMessage.size&&0===A.topic.size)return void ue(e.warn(\"No registered callback listener for Topic\",r.topic));e.advancedLog(\"WebsocketManager invoke callbacks for topic success \",r.topic),U(A.allMessage,r),A.topic.has(r.topic)&&U(A.topic.get(r.topic),r)}else r.message?(e.advancedLog(C,r),ue(e.warn(C,r))):(e.advancedLog(k,r),ue(e.warn(k,r)))}},Q=function t(){if(N.consecutiveNoResponseRequest>3)return ue(e.warn(\"Ignoring subscribePendingTopics since we have exhausted max subscription retries with no response\")),void U(A.subscriptionFailure,L.getSubscriptionResponse(I,!1,Array.from(O.pending)));H()?0!==Array.from(O.pending).length&&(clearInterval(N.responseCheckIntervalId),z().send(ie(I,{topics:Array.from(O.pending)})),N.requestCompleted=!1,N.responseCheckIntervalId=setInterval((function(){N.requestCompleted||(++N.consecutiveNoResponseRequest,t())}),1e3)):ue(e.warn(\"Ignoring subscribePendingTopics call since Default WebSocket is not open\"))},te=function(t,n){W(t,WebSocket.CONNECTING)||W(t,WebSocket.OPEN)?t.close(1e3,n):ue(e.warn(\"Ignoring WebSocket Close request, WebSocket State: \"+q(t)))},ne=function(e){te(n.primary,\"[Primary] WebSocket \"+e),te(n.secondary,\"[Secondary] WebSocket \"+e)},re=function(t){G(),K(),e.advancedLog(v,t),ue(e.error(v)),r.websocketInitFailed=!0,ne(\"Terminating WebSocket Manager\"),clearInterval(D),U(A.initFailure,{connectWebSocketRetryCount:i.connectWebSocketRetryCount,connectionAttemptStartTime:i.connectionAttemptStartTime,reason:t}),X()},ie=function(e,t){return JSON.stringify({topic:e,content:t})},oe=function(t){return!!(L.isObject(t)&&L.isObject(t.webSocketTransport)&&L.isNonEmptyString(t.webSocketTransport.url)&&L.validWSUrl(t.webSocketTransport.url)&&1e3*t.webSocketTransport.transportLifeTimeInSeconds>=3e5)||(ue(e.error(\"Invalid WebSocket Connection Configuration\",t)),!1)},se=function(){if(!L.isNetworkOnline())return e.advancedLog(u),void ue(e.info(u));if(r.websocketInitFailed)ue(e.debug(\"WebSocket Init had failed, ignoring this getWebSocketConnConfig request\"));else{if(R.promiseCompleted)return G(),e.advancedLog(y),ue(e.info(y)),i.connectionAttemptStartTime=i.connectionAttemptStartTime||Date.now(),R.promiseCompleted=!1,R.promiseHandle=A.getWebSocketTransport(),R.promiseHandle.then((function(t){return R.promiseCompleted=!0,e.advancedLog(b),ue(e.debug(b,t)),oe(t)?(R.connConfig=t,R.connConfig.urlConnValidTime=Date.now()+85e3,ae()):(re(\"Invalid WebSocket connection configuration: \"+t),{webSocketConnectionFailed:!0})}),(function(t){return R.promiseCompleted=!0,e.advancedLog(w),ue(e.error(w,t)),L.isNetworkFailure(t)?(e.advancedLog(S+JSON.stringify(t)),ue(e.info(S+JSON.stringify(t))),M.retry()):re(\"Failed to fetch webSocket connection configuration: \"+JSON.stringify(t)),{webSocketConnectionFailed:!0}}));ue(e.debug(\"There is an ongoing getWebSocketConnConfig request, this request will be ignored\"))}},ae=function(){if(r.websocketInitFailed)return ue(e.info(\"web-socket initializing had failed, aborting re-init\")),{webSocketConnectionFailed:!0};if(!L.isNetworkOnline())return ue(e.warn(\"System is offline aborting web-socket init\")),{webSocketConnectionFailed:!0};e.advancedLog(E),ue(e.info(E)),j(\"initWebSocket\");try{if(oe(R.connConfig)){var t=null;return F(n.primary)?(ue(e.debug(\"Primary Socket connection is already open\")),W(n.secondary,WebSocket.CONNECTING)||(ue(e.debug(\"Establishing a secondary web-socket connection\")),M.numAttempts=0,n.secondary=ce()),t=n.secondary):(W(n.primary,WebSocket.CONNECTING)||(ue(e.debug(\"Establishing a primary web-socket connection\")),n.primary=ce()),t=n.primary),r.webSocketInitCheckerTimeoutId=setTimeout((function(){F(t)||function(){i.connectWebSocketRetryCount++;var t=L.addJitter(r.exponentialBackOffTime,.3);Date.now()+t<=R.connConfig.urlConnValidTime?(e.advancedLog(m),ue(e.debug(m+t+\" ms\")),r.exponentialTimeoutHandle=setTimeout((function(){return ae()}),t),r.exponentialBackOffTime*=2):(e.advancedLog(g),ue(e.warn(g)),se())}()}),1e3),{webSocketConnectionFailed:!1}}}catch(t){return ue(e.error(\"Error Initializing web-socket-manager\",t)),re(\"Failed to initialize new WebSocket: \"+t.message),{webSocketConnectionFailed:!0}}},ce=function(){var t=new WebSocket(R.connConfig.webSocketTransport.url);return t.addEventListener(\"open\",J),t.addEventListener(\"message\",$),t.addEventListener(\"error\",Y),t.addEventListener(\"close\",(function(o){return function(t,o){e.advancedLog(h,JSON.stringify(t)),ue(e.info(h,JSON.stringify(t))),j(\"webSocketOnClose before-cleanup\"),U(A.connectionClose,{openTimestamp:o.openTimestamp,closeTimestamp:Date.now(),connectionDuration:Date.now()-o.openTimestamp,code:t.code,reason:t.reason}),B(n.primary)&&(n.primary=null),B(n.secondary)&&(n.secondary=null),r.reconnectWebSocket&&(F(n.primary)||F(n.secondary)?B(n.primary)&&F(n.secondary)&&(ue(e.info(\"[Primary] WebSocket Cleanly Closed\")),n.primary=n.secondary,n.secondary=null):(ue(e.warn(\"Neither primary websocket and nor secondary websocket have open connections, attempting to re-establish connection\")),r.connState===x?ue(e.info(\"Ignoring connectionLost callback invocation\")):(U(A.connectionLost,{openTimestamp:o.openTimestamp,closeTimestamp:Date.now(),connectionDuration:Date.now()-o.openTimestamp,code:t.code,reason:t.reason}),i.noOpenConnectionsTimestamp=Date.now()),r.connState=x,se()),j(\"webSocketOnClose after-cleanup\"))}(o,t)})),t},ue=function(e){return e&&\"function\"==typeof e.sendInternalLogToServer&&e.sendInternalLogToServer(),e};this.init=function(t){if(L.assertTrue(L.isFunction(t),\"transportHandle must be a function\"),null===A.getWebSocketTransport)return A.getWebSocketTransport=t,se();ue(e.warn(\"Web Socket Manager was already initialized\"))},this.onInitFailure=function(t){return e.advancedLog(\"Initializing Websocket Manager Failure callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.initFailure.add(t),r.websocketInitFailed&&t(),function(){return A.initFailure.delete(t)}},this.onConnectionOpen=function(t){return e.advancedLog(\"Websocket connection open callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.connectionOpen.add(t),function(){return A.connectionOpen.delete(t)}},this.onConnectionClose=function(t){return e.advancedLog(\"Websocket connection close callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.connectionClose.add(t),function(){return A.connectionClose.delete(t)}},this.onConnectionGain=function(t){return e.advancedLog(\"Websocket connection gain callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.connectionGain.add(t),H()&&t(),function(){return A.connectionGain.delete(t)}},this.onConnectionLost=function(t){return e.advancedLog(\"Websocket connection lost callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.connectionLost.add(t),r.connState===x&&t(),function(){return A.connectionLost.delete(t)}},this.onSubscriptionUpdate=function(e){return L.assertTrue(L.isFunction(e),\"cb must be a function\"),A.subscriptionUpdate.add(e),function(){return A.subscriptionUpdate.delete(e)}},this.onSubscriptionFailure=function(t){return e.advancedLog(\"Websocket subscription failure callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.subscriptionFailure.add(t),function(){return A.subscriptionFailure.delete(t)}},this.onMessage=function(e,t){return L.assertNotNull(e,\"topicName\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.topic.has(e)?A.topic.get(e).add(t):A.topic.set(e,new Set([t])),function(){return A.topic.get(e).delete(t)}},this.onAllMessage=function(e){return L.assertTrue(L.isFunction(e),\"cb must be a function\"),A.allMessage.add(e),function(){return A.allMessage.delete(e)}},this.subscribeTopics=function(e){L.assertNotNull(e,\"topics\"),L.assertIsList(e),e.forEach((function(e){O.subscribed.has(e)||O.pending.add(e)})),N.consecutiveNoResponseRequest=0,Q()},this.sendMessage=function(t){if(L.assertIsObject(t,\"payload\"),void 0===t.topic||P.has(t.topic))ue(e.warn(\"Cannot send message, Invalid topic\",t));else{try{t=JSON.stringify(t)}catch(n){return void ue(e.warn(\"Error stringify message\",t))}H()?z().send(t):ue(e.warn(\"Cannot send message, web socket connection is not open\"))}},this.closeWebSocket=function(){G(),K(),r.reconnectWebSocket=!1,clearInterval(D),ne(\"User request to close WebSocket\")},this.terminateWebSocketManager=re},ne={create:function(e){return ee||(ee=new J(e)),ee.hasLogMetaData()||ee.setLogMetaData(e),e||console.info(\"********Missing metaData for logs from websocketManager: initialize websocketManager using create(metaData)*******\"),new te},setGlobalConfig:function(e){var t=e&&e.loggerConfig;ee||(ee=new J),ee.updateLoggerConfig(t)},LogLevel:X,Logger:G}},function(e,t,n){var r;!function(){var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\\x25]+/,modulo:/^\\x25{2}/,placeholder:/^\\x25(?:([1-9]\\d*)\\$|\\(([^)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\\d]*)/i,key_access:/^\\.([a-z_][a-z_\\d]*)/i,index_access:/^\\[(\\d+)\\]/,sign:/^[+-]/};function o(e){return a(u(e),arguments)}function s(e,t){return o.apply(null,[e].concat(t||[]))}function a(e,t){var n,r,s,a,c,u,l,p,d,h=1,f=e.length,m=\"\";for(r=0;r<f;r++)if(\"string\"==typeof e[r])m+=e[r];else if(\"object\"==typeof e[r]){if((a=e[r]).keys)for(n=t[h],s=0;s<a.keys.length;s++){if(null==n)throw new Error(o('[sprintf] Cannot access property \"%s\" of undefined value \"%s\"',a.keys[s],a.keys[s-1]));n=n[a.keys[s]]}else n=a.param_no?t[a.param_no]:t[h++];if(i.not_type.test(a.type)&&i.not_primitive.test(a.type)&&n instanceof Function&&(n=n()),i.numeric_arg.test(a.type)&&\"number\"!=typeof n&&isNaN(n))throw new TypeError(o(\"[sprintf] expecting number but found %T\",n));switch(i.number.test(a.type)&&(p=n>=0),a.type){case\"b\":n=parseInt(n,10).toString(2);break;case\"c\":n=String.fromCharCode(parseInt(n,10));break;case\"d\":case\"i\":n=parseInt(n,10);break;case\"j\":n=JSON.stringify(n,null,a.width?parseInt(a.width):0);break;case\"e\":n=a.precision?parseFloat(n).toExponential(a.precision):parseFloat(n).toExponential();break;case\"f\":n=a.precision?parseFloat(n).toFixed(a.precision):parseFloat(n);break;case\"g\":n=a.precision?String(Number(n.toPrecision(a.precision))):parseFloat(n);break;case\"o\":n=(parseInt(n,10)>>>0).toString(8);break;case\"s\":n=String(n),n=a.precision?n.substring(0,a.precision):n;break;case\"t\":n=String(!!n),n=a.precision?n.substring(0,a.precision):n;break;case\"T\":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=a.precision?n.substring(0,a.precision):n;break;case\"u\":n=parseInt(n,10)>>>0;break;case\"v\":n=n.valueOf(),n=a.precision?n.substring(0,a.precision):n;break;case\"x\":n=(parseInt(n,10)>>>0).toString(16);break;case\"X\":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}i.json.test(a.type)?m+=n:(!i.number.test(a.type)||p&&!a.sign?d=\"\":(d=p?\"+\":\"-\",n=n.toString().replace(i.sign,\"\")),u=a.pad_char?\"0\"===a.pad_char?\"0\":a.pad_char.charAt(1):\" \",l=a.width-(d+n).length,c=a.width&&l>0?u.repeat(l):\"\",m+=a.align?d+n+c:\"0\"===u?d+c+n:c+d+n)}return m}var c=Object.create(null);function u(e){if(c[e])return c[e];for(var t,n=e,r=[],o=0;n;){if(null!==(t=i.text.exec(n)))r.push(t[0]);else if(null!==(t=i.modulo.exec(n)))r.push(\"%\");else{if(null===(t=i.placeholder.exec(n)))throw new SyntaxError(\"[sprintf] unexpected placeholder\");if(t[2]){o|=1;var s=[],a=t[2],u=[];if(null===(u=i.key.exec(a)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");for(s.push(u[1]);\"\"!==(a=a.substring(u[0].length));)if(null!==(u=i.key_access.exec(a)))s.push(u[1]);else{if(null===(u=i.index_access.exec(a)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");s.push(u[1])}t[2]=s}else o|=2;if(3===o)throw new Error(\"[sprintf] mixing positional and named placeholders is not (yet) supported\");r.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return c[e]=r}t.sprintf=o,t.vsprintf=s,\"undefined\"!=typeof window&&(window.sprintf=o,window.vsprintf=s,void 0===(r=function(){return{sprintf:o,vsprintf:s}}.call(t,n,t,e))||(e.exports=r))}()},function(e,t,n){var r=n(11);e.exports=function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(0).default,i=n(12);e.exports=function(e,t){if(t&&(\"object\"===r(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){n.r(t),function(e){n.d(t,\"WebSocketManager\",(function(){return i}));var r=n(4);e.connect=e.connect||{},connect.WebSocketManager=r.a;var i=r.a}.call(this,n(10))},function(e,t){var n;n=function(){return this}();try{n=n||new Function(\"return this\")()}catch(e){\"object\"==typeof window&&(n=window)}e.exports=n},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t,r)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e},e.exports.__esModule=!0,e.exports.default=e.exports}]);var Z=connect.WebSocketManager;connect.WebSocketManager=Q||Z;const ee=Z;class te extends class{constructor(e,t){this.connectionDetailsProvider=e,this.isStarted=!1,this.logger=I.getLogger({prefix:\"ChatJS-BaseConnectionHelper\",logMetaData:t})}startConnectionTokenPolling(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:432e5;arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(this.logger.info(\"First time polling connection token.\"),this.timeout=setTimeout(this.startConnectionTokenPolling.bind(this),e)):this.connectionDetailsProvider.fetchConnectionToken().then((()=>{this.logger.info(\"Connection token polling succeeded.\"),e=this.getTimeToConnectionTokenExpiry(),this.timeout=setTimeout(this.startConnectionTokenPolling.bind(this),e)})).catch((t=>{this.logger.error(\"An error occurred when attempting to fetch the connection token during Connection Token Polling\",t),this.timeout=setTimeout(this.startConnectionTokenPolling.bind(this),e)}))}start(){this.isStarted||(this.isStarted=!0,this.startConnectionTokenPolling(!0,this.getTimeToConnectionTokenExpiry()))}end(){clearTimeout(this.timeout)}getConnectionToken(){return this.connectionDetailsProvider.getFetchedConnectionToken()}getConnectionTokenExpiry(){return this.connectionDetailsProvider.getConnectionTokenExpiry()}getTimeToConnectionTokenExpiry(){return new Date(this.getConnectionTokenExpiry()).getTime()-(new Date).getTime()-6e4}}{constructor(e,t,n,r,i){super(n,i),this.customerConnection=!r,this.customerConnection?(te.customerBaseInstances[e]||(te.customerBaseInstances[e]=new ne(n,void 0,i)),this.baseInstance=te.customerBaseInstances[e]):(te.agentBaseInstance&&te.agentBaseInstance.getWebsocketManager()!==r&&(te.agentBaseInstance.end(),te.agentBaseInstance=null),te.agentBaseInstance||(te.agentBaseInstance=new ne(void 0,r,i)),this.baseInstance=te.agentBaseInstance),this.contactId=e,this.initialContactId=t,this.status=null,this.eventBus=new X,this.subscriptions=[this.baseInstance.onEnded(this.handleEnded.bind(this)),this.baseInstance.onConnectionGain(this.handleConnectionGain.bind(this)),this.baseInstance.onConnectionLost(this.handleConnectionLost.bind(this)),this.baseInstance.onMessage(this.handleMessage.bind(this))]}start(){return super.start(),this.baseInstance.start()}end(){super.end(),this.eventBus.unsubscribeAll(),this.subscriptions.forEach((e=>e())),this.status=W,this.tryCleanup()}tryCleanup(){this.customerConnection&&!this.baseInstance.hasMessageSubscribers()&&(this.baseInstance.end(),delete te.customerBaseInstances[this.contactId])}getStatus(){return this.status||this.baseInstance.getStatus()}onEnded(e){return this.eventBus.subscribe(z,e)}handleEnded(){this.eventBus.trigger(z,{})}onConnectionGain(e){return this.eventBus.subscribe(B,e)}handleConnectionGain(){this.eventBus.trigger(B,{})}onConnectionLost(e){return this.eventBus.subscribe(F,e)}handleConnectionLost(){this.eventBus.trigger(F,{})}onMessage(e){return this.eventBus.subscribe(H,e)}handleMessage(e){e.InitialContactId!==this.initialContactId&&e.ContactId!==this.contactId||this.eventBus.trigger(H,e)}}te.customerBaseInstances={},te.agentBaseInstance=null;class ne{constructor(e,t,n){this.status=D,this.eventBus=new X,this.logger=I.getLogger({prefix:\"ChatJS-LPCConnectionHelperBase\",logMetaData:n}),this.initWebsocketManager(t,e,n)}initWebsocketManager(e,t,n){if(this.websocketManager=e||ee.create(n),this.websocketManager.subscribeTopics([\"aws/chat\"]),this.subscriptions=[this.websocketManager.onMessage(\"aws/chat\",this.handleMessage.bind(this)),this.websocketManager.onConnectionGain(this.handleConnectionGain.bind(this)),this.websocketManager.onConnectionLost(this.handleConnectionLost.bind(this)),this.websocketManager.onInitFailure(this.handleEnded.bind(this))],this.logger.info(\"Initializing websocket manager.\"),!e){var r=(new Date).getTime();this.websocketManager.init((()=>t.fetchConnectionDetails().then((e=>{var t={webSocketTransport:{url:e.url,expiry:e.expiry,transportLifeTimeInSeconds:S}},n={expiry:e.expiry,transportLifeTimeInSeconds:S};return this.logger.debug(\"Websocket manager initialized. Connection details:\",n),Y.addLatencyMetricWithStartTime(f,r,s),Y.addCountAndErrorMetric(f,s,!1),t})).catch((e=>{throw this.logger.error(\"Initializing Websocket Manager failed:\",e),Y.addLatencyMetricWithStartTime(f,r,s),Y.addCountAndErrorMetric(f,s,!0),e}))))}}end(){this.websocketManager.closeWebSocket&&this.websocketManager.closeWebSocket(),this.eventBus.unsubscribeAll(),this.subscriptions.forEach((e=>e())),this.logger.info(\"Websocket closed. All event subscriptions are cleared.\")}start(){return this.status===D&&(this.status=U),Promise.resolve()}onEnded(e){return this.eventBus.subscribe(z,e)}handleEnded(){this.status=W,this.eventBus.trigger(z,{}),this.logger.info(\"Websocket connection ended.\"),Y.addCountMetric(\"WebsocketEnded\",s)}onConnectionGain(e){return this.eventBus.subscribe(B,e)}handleConnectionGain(){this.status=q,this.eventBus.trigger(B,{}),this.logger.info(\"Websocket connection gained.\"),Y.addCountMetric(\"WebsocketConnectionGained\",s)}onConnectionLost(e){return this.eventBus.subscribe(F,e)}handleConnectionLost(){this.status=j,this.eventBus.trigger(F,{}),this.logger.info(\"Websocket connection lost.\"),Y.addCountMetric(\"WebsocketConnectionLost\",s)}onMessage(e){return this.eventBus.subscribe(H,e)}handleMessage(e){var t;try{t=JSON.parse(e.content),this.eventBus.trigger(H,t),this.logger.info(\"Websocket incoming message\",{messageId:t.Id,contentType:t.ContentType}),Y.addCountMetric(\"WebsocketIncomingMessage\",s)}catch(e){this._sendInternalLogToServer(this.logger.error(\"Wrong message format\"))}}getStatus(){return this.status}getWebsocketManager(){return this.websocketManager}hasMessageSubscribers(){return this.eventBus.getSubscriptions(H).length>0}_sendInternalLogToServer(e){return e&&\"function\"==typeof e.sendInternalLogToServer&&e.sendInternalLogToServer(),e}}const re=te;class ie{constructor(e){this.argsValidator=new P,this.pubsub=new X,this.sessionType=e.sessionType,this.getConnectionToken=e.chatDetails.getConnectionToken,this.connectionDetails=e.chatDetails.connectionDetails,this.initialContactId=e.chatDetails.initialContactId,this.contactId=e.chatDetails.contactId,this.participantId=e.chatDetails.participantId,this.chatClient=e.chatClient,this.participantToken=e.chatDetails.participantToken,this.websocketManager=e.websocketManager,this._participantDisconnected=!1,this.sessionMetadata={},this.logger=I.getLogger({prefix:\"ChatJS-ChatController\",logMetaData:e.logMetaData}),this.logMetaData=e.logMetaData,this.logger.info(\"Browser info:\",window.navigator.userAgent)}subscribe(e,t){this.pubsub.subscribe(e,t),this._sendInternalLogToServer(this.logger.info(\"Subscribed successfully to event:\",e))}handleRequestSuccess(e,t,n,r){return i=>this.handleResponse(e,t,n,r,i,!1)}handleRequestFailure(e,t,n,r){return i=>this.handleResponse(e,t,n,r,i,!0)}handleResponse(e,t,n,r,i,o){var a=r?[{name:\"ContentType\",value:r}]:[];return Y.addLatencyMetricWithStartTime(t,n,s,a),Y.addCountAndErrorMetric(t,s,o,a),i.metadata=e,o?Promise.reject(i):i}sendMessage(e){var t=(new Date).getTime(),n=e.metadata||null;this.argsValidator.validateSendMessage(e);var r=this.connectionHelper.getConnectionToken();return this.chatClient.sendMessage(r,e.message,e.contentType).then(this.handleRequestSuccess(n,a,t,e.contentType)).catch(this.handleRequestFailure(n,a,t,e.contentType))}sendAttachment(e){var t=(new Date).getTime(),n=e.metadata||null,r=this.connectionHelper.getConnectionToken();return this.chatClient.sendAttachment(r,e.attachment,e.metadata).then(this.handleRequestSuccess(n,c,t,e.attachment.type)).catch(this.handleRequestFailure(n,c,t,e.attachment.type))}downloadAttachment(e){var t=(new Date).getTime(),n=e.metadata||null,r=this.connectionHelper.getConnectionToken();return this.chatClient.downloadAttachment(r,e.attachmentId).then(this.handleRequestSuccess(n,u,t)).catch(this.handleRequestFailure(n,u,t))}sendEvent(e){var t=(new Date).getTime(),n=e.metadata||null;this.argsValidator.validateSendEvent(e);var r=this.connectionHelper.getConnectionToken(),i=e.content||null;return this.chatClient.sendEvent(r,e.contentType,i).then(this.handleRequestSuccess(n,l,t,e.contentType)).catch(this.handleRequestFailure(n,l,t,e.contentType))}getTranscript(e){var t=(new Date).getTime(),n=e.metadata||null,r={startPosition:e.startPosition||{},scanDirection:e.scanDirection||\"BACKWARD\",sortOrder:e.sortOrder||\"ASCENDING\",maxResults:e.maxResults||15};e.nextToken&&(r.nextToken=e.nextToken),e.contactId&&(r.contactId=e.contactId);var i=this.connectionHelper.getConnectionToken();return this.chatClient.getTranscript(i,r).then(this.handleRequestSuccess(n,p,t)).catch(this.handleRequestFailure(n,p,t))}connect(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionMetadata=e.metadata||null,this.argsValidator.validateConnectChat(e);var t=this._getConnectionDetailsProvider();return t.fetchConnectionToken().then(this._initConnectionHelper.bind(this,t)).then(this._onConnectSuccess.bind(this),this._onConnectFailure.bind(this))}_initConnectionHelper(e){return this.connectionHelper=new re(this.contactId,this.initialContactId,e,this.websocketManager,this.logMetaData),this.connectionHelper.onEnded(this._handleEndedConnection.bind(this)),this.connectionHelper.onConnectionLost(this._handleLostConnection.bind(this)),this.connectionHelper.onConnectionGain(this._handleGainedConnection.bind(this)),this.connectionHelper.onMessage(this._handleIncomingMessage.bind(this)),this.connectionHelper.start()}_getConnectionDetailsProvider(){return new $(this.participantToken,this.chatClient,this.sessionType,this.getConnectionToken)}_handleEndedConnection(e){this._forwardChatEvent(y,{data:e,chatDetails:this.getChatDetails()}),this.breakConnection()}_handleLostConnection(e){this._forwardChatEvent(\"CONNECTION_LOST\",{data:e,chatDetails:this.getChatDetails()})}_handleGainedConnection(e){this._forwardChatEvent(v,{data:e,chatDetails:this.getChatDetails()})}_handleIncomingMessage(e){try{var t=e.ContentType===w.typing?g:m;this._forwardChatEvent(t,{data:e,chatDetails:this.getChatDetails()}),e.ContentType===w.chatEnded&&(this._forwardChatEvent(b,{data:null,chatDetails:this.getChatDetails()}),this.breakConnection())}catch(t){this._sendInternalLogToServer(this.logger.error(\"Error occured while handling message from Connection. eventData:\",e,\" Causing exception:\",t))}}_forwardChatEvent(e,t){this.pubsub.triggerAsync(e,t)}_onConnectSuccess(e){this._sendInternalLogToServer(this.logger.info(\"Connect successful!\"));var t={_debug:e,connectSuccess:!0,connectCalled:!0,metadata:this.sessionMetadata},n=Object.assign({chatDetails:this.getChatDetails()},t);return this.pubsub.triggerAsync(v,n),this._shouldAcknowledgeContact()&&this.sendEvent({contentType:w.connectionAcknowledged}),t}_onConnectFailure(e){var t={_debug:e,connectSuccess:!1,connectCalled:!0,metadata:this.sessionMetadata};return this._sendInternalLogToServer(this.logger.error(\"Connect Failed. Error: \",t)),Promise.reject(t)}_shouldAcknowledgeContact(){return this.sessionType===o.AGENT}breakConnection(){return this.connectionHelper?this.connectionHelper.end():Promise.resolve()}cleanUpOnParticipantDisconnect(){this.pubsub.unsubscribeAll()}disconnectParticipant(){var e=(new Date).getTime(),t=this.connectionHelper.getConnectionToken();return this.chatClient.disconnectParticipant(t).then((t=>(this._sendInternalLogToServer(this.logger.info(\"Disconnect participant successfully\")),this._participantDisconnected=!0,this.cleanUpOnParticipantDisconnect(),this.breakConnection(),Y.addLatencyMetricWithStartTime(d,e,s),Y.addCountAndErrorMetric(d,s,!1),t)),(t=>(Y.addLatencyMetricWithStartTime(d,e,s),Y.addCountAndErrorMetric(d,s,!0),this._sendInternalLogToServer(this.logger.error(\"Disconnect participant failed. Error:\",t)),Promise.reject(t))))}getChatDetails(){return{initialContactId:this.initialContactId,contactId:this.contactId,participantId:this.participantId,participantToken:this.participantToken,connectionDetails:this.connectionDetails}}_convertConnectionHelperStatus(e){switch(e){case D:return\"NeverEstablished\";case U:return\"Establishing\";case W:case j:return\"Broken\";case q:return\"Established\"}this._sendInternalLogToServer(this.logger.error(\"Reached invalid state. Unknown connectionHelperStatus: \",e))}getConnectionStatus(){return this._convertConnectionHelperStatus(this.connectionHelper.getStatus())}_sendInternalLogToServer(e){return e&&\"function\"==typeof e.sendInternalLogToServer&&e.sendInternalLogToServer(),e}}class oe{constructor(e){this.controller=e,Y.addCountMetric(\"StartChatSession\",\"UI\")}onMessage(e){this.controller.subscribe(m,e)}onTyping(e){this.controller.subscribe(g,e)}onConnectionBroken(e){this.controller.subscribe(y,e)}onConnectionEstablished(e){this.controller.subscribe(v,e)}onEnded(e){this.controller.subscribe(b,e)}sendMessage(e){return this.controller.sendMessage(e)}sendAttachment(e){return this.controller.sendAttachment(e)}downloadAttachment(e){return this.controller.downloadAttachment(e)}connect(e){return this.controller.connect(e)}sendEvent(e){return this.controller.sendEvent(e)}getTranscript(e){return this.controller.getTranscript(e)}getChatDetails(){return this.controller.getChatDetails()}}class se extends oe{constructor(e){super(e)}cleanUpOnParticipantDisconnect(){return this.controller.cleanUpOnParticipantDisconnect()}}class ae extends oe{constructor(e){super(e)}disconnectParticipant(){return this.controller.disconnectParticipant()}}var ce=new class extends class{createAgentChatController(e,n){throw new t(\"createAgentChatController in ChatControllerFactory.\")}createCustomerChatController(e,n){throw new t(\"createCustomerChatController in ChatControllerFactory.\")}}{constructor(){super(),this.argsValidator=new P}createChatSession(e,t,n,i){var s=this._createChatController(e,t,n,i);if(e===o.AGENT)return new se(s);if(e===o.CUSTOMER)return new ae(s);throw new r(\"Unkown value for session type, Allowed values are: \"+Object.values(o),e)}_createChatController(e,t,n,r){var i=this.argsValidator.normalizeChatDetails(t),o={contactId:i.contactId,participantId:i.participantId,sessionType:e},s=M.getCachedClient(n,o);return new ie({sessionType:e,chatDetails:i,chatClient:s,websocketManager:r,logMetaData:o})}},ue={create:e=>{var t=e.options||{},n=e.type||o.AGENT;return i.updateStageRegion(t),e.disableCSM||n!==o.CUSTOMER||Y.initializeCSM(),ce.createChatSession(n,e.chatDetails,t,e.websocketManager)},setGlobalConfig:e=>{var t=e.loggerConfig,n=e.csmConfig;ee.setGlobalConfig(e),i.update(e),I.updateLoggerConfig(t),n&&Y.updateCsmConfig(n)},LogLevel:k,Logger:class{debug(e){}info(e){}warn(e){}error(e){}advancedLog(e){}},SessionTypes:o,csmService:Y};n.g.connect=n.g.connect||{},connect.ChatSession=ue,connect.LogManager=I,connect.LogLevel=k,connect.csmService=ue.csmService})()})();\n//# sourceMappingURL=amazon-connect-chat.js.map"
            }
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "17f5b2ec49610500:1",
        "primaryLocationStartColumnFingerprint" : "227426"
      }
    }, {
      "ruleId" : "js/incomplete-sanitization",
      "rule" : {
        "id" : "js/incomplete-sanitization",
        "index" : 39,
        "toolComponent" : {
          "index" : 4
        }
      },
      "message" : {
        "text" : "This replaces only the first occurrence of \"#\"."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "dist/amazon-connect-chat.js",
            "uriBaseId" : "%SRCROOT%",
            "index" : 1
          },
          "region" : {
            "startLine" : 1,
            "startColumn" : 228084,
            "endColumn" : 228093
          },
          "contextRegion" : {
            "startLine" : 1,
            "endLine" : 2,
            "snippet" : {
              "text" : "(()=>{var e={228:(e,t,n)=>{var r;!function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){if(o)return o(s,!0);var c=new Error(\"Cannot find module '\"+s+\"'\");throw c.code=\"MODULE_NOT_FOUND\",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,(function(e){return i(t[s][1][e]||e)}),u,u.exports,e,t,n,r)}return n[s].exports}for(var o=void 0,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){t.exports={version:\"2.0\",metadata:{apiVersion:\"2014-06-30\",endpointPrefix:\"cognito-identity\",jsonVersion:\"1.1\",protocol:\"json\",serviceFullName:\"Amazon Cognito Identity\",serviceId:\"Cognito Identity\",signatureVersion:\"v4\",targetPrefix:\"AWSCognitoIdentityService\",uid:\"cognito-identity-2014-06-30\"},operations:{CreateIdentityPool:{input:{type:\"structure\",required:[\"IdentityPoolName\",\"AllowUnauthenticatedIdentities\"],members:{IdentityPoolName:{},AllowUnauthenticatedIdentities:{type:\"boolean\"},AllowClassicFlow:{type:\"boolean\"},SupportedLoginProviders:{shape:\"S5\"},DeveloperProviderName:{},OpenIdConnectProviderARNs:{shape:\"S9\"},CognitoIdentityProviders:{shape:\"Sb\"},SamlProviderARNs:{shape:\"Sg\"},IdentityPoolTags:{shape:\"Sh\"}}},output:{shape:\"Sk\"}},DeleteIdentities:{input:{type:\"structure\",required:[\"IdentityIdsToDelete\"],members:{IdentityIdsToDelete:{type:\"list\",member:{}}}},output:{type:\"structure\",members:{UnprocessedIdentityIds:{type:\"list\",member:{type:\"structure\",members:{IdentityId:{},ErrorCode:{}}}}}}},DeleteIdentityPool:{input:{type:\"structure\",required:[\"IdentityPoolId\"],members:{IdentityPoolId:{}}}},DescribeIdentity:{input:{type:\"structure\",required:[\"IdentityId\"],members:{IdentityId:{}}},output:{shape:\"Sv\"}},DescribeIdentityPool:{input:{type:\"structure\",required:[\"IdentityPoolId\"],members:{IdentityPoolId:{}}},output:{shape:\"Sk\"}},GetCredentialsForIdentity:{input:{type:\"structure\",required:[\"IdentityId\"],members:{IdentityId:{},Logins:{shape:\"S10\"},CustomRoleArn:{}}},output:{type:\"structure\",members:{IdentityId:{},Credentials:{type:\"structure\",members:{AccessKeyId:{},SecretKey:{},SessionToken:{},Expiration:{type:\"timestamp\"}}}}}},GetId:{input:{type:\"structure\",required:[\"IdentityPoolId\"],members:{AccountId:{},IdentityPoolId:{},Logins:{shape:\"S10\"}}},output:{type:\"structure\",members:{IdentityId:{}}}},GetIdentityPoolRoles:{input:{type:\"structure\",required:[\"IdentityPoolId\"],members:{IdentityPoolId:{}}},output:{type:\"structure\",members:{IdentityPoolId:{},Roles:{shape:\"S1c\"},RoleMappings:{shape:\"S1e\"}}}},GetOpenIdToken:{input:{type:\"structure\",required:[\"IdentityId\"],members:{IdentityId:{},Logins:{shape:\"S10\"}}},output:{type:\"structure\",members:{IdentityId:{},Token:{}}}},GetOpenIdTokenForDeveloperIdentity:{input:{type:\"structure\",required:[\"IdentityPoolId\",\"Logins\"],members:{IdentityPoolId:{},IdentityId:{},Logins:{shape:\"S10\"},TokenDuration:{type:\"long\"}}},output:{type:\"structure\",members:{IdentityId:{},Token:{}}}},ListIdentities:{input:{type:\"structure\",required:[\"IdentityPoolId\",\"MaxResults\"],members:{IdentityPoolId:{},MaxResults:{type:\"integer\"},NextToken:{},HideDisabled:{type:\"boolean\"}}},output:{type:\"structure\",members:{IdentityPoolId:{},Identities:{type:\"list\",member:{shape:\"Sv\"}},NextToken:{}}}},ListIdentityPools:{input:{type:\"structure\",required:[\"MaxResults\"],members:{MaxResults:{type:\"integer\"},NextToken:{}}},output:{type:\"structure\",members:{IdentityPools:{type:\"list\",member:{type:\"structure\",members:{IdentityPoolId:{},IdentityPoolName:{}}}},NextToken:{}}}},ListTagsForResource:{input:{type:\"structure\",required:[\"ResourceArn\"],members:{ResourceArn:{}}},output:{type:\"structure\",members:{Tags:{shape:\"Sh\"}}}},LookupDeveloperIdentity:{input:{type:\"structure\",required:[\"IdentityPoolId\"],members:{IdentityPoolId:{},IdentityId:{},DeveloperUserIdentifier:{},MaxResults:{type:\"integer\"},NextToken:{}}},output:{type:\"structure\",members:{IdentityId:{},DeveloperUserIdentifierList:{type:\"list\",member:{}},NextToken:{}}}},MergeDeveloperIdentities:{input:{type:\"structure\",required:[\"SourceUserIdentifier\",\"DestinationUserIdentifier\",\"DeveloperProviderName\",\"IdentityPoolId\"],members:{SourceUserIdentifier:{},DestinationUserIdentifier:{},DeveloperProviderName:{},IdentityPoolId:{}}},output:{type:\"structure\",members:{IdentityId:{}}}},SetIdentityPoolRoles:{input:{type:\"structure\",required:[\"IdentityPoolId\",\"Roles\"],members:{IdentityPoolId:{},Roles:{shape:\"S1c\"},RoleMappings:{shape:\"S1e\"}}}},TagResource:{input:{type:\"structure\",required:[\"ResourceArn\",\"Tags\"],members:{ResourceArn:{},Tags:{shape:\"Sh\"}}},output:{type:\"structure\",members:{}}},UnlinkDeveloperIdentity:{input:{type:\"structure\",required:[\"IdentityId\",\"IdentityPoolId\",\"DeveloperProviderName\",\"DeveloperUserIdentifier\"],members:{IdentityId:{},IdentityPoolId:{},DeveloperProviderName:{},DeveloperUserIdentifier:{}}}},UnlinkIdentity:{input:{type:\"structure\",required:[\"IdentityId\",\"Logins\",\"LoginsToRemove\"],members:{IdentityId:{},Logins:{shape:\"S10\"},LoginsToRemove:{shape:\"Sw\"}}}},UntagResource:{input:{type:\"structure\",required:[\"ResourceArn\",\"TagKeys\"],members:{ResourceArn:{},TagKeys:{type:\"list\",member:{}}}},output:{type:\"structure\",members:{}}},UpdateIdentityPool:{input:{shape:\"Sk\"},output:{shape:\"Sk\"}}},shapes:{S5:{type:\"map\",key:{},value:{}},S9:{type:\"list\",member:{}},Sb:{type:\"list\",member:{type:\"structure\",members:{ProviderName:{},ClientId:{},ServerSideTokenCheck:{type:\"boolean\"}}}},Sg:{type:\"list\",member:{}},Sh:{type:\"map\",key:{},value:{}},Sk:{type:\"structure\",required:[\"IdentityPoolId\",\"IdentityPoolName\",\"AllowUnauthenticatedIdentities\"],members:{IdentityPoolId:{},IdentityPoolName:{},AllowUnauthenticatedIdentities:{type:\"boolean\"},AllowClassicFlow:{type:\"boolean\"},SupportedLoginProviders:{shape:\"S5\"},DeveloperProviderName:{},OpenIdConnectProviderARNs:{shape:\"S9\"},CognitoIdentityProviders:{shape:\"Sb\"},SamlProviderARNs:{shape:\"Sg\"},IdentityPoolTags:{shape:\"Sh\"}}},Sv:{type:\"structure\",members:{IdentityId:{},Logins:{shape:\"Sw\"},CreationDate:{type:\"timestamp\"},LastModifiedDate:{type:\"timestamp\"}}},Sw:{type:\"list\",member:{}},S10:{type:\"map\",key:{},value:{}},S1c:{type:\"map\",key:{},value:{}},S1e:{type:\"map\",key:{},value:{type:\"structure\",required:[\"Type\"],members:{Type:{},AmbiguousRoleResolution:{},RulesConfiguration:{type:\"structure\",required:[\"Rules\"],members:{Rules:{type:\"list\",member:{type:\"structure\",required:[\"Claim\",\"MatchType\",\"Value\",\"RoleARN\"],members:{Claim:{},MatchType:{},Value:{},RoleARN:{}}}}}}}}}}}},{}],2:[function(e,t,n){t.exports={pagination:{}}},{}],3:[function(e,t,n){t.exports={version:\"2.0\",metadata:{apiVersion:\"2018-09-07\",endpointPrefix:\"participant.connect\",jsonVersion:\"1.1\",protocol:\"rest-json\",serviceAbbreviation:\"Amazon Connect Participant\",serviceFullName:\"Amazon Connect Participant Service\",serviceId:\"ConnectParticipant\",signatureVersion:\"v4\",signingName:\"execute-api\",uid:\"connectparticipant-2018-09-07\"},operations:{CompleteAttachmentUpload:{http:{requestUri:\"/participant/complete-attachment-upload\"},input:{type:\"structure\",required:[\"AttachmentIds\",\"ClientToken\",\"ConnectionToken\"],members:{AttachmentIds:{type:\"list\",member:{}},ClientToken:{idempotencyToken:!0},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{}}},CreateParticipantConnection:{http:{requestUri:\"/participant/connection\"},input:{type:\"structure\",required:[\"Type\",\"ParticipantToken\"],members:{Type:{type:\"list\",member:{}},ParticipantToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{Websocket:{type:\"structure\",members:{Url:{},ConnectionExpiry:{}}},ConnectionCredentials:{type:\"structure\",members:{ConnectionToken:{},Expiry:{}}}}}},DisconnectParticipant:{http:{requestUri:\"/participant/disconnect\"},input:{type:\"structure\",required:[\"ConnectionToken\"],members:{ClientToken:{idempotencyToken:!0},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{}}},GetAttachment:{http:{requestUri:\"/participant/attachment\"},input:{type:\"structure\",required:[\"AttachmentId\",\"ConnectionToken\"],members:{AttachmentId:{},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{Url:{},UrlExpiry:{}}}},GetTranscript:{http:{requestUri:\"/participant/transcript\"},input:{type:\"structure\",required:[\"ConnectionToken\"],members:{ContactId:{},MaxResults:{type:\"integer\"},NextToken:{},ScanDirection:{},SortOrder:{},StartPosition:{type:\"structure\",members:{Id:{},AbsoluteTime:{},MostRecent:{type:\"integer\"}}},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{InitialContactId:{},Transcript:{type:\"list\",member:{type:\"structure\",members:{AbsoluteTime:{},Content:{},ContentType:{},Id:{},Type:{},ParticipantId:{},DisplayName:{},ParticipantRole:{},Attachments:{type:\"list\",member:{type:\"structure\",members:{ContentType:{},AttachmentId:{},AttachmentName:{},Status:{}}}}}}},NextToken:{}}}},SendEvent:{http:{requestUri:\"/participant/event\"},input:{type:\"structure\",required:[\"ContentType\",\"ConnectionToken\"],members:{ContentType:{},Content:{},ClientToken:{idempotencyToken:!0},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{Id:{},AbsoluteTime:{}}}},SendMessage:{http:{requestUri:\"/participant/message\"},input:{type:\"structure\",required:[\"ContentType\",\"Content\",\"ConnectionToken\"],members:{ContentType:{},Content:{},ClientToken:{idempotencyToken:!0},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{Id:{},AbsoluteTime:{}}}},StartAttachmentUpload:{http:{requestUri:\"/participant/start-attachment-upload\"},input:{type:\"structure\",required:[\"ContentType\",\"AttachmentSizeInBytes\",\"AttachmentName\",\"ClientToken\",\"ConnectionToken\"],members:{ContentType:{},AttachmentSizeInBytes:{type:\"long\"},AttachmentName:{},ClientToken:{idempotencyToken:!0},ConnectionToken:{location:\"header\",locationName:\"X-Amz-Bearer\"}}},output:{type:\"structure\",members:{AttachmentId:{},UploadMetadata:{type:\"structure\",members:{Url:{},UrlExpiry:{},HeadersToInclude:{type:\"map\",key:{},value:{}}}}}}}},shapes:{}}},{}],4:[function(e,t,n){t.exports={pagination:{GetTranscript:{input_token:\"NextToken\",output_token:\"NextToken\",limit_key:\"MaxResults\"}}}},{}],5:[function(e,t,n){t.exports={acm:{name:\"ACM\",cors:!0},apigateway:{name:\"APIGateway\",cors:!0},applicationautoscaling:{prefix:\"application-autoscaling\",name:\"ApplicationAutoScaling\",cors:!0},appstream:{name:\"AppStream\"},autoscaling:{name:\"AutoScaling\",cors:!0},batch:{name:\"Batch\"},budgets:{name:\"Budgets\"},clouddirectory:{name:\"CloudDirectory\",versions:[\"2016-05-10*\"]},cloudformation:{name:\"CloudFormation\",cors:!0},cloudfront:{name:\"CloudFront\",versions:[\"2013-05-12*\",\"2013-11-11*\",\"2014-05-31*\",\"2014-10-21*\",\"2014-11-06*\",\"2015-04-17*\",\"2015-07-27*\",\"2015-09-17*\",\"2016-01-13*\",\"2016-01-28*\",\"2016-08-01*\",\"2016-08-20*\",\"2016-09-07*\",\"2016-09-29*\",\"2016-11-25*\",\"2017-03-25*\",\"2017-10-30*\",\"2018-06-18*\",\"2018-11-05*\",\"2019-03-26*\"],cors:!0},cloudhsm:{name:\"CloudHSM\",cors:!0},cloudsearch:{name:\"CloudSearch\"},cloudsearchdomain:{name:\"CloudSearchDomain\"},cloudtrail:{name:\"CloudTrail\",cors:!0},cloudwatch:{prefix:\"monitoring\",name:\"CloudWatch\",cors:!0},cloudwatchevents:{prefix:\"events\",name:\"CloudWatchEvents\",versions:[\"2014-02-03*\"],cors:!0},cloudwatchlogs:{prefix:\"logs\",name:\"CloudWatchLogs\",cors:!0},codebuild:{name:\"CodeBuild\",cors:!0},codecommit:{name:\"CodeCommit\",cors:!0},codedeploy:{name:\"CodeDeploy\",cors:!0},codepipeline:{name:\"CodePipeline\",cors:!0},cognitoidentity:{prefix:\"cognito-identity\",name:\"CognitoIdentity\",cors:!0},cognitoidentityserviceprovider:{prefix:\"cognito-idp\",name:\"CognitoIdentityServiceProvider\",cors:!0},cognitosync:{prefix:\"cognito-sync\",name:\"CognitoSync\",cors:!0},configservice:{prefix:\"config\",name:\"ConfigService\",cors:!0},cur:{name:\"CUR\",cors:!0},datapipeline:{name:\"DataPipeline\"},devicefarm:{name:\"DeviceFarm\",cors:!0},directconnect:{name:\"DirectConnect\",cors:!0},directoryservice:{prefix:\"ds\",name:\"DirectoryService\"},discovery:{name:\"Discovery\"},dms:{name:\"DMS\"},dynamodb:{name:\"DynamoDB\",cors:!0},dynamodbstreams:{prefix:\"streams.dynamodb\",name:\"DynamoDBStreams\",cors:!0},ec2:{name:\"EC2\",versions:[\"2013-06-15*\",\"2013-10-15*\",\"2014-02-01*\",\"2014-05-01*\",\"2014-06-15*\",\"2014-09-01*\",\"2014-10-01*\",\"2015-03-01*\",\"2015-04-15*\",\"2015-10-01*\",\"2016-04-01*\",\"2016-09-15*\"],cors:!0},ecr:{name:\"ECR\",cors:!0},ecs:{name:\"ECS\",cors:!0},efs:{prefix:\"elasticfilesystem\",name:\"EFS\",cors:!0},elasticache:{name:\"ElastiCache\",versions:[\"2012-11-15*\",\"2014-03-24*\",\"2014-07-15*\",\"2014-09-30*\"],cors:!0},elasticbeanstalk:{name:\"ElasticBeanstalk\",cors:!0},elb:{prefix:\"elasticloadbalancing\",name:\"ELB\",cors:!0},elbv2:{prefix:\"elasticloadbalancingv2\",name:\"ELBv2\",cors:!0},emr:{prefix:\"elasticmapreduce\",name:\"EMR\",cors:!0},es:{name:\"ES\"},elastictranscoder:{name:\"ElasticTranscoder\",cors:!0},firehose:{name:\"Firehose\",cors:!0},gamelift:{name:\"GameLift\",cors:!0},glacier:{name:\"Glacier\"},health:{name:\"Health\"},iam:{name:\"IAM\",cors:!0},importexport:{name:\"ImportExport\"},inspector:{name:\"Inspector\",versions:[\"2015-08-18*\"],cors:!0},iot:{name:\"Iot\",cors:!0},iotdata:{prefix:\"iot-data\",name:\"IotData\",cors:!0},kinesis:{name:\"Kinesis\",cors:!0},kinesisanalytics:{name:\"KinesisAnalytics\"},kms:{name:\"KMS\",cors:!0},lambda:{name:\"Lambda\",cors:!0},lexruntime:{prefix:\"runtime.lex\",name:\"LexRuntime\",cors:!0},lightsail:{name:\"Lightsail\"},machinelearning:{name:\"MachineLearning\",cors:!0},marketplacecommerceanalytics:{name:\"MarketplaceCommerceAnalytics\",cors:!0},marketplacemetering:{prefix:\"meteringmarketplace\",name:\"MarketplaceMetering\"},mturk:{prefix:\"mturk-requester\",name:\"MTurk\",cors:!0},mobileanalytics:{name:\"MobileAnalytics\",cors:!0},opsworks:{name:\"OpsWorks\",cors:!0},opsworkscm:{name:\"OpsWorksCM\"},organizations:{name:\"Organizations\"},pinpoint:{name:\"Pinpoint\"},polly:{name:\"Polly\",cors:!0},rds:{name:\"RDS\",versions:[\"2014-09-01*\"],cors:!0},redshift:{name:\"Redshift\",cors:!0},rekognition:{name:\"Rekognition\",cors:!0},resourcegroupstaggingapi:{name:\"ResourceGroupsTaggingAPI\"},route53:{name:\"Route53\",cors:!0},route53domains:{name:\"Route53Domains\",cors:!0},s3:{name:\"S3\",dualstackAvailable:!0,cors:!0},s3control:{name:\"S3Control\",dualstackAvailable:!0,xmlNoDefaultLists:!0},servicecatalog:{name:\"ServiceCatalog\",cors:!0},ses:{prefix:\"email\",name:\"SES\",cors:!0},shield:{name:\"Shield\"},simpledb:{prefix:\"sdb\",name:\"SimpleDB\"},sms:{name:\"SMS\"},snowball:{name:\"Snowball\"},sns:{name:\"SNS\",cors:!0},sqs:{name:\"SQS\",cors:!0},ssm:{name:\"SSM\",cors:!0},storagegateway:{name:\"StorageGateway\",cors:!0},stepfunctions:{prefix:\"states\",name:\"StepFunctions\"},sts:{name:\"STS\",cors:!0},support:{name:\"Support\"},swf:{name:\"SWF\"},xray:{name:\"XRay\",cors:!0},waf:{name:\"WAF\",cors:!0},wafregional:{prefix:\"waf-regional\",name:\"WAFRegional\"},workdocs:{name:\"WorkDocs\",cors:!0},workspaces:{name:\"WorkSpaces\"},codestar:{name:\"CodeStar\"},lexmodelbuildingservice:{prefix:\"lex-models\",name:\"LexModelBuildingService\",cors:!0},marketplaceentitlementservice:{prefix:\"entitlement.marketplace\",name:\"MarketplaceEntitlementService\"},athena:{name:\"Athena\"},greengrass:{name:\"Greengrass\"},dax:{name:\"DAX\"},migrationhub:{prefix:\"AWSMigrationHub\",name:\"MigrationHub\"},cloudhsmv2:{name:\"CloudHSMV2\"},glue:{name:\"Glue\"},mobile:{name:\"Mobile\"},pricing:{name:\"Pricing\",cors:!0},costexplorer:{prefix:\"ce\",name:\"CostExplorer\",cors:!0},mediaconvert:{name:\"MediaConvert\"},medialive:{name:\"MediaLive\"},mediapackage:{name:\"MediaPackage\"},mediastore:{name:\"MediaStore\"},mediastoredata:{prefix:\"mediastore-data\",name:\"MediaStoreData\",cors:!0},appsync:{name:\"AppSync\"},guardduty:{name:\"GuardDuty\"},mq:{name:\"MQ\"},comprehend:{name:\"Comprehend\",cors:!0},iotjobsdataplane:{prefix:\"iot-jobs-data\",name:\"IoTJobsDataPlane\"},kinesisvideoarchivedmedia:{prefix:\"kinesis-video-archived-media\",name:\"KinesisVideoArchivedMedia\",cors:!0},kinesisvideomedia:{prefix:\"kinesis-video-media\",name:\"KinesisVideoMedia\",cors:!0},kinesisvideo:{name:\"KinesisVideo\",cors:!0},sagemakerruntime:{prefix:\"runtime.sagemaker\",name:\"SageMakerRuntime\"},sagemaker:{name:\"SageMaker\"},translate:{name:\"Translate\",cors:!0},resourcegroups:{prefix:\"resource-groups\",name:\"ResourceGroups\",cors:!0},alexaforbusiness:{name:\"AlexaForBusiness\"},cloud9:{name:\"Cloud9\"},serverlessapplicationrepository:{prefix:\"serverlessrepo\",name:\"ServerlessApplicationRepository\"},servicediscovery:{name:\"ServiceDiscovery\"},workmail:{name:\"WorkMail\"},autoscalingplans:{prefix:\"autoscaling-plans\",name:\"AutoScalingPlans\"},transcribeservice:{prefix:\"transcribe\",name:\"TranscribeService\"},connect:{name:\"Connect\",cors:!0},acmpca:{prefix:\"acm-pca\",name:\"ACMPCA\"},fms:{name:\"FMS\"},secretsmanager:{name:\"SecretsManager\",cors:!0},iotanalytics:{name:\"IoTAnalytics\",cors:!0},iot1clickdevicesservice:{prefix:\"iot1click-devices\",name:\"IoT1ClickDevicesService\"},iot1clickprojects:{prefix:\"iot1click-projects\",name:\"IoT1ClickProjects\"},pi:{name:\"PI\"},neptune:{name:\"Neptune\"},mediatailor:{name:\"MediaTailor\"},eks:{name:\"EKS\"},macie:{name:\"Macie\"},dlm:{name:\"DLM\"},signer:{name:\"Signer\"},chime:{name:\"Chime\"},pinpointemail:{prefix:\"pinpoint-email\",name:\"PinpointEmail\"},ram:{name:\"RAM\"},route53resolver:{name:\"Route53Resolver\"},pinpointsmsvoice:{prefix:\"sms-voice\",name:\"PinpointSMSVoice\"},quicksight:{name:\"QuickSight\"},rdsdataservice:{prefix:\"rds-data\",name:\"RDSDataService\"},amplify:{name:\"Amplify\"},datasync:{name:\"DataSync\"},robomaker:{name:\"RoboMaker\"},transfer:{name:\"Transfer\"},globalaccelerator:{name:\"GlobalAccelerator\"},comprehendmedical:{name:\"ComprehendMedical\",cors:!0},kinesisanalyticsv2:{name:\"KinesisAnalyticsV2\"},mediaconnect:{name:\"MediaConnect\"},fsx:{name:\"FSx\"},securityhub:{name:\"SecurityHub\"},appmesh:{name:\"AppMesh\",versions:[\"2018-10-01*\"]},licensemanager:{prefix:\"license-manager\",name:\"LicenseManager\"},kafka:{name:\"Kafka\"},apigatewaymanagementapi:{name:\"ApiGatewayManagementApi\"},apigatewayv2:{name:\"ApiGatewayV2\"},docdb:{name:\"DocDB\"},backup:{name:\"Backup\"},worklink:{name:\"WorkLink\"},textract:{name:\"Textract\"},managedblockchain:{name:\"ManagedBlockchain\"},mediapackagevod:{prefix:\"mediapackage-vod\",name:\"MediaPackageVod\"},groundstation:{name:\"GroundStation\"},iotthingsgraph:{name:\"IoTThingsGraph\"},iotevents:{name:\"IoTEvents\"},ioteventsdata:{prefix:\"iotevents-data\",name:\"IoTEventsData\"},personalize:{name:\"Personalize\",cors:!0},personalizeevents:{prefix:\"personalize-events\",name:\"PersonalizeEvents\",cors:!0},personalizeruntime:{prefix:\"personalize-runtime\",name:\"PersonalizeRuntime\",cors:!0},applicationinsights:{prefix:\"application-insights\",name:\"ApplicationInsights\"},servicequotas:{prefix:\"service-quotas\",name:\"ServiceQuotas\"},ec2instanceconnect:{prefix:\"ec2-instance-connect\",name:\"EC2InstanceConnect\"},eventbridge:{name:\"EventBridge\"},lakeformation:{name:\"LakeFormation\"},forecastservice:{prefix:\"forecast\",name:\"ForecastService\",cors:!0},forecastqueryservice:{prefix:\"forecastquery\",name:\"ForecastQueryService\",cors:!0},qldb:{name:\"QLDB\"},qldbsession:{prefix:\"qldb-session\",name:\"QLDBSession\"},workmailmessageflow:{name:\"WorkMailMessageFlow\"},codestarnotifications:{prefix:\"codestar-notifications\",name:\"CodeStarNotifications\"},savingsplans:{name:\"SavingsPlans\"},sso:{name:\"SSO\"},ssooidc:{prefix:\"sso-oidc\",name:\"SSOOIDC\"},marketplacecatalog:{prefix:\"marketplace-catalog\",name:\"MarketplaceCatalog\"},dataexchange:{name:\"DataExchange\"},sesv2:{name:\"SESV2\"},migrationhubconfig:{prefix:\"migrationhub-config\",name:\"MigrationHubConfig\"},connectparticipant:{name:\"ConnectParticipant\"},appconfig:{name:\"AppConfig\"},iotsecuretunneling:{name:\"IoTSecureTunneling\"},wafv2:{name:\"WAFV2\"},elasticinference:{prefix:\"elastic-inference\",name:\"ElasticInference\"},imagebuilder:{name:\"Imagebuilder\"},schemas:{name:\"Schemas\"},accessanalyzer:{name:\"AccessAnalyzer\"},codegurureviewer:{prefix:\"codeguru-reviewer\",name:\"CodeGuruReviewer\"},codeguruprofiler:{name:\"CodeGuruProfiler\"},computeoptimizer:{prefix:\"compute-optimizer\",name:\"ComputeOptimizer\"},frauddetector:{name:\"FraudDetector\"},kendra:{name:\"Kendra\"},networkmanager:{name:\"NetworkManager\"},outposts:{name:\"Outposts\"},augmentedairuntime:{prefix:\"sagemaker-a2i-runtime\",name:\"AugmentedAIRuntime\"},ebs:{name:\"EBS\"},kinesisvideosignalingchannels:{prefix:\"kinesis-video-signaling\",name:\"KinesisVideoSignalingChannels\",cors:!0},detective:{name:\"Detective\"},codestarconnections:{prefix:\"codestar-connections\",name:\"CodeStarconnections\"},synthetics:{name:\"Synthetics\"},iotsitewise:{name:\"IoTSiteWise\"},macie2:{name:\"Macie2\"},codeartifact:{name:\"CodeArtifact\"},honeycode:{name:\"Honeycode\"},ivs:{name:\"IVS\"},braket:{name:\"Braket\"},identitystore:{name:\"IdentityStore\"},appflow:{name:\"Appflow\"},redshiftdata:{prefix:\"redshift-data\",name:\"RedshiftData\"},ssoadmin:{prefix:\"sso-admin\",name:\"SSOAdmin\"},timestreamquery:{prefix:\"timestream-query\",name:\"TimestreamQuery\"},timestreamwrite:{prefix:\"timestream-write\",name:\"TimestreamWrite\"},s3outposts:{name:\"S3Outposts\"}}},{}],6:[function(e,t,n){t.exports={version:\"2.0\",metadata:{apiVersion:\"2011-06-15\",endpointPrefix:\"sts\",globalEndpoint:\"sts.amazonaws.com\",protocol:\"query\",serviceAbbreviation:\"AWS STS\",serviceFullName:\"AWS Security Token Service\",serviceId:\"STS\",signatureVersion:\"v4\",uid:\"sts-2011-06-15\",xmlNamespace:\"https://sts.amazonaws.com/doc/2011-06-15/\"},operations:{AssumeRole:{input:{type:\"structure\",required:[\"RoleArn\",\"RoleSessionName\"],members:{RoleArn:{},RoleSessionName:{},PolicyArns:{shape:\"S4\"},Policy:{},DurationSeconds:{type:\"integer\"},Tags:{shape:\"S8\"},TransitiveTagKeys:{type:\"list\",member:{}},ExternalId:{},SerialNumber:{},TokenCode:{}}},output:{resultWrapper:\"AssumeRoleResult\",type:\"structure\",members:{Credentials:{shape:\"Sh\"},AssumedRoleUser:{shape:\"Sm\"},PackedPolicySize:{type:\"integer\"}}}},AssumeRoleWithSAML:{input:{type:\"structure\",required:[\"RoleArn\",\"PrincipalArn\",\"SAMLAssertion\"],members:{RoleArn:{},PrincipalArn:{},SAMLAssertion:{},PolicyArns:{shape:\"S4\"},Policy:{},DurationSeconds:{type:\"integer\"}}},output:{resultWrapper:\"AssumeRoleWithSAMLResult\",type:\"structure\",members:{Credentials:{shape:\"Sh\"},AssumedRoleUser:{shape:\"Sm\"},PackedPolicySize:{type:\"integer\"},Subject:{},SubjectType:{},Issuer:{},Audience:{},NameQualifier:{}}}},AssumeRoleWithWebIdentity:{input:{type:\"structure\",required:[\"RoleArn\",\"RoleSessionName\",\"WebIdentityToken\"],members:{RoleArn:{},RoleSessionName:{},WebIdentityToken:{},ProviderId:{},PolicyArns:{shape:\"S4\"},Policy:{},DurationSeconds:{type:\"integer\"}}},output:{resultWrapper:\"AssumeRoleWithWebIdentityResult\",type:\"structure\",members:{Credentials:{shape:\"Sh\"},SubjectFromWebIdentityToken:{},AssumedRoleUser:{shape:\"Sm\"},PackedPolicySize:{type:\"integer\"},Provider:{},Audience:{}}}},DecodeAuthorizationMessage:{input:{type:\"structure\",required:[\"EncodedMessage\"],members:{EncodedMessage:{}}},output:{resultWrapper:\"DecodeAuthorizationMessageResult\",type:\"structure\",members:{DecodedMessage:{}}}},GetAccessKeyInfo:{input:{type:\"structure\",required:[\"AccessKeyId\"],members:{AccessKeyId:{}}},output:{resultWrapper:\"GetAccessKeyInfoResult\",type:\"structure\",members:{Account:{}}}},GetCallerIdentity:{input:{type:\"structure\",members:{}},output:{resultWrapper:\"GetCallerIdentityResult\",type:\"structure\",members:{UserId:{},Account:{},Arn:{}}}},GetFederationToken:{input:{type:\"structure\",required:[\"Name\"],members:{Name:{},Policy:{},PolicyArns:{shape:\"S4\"},DurationSeconds:{type:\"integer\"},Tags:{shape:\"S8\"}}},output:{resultWrapper:\"GetFederationTokenResult\",type:\"structure\",members:{Credentials:{shape:\"Sh\"},FederatedUser:{type:\"structure\",required:[\"FederatedUserId\",\"Arn\"],members:{FederatedUserId:{},Arn:{}}},PackedPolicySize:{type:\"integer\"}}}},GetSessionToken:{input:{type:\"structure\",members:{DurationSeconds:{type:\"integer\"},SerialNumber:{},TokenCode:{}}},output:{resultWrapper:\"GetSessionTokenResult\",type:\"structure\",members:{Credentials:{shape:\"Sh\"}}}}},shapes:{S4:{type:\"list\",member:{type:\"structure\",members:{arn:{}}}},S8:{type:\"list\",member:{type:\"structure\",required:[\"Key\",\"Value\"],members:{Key:{},Value:{}}}},Sh:{type:\"structure\",required:[\"AccessKeyId\",\"SecretAccessKey\",\"SessionToken\",\"Expiration\"],members:{AccessKeyId:{},SecretAccessKey:{},SessionToken:{},Expiration:{type:\"timestamp\"}}},Sm:{type:\"structure\",required:[\"AssumedRoleId\",\"Arn\"],members:{AssumedRoleId:{},Arn:{}}}}}},{}],7:[function(e,t,n){arguments[4][2][0].apply(n,arguments)},{dup:2}],8:[function(e,t,n){e(\"../lib/node_loader\");var r=e(\"../lib/core\"),i=r.Service,o=r.apiLoader;o.services.cognitoidentity={},r.CognitoIdentity=i.defineService(\"cognitoidentity\",[\"2014-06-30\"]),e(\"../lib/services/cognitoidentity\"),Object.defineProperty(o.services.cognitoidentity,\"2014-06-30\",{get:function(){var t=e(\"../apis/cognito-identity-2014-06-30.min.json\");return t.paginators=e(\"../apis/cognito-identity-2014-06-30.paginators.json\").pagination,t},enumerable:!0,configurable:!0}),t.exports=r.CognitoIdentity},{\"../apis/cognito-identity-2014-06-30.min.json\":1,\"../apis/cognito-identity-2014-06-30.paginators.json\":2,\"../lib/core\":20,\"../lib/node_loader\":17,\"../lib/services/cognitoidentity\":62}],9:[function(e,t,n){e(\"../lib/node_loader\");var r=e(\"../lib/core\"),i=r.Service,o=r.apiLoader;o.services.sts={},r.STS=i.defineService(\"sts\",[\"2011-06-15\"]),e(\"../lib/services/sts\"),Object.defineProperty(o.services.sts,\"2011-06-15\",{get:function(){var t=e(\"../apis/sts-2011-06-15.min.json\");return t.paginators=e(\"../apis/sts-2011-06-15.paginators.json\").pagination,t},enumerable:!0,configurable:!0}),t.exports=r.STS},{\"../apis/sts-2011-06-15.min.json\":6,\"../apis/sts-2011-06-15.paginators.json\":7,\"../lib/core\":20,\"../lib/node_loader\":17,\"../lib/services/sts\":63}],10:[function(e,t,n){function r(e,t){if(!r.services.hasOwnProperty(e))throw new Error(\"InvalidService: Failed to load api for \"+e);return r.services[e][t]}r.services={},t.exports=r},{}],11:[function(e,t,n){var r=e(\"./browserHmac\"),i=e(\"./browserMd5\"),o=e(\"./browserSha1\"),s=e(\"./browserSha256\");t.exports={createHash:function(e){if(\"md5\"===(e=e.toLowerCase()))return new i;if(\"sha256\"===e)return new s;if(\"sha1\"===e)return new o;throw new Error(\"Hash algorithm \"+e+\" is not supported in the browser SDK\")},createHmac:function(e,t){if(\"md5\"===(e=e.toLowerCase()))return new r(i,t);if(\"sha256\"===e)return new r(s,t);if(\"sha1\"===e)return new r(o,t);throw new Error(\"HMAC algorithm \"+e+\" is not supported in the browser SDK\")},createSign:function(){throw new Error(\"createSign is not implemented in the browser\")}}},{\"./browserHmac\":13,\"./browserMd5\":14,\"./browserSha1\":15,\"./browserSha256\":16}],12:[function(e,t,n){var r=e(\"buffer/\").Buffer;\"undefined\"!=typeof ArrayBuffer&&void 0===ArrayBuffer.isView&&(ArrayBuffer.isView=function(e){return i.indexOf(Object.prototype.toString.call(e))>-1});var i=[\"[object Int8Array]\",\"[object Uint8Array]\",\"[object Uint8ClampedArray]\",\"[object Int16Array]\",\"[object Uint16Array]\",\"[object Int32Array]\",\"[object Uint32Array]\",\"[object Float32Array]\",\"[object Float64Array]\",\"[object DataView]\"];t.exports={isEmptyData:function(e){return\"string\"==typeof e?0===e.length:0===e.byteLength},convertToBuffer:function(e){return\"string\"==typeof e&&(e=new r(e,\"utf8\")),ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}}},{\"buffer/\":82}],13:[function(e,t,n){function r(e,t){this.hash=new e,this.outer=new e;var n=i(e,t),r=new Uint8Array(e.BLOCK_SIZE);r.set(n);for(var o=0;o<e.BLOCK_SIZE;o++)n[o]^=54,r[o]^=92;for(this.hash.update(n),this.outer.update(r),o=0;o<n.byteLength;o++)n[o]=0}function i(e,t){var n=o.convertToBuffer(t);if(n.byteLength>e.BLOCK_SIZE){var r=new e;r.update(n),n=r.digest()}var i=new Uint8Array(e.BLOCK_SIZE);return i.set(n),i}var o=e(\"./browserHashUtils\");t.exports=r,r.prototype.update=function(e){if(o.isEmptyData(e)||this.error)return this;try{this.hash.update(o.convertToBuffer(e))}catch(e){this.error=e}return this},r.prototype.digest=function(e){return this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest(e)}},{\"./browserHashUtils\":12}],14:[function(e,t,n){function r(){this.state=[1732584193,4023233417,2562383102,271733878],this.buffer=new DataView(new ArrayBuffer(p)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}function i(e,t,n,r,i,o){return((t=(t+e&4294967295)+(r+o&4294967295)&4294967295)<<i|t>>>32-i)+n&4294967295}function o(e,t,n,r,o,s,a){return i(t&n|~t&r,e,t,o,s,a)}function s(e,t,n,r,o,s,a){return i(t&r|n&~r,e,t,o,s,a)}function a(e,t,n,r,o,s,a){return i(t^n^r,e,t,o,s,a)}function c(e,t,n,r,o,s,a){return i(n^(t|~r),e,t,o,s,a)}var u=e(\"./browserHashUtils\"),l=e(\"buffer/\").Buffer,p=64;t.exports=r,r.BLOCK_SIZE=p,r.prototype.update=function(e){if(u.isEmptyData(e))return this;if(this.finished)throw new Error(\"Attempted to update an already finished hash.\");var t=u.convertToBuffer(e),n=0,r=t.byteLength;for(this.bytesHashed+=r;r>0;)this.buffer.setUint8(this.bufferLength++,t[n++]),r--,this.bufferLength===p&&(this.hashBuffer(),this.bufferLength=0);return this},r.prototype.digest=function(e){if(!this.finished){var t=this,n=t.buffer,r=t.bufferLength,i=8*t.bytesHashed;if(n.setUint8(this.bufferLength++,128),r%p>=p-8){for(var o=this.bufferLength;o<p;o++)n.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(o=this.bufferLength;o<p-8;o++)n.setUint8(o,0);n.setUint32(p-8,i>>>0,!0),n.setUint32(p-4,Math.floor(i/4294967296),!0),this.hashBuffer(),this.finished=!0}var s=new DataView(new ArrayBuffer(16));for(o=0;o<4;o++)s.setUint32(4*o,this.state[o],!0);var a=new l(s.buffer,s.byteOffset,s.byteLength);return e?a.toString(e):a},r.prototype.hashBuffer=function(){var e=this.buffer,t=this.state,n=t[0],r=t[1],i=t[2],u=t[3];n=o(n,r,i,u,e.getUint32(0,!0),7,3614090360),u=o(u,n,r,i,e.getUint32(4,!0),12,3905402710),i=o(i,u,n,r,e.getUint32(8,!0),17,606105819),r=o(r,i,u,n,e.getUint32(12,!0),22,3250441966),n=o(n,r,i,u,e.getUint32(16,!0),7,4118548399),u=o(u,n,r,i,e.getUint32(20,!0),12,1200080426),i=o(i,u,n,r,e.getUint32(24,!0),17,2821735955),r=o(r,i,u,n,e.getUint32(28,!0),22,4249261313),n=o(n,r,i,u,e.getUint32(32,!0),7,1770035416),u=o(u,n,r,i,e.getUint32(36,!0),12,2336552879),i=o(i,u,n,r,e.getUint32(40,!0),17,4294925233),r=o(r,i,u,n,e.getUint32(44,!0),22,2304563134),n=o(n,r,i,u,e.getUint32(48,!0),7,1804603682),u=o(u,n,r,i,e.getUint32(52,!0),12,4254626195),i=o(i,u,n,r,e.getUint32(56,!0),17,2792965006),n=s(n,r=o(r,i,u,n,e.getUint32(60,!0),22,1236535329),i,u,e.getUint32(4,!0),5,4129170786),u=s(u,n,r,i,e.getUint32(24,!0),9,3225465664),i=s(i,u,n,r,e.getUint32(44,!0),14,643717713),r=s(r,i,u,n,e.getUint32(0,!0),20,3921069994),n=s(n,r,i,u,e.getUint32(20,!0),5,3593408605),u=s(u,n,r,i,e.getUint32(40,!0),9,38016083),i=s(i,u,n,r,e.getUint32(60,!0),14,3634488961),r=s(r,i,u,n,e.getUint32(16,!0),20,3889429448),n=s(n,r,i,u,e.getUint32(36,!0),5,568446438),u=s(u,n,r,i,e.getUint32(56,!0),9,3275163606),i=s(i,u,n,r,e.getUint32(12,!0),14,4107603335),r=s(r,i,u,n,e.getUint32(32,!0),20,1163531501),n=s(n,r,i,u,e.getUint32(52,!0),5,2850285829),u=s(u,n,r,i,e.getUint32(8,!0),9,4243563512),i=s(i,u,n,r,e.getUint32(28,!0),14,1735328473),n=a(n,r=s(r,i,u,n,e.getUint32(48,!0),20,2368359562),i,u,e.getUint32(20,!0),4,4294588738),u=a(u,n,r,i,e.getUint32(32,!0),11,2272392833),i=a(i,u,n,r,e.getUint32(44,!0),16,1839030562),r=a(r,i,u,n,e.getUint32(56,!0),23,4259657740),n=a(n,r,i,u,e.getUint32(4,!0),4,2763975236),u=a(u,n,r,i,e.getUint32(16,!0),11,1272893353),i=a(i,u,n,r,e.getUint32(28,!0),16,4139469664),r=a(r,i,u,n,e.getUint32(40,!0),23,3200236656),n=a(n,r,i,u,e.getUint32(52,!0),4,681279174),u=a(u,n,r,i,e.getUint32(0,!0),11,3936430074),i=a(i,u,n,r,e.getUint32(12,!0),16,3572445317),r=a(r,i,u,n,e.getUint32(24,!0),23,76029189),n=a(n,r,i,u,e.getUint32(36,!0),4,3654602809),u=a(u,n,r,i,e.getUint32(48,!0),11,3873151461),i=a(i,u,n,r,e.getUint32(60,!0),16,530742520),n=c(n,r=a(r,i,u,n,e.getUint32(8,!0),23,3299628645),i,u,e.getUint32(0,!0),6,4096336452),u=c(u,n,r,i,e.getUint32(28,!0),10,1126891415),i=c(i,u,n,r,e.getUint32(56,!0),15,2878612391),r=c(r,i,u,n,e.getUint32(20,!0),21,4237533241),n=c(n,r,i,u,e.getUint32(48,!0),6,1700485571),u=c(u,n,r,i,e.getUint32(12,!0),10,2399980690),i=c(i,u,n,r,e.getUint32(40,!0),15,4293915773),r=c(r,i,u,n,e.getUint32(4,!0),21,2240044497),n=c(n,r,i,u,e.getUint32(32,!0),6,1873313359),u=c(u,n,r,i,e.getUint32(60,!0),10,4264355552),i=c(i,u,n,r,e.getUint32(24,!0),15,2734768916),r=c(r,i,u,n,e.getUint32(52,!0),21,1309151649),n=c(n,r,i,u,e.getUint32(16,!0),6,4149444226),u=c(u,n,r,i,e.getUint32(44,!0),10,3174756917),i=c(i,u,n,r,e.getUint32(8,!0),15,718787259),r=c(r,i,u,n,e.getUint32(36,!0),21,3951481745),t[0]=n+t[0]&4294967295,t[1]=r+t[1]&4294967295,t[2]=i+t[2]&4294967295,t[3]=u+t[3]&4294967295}},{\"./browserHashUtils\":12,\"buffer/\":82}],15:[function(e,t,n){function r(){this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=new Uint32Array(80),this.offset=0,this.shift=24,this.totalLength=0}var i=e(\"buffer/\").Buffer,o=e(\"./browserHashUtils\");new Uint32Array([1518500249,1859775393,-1894007588,-899497514]),Math.pow(2,53),t.exports=r,r.BLOCK_SIZE=64,r.prototype.update=function(e){if(this.finished)throw new Error(\"Attempted to update an already finished hash.\");if(o.isEmptyData(e))return this;var t=(e=o.convertToBuffer(e)).length;this.totalLength+=8*t;for(var n=0;n<t;n++)this.write(e[n]);return this},r.prototype.write=function(e){this.block[this.offset]|=(255&e)<<this.shift,this.shift?this.shift-=8:(this.offset++,this.shift=24),16===this.offset&&this.processBlock()},r.prototype.digest=function(e){this.write(128),(this.offset>14||14===this.offset&&this.shift<24)&&this.processBlock(),this.offset=14,this.shift=24,this.write(0),this.write(0),this.write(this.totalLength>0xffffffffff?this.totalLength/1099511627776:0),this.write(this.totalLength>4294967295?this.totalLength/4294967296:0);for(var t=24;t>=0;t-=8)this.write(this.totalLength>>t);var n=new i(20),r=new DataView(n.buffer);return r.setUint32(0,this.h0,!1),r.setUint32(4,this.h1,!1),r.setUint32(8,this.h2,!1),r.setUint32(12,this.h3,!1),r.setUint32(16,this.h4,!1),e?n.toString(e):n},r.prototype.processBlock=function(){for(var e=16;e<80;e++){var t=this.block[e-3]^this.block[e-8]^this.block[e-14]^this.block[e-16];this.block[e]=t<<1|t>>>31}var n,r,i=this.h0,o=this.h1,s=this.h2,a=this.h3,c=this.h4;for(e=0;e<80;e++){e<20?(n=a^o&(s^a),r=1518500249):e<40?(n=o^s^a,r=1859775393):e<60?(n=o&s|a&(o|s),r=2400959708):(n=o^s^a,r=3395469782);var u=(i<<5|i>>>27)+n+c+r+(0|this.block[e]);c=a,a=s,s=o<<30|o>>>2,o=i,i=u}for(this.h0=this.h0+i|0,this.h1=this.h1+o|0,this.h2=this.h2+s|0,this.h3=this.h3+a|0,this.h4=this.h4+c|0,this.offset=0,e=0;e<16;e++)this.block[e]=0}},{\"./browserHashUtils\":12,\"buffer/\":82}],16:[function(e,t,n){function r(){this.state=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}var i=e(\"buffer/\").Buffer,o=e(\"./browserHashUtils\"),s=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=Math.pow(2,53)-1;t.exports=r,r.BLOCK_SIZE=64,r.prototype.update=function(e){if(this.finished)throw new Error(\"Attempted to update an already finished hash.\");if(o.isEmptyData(e))return this;var t=0,n=(e=o.convertToBuffer(e)).byteLength;if(this.bytesHashed+=n,8*this.bytesHashed>a)throw new Error(\"Cannot hash more than 2^53 - 1 bits\");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,64===this.bufferLength&&(this.hashBuffer(),this.bufferLength=0);return this},r.prototype.digest=function(e){if(!this.finished){var t=8*this.bytesHashed,n=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(n.setUint8(this.bufferLength++,128),r%64>=56){for(var o=this.bufferLength;o<64;o++)n.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(o=this.bufferLength;o<56;o++)n.setUint8(o,0);n.setUint32(56,Math.floor(t/4294967296),!0),n.setUint32(60,t),this.hashBuffer(),this.finished=!0}var s=new i(32);for(o=0;o<8;o++)s[4*o]=this.state[o]>>>24&255,s[4*o+1]=this.state[o]>>>16&255,s[4*o+2]=this.state[o]>>>8&255,s[4*o+3]=this.state[o]>>>0&255;return e?s.toString(e):s},r.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],c=t[5],u=t[6],l=t[7],p=0;p<64;p++){if(p<16)this.temp[p]=(255&e[4*p])<<24|(255&e[4*p+1])<<16|(255&e[4*p+2])<<8|255&e[4*p+3];else{var d=this.temp[p-2],h=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,f=((d=this.temp[p-15])>>>7|d<<25)^(d>>>18|d<<14)^d>>>3;this.temp[p]=(h+this.temp[p-7]|0)+(f+this.temp[p-16]|0)}var m=(((a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7))+(a&c^~a&u)|0)+(l+(s[p]+this.temp[p]|0)|0)|0,g=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&r^n&i^r&i)|0;l=u,u=c,c=a,a=o+m|0,o=i,i=r,r=n,n=m+g|0}t[0]+=n,t[1]+=r,t[2]+=i,t[3]+=o,t[4]+=a,t[5]+=c,t[6]+=u,t[7]+=l}},{\"./browserHashUtils\":12,\"buffer/\":82}],17:[function(e,t,n){(function(n){(function(){var n=e(\"./util\");n.crypto.lib=e(\"./browserCryptoLib\"),n.Buffer=e(\"buffer/\").Buffer,n.url=e(\"url/\"),n.querystring=e(\"querystring/\"),n.realClock=e(\"./realclock/browserClock\"),n.environment=\"js\",n.createEventStream=e(\"./event-stream/buffered-create-event-stream\").createEventStream,n.isBrowser=function(){return!0},n.isNode=function(){return!1};var r=e(\"./core\");if(t.exports=r,e(\"./credentials\"),e(\"./credentials/credential_provider_chain\"),e(\"./credentials/temporary_credentials\"),e(\"./credentials/chainable_temporary_credentials\"),e(\"./credentials/web_identity_credentials\"),e(\"./credentials/cognito_identity_credentials\"),e(\"./credentials/saml_credentials\"),r.XML.Parser=e(\"./xml/browser_parser\"),e(\"./http/xhr\"),void 0===i)var i={browser:!0}}).call(this)}).call(this,e(\"_process\"))},{\"./browserCryptoLib\":11,\"./core\":20,\"./credentials\":21,\"./credentials/chainable_temporary_credentials\":22,\"./credentials/cognito_identity_credentials\":23,\"./credentials/credential_provider_chain\":24,\"./credentials/saml_credentials\":25,\"./credentials/temporary_credentials\":26,\"./credentials/web_identity_credentials\":27,\"./event-stream/buffered-create-event-stream\":29,\"./http/xhr\":37,\"./realclock/browserClock\":54,\"./util\":73,\"./xml/browser_parser\":74,_process:87,\"buffer/\":82,\"querystring/\":94,\"url/\":96}],18:[function(e,t,n){var r,i=e(\"./core\");e(\"./credentials\"),e(\"./credentials/credential_provider_chain\"),i.Config=i.util.inherit({constructor:function(e){void 0===e&&(e={}),e=this.extractCredentials(e),i.util.each.call(this,this.keys,(function(t,n){this.set(t,e[t],n)}))},getCredentials:function(e){function t(t){e(t,t?null:r.credentials)}function n(e,t){return new i.util.error(t||new Error,{code:\"CredentialsError\",message:e,name:\"CredentialsError\"})}var r=this;r.credentials?\"function\"==typeof r.credentials.get?r.credentials.get((function(e){e&&(e=n(\"Could not load credentials from \"+r.credentials.constructor.name,e)),t(e)})):function(){var e=null;r.credentials.accessKeyId&&r.credentials.secretAccessKey||(e=n(\"Missing credentials\")),t(e)}():r.credentialProvider?r.credentialProvider.resolve((function(e,i){e&&(e=n(\"Could not load credentials from any providers\",e)),r.credentials=i,t(e)})):t(n(\"No credentials to load\"))},update:function(e,t){t=t||!1,e=this.extractCredentials(e),i.util.each.call(this,e,(function(e,n){(t||Object.prototype.hasOwnProperty.call(this.keys,e)||i.Service.hasService(e))&&this.set(e,n)}))},loadFromPath:function(e){this.clear();var t=JSON.parse(i.util.readFileSync(e)),n=new i.FileSystemCredentials(e),r=new i.CredentialProviderChain;return r.providers.unshift(n),r.resolve((function(e,n){if(e)throw e;t.credentials=n})),this.constructor(t),this},clear:function(){i.util.each.call(this,this.keys,(function(e){delete this[e]})),this.set(\"credentials\",void 0),this.set(\"credentialProvider\",void 0)},set:function(e,t,n){void 0===t?(void 0===n&&(n=this.keys[e]),this[e]=\"function\"==typeof n?n.call(this):n):\"httpOptions\"===e&&this[e]?this[e]=i.util.merge(this[e],t):this[e]=t},keys:{credentials:null,credentialProvider:null,region:null,logger:null,apiVersions:{},apiVersion:null,endpoint:void 0,httpOptions:{timeout:12e4},maxRetries:void 0,maxRedirects:10,paramValidation:!0,sslEnabled:!0,s3ForcePathStyle:!1,s3BucketEndpoint:!1,s3DisableBodySigning:!0,s3UsEast1RegionalEndpoint:\"legacy\",s3UseArnRegion:void 0,computeChecksums:!0,convertResponseTypes:!0,correctClockSkew:!1,customUserAgent:null,dynamoDbCrc32:!0,systemClockOffset:0,signatureVersion:null,signatureCache:!0,retryDelayOptions:{},useAccelerateEndpoint:!1,clientSideMonitoring:!1,endpointDiscoveryEnabled:void 0,endpointCacheSize:1e3,hostPrefixEnabled:!0,stsRegionalEndpoints:\"legacy\"},extractCredentials:function(e){return e.accessKeyId&&e.secretAccessKey&&((e=i.util.copy(e)).credentials=new i.Credentials(e)),e},setPromisesDependency:function(e){r=e,null===e&&\"function\"==typeof Promise&&(r=Promise);var t=[i.Request,i.Credentials,i.CredentialProviderChain];i.S3&&(t.push(i.S3),i.S3.ManagedUpload&&t.push(i.S3.ManagedUpload)),i.util.addPromises(t,r)},getPromisesDependency:function(){return r}}),i.config=new i.Config},{\"./core\":20,\"./credentials\":21,\"./credentials/credential_provider_chain\":24}],19:[function(e,t,n){(function(n){(function(){function r(e,t){if(\"string\"==typeof e){if([\"legacy\",\"regional\"].indexOf(e.toLowerCase())>=0)return e.toLowerCase();throw i.util.error(new Error,t)}}var i=e(\"./core\");t.exports=function(e,t){var o;if((e=e||{})[t.clientConfig]&&(o=r(e[t.clientConfig],{code:\"InvalidConfiguration\",message:'invalid \"'+t.clientConfig+'\" configuration. Expect \"legacy\"  or \"regional\". Got \"'+e[t.clientConfig]+'\".'})))return o;if(!i.util.isNode())return o;if(Object.prototype.hasOwnProperty.call(n.env,t.env)&&(o=r(n.env[t.env],{code:\"InvalidEnvironmentalVariable\",message:\"invalid \"+t.env+' environmental variable. Expect \"legacy\"  or \"regional\". Got \"'+n.env[t.env]+'\".'})))return o;var s={};try{s=i.util.getProfilesFromSharedConfig(i.util.iniLoader)[n.env.AWS_PROFILE||i.util.defaultProfile]}catch(e){}return s&&Object.prototype.hasOwnProperty.call(s,t.sharedConfig)&&(o=r(s[t.sharedConfig],{code:\"InvalidConfiguration\",message:\"invalid \"+t.sharedConfig+' profile config. Expect \"legacy\"  or \"regional\". Got \"'+s[t.sharedConfig]+'\".'})),o}}).call(this)}).call(this,e(\"_process\"))},{\"./core\":20,_process:87}],20:[function(e,t,n){var r={util:e(\"./util\")};({}).toString(),t.exports=r,r.util.update(r,{VERSION:\"2.772.0\",Signers:{},Protocol:{Json:e(\"./protocol/json\"),Query:e(\"./protocol/query\"),Rest:e(\"./protocol/rest\"),RestJson:e(\"./protocol/rest_json\"),RestXml:e(\"./protocol/rest_xml\")},XML:{Builder:e(\"./xml/builder\"),Parser:null},JSON:{Builder:e(\"./json/builder\"),Parser:e(\"./json/parser\")},Model:{Api:e(\"./model/api\"),Operation:e(\"./model/operation\"),Shape:e(\"./model/shape\"),Paginator:e(\"./model/paginator\"),ResourceWaiter:e(\"./model/resource_waiter\")},apiLoader:e(\"./api_loader\"),EndpointCache:e(\"../vendor/endpoint-cache\").EndpointCache}),e(\"./sequential_executor\"),e(\"./service\"),e(\"./config\"),e(\"./http\"),e(\"./event_listeners\"),e(\"./request\"),e(\"./response\"),e(\"./resource_waiter\"),e(\"./signers/request_signer\"),e(\"./param_validator\"),r.events=new r.SequentialExecutor,r.util.memoizedProperty(r,\"endpointCache\",(function(){return new r.EndpointCache(r.config.endpointCacheSize)}),!0)},{\"../vendor/endpoint-cache\":105,\"./api_loader\":10,\"./config\":18,\"./event_listeners\":35,\"./http\":36,\"./json/builder\":38,\"./json/parser\":39,\"./model/api\":40,\"./model/operation\":42,\"./model/paginator\":43,\"./model/resource_waiter\":44,\"./model/shape\":45,\"./param_validator\":46,\"./protocol/json\":48,\"./protocol/query\":49,\"./protocol/rest\":50,\"./protocol/rest_json\":51,\"./protocol/rest_xml\":52,\"./request\":57,\"./resource_waiter\":58,\"./response\":59,\"./sequential_executor\":60,\"./service\":61,\"./signers/request_signer\":65,\"./util\":73,\"./xml/builder\":75}],21:[function(e,t,n){var r=e(\"./core\");r.Credentials=r.util.inherit({constructor:function(){if(r.util.hideProperties(this,[\"secretAccessKey\"]),this.expired=!1,this.expireTime=null,this.refreshCallbacks=[],1===arguments.length&&\"object\"==typeof arguments[0]){var e=arguments[0].credentials||arguments[0];this.accessKeyId=e.accessKeyId,this.secretAccessKey=e.secretAccessKey,this.sessionToken=e.sessionToken}else this.accessKeyId=arguments[0],this.secretAccessKey=arguments[1],this.sessionToken=arguments[2]},expiryWindow:15,needsRefresh:function(){var e=r.util.date.getDate().getTime(),t=new Date(e+1e3*this.expiryWindow);return!!(this.expireTime&&t>this.expireTime)||this.expired||!this.accessKeyId||!this.secretAccessKey},get:function(e){var t=this;this.needsRefresh()?this.refresh((function(n){n||(t.expired=!1),e&&e(n)})):e&&e()},refresh:function(e){this.expired=!1,e()},coalesceRefresh:function(e,t){var n=this;1===n.refreshCallbacks.push(e)&&n.load((function(e){r.util.arrayEach(n.refreshCallbacks,(function(n){t?n(e):r.util.defer((function(){n(e)}))})),n.refreshCallbacks.length=0}))},load:function(e){e()}}),r.Credentials.addPromisesToClass=function(e){this.prototype.getPromise=r.util.promisifyMethod(\"get\",e),this.prototype.refreshPromise=r.util.promisifyMethod(\"refresh\",e)},r.Credentials.deletePromisesFromClass=function(){delete this.prototype.getPromise,delete this.prototype.refreshPromise},r.util.addPromises(r.Credentials)},{\"./core\":20}],22:[function(e,t,n){var r=e(\"../core\"),i=e(\"../../clients/sts\");r.ChainableTemporaryCredentials=r.util.inherit(r.Credentials,{constructor:function(e){r.Credentials.call(this),e=e||{},this.errorCode=\"ChainableTemporaryCredentialsProviderFailure\",this.expired=!0,this.tokenCodeFn=null;var t=r.util.copy(e.params)||{};if(t.RoleArn&&(t.RoleSessionName=t.RoleSessionName||\"temporary-credentials\"),t.SerialNumber){if(!e.tokenCodeFn||\"function\"!=typeof e.tokenCodeFn)throw new r.util.error(new Error(\"tokenCodeFn must be a function when params.SerialNumber is given\"),{code:this.errorCode});this.tokenCodeFn=e.tokenCodeFn}var n=r.util.merge({params:t,credentials:e.masterCredentials||r.config.credentials},e.stsConfig||{});this.service=new i(n)},refresh:function(e){this.coalesceRefresh(e||r.util.fn.callback)},load:function(e){var t=this,n=t.service.config.params.RoleArn?\"assumeRole\":\"getSessionToken\";this.getTokenCode((function(r,i){var o={};r?e(r):(i&&(o.TokenCode=i),t.service[n](o,(function(n,r){n||t.service.credentialsFrom(r,t),e(n)})))}))},getTokenCode:function(e){var t=this;this.tokenCodeFn?this.tokenCodeFn(this.service.config.params.SerialNumber,(function(n,i){if(n){var o=n;return n instanceof Error&&(o=n.message),void e(r.util.error(new Error(\"Error fetching MFA token: \"+o),{code:t.errorCode}))}e(null,i)})):e(null)}})},{\"../../clients/sts\":9,\"../core\":20}],23:[function(e,t,n){var r=e(\"../core\"),i=e(\"../../clients/cognitoidentity\"),o=e(\"../../clients/sts\");r.CognitoIdentityCredentials=r.util.inherit(r.Credentials,{localStorageKey:{id:\"aws.cognito.identity-id.\",providers:\"aws.cognito.identity-providers.\"},constructor:function(e,t){r.Credentials.call(this),this.expired=!0,this.params=e,this.data=null,this._identityId=null,this._clientConfig=r.util.copy(t||{}),this.loadCachedId();var n=this;Object.defineProperty(this,\"identityId\",{get:function(){return n.loadCachedId(),n._identityId||n.params.IdentityId},set:function(e){n._identityId=e}})},refresh:function(e){this.coalesceRefresh(e||r.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.data=null,t._identityId=null,t.getId((function(n){n?(t.clearIdOnNotAuthorized(n),e(n)):t.params.RoleArn?t.getCredentialsFromSTS(e):t.getCredentialsForIdentity(e)}))},clearCachedId:function(){this._identityId=null,delete this.params.IdentityId;var e=this.params.IdentityPoolId,t=this.params.LoginId||\"\";delete this.storage[this.localStorageKey.id+e+t],delete this.storage[this.localStorageKey.providers+e+t]},clearIdOnNotAuthorized:function(e){\"NotAuthorizedException\"==e.code&&this.clearCachedId()},getId:function(e){var t=this;if(\"string\"==typeof t.params.IdentityId)return e(null,t.params.IdentityId);t.cognito.getId((function(n,r){!n&&r.IdentityId?(t.params.IdentityId=r.IdentityId,e(null,r.IdentityId)):e(n)}))},loadCredentials:function(e,t){e&&t&&(t.expired=!1,t.accessKeyId=e.Credentials.AccessKeyId,t.secretAccessKey=e.Credentials.SecretKey,t.sessionToken=e.Credentials.SessionToken,t.expireTime=e.Credentials.Expiration)},getCredentialsForIdentity:function(e){var t=this;t.cognito.getCredentialsForIdentity((function(n,r){n?t.clearIdOnNotAuthorized(n):(t.cacheId(r),t.data=r,t.loadCredentials(t.data,t)),e(n)}))},getCredentialsFromSTS:function(e){var t=this;t.cognito.getOpenIdToken((function(n,r){n?(t.clearIdOnNotAuthorized(n),e(n)):(t.cacheId(r),t.params.WebIdentityToken=r.Token,t.webIdentityCredentials.refresh((function(n){n||(t.data=t.webIdentityCredentials.data,t.sts.credentialsFrom(t.data,t)),e(n)})))}))},loadCachedId:function(){var e=this;if(r.util.isBrowser()&&!e.params.IdentityId){var t=e.getStorage(\"id\");if(t&&e.params.Logins){var n=Object.keys(e.params.Logins);0!==(e.getStorage(\"providers\")||\"\").split(\",\").filter((function(e){return-1!==n.indexOf(e)})).length&&(e.params.IdentityId=t)}else t&&(e.params.IdentityId=t)}},createClients:function(){var e=this._clientConfig;if(this.webIdentityCredentials=this.webIdentityCredentials||new r.WebIdentityCredentials(this.params,e),!this.cognito){var t=r.util.merge({},e);t.params=this.params,this.cognito=new i(t)}this.sts=this.sts||new o(e)},cacheId:function(e){this._identityId=e.IdentityId,this.params.IdentityId=this._identityId,r.util.isBrowser()&&(this.setStorage(\"id\",e.IdentityId),this.params.Logins&&this.setStorage(\"providers\",Object.keys(this.params.Logins).join(\",\")))},getStorage:function(e){return this.storage[this.localStorageKey[e]+this.params.IdentityPoolId+(this.params.LoginId||\"\")]},setStorage:function(e,t){try{this.storage[this.localStorageKey[e]+this.params.IdentityPoolId+(this.params.LoginId||\"\")]=t}catch(e){}},storage:function(){try{var e=r.util.isBrowser()&&null!==window.localStorage&&\"object\"==typeof window.localStorage?window.localStorage:{};return e[\"aws.test-storage\"]=\"foobar\",delete e[\"aws.test-storage\"],e}catch(e){return{}}}()})},{\"../../clients/cognitoidentity\":8,\"../../clients/sts\":9,\"../core\":20}],24:[function(e,t,n){var r=e(\"../core\");r.CredentialProviderChain=r.util.inherit(r.Credentials,{constructor:function(e){this.providers=e||r.CredentialProviderChain.defaultProviders.slice(0),this.resolveCallbacks=[]},resolve:function(e){var t=this;if(0===t.providers.length)return e(new Error(\"No providers\")),t;if(1===t.resolveCallbacks.push(e)){var n=0,i=t.providers.slice(0);!function e(o,s){if(!o&&s||n===i.length)return r.util.arrayEach(t.resolveCallbacks,(function(e){e(o,s)})),void(t.resolveCallbacks.length=0);var a=i[n++];(s=\"function\"==typeof a?a.call():a).get?s.get((function(t){e(t,t?null:s)})):e(null,s)}()}return t}}),r.CredentialProviderChain.defaultProviders=[],r.CredentialProviderChain.addPromisesToClass=function(e){this.prototype.resolvePromise=r.util.promisifyMethod(\"resolve\",e)},r.CredentialProviderChain.deletePromisesFromClass=function(){delete this.prototype.resolvePromise},r.util.addPromises(r.CredentialProviderChain)},{\"../core\":20}],25:[function(e,t,n){var r=e(\"../core\"),i=e(\"../../clients/sts\");r.SAMLCredentials=r.util.inherit(r.Credentials,{constructor:function(e){r.Credentials.call(this),this.expired=!0,this.params=e},refresh:function(e){this.coalesceRefresh(e||r.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.service.assumeRoleWithSAML((function(n,r){n||t.service.credentialsFrom(r,t),e(n)}))},createClients:function(){this.service=this.service||new i({params:this.params})}})},{\"../../clients/sts\":9,\"../core\":20}],26:[function(e,t,n){var r=e(\"../core\"),i=e(\"../../clients/sts\");r.TemporaryCredentials=r.util.inherit(r.Credentials,{constructor:function(e,t){r.Credentials.call(this),this.loadMasterCredentials(t),this.expired=!0,this.params=e||{},this.params.RoleArn&&(this.params.RoleSessionName=this.params.RoleSessionName||\"temporary-credentials\")},refresh:function(e){this.coalesceRefresh(e||r.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.masterCredentials.get((function(){t.service.config.credentials=t.masterCredentials,(t.params.RoleArn?t.service.assumeRole:t.service.getSessionToken).call(t.service,(function(n,r){n||t.service.credentialsFrom(r,t),e(n)}))}))},loadMasterCredentials:function(e){for(this.masterCredentials=e||r.config.credentials;this.masterCredentials.masterCredentials;)this.masterCredentials=this.masterCredentials.masterCredentials;\"function\"!=typeof this.masterCredentials.get&&(this.masterCredentials=new r.Credentials(this.masterCredentials))},createClients:function(){this.service=this.service||new i({params:this.params})}})},{\"../../clients/sts\":9,\"../core\":20}],27:[function(e,t,n){var r=e(\"../core\"),i=e(\"../../clients/sts\");r.WebIdentityCredentials=r.util.inherit(r.Credentials,{constructor:function(e,t){r.Credentials.call(this),this.expired=!0,this.params=e,this.params.RoleSessionName=this.params.RoleSessionName||\"web-identity\",this.data=null,this._clientConfig=r.util.copy(t||{})},refresh:function(e){this.coalesceRefresh(e||r.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.service.assumeRoleWithWebIdentity((function(n,r){t.data=null,n||(t.data=r,t.service.credentialsFrom(r,t)),e(n)}))},createClients:function(){if(!this.service){var e=r.util.merge({},this._clientConfig);e.params=this.params,this.service=new i(e)}}})},{\"../../clients/sts\":9,\"../core\":20}],28:[function(e,t,n){(function(n){(function(){function r(e){var t=e.service,n=t.api||{},r={};return t.config.region&&(r.region=t.config.region),n.serviceId&&(r.serviceId=n.serviceId),t.config.credentials.accessKeyId&&(r.accessKeyId=t.config.credentials.accessKeyId),r}function i(e,t,n){n&&null!=t&&\"structure\"===n.type&&n.required&&n.required.length>0&&h.arrayEach(n.required,(function(r){var o=n.members[r];if(!0===o.endpointDiscoveryId){var s=o.isLocationName?o.name:r;e[s]=String(t[r])}else i(e,t[r],o)}))}function o(e,t){var n={};return i(n,e.params,t),n}function s(e){var t=e.service,n=t.api,i=n.operations?n.operations[e.operation]:void 0,s=o(e,i?i.input:void 0),a=r(e);Object.keys(s).length>0&&(a=h.update(a,s),i&&(a.operation=i.name));var u=d.endpointCache.get(a);if(!u||1!==u.length||\"\"!==u[0].Address)if(u&&u.length>0)e.httpRequest.updateEndpoint(u[0].Address);else{var l=t.makeRequest(n.endpointOperation,{Operation:i.name,Identifiers:s});c(l),l.removeListener(\"validate\",d.EventListeners.Core.VALIDATE_PARAMETERS),l.removeListener(\"retry\",d.EventListeners.Core.RETRY_CHECK),d.endpointCache.put(a,[{Address:\"\",CachePeriodInMinutes:1}]),l.send((function(e,t){t&&t.Endpoints?d.endpointCache.put(a,t.Endpoints):e&&d.endpointCache.put(a,[{Address:\"\",CachePeriodInMinutes:1}])}))}}function a(e,t){var n=e.service,i=n.api,s=i.operations?i.operations[e.operation]:void 0,a=s?s.input:void 0,u=o(e,a),l=r(e);Object.keys(u).length>0&&(l=h.update(l,u),s&&(l.operation=s.name));var p=d.EndpointCache.getKeyString(l),f=d.endpointCache.get(p);if(f&&1===f.length&&\"\"===f[0].Address)return m[p]||(m[p]=[]),void m[p].push({request:e,callback:t});if(f&&f.length>0)e.httpRequest.updateEndpoint(f[0].Address),t();else{var g=n.makeRequest(i.endpointOperation,{Operation:s.name,Identifiers:u});g.removeListener(\"validate\",d.EventListeners.Core.VALIDATE_PARAMETERS),c(g),d.endpointCache.put(p,[{Address:\"\",CachePeriodInMinutes:60}]),g.send((function(n,r){if(n){if(e.response.error=h.error(n,{retryable:!1}),d.endpointCache.remove(l),m[p]){var i=m[p];h.arrayEach(i,(function(e){e.request.response.error=h.error(n,{retryable:!1}),e.callback()})),delete m[p]}}else r&&(d.endpointCache.put(p,r.Endpoints),e.httpRequest.updateEndpoint(r.Endpoints[0].Address),m[p])&&(i=m[p],h.arrayEach(i,(function(e){e.request.httpRequest.updateEndpoint(r.Endpoints[0].Address),e.callback()})),delete m[p]);t()}))}}function c(e){var t=e.service.api.apiVersion;t&&!e.httpRequest.headers[\"x-amz-api-version\"]&&(e.httpRequest.headers[\"x-amz-api-version\"]=t)}function u(e){var t=e.error,n=e.httpResponse;if(t&&(\"InvalidEndpointException\"===t.code||421===n.statusCode)){var i=e.request,s=i.service.api.operations||{},a=o(i,s[i.operation]?s[i.operation].input:void 0),c=r(i);Object.keys(a).length>0&&(c=h.update(c,a),s[i.operation]&&(c.operation=s[i.operation].name)),d.endpointCache.remove(c)}}function l(e){return[\"false\",\"0\"].indexOf(e)>=0}function p(e){var t=e.service||{};if(void 0!==t.config.endpointDiscoveryEnabled)return t.config.endpointDiscoveryEnabled;if(!h.isBrowser()){for(var r=0;r<f.length;r++){var i=f[r];if(Object.prototype.hasOwnProperty.call(n.env,i)){if(\"\"===n.env[i]||void 0===n.env[i])throw h.error(new Error,{code:\"ConfigurationException\",message:\"environmental variable \"+i+\" cannot be set to nothing\"});return!l(n.env[i])}}var o={};try{o=d.util.iniLoader?d.util.iniLoader.loadFrom({isConfig:!0,filename:n.env[d.util.sharedConfigFileEnv]}):{}}catch(e){}var s=o[n.env.AWS_PROFILE||d.util.defaultProfile]||{};if(Object.prototype.hasOwnProperty.call(s,\"endpoint_discovery_enabled\")){if(void 0===s.endpoint_discovery_enabled)throw h.error(new Error,{code:\"ConfigurationException\",message:\"config file entry 'endpoint_discovery_enabled' cannot be set to nothing\"});return!l(s.endpoint_discovery_enabled)}}}var d=e(\"./core\"),h=e(\"./util\"),f=[\"AWS_ENABLE_ENDPOINT_DISCOVERY\",\"AWS_ENDPOINT_DISCOVERY_ENABLED\"],m={};t.exports={discoverEndpoint:function(e,t){var n=e.service||{};if(function(e){if(e._originalConfig&&e._originalConfig.endpoint&&!0===e._originalConfig.endpointDiscoveryEnabled)throw h.error(new Error,{code:\"ConfigurationException\",message:\"Custom endpoint is supplied; endpointDiscoveryEnabled must not be true.\"});var t=d.config[e.serviceIdentifier]||{};return Boolean(d.config.endpoint||t.endpoint||e._originalConfig&&e._originalConfig.endpoint)}(n)||e.isPresigned())return t();var r=(n.api.operations||{})[e.operation],i=r?r.endpointDiscoveryRequired:\"NULL\",o=p(e),c=n.api.hasRequiredEndpointDiscovery;switch((o||c)&&e.httpRequest.appendToUserAgent(\"endpoint-discovery\"),i){case\"OPTIONAL\":(o||c)&&(s(e),e.addNamedListener(\"INVALIDATE_CACHED_ENDPOINTS\",\"extractError\",u)),t();break;case\"REQUIRED\":if(!1===o){e.response.error=h.error(new Error,{code:\"ConfigurationException\",message:\"Endpoint Discovery is disabled but \"+n.api.className+\".\"+e.operation+\"() requires it. Please check your configurations.\"}),t();break}e.addNamedListener(\"INVALIDATE_CACHED_ENDPOINTS\",\"extractError\",u),a(e,t);break;default:t()}},requiredDiscoverEndpoint:a,optionalDiscoverEndpoint:s,marshallCustomIdentifiers:o,getCacheKey:r,invalidateCachedEndpoint:u}}).call(this)}).call(this,e(\"_process\"))},{\"./core\":20,\"./util\":73,_process:87}],29:[function(e,t,n){var r=e(\"../event-stream/event-message-chunker\").eventMessageChunker,i=e(\"./parse-event\").parseEvent;t.exports={createEventStream:function(e,t,n){for(var o=r(e),s=[],a=0;a<o.length;a++)s.push(i(t,o[a],n));return s}}},{\"../event-stream/event-message-chunker\":30,\"./parse-event\":32}],30:[function(e,t,n){t.exports={eventMessageChunker:function(e){for(var t=[],n=0;n<e.length;){var r=e.readInt32BE(n),i=e.slice(n,r+n);n+=r,t.push(i)}return t}}},{}],31:[function(e,t,n){function r(e){if(8!==e.length)throw new Error(\"Int64 buffers must be exactly 8 bytes\");o.Buffer.isBuffer(e)||(e=s(e)),this.bytes=e}function i(e){for(var t=0;t<8;t++)e[t]^=255;for(t=7;t>-1&&0==++e[t];t--);}var o=e(\"../core\").util,s=o.buffer.toBuffer;r.fromNumber=function(e){if(e>0x8000000000000000||e<-0x8000000000000000)throw new Error(e+\" is too large (or, if negative, too small) to represent as an Int64\");for(var t=new Uint8Array(8),n=7,o=Math.abs(Math.round(e));n>-1&&o>0;n--,o/=256)t[n]=o;return e<0&&i(t),new r(t)},r.prototype.valueOf=function(){var e=this.bytes.slice(0),t=128&e[0];return t&&i(e),parseInt(e.toString(\"hex\"),16)*(t?-1:1)},r.prototype.toString=function(){return String(this.valueOf())},t.exports={Int64:r}},{\"../core\":20}],32:[function(e,t,n){var r=e(\"./parse-message\").parseMessage;t.exports={parseEvent:function(e,t,n){var i=r(t),o=i.headers[\":message-type\"];if(o){if(\"error\"===o.value)throw function(e){var t=e.headers[\":error-code\"],n=e.headers[\":error-message\"],r=new Error(n.value||n);return r.code=r.name=t.value||t,r}(i);if(\"event\"!==o.value)return}var s=i.headers[\":event-type\"],a=n.members[s.value];if(a){var c={},u=a.eventPayloadMemberName;if(u){var l=a.members[u];\"binary\"===l.type?c[u]=i.body:c[u]=e.parse(i.body.toString(),l)}for(var p=a.eventHeaderMemberNames,d=0;d<p.length;d++){var h=p[d];i.headers[h]&&(c[h]=a.members[h].toType(i.headers[h].value))}var f={};return f[s.value]=c,f}}}},{\"./parse-message\":33}],33:[function(e,t,n){function r(e){for(var t={},n=0;n<e.length;){var r=e.readUInt8(n++),o=e.slice(n,n+r).toString();switch(n+=r,e.readUInt8(n++)){case 0:t[o]={type:s,value:!0};break;case 1:t[o]={type:s,value:!1};break;case 2:t[o]={type:a,value:e.readInt8(n++)};break;case 3:t[o]={type:c,value:e.readInt16BE(n)},n+=2;break;case 4:t[o]={type:u,value:e.readInt32BE(n)},n+=4;break;case 5:t[o]={type:l,value:new i(e.slice(n,n+8))},n+=8;break;case 6:var m=e.readUInt16BE(n);n+=2,t[o]={type:p,value:e.slice(n,n+m)},n+=m;break;case 7:var g=e.readUInt16BE(n);n+=2,t[o]={type:d,value:e.slice(n,n+g).toString()},n+=g;break;case 8:t[o]={type:h,value:new Date(new i(e.slice(n,n+8)).valueOf())},n+=8;break;case 9:var v=e.slice(n,n+16).toString(\"hex\");n+=16,t[o]={type:f,value:v.substr(0,8)+\"-\"+v.substr(8,4)+\"-\"+v.substr(12,4)+\"-\"+v.substr(16,4)+\"-\"+v.substr(20)};break;default:throw new Error(\"Unrecognized header type tag\")}}return t}var i=e(\"./int64\").Int64,o=e(\"./split-message\").splitMessage,s=\"boolean\",a=\"byte\",c=\"short\",u=\"integer\",l=\"long\",p=\"binary\",d=\"string\",h=\"timestamp\",f=\"uuid\";t.exports={parseMessage:function(e){var t=o(e);return{headers:r(t.headers),body:t.body}}}},{\"./int64\":31,\"./split-message\":34}],34:[function(e,t,n){var r=e(\"../core\").util,i=r.buffer.toBuffer;t.exports={splitMessage:function(e){if(r.Buffer.isBuffer(e)||(e=i(e)),e.length<16)throw new Error(\"Provided message too short to accommodate event stream message overhead\");if(e.length!==e.readUInt32BE(0))throw new Error(\"Reported message length does not match received message length\");var t=e.readUInt32BE(8);if(t!==r.crypto.crc32(e.slice(0,8)))throw new Error(\"The prelude checksum specified in the message (\"+t+\") does not match the calculated CRC32 checksum.\");var n=e.readUInt32BE(e.length-4);if(n!==r.crypto.crc32(e.slice(0,e.length-4)))throw new Error(\"The message checksum did not match the expected value of \"+n);var o=12+e.readUInt32BE(4);return{headers:e.slice(12,o),body:e.slice(o,e.length-4)}}}},{\"../core\":20}],35:[function(e,t,n){var r=e(\"./core\"),i=e(\"./sequential_executor\"),o=e(\"./discover_endpoint\").discoverEndpoint;r.EventListeners={Core:{}},r.EventListeners={Core:(new i).addNamedListeners((function(e,t){t(\"VALIDATE_CREDENTIALS\",\"validate\",(function(e,t){if(!e.service.api.signatureVersion&&!e.service.config.signatureVersion)return t();e.service.config.getCredentials((function(n){n&&(e.response.error=r.util.error(n,{code:\"CredentialsError\",message:\"Missing credentials in config, if using AWS_CONFIG_FILE, set AWS_SDK_LOAD_CONFIG=1\"})),t()}))})),e(\"VALIDATE_REGION\",\"validate\",(function(e){if(!e.service.isGlobalEndpoint){var t=new RegExp(/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9])$/);e.service.config.region?t.test(e.service.config.region)||(e.response.error=r.util.error(new Error,{code:\"ConfigError\",message:\"Invalid region in config\"})):e.response.error=r.util.error(new Error,{code:\"ConfigError\",message:\"Missing region in config\"})}})),e(\"BUILD_IDEMPOTENCY_TOKENS\",\"validate\",(function(e){if(e.service.api.operations){var t=e.service.api.operations[e.operation];if(t){var n=t.idempotentMembers;if(n.length){for(var i=r.util.copy(e.params),o=0,s=n.length;o<s;o++)i[n[o]]||(i[n[o]]=r.util.uuid.v4());e.params=i}}}})),e(\"VALIDATE_PARAMETERS\",\"validate\",(function(e){if(e.service.api.operations){var t=e.service.api.operations[e.operation].input,n=e.service.config.paramValidation;new r.ParamValidator(n).validate(t,e.params)}})),t(\"COMPUTE_SHA256\",\"afterBuild\",(function(e,t){if(e.haltHandlersOnError(),e.service.api.operations){var n=e.service.api.operations[e.operation],i=n?n.authtype:\"\";if(!e.service.api.signatureVersion&&!i&&!e.service.config.signatureVersion)return t();if(e.service.getSignerClass(e)===r.Signers.V4){var o=e.httpRequest.body||\"\";if(i.indexOf(\"unsigned-body\")>=0)return e.httpRequest.headers[\"X-Amz-Content-Sha256\"]=\"UNSIGNED-PAYLOAD\",t();r.util.computeSha256(o,(function(n,r){n?t(n):(e.httpRequest.headers[\"X-Amz-Content-Sha256\"]=r,t())}))}else t()}})),e(\"SET_CONTENT_LENGTH\",\"afterBuild\",(function(e){var t=function(e){if(!e.service.api.operations)return\"\";var t=e.service.api.operations[e.operation];return t?t.authtype:\"\"}(e),n=r.util.getRequestPayloadShape(e);if(void 0===e.httpRequest.headers[\"Content-Length\"])try{var i=r.util.string.byteLength(e.httpRequest.body);e.httpRequest.headers[\"Content-Length\"]=i}catch(r){if(n&&n.isStreaming){if(n.requiresLength)throw r;if(t.indexOf(\"unsigned-body\")>=0)return void(e.httpRequest.headers[\"Transfer-Encoding\"]=\"chunked\");throw r}throw r}})),e(\"SET_HTTP_HOST\",\"afterBuild\",(function(e){e.httpRequest.headers.Host=e.httpRequest.endpoint.host})),e(\"RESTART\",\"restart\",(function(){var e=this.response.error;e&&e.retryable&&(this.httpRequest=new r.HttpRequest(this.service.endpoint,this.service.region),this.response.retryCount<this.service.config.maxRetries?this.response.retryCount++:this.response.error=null)})),t(\"DISCOVER_ENDPOINT\",\"sign\",o,!0),t(\"SIGN\",\"sign\",(function(e,t){var n=e.service,r=(e.service.api.operations||{})[e.operation],i=r?r.authtype:\"\";if(!n.api.signatureVersion&&!i&&!n.config.signatureVersion)return t();n.config.getCredentials((function(i,o){if(i)return e.response.error=i,t();try{var s=n.getSkewCorrectedDate(),a=new(n.getSignerClass(e))(e.httpRequest,n.getSigningName(),{signatureCache:n.config.signatureCache,operation:r,signatureVersion:n.api.signatureVersion});a.setServiceClientId(n._clientId),delete e.httpRequest.headers.Authorization,delete e.httpRequest.headers.Date,delete e.httpRequest.headers[\"X-Amz-Date\"],a.addAuthorization(o,s),e.signedAt=s}catch(t){e.response.error=t}t()}))})),e(\"VALIDATE_RESPONSE\",\"validateResponse\",(function(e){this.service.successfulResponse(e,this)?(e.data={},e.error=null):(e.data=null,e.error=r.util.error(new Error,{code:\"UnknownError\",message:\"An unknown error occurred.\"}))})),t(\"SEND\",\"send\",(function(e,t){function n(n){e.httpResponse.stream=n;var i=e.request.httpRequest.stream,o=e.request.service,s=o.api,a=e.request.operation,c=s.operations[a]||{};n.on(\"headers\",(function(i,s,a){if(e.request.emit(\"httpHeaders\",[i,s,e,a]),!e.httpResponse.streaming)if(2===r.HttpClient.streamsApiVersion){if(c.hasEventOutput&&o.successfulResponse(e))return e.request.emit(\"httpDone\"),void t();n.on(\"readable\",(function(){var t=n.read();null!==t&&e.request.emit(\"httpData\",[t,e])}))}else n.on(\"data\",(function(t){e.request.emit(\"httpData\",[t,e])}))})),n.on(\"end\",(function(){if(!i||!i.didCallback){if(2===r.HttpClient.streamsApiVersion&&c.hasEventOutput&&o.successfulResponse(e))return;e.request.emit(\"httpDone\"),t()}}))}function i(n){if(\"RequestAbortedError\"!==n.code){var i=\"TimeoutError\"===n.code?n.code:\"NetworkingError\";n=r.util.error(n,{code:i,region:e.request.httpRequest.region,hostname:e.request.httpRequest.endpoint.hostname,retryable:!0})}e.error=n,e.request.emit(\"httpError\",[e.error,e],(function(){t()}))}function o(){var t=r.HttpClient.getInstance(),o=e.request.service.config.httpOptions||{};try{!function(t){t.on(\"sendProgress\",(function(t){e.request.emit(\"httpUploadProgress\",[t,e])})),t.on(\"receiveProgress\",(function(t){e.request.emit(\"httpDownloadProgress\",[t,e])}))}(t.handleRequest(e.request.httpRequest,o,n,i))}catch(e){i(e)}}e.httpResponse._abortCallback=t,e.error=null,e.data=null,(e.request.service.getSkewCorrectedDate()-this.signedAt)/1e3>=600?this.emit(\"sign\",[this],(function(e){e?t(e):o()})):o()})),e(\"HTTP_HEADERS\",\"httpHeaders\",(function(e,t,n,i){n.httpResponse.statusCode=e,n.httpResponse.statusMessage=i,n.httpResponse.headers=t,n.httpResponse.body=r.util.buffer.toBuffer(\"\"),n.httpResponse.buffers=[],n.httpResponse.numBytes=0;var o=t.date||t.Date,s=n.request.service;if(o){var a=Date.parse(o);s.config.correctClockSkew&&s.isClockSkewed(a)&&s.applyClockOffset(a)}})),e(\"HTTP_DATA\",\"httpData\",(function(e,t){if(e){if(r.util.isNode()){t.httpResponse.numBytes+=e.length;var n=t.httpResponse.headers[\"content-length\"],i={loaded:t.httpResponse.numBytes,total:n};t.request.emit(\"httpDownloadProgress\",[i,t])}t.httpResponse.buffers.push(r.util.buffer.toBuffer(e))}})),e(\"HTTP_DONE\",\"httpDone\",(function(e){if(e.httpResponse.buffers&&e.httpResponse.buffers.length>0){var t=r.util.buffer.concat(e.httpResponse.buffers);e.httpResponse.body=t}delete e.httpResponse.numBytes,delete e.httpResponse.buffers})),e(\"FINALIZE_ERROR\",\"retry\",(function(e){e.httpResponse.statusCode&&(e.error.statusCode=e.httpResponse.statusCode,void 0===e.error.retryable&&(e.error.retryable=this.service.retryableError(e.error,this)))})),e(\"INVALIDATE_CREDENTIALS\",\"retry\",(function(e){if(e.error)switch(e.error.code){case\"RequestExpired\":case\"ExpiredTokenException\":case\"ExpiredToken\":e.error.retryable=!0,e.request.service.config.credentials.expired=!0}})),e(\"EXPIRED_SIGNATURE\",\"retry\",(function(e){var t=e.error;t&&\"string\"==typeof t.code&&\"string\"==typeof t.message&&t.code.match(/Signature/)&&t.message.match(/expired/)&&(e.error.retryable=!0)})),e(\"CLOCK_SKEWED\",\"retry\",(function(e){e.error&&this.service.clockSkewError(e.error)&&this.service.config.correctClockSkew&&(e.error.retryable=!0)})),e(\"REDIRECT\",\"retry\",(function(e){e.error&&e.error.statusCode>=300&&e.error.statusCode<400&&e.httpResponse.headers.location&&(this.httpRequest.endpoint=new r.Endpoint(e.httpResponse.headers.location),this.httpRequest.headers.Host=this.httpRequest.endpoint.host,e.error.redirect=!0,e.error.retryable=!0)})),e(\"RETRY_CHECK\",\"retry\",(function(e){e.error&&(e.error.redirect&&e.redirectCount<e.maxRedirects?e.error.retryDelay=0:e.retryCount<e.maxRetries&&(e.error.retryDelay=this.service.retryDelays(e.retryCount,e.error)||0))})),t(\"RESET_RETRY_STATE\",\"afterRetry\",(function(e,t){var n,r=!1;e.error&&(n=e.error.retryDelay||0,e.error.retryable&&e.retryCount<e.maxRetries?(e.retryCount++,r=!0):e.error.redirect&&e.redirectCount<e.maxRedirects&&(e.redirectCount++,r=!0)),r&&n>=0?(e.error=null,setTimeout(t,n)):t()}))})),CorePost:(new i).addNamedListeners((function(e){e(\"EXTRACT_REQUEST_ID\",\"extractData\",r.util.extractRequestId),e(\"EXTRACT_REQUEST_ID\",\"extractError\",r.util.extractRequestId),e(\"ENOTFOUND_ERROR\",\"httpError\",(function(e){if(\"NetworkingError\"===e.code&&function(e){return\"ENOTFOUND\"===e.errno||\"number\"==typeof e.errno&&\"function\"==typeof r.util.getSystemErrorName&&[\"EAI_NONAME\",\"EAI_NODATA\"].indexOf(r.util.getSystemErrorName(e.errno)>=0)}(e)){var t=\"Inaccessible host: `\"+e.hostname+\"'. This service may not be available in the `\"+e.region+\"' region.\";this.response.error=r.util.error(new Error(t),{code:\"UnknownEndpoint\",region:e.region,hostname:e.hostname,retryable:!0,originalError:e})}}))})),Logger:(new i).addNamedListeners((function(t){t(\"LOG_REQUEST\",\"complete\",(function(t){function n(e,t){if(!t)return t;if(e.isSensitive)return\"***SensitiveInformation***\";switch(e.type){case\"structure\":var i={};return r.util.each(t,(function(t,r){Object.prototype.hasOwnProperty.call(e.members,t)?i[t]=n(e.members[t],r):i[t]=r})),i;case\"list\":var o=[];return r.util.arrayEach(t,(function(t,r){o.push(n(e.member,t))})),o;case\"map\":var s={};return r.util.each(t,(function(t,r){s[t]=n(e.value,r)})),s;default:return t}}var i=t.request,o=i.service.config.logger;if(o){var s=function(){var s=(t.request.service.getSkewCorrectedDate().getTime()-i.startTime.getTime())/1e3,a=!!o.isTTY,c=t.httpResponse.statusCode,u=i.params;i.service.api.operations&&i.service.api.operations[i.operation]&&i.service.api.operations[i.operation].input&&(u=n(i.service.api.operations[i.operation].input,i.params));var l=e(\"util\").inspect(u,!0,null),p=\"\";return a&&(p+=\"\u001B[33m\"),p+=\"[AWS \"+i.service.serviceIdentifier+\" \"+c,p+=\" \"+s.toString()+\"s \"+t.retryCount+\" retries]\",a&&(p+=\"\u001B[0;1m\"),p+=\" \"+r.util.string.lowerFirst(i.operation),p+=\"(\"+l+\")\",a&&(p+=\"\u001B[0m\"),p}();\"function\"==typeof o.log?o.log(s):\"function\"==typeof o.write&&o.write(s+\"\\n\")}}))})),Json:(new i).addNamedListeners((function(t){var n=e(\"./protocol/json\");t(\"BUILD\",\"build\",n.buildRequest),t(\"EXTRACT_DATA\",\"extractData\",n.extractData),t(\"EXTRACT_ERROR\",\"extractError\",n.extractError)})),Rest:(new i).addNamedListeners((function(t){var n=e(\"./protocol/rest\");t(\"BUILD\",\"build\",n.buildRequest),t(\"EXTRACT_DATA\",\"extractData\",n.extractData),t(\"EXTRACT_ERROR\",\"extractError\",n.extractError)})),RestJson:(new i).addNamedListeners((function(t){var n=e(\"./protocol/rest_json\");t(\"BUILD\",\"build\",n.buildRequest),t(\"EXTRACT_DATA\",\"extractData\",n.extractData),t(\"EXTRACT_ERROR\",\"extractError\",n.extractError)})),RestXml:(new i).addNamedListeners((function(t){var n=e(\"./protocol/rest_xml\");t(\"BUILD\",\"build\",n.buildRequest),t(\"EXTRACT_DATA\",\"extractData\",n.extractData),t(\"EXTRACT_ERROR\",\"extractError\",n.extractError)})),Query:(new i).addNamedListeners((function(t){var n=e(\"./protocol/query\");t(\"BUILD\",\"build\",n.buildRequest),t(\"EXTRACT_DATA\",\"extractData\",n.extractData),t(\"EXTRACT_ERROR\",\"extractError\",n.extractError)}))}},{\"./core\":20,\"./discover_endpoint\":28,\"./protocol/json\":48,\"./protocol/query\":49,\"./protocol/rest\":50,\"./protocol/rest_json\":51,\"./protocol/rest_xml\":52,\"./sequential_executor\":60,util:99}],36:[function(e,t,n){var r=e(\"./core\"),i=r.util.inherit;r.Endpoint=i({constructor:function(e,t){if(r.util.hideProperties(this,[\"slashes\",\"auth\",\"hash\",\"search\",\"query\"]),null==e)throw new Error(\"Invalid endpoint: \"+e);if(\"string\"!=typeof e)return r.util.copy(e);e.match(/^http/)||(e=((t&&void 0!==t.sslEnabled?t.sslEnabled:r.config.sslEnabled)?\"https\":\"http\")+\"://\"+e),r.util.update(this,r.util.urlParse(e)),this.port?this.port=parseInt(this.port,10):this.port=\"https:\"===this.protocol?443:80}}),r.HttpRequest=i({constructor:function(e,t){e=new r.Endpoint(e),this.method=\"POST\",this.path=e.path||\"/\",this.headers={},this.body=\"\",this.endpoint=e,this.region=t,this._userAgent=\"\",this.setUserAgent()},setUserAgent:function(){this._userAgent=this.headers[this.getUserAgentHeaderName()]=r.util.userAgent()},getUserAgentHeaderName:function(){return(r.util.isBrowser()?\"X-Amz-\":\"\")+\"User-Agent\"},appendToUserAgent:function(e){\"string\"==typeof e&&e&&(this._userAgent+=\" \"+e),this.headers[this.getUserAgentHeaderName()]=this._userAgent},getUserAgent:function(){return this._userAgent},pathname:function(){return this.path.split(\"?\",1)[0]},search:function(){var e=this.path.split(\"?\",2)[1];return e?(e=r.util.queryStringParse(e),r.util.queryParamsToString(e)):\"\"},updateEndpoint:function(e){var t=new r.Endpoint(e);this.endpoint=t,this.path=t.path||\"/\",this.headers.Host&&(this.headers.Host=t.host)}}),r.HttpResponse=i({constructor:function(){this.statusCode=void 0,this.headers={},this.body=void 0,this.streaming=!1,this.stream=null},createUnbufferedStream:function(){return this.streaming=!0,this.stream}}),r.HttpClient=i({}),r.HttpClient.getInstance=function(){return void 0===this.singleton&&(this.singleton=new this),this.singleton}},{\"./core\":20}],37:[function(e,t,n){var r=e(\"../core\"),i=e(\"events\").EventEmitter;e(\"../http\"),r.XHRClient=r.util.inherit({handleRequest:function(e,t,n,o){var s=this,a=e.endpoint,c=new i,u=a.protocol+\"//\"+a.hostname;80!==a.port&&443!==a.port&&(u+=\":\"+a.port),u+=e.path;var l=new XMLHttpRequest,p=!1;e.stream=l,l.addEventListener(\"readystatechange\",(function(){try{if(0===l.status)return}catch(e){return}this.readyState>=this.HEADERS_RECEIVED&&!p&&(c.statusCode=l.status,c.headers=s.parseHeaders(l.getAllResponseHeaders()),c.emit(\"headers\",c.statusCode,c.headers,l.statusText),p=!0),this.readyState===this.DONE&&s.finishRequest(l,c)}),!1),l.upload.addEventListener(\"progress\",(function(e){c.emit(\"sendProgress\",e)})),l.addEventListener(\"progress\",(function(e){c.emit(\"receiveProgress\",e)}),!1),l.addEventListener(\"timeout\",(function(){o(r.util.error(new Error(\"Timeout\"),{code:\"TimeoutError\"}))}),!1),l.addEventListener(\"error\",(function(){o(r.util.error(new Error(\"Network Failure\"),{code:\"NetworkingError\"}))}),!1),l.addEventListener(\"abort\",(function(){o(r.util.error(new Error(\"Request aborted\"),{code:\"RequestAbortedError\"}))}),!1),n(c),l.open(e.method,u,!1!==t.xhrAsync),r.util.each(e.headers,(function(e,t){\"Content-Length\"!==e&&\"User-Agent\"!==e&&\"Host\"!==e&&l.setRequestHeader(e,t)})),t.timeout&&!1!==t.xhrAsync&&(l.timeout=t.timeout),t.xhrWithCredentials&&(l.withCredentials=!0);try{l.responseType=\"arraybuffer\"}catch(e){}try{e.body?l.send(e.body):l.send()}catch(t){if(!e.body||\"object\"!=typeof e.body.buffer)throw t;l.send(e.body.buffer)}return c},parseHeaders:function(e){var t={};return r.util.arrayEach(e.split(/\\r?\\n/),(function(e){var n=e.split(\":\",1)[0],r=e.substring(n.length+2);n.length>0&&(t[n.toLowerCase()]=r)})),t},finishRequest:function(e,t){var n;if(\"arraybuffer\"===e.responseType&&e.response){var i=e.response;n=new r.util.Buffer(i.byteLength);for(var o=new Uint8Array(i),s=0;s<n.length;++s)n[s]=o[s]}try{n||\"string\"!=typeof e.responseText||(n=new r.util.Buffer(e.responseText))}catch(e){}n&&t.emit(\"data\",n),t.emit(\"end\")}}),r.HttpClient.prototype=r.XHRClient.prototype,r.HttpClient.streamsApiVersion=1},{\"../core\":20,\"../http\":36,events:83}],38:[function(e,t,n){function r(){}function i(e,t){if(t&&null!=e)switch(t.type){case\"structure\":return function(e,t){var n={};return o.each(e,(function(e,r){var o=t.members[e];if(o){if(\"body\"!==o.location)return;var s=o.isLocationName?o.name:e,a=i(r,o);void 0!==a&&(n[s]=a)}})),n}(e,t);case\"map\":return function(e,t){var n={};return o.each(e,(function(e,r){var o=i(r,t.value);void 0!==o&&(n[e]=o)})),n}(e,t);case\"list\":return function(e,t){var n=[];return o.arrayEach(e,(function(e){var r=i(e,t.member);void 0!==r&&n.push(r)})),n}(e,t);default:return function(e,t){return t.toWireFormat(e)}(e,t)}}var o=e(\"../util\");r.prototype.build=function(e,t){return JSON.stringify(i(e,t))},t.exports=r},{\"../util\":73}],39:[function(e,t,n){function r(){}function i(e,t){if(t&&void 0!==e)switch(t.type){case\"structure\":return function(e,t){if(null!=e){var n={},r=t.members;return o.each(r,(function(t,r){var o=r.isLocationName?r.name:t;if(Object.prototype.hasOwnProperty.call(e,o)){var s=i(e[o],r);void 0!==s&&(n[t]=s)}})),n}}(e,t);case\"map\":return function(e,t){if(null!=e){var n={};return o.each(e,(function(e,r){var o=i(r,t.value);n[e]=void 0===o?null:o})),n}}(e,t);case\"list\":return function(e,t){if(null!=e){var n=[];return o.arrayEach(e,(function(e){var r=i(e,t.member);void 0===r?n.push(null):n.push(r)})),n}}(e,t);default:return function(e,t){return t.toType(e)}(e,t)}}var o=e(\"../util\");r.prototype.parse=function(e,t){return i(JSON.parse(e),t)},t.exports=r},{\"../util\":73}],40:[function(e,t,n){var r=e(\"./collection\"),i=e(\"./operation\"),o=e(\"./shape\"),s=e(\"./paginator\"),a=e(\"./resource_waiter\"),c=e(\"../../apis/metadata.json\"),u=e(\"../util\"),l=u.property,p=u.memoizedProperty;t.exports=function(e,t){var n=this;e=e||{},(t=t||{}).api=this,e.metadata=e.metadata||{};var d=t.serviceIdentifier;delete t.serviceIdentifier,l(this,\"isApi\",!0,!1),l(this,\"apiVersion\",e.metadata.apiVersion),l(this,\"endpointPrefix\",e.metadata.endpointPrefix),l(this,\"signingName\",e.metadata.signingName),l(this,\"globalEndpoint\",e.metadata.globalEndpoint),l(this,\"signatureVersion\",e.metadata.signatureVersion),l(this,\"jsonVersion\",e.metadata.jsonVersion),l(this,\"targetPrefix\",e.metadata.targetPrefix),l(this,\"protocol\",e.metadata.protocol),l(this,\"timestampFormat\",e.metadata.timestampFormat),l(this,\"xmlNamespaceUri\",e.metadata.xmlNamespace),l(this,\"abbreviation\",e.metadata.serviceAbbreviation),l(this,\"fullName\",e.metadata.serviceFullName),l(this,\"serviceId\",e.metadata.serviceId),d&&c[d]&&l(this,\"xmlNoDefaultLists\",c[d].xmlNoDefaultLists,!1),p(this,\"className\",(function(){var t=e.metadata.serviceAbbreviation||e.metadata.serviceFullName;return t?(\"ElasticLoadBalancing\"===(t=t.replace(/^Amazon|AWS\\s*|\\(.*|\\s+|\\W+/g,\"\"))&&(t=\"ELB\"),t):null})),l(this,\"operations\",new r(e.operations,t,(function(e,n){return new i(e,n,t)}),u.string.lowerFirst,(function(e,t){!0===t.endpointoperation&&l(n,\"endpointOperation\",u.string.lowerFirst(e)),t.endpointdiscovery&&!n.hasRequiredEndpointDiscovery&&l(n,\"hasRequiredEndpointDiscovery\",!0===t.endpointdiscovery.required)}))),l(this,\"shapes\",new r(e.shapes,t,(function(e,n){return o.create(n,t)}))),l(this,\"paginators\",new r(e.paginators,t,(function(e,n){return new s(e,n,t)}))),l(this,\"waiters\",new r(e.waiters,t,(function(e,n){return new a(e,n,t)}),u.string.lowerFirst)),t.documentation&&(l(this,\"documentation\",e.documentation),l(this,\"documentationUrl\",e.documentationUrl))}},{\"../../apis/metadata.json\":5,\"../util\":73,\"./collection\":41,\"./operation\":42,\"./paginator\":43,\"./resource_waiter\":44,\"./shape\":45}],41:[function(e,t,n){function r(e,t,n,r){i(this,r(e),(function(){return n(e,t)}))}var i=e(\"../util\").memoizedProperty;t.exports=function(e,t,n,i,o){for(var s in i=i||String,e)Object.prototype.hasOwnProperty.call(e,s)&&(r.call(this,s,e[s],n,i),o&&o(s,e[s]))}},{\"../util\":73}],42:[function(e,t,n){var r=e(\"./shape\"),i=e(\"../util\"),o=i.property,s=i.memoizedProperty;t.exports=function(e,t,n){var i=this;n=n||{},o(this,\"name\",t.name||e),o(this,\"api\",n.api,!1),t.http=t.http||{},o(this,\"endpoint\",t.endpoint),o(this,\"httpMethod\",t.http.method||\"POST\"),o(this,\"httpPath\",t.http.requestUri||\"/\"),o(this,\"authtype\",t.authtype||\"\"),o(this,\"endpointDiscoveryRequired\",t.endpointdiscovery?t.endpointdiscovery.required?\"REQUIRED\":\"OPTIONAL\":\"NULL\"),s(this,\"input\",(function(){return t.input?r.create(t.input,n):new r.create({type:\"structure\"},n)})),s(this,\"output\",(function(){return t.output?r.create(t.output,n):new r.create({type:\"structure\"},n)})),s(this,\"errors\",(function(){var e=[];if(!t.errors)return null;for(var i=0;i<t.errors.length;i++)e.push(r.create(t.errors[i],n));return e})),s(this,\"paginator\",(function(){return n.api.paginators[e]})),n.documentation&&(o(this,\"documentation\",t.documentation),o(this,\"documentationUrl\",t.documentationUrl)),s(this,\"idempotentMembers\",(function(){var e=[],t=i.input,n=t.members;if(!t.members)return e;for(var r in n)n.hasOwnProperty(r)&&!0===n[r].isIdempotent&&e.push(r);return e})),s(this,\"hasEventOutput\",(function(){return function(e){var t=e.members,n=e.payload;if(!e.members)return!1;if(n)return t[n].isEventStream;for(var r in t)if(!t.hasOwnProperty(r)&&!0===t[r].isEventStream)return!0;return!1}(i.output)}))}},{\"../util\":73,\"./shape\":45}],43:[function(e,t,n){var r=e(\"../util\").property;t.exports=function(e,t){r(this,\"inputToken\",t.input_token),r(this,\"limitKey\",t.limit_key),r(this,\"moreResults\",t.more_results),r(this,\"outputToken\",t.output_token),r(this,\"resultKey\",t.result_key)}},{\"../util\":73}],44:[function(e,t,n){var r=e(\"../util\"),i=r.property;t.exports=function(e,t,n){n=n||{},i(this,\"name\",e),i(this,\"api\",n.api,!1),t.operation&&i(this,\"operation\",r.string.lowerFirst(t.operation));var o=this;[\"type\",\"description\",\"delay\",\"maxAttempts\",\"acceptors\"].forEach((function(e){var n=t[e];n&&i(o,e,n)}))}},{\"../util\":73}],45:[function(e,t,n){function r(e,t,n){null!=n&&m.property.apply(this,arguments)}function i(e,t){e.constructor.prototype[t]||m.memoizedProperty.apply(this,arguments)}function o(e,t,n){t=t||{},r(this,\"shape\",e.shape),r(this,\"api\",t.api,!1),r(this,\"type\",e.type),r(this,\"enum\",e.enum),r(this,\"min\",e.min),r(this,\"max\",e.max),r(this,\"pattern\",e.pattern),r(this,\"location\",e.location||this.location||\"body\"),r(this,\"name\",this.name||e.xmlName||e.queryName||e.locationName||n),r(this,\"isStreaming\",e.streaming||this.isStreaming||!1),r(this,\"requiresLength\",e.requiresLength,!1),r(this,\"isComposite\",e.isComposite||!1),r(this,\"isShape\",!0,!1),r(this,\"isQueryName\",Boolean(e.queryName),!1),r(this,\"isLocationName\",Boolean(e.locationName),!1),r(this,\"isIdempotent\",!0===e.idempotencyToken),r(this,\"isJsonValue\",!0===e.jsonvalue),r(this,\"isSensitive\",!0===e.sensitive||e.prototype&&!0===e.prototype.sensitive),r(this,\"isEventStream\",Boolean(e.eventstream),!1),r(this,\"isEvent\",Boolean(e.event),!1),r(this,\"isEventPayload\",Boolean(e.eventpayload),!1),r(this,\"isEventHeader\",Boolean(e.eventheader),!1),r(this,\"isTimestampFormatSet\",Boolean(e.timestampFormat)||e.prototype&&!0===e.prototype.isTimestampFormatSet,!1),r(this,\"endpointDiscoveryId\",Boolean(e.endpointdiscoveryid),!1),r(this,\"hostLabel\",Boolean(e.hostLabel),!1),t.documentation&&(r(this,\"documentation\",e.documentation),r(this,\"documentationUrl\",e.documentationUrl)),e.xmlAttribute&&r(this,\"isXmlAttribute\",e.xmlAttribute||!1),r(this,\"defaultValue\",null),this.toWireFormat=function(e){return null==e?\"\":e},this.toType=function(e){return e}}function s(e){o.apply(this,arguments),r(this,\"isComposite\",!0),e.flattened&&r(this,\"flattened\",e.flattened||!1)}function a(e,t){var n=this,a=null,c=!this.isShape;s.apply(this,arguments),c&&(r(this,\"defaultValue\",(function(){return{}})),r(this,\"members\",{}),r(this,\"memberNames\",[]),r(this,\"required\",[]),r(this,\"isRequired\",(function(){return!1}))),e.members&&(r(this,\"members\",new f(e.members,t,(function(e,n){return o.create(n,t,e)}))),i(this,\"memberNames\",(function(){return e.xmlOrder||Object.keys(e.members)})),e.event&&(i(this,\"eventPayloadMemberName\",(function(){for(var e=n.members,t=n.memberNames,r=0,i=t.length;r<i;r++)if(e[t[r]].isEventPayload)return t[r]})),i(this,\"eventHeaderMemberNames\",(function(){for(var e=n.members,t=n.memberNames,r=[],i=0,o=t.length;i<o;i++)e[t[i]].isEventHeader&&r.push(t[i]);return r})))),e.required&&(r(this,\"required\",e.required),r(this,\"isRequired\",(function(t){if(!a){a={};for(var n=0;n<e.required.length;n++)a[e.required[n]]=!0}return a[t]}),!1,!0)),r(this,\"resultWrapper\",e.resultWrapper||null),e.payload&&r(this,\"payload\",e.payload),\"string\"==typeof e.xmlNamespace?r(this,\"xmlNamespaceUri\",e.xmlNamespace):\"object\"==typeof e.xmlNamespace&&(r(this,\"xmlNamespacePrefix\",e.xmlNamespace.prefix),r(this,\"xmlNamespaceUri\",e.xmlNamespace.uri))}function c(e,t){var n=this,a=!this.isShape;if(s.apply(this,arguments),a&&r(this,\"defaultValue\",(function(){return[]})),e.member&&i(this,\"member\",(function(){return o.create(e.member,t)})),this.flattened){var c=this.name;i(this,\"name\",(function(){return n.member.name||c}))}}function u(e,t){var n=!this.isShape;s.apply(this,arguments),n&&(r(this,\"defaultValue\",(function(){return{}})),r(this,\"key\",o.create({type:\"string\"},t)),r(this,\"value\",o.create({type:\"string\"},t))),e.key&&i(this,\"key\",(function(){return o.create(e.key,t)})),e.value&&i(this,\"value\",(function(){return o.create(e.value,t)}))}function l(){o.apply(this,arguments);var e=[\"rest-xml\",\"query\",\"ec2\"];this.toType=function(t){return t=this.api&&e.indexOf(this.api.protocol)>-1?t||\"\":t,this.isJsonValue?JSON.parse(t):t&&\"function\"==typeof t.toString?t.toString():t},this.toWireFormat=function(e){return this.isJsonValue?JSON.stringify(e):e}}function p(){o.apply(this,arguments),this.toType=function(e){var t=m.base64.decode(e);if(this.isSensitive&&m.isNode()&&\"function\"==typeof m.Buffer.alloc){var n=m.Buffer.alloc(t.length,t);t.fill(0),t=n}return t},this.toWireFormat=m.base64.encode}function d(){p.apply(this,arguments)}function h(){o.apply(this,arguments),this.toType=function(e){return\"boolean\"==typeof e?e:null==e?null:\"true\"===e}}var f=e(\"./collection\"),m=e(\"../util\");o.normalizedTypes={character:\"string\",double:\"float\",long:\"integer\",short:\"integer\",biginteger:\"integer\",bigdecimal:\"float\",blob:\"binary\"},o.types={structure:a,list:c,map:u,boolean:h,timestamp:function(e){var t=this;if(o.apply(this,arguments),e.timestampFormat)r(this,\"timestampFormat\",e.timestampFormat);else if(t.isTimestampFormatSet&&this.timestampFormat)r(this,\"timestampFormat\",this.timestampFormat);else if(\"header\"===this.location)r(this,\"timestampFormat\",\"rfc822\");else if(\"querystring\"===this.location)r(this,\"timestampFormat\",\"iso8601\");else if(this.api)switch(this.api.protocol){case\"json\":case\"rest-json\":r(this,\"timestampFormat\",\"unixTimestamp\");break;case\"rest-xml\":case\"query\":case\"ec2\":r(this,\"timestampFormat\",\"iso8601\")}this.toType=function(e){return null==e?null:\"function\"==typeof e.toUTCString?e:\"string\"==typeof e||\"number\"==typeof e?m.date.parseTimestamp(e):null},this.toWireFormat=function(e){return m.date.format(e,t.timestampFormat)}},float:function(){o.apply(this,arguments),this.toType=function(e){return null==e?null:parseFloat(e)},this.toWireFormat=this.toType},integer:function(){o.apply(this,arguments),this.toType=function(e){return null==e?null:parseInt(e,10)},this.toWireFormat=this.toType},string:l,base64:d,binary:p},o.resolve=function(e,t){if(e.shape){var n=t.api.shapes[e.shape];if(!n)throw new Error(\"Cannot find shape reference: \"+e.shape);return n}return null},o.create=function(e,t,n){if(e.isShape)return e;var r=o.resolve(e,t);if(r){var i=Object.keys(e);t.documentation||(i=i.filter((function(e){return!e.match(/documentation/)})));var s=function(){r.constructor.call(this,e,t,n)};return s.prototype=r,new s}e.type||(e.members?e.type=\"structure\":e.member?e.type=\"list\":e.key?e.type=\"map\":e.type=\"string\");var a=e.type;if(o.normalizedTypes[e.type]&&(e.type=o.normalizedTypes[e.type]),o.types[e.type])return new o.types[e.type](e,t,n);throw new Error(\"Unrecognized shape type: \"+a)},o.shapes={StructureShape:a,ListShape:c,MapShape:u,StringShape:l,BooleanShape:h,Base64Shape:d},t.exports=o},{\"../util\":73,\"./collection\":41}],46:[function(e,t,n){var r=e(\"./core\");r.ParamValidator=r.util.inherit({constructor:function(e){!0!==e&&void 0!==e||(e={min:!0}),this.validation=e},validate:function(e,t,n){if(this.errors=[],this.validateMember(e,t||{},n||\"params\"),this.errors.length>1){var i=this.errors.join(\"\\n* \");throw i=\"There were \"+this.errors.length+\" validation errors:\\n* \"+i,r.util.error(new Error(i),{code:\"MultipleValidationErrors\",errors:this.errors})}if(1===this.errors.length)throw this.errors[0];return!0},fail:function(e,t){this.errors.push(r.util.error(new Error(t),{code:e}))},validateStructure:function(e,t,n){this.validateType(t,n,[\"object\"],\"structure\");for(var r,i=0;e.required&&i<e.required.length;i++){null!=t[r=e.required[i]]||this.fail(\"MissingRequiredParameter\",\"Missing required key '\"+r+\"' in \"+n)}for(r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=t[r],s=e.members[r];if(void 0!==s){var a=[n,r].join(\".\");this.validateMember(s,o,a)}else this.fail(\"UnexpectedParameter\",\"Unexpected key '\"+r+\"' found in \"+n)}return!0},validateMember:function(e,t,n){switch(e.type){case\"structure\":return this.validateStructure(e,t,n);case\"list\":return this.validateList(e,t,n);case\"map\":return this.validateMap(e,t,n);default:return this.validateScalar(e,t,n)}},validateList:function(e,t,n){if(this.validateType(t,n,[Array])){this.validateRange(e,t.length,n,\"list member count\");for(var r=0;r<t.length;r++)this.validateMember(e.member,t[r],n+\"[\"+r+\"]\")}},validateMap:function(e,t,n){if(this.validateType(t,n,[\"object\"],\"map\")){var r=0;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(this.validateMember(e.key,i,n+\"[key='\"+i+\"']\"),this.validateMember(e.value,t[i],n+\"['\"+i+\"']\"),r++);this.validateRange(e,r,n,\"map member count\")}},validateScalar:function(e,t,n){switch(e.type){case null:case void 0:case\"string\":return this.validateString(e,t,n);case\"base64\":case\"binary\":return this.validatePayload(t,n);case\"integer\":case\"float\":return this.validateNumber(e,t,n);case\"boolean\":return this.validateType(t,n,[\"boolean\"]);case\"timestamp\":return this.validateType(t,n,[Date,/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$/,\"number\"],\"Date object, ISO-8601 string, or a UNIX timestamp\");default:return this.fail(\"UnkownType\",\"Unhandled type \"+e.type+\" for \"+n)}},validateString:function(e,t,n){var r=[\"string\"];e.isJsonValue&&(r=r.concat([\"number\",\"object\",\"boolean\"])),null!==t&&this.validateType(t,n,r)&&(this.validateEnum(e,t,n),this.validateRange(e,t.length,n,\"string length\"),this.validatePattern(e,t,n),this.validateUri(e,t,n))},validateUri:function(e,t,n){\"uri\"===e.location&&0===t.length&&this.fail(\"UriParameterError\",'Expected uri parameter to have length >= 1, but found \"'+t+'\" for '+n)},validatePattern:function(e,t,n){this.validation.pattern&&void 0!==e.pattern&&(new RegExp(e.pattern).test(t)||this.fail(\"PatternMatchError\",'Provided value \"'+t+'\" does not match regex pattern /'+e.pattern+\"/ for \"+n))},validateRange:function(e,t,n,r){this.validation.min&&void 0!==e.min&&t<e.min&&this.fail(\"MinRangeError\",\"Expected \"+r+\" >= \"+e.min+\", but found \"+t+\" for \"+n),this.validation.max&&void 0!==e.max&&t>e.max&&this.fail(\"MaxRangeError\",\"Expected \"+r+\" <= \"+e.max+\", but found \"+t+\" for \"+n)},validateEnum:function(e,t,n){this.validation.enum&&void 0!==e.enum&&-1===e.enum.indexOf(t)&&this.fail(\"EnumError\",\"Found string value of \"+t+\", but expected \"+e.enum.join(\"|\")+\" for \"+n)},validateType:function(e,t,n,i){if(null==e)return!1;for(var o=!1,s=0;s<n.length;s++){if(\"string\"==typeof n[s]){if(typeof e===n[s])return!0}else if(n[s]instanceof RegExp){if((e||\"\").toString().match(n[s]))return!0}else{if(e instanceof n[s])return!0;if(r.util.isType(e,n[s]))return!0;i||o||(n=n.slice()),n[s]=r.util.typeName(n[s])}o=!0}var a=i;a||(a=n.join(\", \").replace(/,([^,]+)$/,\", or$1\"));var c=a.match(/^[aeiou]/i)?\"n\":\"\";return this.fail(\"InvalidParameterType\",\"Expected \"+t+\" to be a\"+c+\" \"+a),!1},validateNumber:function(e,t,n){if(null!=t){if(\"string\"==typeof t){var r=parseFloat(t);r.toString()===t&&(t=r)}this.validateType(t,n,[\"number\"])&&this.validateRange(e,t,n,\"numeric value\")}},validatePayload:function(e,t){if(null!=e&&\"string\"!=typeof e&&(!e||\"number\"!=typeof e.byteLength)){if(r.util.isNode()){var n=r.util.stream.Stream;if(r.util.Buffer.isBuffer(e)||e instanceof n)return}else if(void 0!==typeof Blob&&e instanceof Blob)return;var i=[\"Buffer\",\"Stream\",\"File\",\"Blob\",\"ArrayBuffer\",\"DataView\"];if(e)for(var o=0;o<i.length;o++){if(r.util.isType(e,i[o]))return;if(r.util.typeName(e.constructor)===i[o])return}this.fail(\"InvalidParameterType\",\"Expected \"+t+\" to be a string, Buffer, Stream, Blob, or typed array object\")}}})},{\"./core\":20}],47:[function(e,t,n){var r=e(\"../util\"),i=e(\"../core\");t.exports={populateHostPrefix:function(e){if(!e.service.config.hostPrefixEnabled)return e;var t=e.service.api.operations[e.operation];if(function(e){var t=e.service.api,n=t.operations[e.operation],i=t.endpointOperation&&t.endpointOperation===r.string.lowerFirst(n.name);return\"NULL\"!==n.endpointDiscoveryRequired||!0===i}(e))return e;if(t.endpoint&&t.endpoint.hostPrefix){var n=function(e,t,n){return r.each(n.members,(function(n,i){if(!0===i.hostLabel){if(\"string\"!=typeof t[n]||\"\"===t[n])throw r.error(new Error,{message:\"Parameter \"+n+\" should be a non-empty string.\",code:\"InvalidParameter\"});var o=new RegExp(\"\\\\{\"+n+\"\\\\}\",\"g\");e=e.replace(o,t[n])}})),e}(t.endpoint.hostPrefix,e.params,t.input);(function(e,t){e.host&&(e.host=t+e.host),e.hostname&&(e.hostname=t+e.hostname)})(e.httpRequest.endpoint,n),function(e){var t=e.split(\".\"),n=/^[a-zA-Z0-9]{1}$|^[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9]$/;r.arrayEach(t,(function(e){if(!e.length||e.length<1||e.length>63)throw r.error(new Error,{code:\"ValidationError\",message:\"Hostname label length should be between 1 to 63 characters, inclusive.\"});if(!n.test(e))throw i.util.error(new Error,{code:\"ValidationError\",message:e+\" is not hostname compatible.\"})}))}(e.httpRequest.endpoint.hostname)}return e}}},{\"../core\":20,\"../util\":73}],48:[function(e,t,n){var r=e(\"../util\"),i=e(\"../json/builder\"),o=e(\"../json/parser\"),s=e(\"./helpers\").populateHostPrefix;t.exports={buildRequest:function(e){var t=e.httpRequest,n=e.service.api,r=n.targetPrefix+\".\"+n.operations[e.operation].name,o=n.jsonVersion||\"1.0\",a=n.operations[e.operation].input,c=new i;1===o&&(o=\"1.0\"),t.body=c.build(e.params||{},a),t.headers[\"Content-Type\"]=\"application/x-amz-json-\"+o,t.headers[\"X-Amz-Target\"]=r,s(e)},extractError:function(e){var t={},n=e.httpResponse;if(t.code=n.headers[\"x-amzn-errortype\"]||\"UnknownError\",\"string\"==typeof t.code&&(t.code=t.code.split(\":\")[0]),n.body.length>0)try{var i=JSON.parse(n.body.toString()),o=i.__type||i.code||i.Code;o&&(t.code=o.split(\"#\").pop()),\"RequestEntityTooLarge\"===t.code?t.message=\"Request body must be less than 1 MB\":t.message=i.message||i.Message||null}catch(i){t.statusCode=n.statusCode,t.message=n.statusMessage}else t.statusCode=n.statusCode,t.message=n.statusCode.toString();e.error=r.error(new Error,t)},extractData:function(e){var t=e.httpResponse.body.toString()||\"{}\";if(!1===e.request.service.config.convertResponseTypes)e.data=JSON.parse(t);else{var n=e.request.service.api.operations[e.request.operation].output||{},r=new o;e.data=r.parse(t,n)}}}},{\"../json/builder\":38,\"../json/parser\":39,\"../util\":73,\"./helpers\":47}],49:[function(e,t,n){var r=e(\"../core\"),i=e(\"../util\"),o=e(\"../query/query_param_serializer\"),s=e(\"../model/shape\"),a=e(\"./helpers\").populateHostPrefix;t.exports={buildRequest:function(e){var t=e.service.api.operations[e.operation],n=e.httpRequest;n.headers[\"Content-Type\"]=\"application/x-www-form-urlencoded; charset=utf-8\",n.params={Version:e.service.api.apiVersion,Action:t.name},(new o).serialize(e.params,t.input,(function(e,t){n.params[e]=t})),n.body=i.queryParamsToString(n.params),a(e)},extractError:function(e){var t,n=e.httpResponse.body.toString();if(n.match(\"<UnknownOperationException\"))t={Code:\"UnknownOperation\",Message:\"Unknown operation \"+e.request.operation};else try{t=(new r.XML.Parser).parse(n)}catch(n){t={Code:e.httpResponse.statusCode,Message:e.httpResponse.statusMessage}}t.requestId&&!e.requestId&&(e.requestId=t.requestId),t.Errors&&(t=t.Errors),t.Error&&(t=t.Error),t.Code?e.error=i.error(new Error,{code:t.Code,message:t.Message}):e.error=i.error(new Error,{code:e.httpResponse.statusCode,message:null})},extractData:function(e){var t=e.request,n=t.service.api.operations[t.operation].output||{},o=n;if(o.resultWrapper){var a=s.create({type:\"structure\"});a.members[o.resultWrapper]=n,a.memberNames=[o.resultWrapper],i.property(n,\"name\",n.resultWrapper),n=a}var c=new r.XML.Parser;if(n&&n.members&&!n.members._XAMZRequestId){var u=s.create({type:\"string\"},{api:{protocol:\"query\"}},\"requestId\");n.members._XAMZRequestId=u}var l=c.parse(e.httpResponse.body.toString(),n);e.requestId=l._XAMZRequestId||l.requestId,l._XAMZRequestId&&delete l._XAMZRequestId,o.resultWrapper&&l[o.resultWrapper]&&(i.update(l,l[o.resultWrapper]),delete l[o.resultWrapper]),e.data=l}}},{\"../core\":20,\"../model/shape\":45,\"../query/query_param_serializer\":53,\"../util\":73,\"./helpers\":47}],50:[function(e,t,n){function r(e,t,n,r){var o=[e,t].join(\"/\");o=o.replace(/\\/+/g,\"/\");var s={},a=!1;if(i.each(n.members,(function(e,t){var n=r[e];if(null!=n)if(\"uri\"===t.location){var c=new RegExp(\"\\\\{\"+t.name+\"(\\\\+)?\\\\}\");o=o.replace(c,(function(e,t){return(t?i.uriEscapePath:i.uriEscape)(String(n))}))}else\"querystring\"===t.location&&(a=!0,\"list\"===t.type?s[t.name]=n.map((function(e){return i.uriEscape(t.member.toWireFormat(e).toString())})):\"map\"===t.type?i.each(n,(function(e,t){Array.isArray(t)?s[e]=t.map((function(e){return i.uriEscape(String(e))})):s[e]=i.uriEscape(String(t))})):s[t.name]=i.uriEscape(t.toWireFormat(n).toString()))})),a){o+=o.indexOf(\"?\")>=0?\"&\":\"?\";var c=[];i.arrayEach(Object.keys(s).sort(),(function(e){Array.isArray(s[e])||(s[e]=[s[e]]);for(var t=0;t<s[e].length;t++)c.push(i.uriEscape(String(e))+\"=\"+s[e][t])})),o+=c.join(\"&\")}return o}var i=e(\"../util\"),o=e(\"./helpers\").populateHostPrefix;t.exports={buildRequest:function(e){(function(e){e.httpRequest.method=e.service.api.operations[e.operation].httpMethod})(e),function(e){var t=e.service.api.operations[e.operation],n=t.input,i=r(e.httpRequest.endpoint.path,t.httpPath,n,e.params);e.httpRequest.path=i}(e),function(e){var t=e.service.api.operations[e.operation];i.each(t.input.members,(function(t,n){var r=e.params[t];null!=r&&(\"headers\"===n.location&&\"map\"===n.type?i.each(r,(function(t,r){e.httpRequest.headers[n.name+t]=r})):\"header\"===n.location&&(r=n.toWireFormat(r).toString(),n.isJsonValue&&(r=i.base64.encode(r)),e.httpRequest.headers[n.name]=r))}))}(e),o(e)},extractError:function(){},extractData:function(e){var t=e.request,n={},r=e.httpResponse,o=t.service.api.operations[t.operation].output,s={};i.each(r.headers,(function(e,t){s[e.toLowerCase()]=t})),i.each(o.members,(function(e,t){var o=(t.name||e).toLowerCase();if(\"headers\"===t.location&&\"map\"===t.type){n[e]={};var a=t.isLocationName?t.name:\"\",c=new RegExp(\"^\"+a+\"(.+)\",\"i\");i.each(r.headers,(function(t,r){var i=t.match(c);null!==i&&(n[e][i[1]]=r)}))}else if(\"header\"===t.location){if(void 0!==s[o]){var u=t.isJsonValue?i.base64.decode(s[o]):s[o];n[e]=t.toType(u)}}else\"statusCode\"===t.location&&(n[e]=parseInt(r.statusCode,10))})),e.data=n},generateURI:r}},{\"../util\":73,\"./helpers\":47}],51:[function(e,t,n){function r(e,t){if(e.service.api.operations[e.operation].input,!e.httpRequest.headers[\"Content-Type\"]){var n=t?\"binary/octet-stream\":\"application/json\";e.httpRequest.headers[\"Content-Type\"]=n}}var i=e(\"../util\"),o=e(\"./rest\"),s=e(\"./json\"),a=e(\"../json/builder\"),c=e(\"../json/parser\");t.exports={buildRequest:function(e){o.buildRequest(e),[\"HEAD\",\"DELETE\"].indexOf(e.httpRequest.method)<0&&function(e){var t=new a,n=e.service.api.operations[e.operation].input;if(n.payload){var i,o=n.members[n.payload];if(void 0===(i=e.params[n.payload]))return;\"structure\"===o.type?(e.httpRequest.body=t.build(i,o),r(e)):(e.httpRequest.body=i,(\"binary\"===o.type||o.isStreaming)&&r(e,!0))}else{var s=t.build(e.params,n);\"{}\"===s&&\"GET\"===e.httpRequest.method||(e.httpRequest.body=s),r(e)}}(e)},extractError:function(e){s.extractError(e)},extractData:function(e){o.extractData(e);var t=e.request,n=t.service.api.operations[t.operation],r=t.service.api.operations[t.operation].output||{};if(n.hasEventOutput,r.payload){var a=r.members[r.payload],u=e.httpResponse.body;if(a.isEventStream)l=new c,e.data[payload]=i.createEventStream(2===AWS.HttpClient.streamsApiVersion?e.httpResponse.stream:u,l,a);else if(\"structure\"===a.type||\"list\"===a.type){var l=new c;e.data[r.payload]=l.parse(u,a)}else\"binary\"===a.type||a.isStreaming?e.data[r.payload]=u:e.data[r.payload]=a.toType(u)}else{var p=e.data;s.extractData(e),e.data=i.merge(p,e.data)}}}},{\"../json/builder\":38,\"../json/parser\":39,\"../util\":73,\"./json\":48,\"./rest\":50}],52:[function(e,t,n){var r=e(\"../core\"),i=e(\"../util\"),o=e(\"./rest\");t.exports={buildRequest:function(e){o.buildRequest(e),[\"GET\",\"HEAD\"].indexOf(e.httpRequest.method)<0&&function(e){var t=e.service.api.operations[e.operation].input,n=new r.XML.Builder,o=e.params,s=t.payload;if(s){var a=t.members[s];if(void 0===(o=o[s]))return;if(\"structure\"===a.type){var c=a.name;e.httpRequest.body=n.toXML(o,a,c,!0)}else e.httpRequest.body=o}else e.httpRequest.body=n.toXML(o,t,t.name||t.shape||i.string.upperFirst(e.operation)+\"Request\")}(e)},extractError:function(e){var t;o.extractError(e);try{t=(new r.XML.Parser).parse(e.httpResponse.body.toString())}catch(n){t={Code:e.httpResponse.statusCode,Message:e.httpResponse.statusMessage}}t.Errors&&(t=t.Errors),t.Error&&(t=t.Error),t.Code?e.error=i.error(new Error,{code:t.Code,message:t.Message}):e.error=i.error(new Error,{code:e.httpResponse.statusCode,message:null})},extractData:function(e){o.extractData(e);var t,n=e.request,s=e.httpResponse.body,a=n.service.api.operations[n.operation],c=a.output,u=(a.hasEventOutput,c.payload);if(u){var l=c.members[u];l.isEventStream?(t=new r.XML.Parser,e.data[u]=i.createEventStream(2===r.HttpClient.streamsApiVersion?e.httpResponse.stream:e.httpResponse.body,t,l)):\"structure\"===l.type?(t=new r.XML.Parser,e.data[u]=t.parse(s.toString(),l)):\"binary\"===l.type||l.isStreaming?e.data[u]=s:e.data[u]=l.toType(s)}else if(s.length>0){var p=(t=new r.XML.Parser).parse(s.toString(),c);i.update(e.data,p)}}}},{\"../core\":20,\"../util\":73,\"./rest\":50}],53:[function(e,t,n){function r(){}function i(e){return e.isQueryName||\"ec2\"!==e.api.protocol?e.name:e.name[0].toUpperCase()+e.name.substr(1)}function o(e,t,n,r){a.each(n.members,(function(n,o){var a=t[n];if(null!=a){var c=i(o);s(c=e?e+\".\"+c:c,a,o,r)}}))}function s(e,t,n,r){null!=t&&(\"structure\"===n.type?o(e,t,n,r):\"list\"===n.type?function(e,t,n,r){var o=n.member||{};0!==t.length?a.arrayEach(t,(function(t,a){var c=\".\"+(a+1);if(\"ec2\"===n.api.protocol)c+=\"\";else if(n.flattened){if(o.name){var u=e.split(\".\");u.pop(),u.push(i(o)),e=u.join(\".\")}}else c=\".\"+(o.name?o.name:\"member\")+c;s(e+c,t,o,r)})):r.call(this,e,null)}(e,t,n,r):\"map\"===n.type?function(e,t,n,r){var i=1;a.each(t,(function(t,o){var a=(n.flattened?\".\":\".entry.\")+i+++\".\",c=a+(n.key.name||\"key\"),u=a+(n.value.name||\"value\");s(e+c,t,n.key,r),s(e+u,o,n.value,r)}))}(e,t,n,r):r(e,n.toWireFormat(t).toString()))}var a=e(\"../util\");r.prototype.serialize=function(e,t,n){o(\"\",e,t,n)},t.exports=r},{\"../util\":73}],54:[function(e,t,n){t.exports={now:function(){return\"undefined\"!=typeof performance&&\"function\"==typeof performance.now?performance.now():Date.now()}}},{}],55:[function(e,t,n){function r(e,t){i.each(t,(function(t,n){\"globalEndpoint\"!==t&&(void 0!==e.config[t]&&null!==e.config[t]||(e.config[t]=n))}))}var i=e(\"./util\"),o=e(\"./region_config_data.json\");t.exports={configureEndpoint:function(e){for(var t=function(e){var t=e.config.region,n=function(e){if(!e)return null;var t=e.split(\"-\");return t.length<3?null:t.slice(0,t.length-2).join(\"-\")+\"-*\"}(t),r=e.api.endpointPrefix;return[[t,r],[n,r],[t,\"*\"],[n,\"*\"],[\"*\",r],[\"*\",\"*\"]].map((function(e){return e[0]&&e[1]?e.join(\"/\"):null}))}(e),n=0;n<t.length;n++){var s=t[n];if(s&&Object.prototype.hasOwnProperty.call(o.rules,s)){var a=o.rules[s];return\"string\"==typeof a&&(a=o.patterns[a]),e.config.useDualstack&&i.isDualstackAvailable(e)&&((a=i.copy(a)).endpoint=a.endpoint.replace(/{service}\\.({region}\\.)?/,\"{service}.dualstack.{region}.\")),e.isGlobalEndpoint=!!a.globalEndpoint,a.signingRegion&&(e.signingRegion=a.signingRegion),a.signatureVersion||(a.signatureVersion=\"v4\"),void r(e,a)}}},getEndpointSuffix:function(e){for(var t={\"^(us|eu|ap|sa|ca|me)\\\\-\\\\w+\\\\-\\\\d+$\":\"amazonaws.com\",\"^cn\\\\-\\\\w+\\\\-\\\\d+$\":\"amazonaws.com.cn\",\"^us\\\\-gov\\\\-\\\\w+\\\\-\\\\d+$\":\"amazonaws.com\",\"^us\\\\-iso\\\\-\\\\w+\\\\-\\\\d+$\":\"c2s.ic.gov\",\"^us\\\\-isob\\\\-\\\\w+\\\\-\\\\d+$\":\"sc2s.sgov.gov\"},n=Object.keys(t),r=0;r<n.length;r++){var i=RegExp(n[r]),o=t[n[r]];if(i.test(e))return o}return\"amazonaws.com\"}}},{\"./region_config_data.json\":56,\"./util\":73}],56:[function(e,t,n){t.exports={rules:{\"*/*\":{endpoint:\"{service}.{region}.amazonaws.com\"},\"cn-*/*\":{endpoint:\"{service}.{region}.amazonaws.com.cn\"},\"us-iso-*/*\":{endpoint:\"{service}.{region}.c2s.ic.gov\"},\"us-isob-*/*\":{endpoint:\"{service}.{region}.sc2s.sgov.gov\"},\"*/budgets\":\"globalSSL\",\"*/cloudfront\":\"globalSSL\",\"*/sts\":\"globalSSL\",\"*/importexport\":{endpoint:\"{service}.amazonaws.com\",signatureVersion:\"v2\",globalEndpoint:!0},\"*/route53\":\"globalSSL\",\"cn-*/route53\":{endpoint:\"{service}.amazonaws.com.cn\",globalEndpoint:!0,signingRegion:\"cn-northwest-1\"},\"us-gov-*/route53\":\"globalGovCloud\",\"*/waf\":\"globalSSL\",\"*/iam\":\"globalSSL\",\"cn-*/iam\":{endpoint:\"{service}.cn-north-1.amazonaws.com.cn\",globalEndpoint:!0,signingRegion:\"cn-north-1\"},\"us-gov-*/iam\":\"globalGovCloud\",\"us-gov-*/sts\":{endpoint:\"{service}.{region}.amazonaws.com\"},\"us-gov-west-1/s3\":\"s3signature\",\"us-west-1/s3\":\"s3signature\",\"us-west-2/s3\":\"s3signature\",\"eu-west-1/s3\":\"s3signature\",\"ap-southeast-1/s3\":\"s3signature\",\"ap-southeast-2/s3\":\"s3signature\",\"ap-northeast-1/s3\":\"s3signature\",\"sa-east-1/s3\":\"s3signature\",\"us-east-1/s3\":{endpoint:\"{service}.amazonaws.com\",signatureVersion:\"s3\"},\"us-east-1/sdb\":{endpoint:\"{service}.amazonaws.com\",signatureVersion:\"v2\"},\"*/sdb\":{endpoint:\"{service}.{region}.amazonaws.com\",signatureVersion:\"v2\"}},patterns:{globalSSL:{endpoint:\"https://{service}.amazonaws.com\",globalEndpoint:!0,signingRegion:\"us-east-1\"},globalGovCloud:{endpoint:\"{service}.us-gov.amazonaws.com\",globalEndpoint:!0,signingRegion:\"us-gov-west-1\"},s3signature:{endpoint:\"{service}.{region}.amazonaws.com\",signatureVersion:\"s3\"}}}},{}],57:[function(e,t,n){(function(t){(function(){var n=e(\"./core\"),r=e(\"./state_machine\"),i=n.util.inherit,o=n.util.domain,s=e(\"jmespath\"),a={success:1,error:1,complete:1},c=new r;c.setupStates=function(){var e=function(e,t){var n=this;n._haltHandlersOnError=!1,n.emit(n._asm.currentState,(function(e){if(e)if(function(e){return Object.prototype.hasOwnProperty.call(a,e._asm.currentState)}(n)){if(!(o&&n.domain instanceof o.Domain))throw e;e.domainEmitter=n,e.domain=n.domain,e.domainThrown=!1,n.domain.emit(\"error\",e)}else n.response.error=e,t(e);else t(n.response.error)}))};this.addState(\"validate\",\"build\",\"error\",e),this.addState(\"build\",\"afterBuild\",\"restart\",e),this.addState(\"afterBuild\",\"sign\",\"restart\",e),this.addState(\"sign\",\"send\",\"retry\",e),this.addState(\"retry\",\"afterRetry\",\"afterRetry\",e),this.addState(\"afterRetry\",\"sign\",\"error\",e),this.addState(\"send\",\"validateResponse\",\"retry\",e),this.addState(\"validateResponse\",\"extractData\",\"extractError\",e),this.addState(\"extractError\",\"extractData\",\"retry\",e),this.addState(\"extractData\",\"success\",\"retry\",e),this.addState(\"restart\",\"build\",\"error\",e),this.addState(\"success\",\"complete\",\"complete\",e),this.addState(\"error\",\"complete\",\"complete\",e),this.addState(\"complete\",null,null,e)},c.setupStates(),n.Request=i({constructor:function(e,t,i){var s=e.endpoint,a=e.config.region,u=e.config.customUserAgent;e.isGlobalEndpoint&&(a=e.signingRegion?e.signingRegion:\"us-east-1\"),this.domain=o&&o.active,this.service=e,this.operation=t,this.params=i||{},this.httpRequest=new n.HttpRequest(s,a),this.httpRequest.appendToUserAgent(u),this.startTime=e.getSkewCorrectedDate(),this.response=new n.Response(this),this._asm=new r(c.states,\"validate\"),this._haltHandlersOnError=!1,n.SequentialExecutor.call(this),this.emit=this.emitEvent},send:function(e){return e&&(this.httpRequest.appendToUserAgent(\"callback\"),this.on(\"complete\",(function(t){e.call(t,t.error,t.data)}))),this.runTo(),this.response},build:function(e){return this.runTo(\"send\",e)},runTo:function(e,t){return this._asm.runTo(e,t,this),this},abort:function(){return this.removeAllListeners(\"validateResponse\"),this.removeAllListeners(\"extractError\"),this.on(\"validateResponse\",(function(e){e.error=n.util.error(new Error(\"Request aborted by user\"),{code:\"RequestAbortedError\",retryable:!1})})),this.httpRequest.stream&&!this.httpRequest.stream.didCallback&&(this.httpRequest.stream.abort(),this.httpRequest._abortCallback?this.httpRequest._abortCallback():this.removeAllListeners(\"send\")),this},eachPage:function(e){e=n.util.fn.makeAsync(e,3),this.on(\"complete\",(function t(r){e.call(r,r.error,r.data,(function(i){!1!==i&&(r.hasNextPage()?r.nextPage().on(\"complete\",t).send():e.call(r,null,null,n.util.fn.noop))}))})).send()},eachItem:function(e){var t=this;this.eachPage((function(r,i){if(r)return e(r,null);if(null===i)return e(null,null);var o=t.service.paginationConfig(t.operation).resultKey;Array.isArray(o)&&(o=o[0]);var a=s.search(i,o),c=!0;return n.util.arrayEach(a,(function(t){if(!1===(c=e(null,t)))return n.util.abort})),c}))},isPageable:function(){return!!this.service.paginationConfig(this.operation)},createReadStream:function(){var e=n.util.stream,r=this,i=null;return 2===n.HttpClient.streamsApiVersion?(i=new e.PassThrough,t.nextTick((function(){r.send()}))):((i=new e.Stream).readable=!0,i.sent=!1,i.on(\"newListener\",(function(e){i.sent||\"data\"!==e||(i.sent=!0,t.nextTick((function(){r.send()})))}))),this.on(\"error\",(function(e){i.emit(\"error\",e)})),this.on(\"httpHeaders\",(function(t,o,s){if(t<300){r.removeListener(\"httpData\",n.EventListeners.Core.HTTP_DATA),r.removeListener(\"httpError\",n.EventListeners.Core.HTTP_ERROR),r.on(\"httpError\",(function(e){s.error=e,s.error.retryable=!1}));var a,c=!1;if(\"HEAD\"!==r.httpRequest.method&&(a=parseInt(o[\"content-length\"],10)),void 0!==a&&!isNaN(a)&&a>=0){c=!0;var u=0}var l=function(){c&&u!==a?i.emit(\"error\",n.util.error(new Error(\"Stream content length mismatch. Received \"+u+\" of \"+a+\" bytes.\"),{code:\"StreamContentLengthMismatch\"})):2===n.HttpClient.streamsApiVersion?i.end():i.emit(\"end\")},p=s.httpResponse.createUnbufferedStream();if(2===n.HttpClient.streamsApiVersion)if(c){var d=new e.PassThrough;d._write=function(t){return t&&t.length&&(u+=t.length),e.PassThrough.prototype._write.apply(this,arguments)},d.on(\"end\",l),i.on(\"error\",(function(e){c=!1,p.unpipe(d),d.emit(\"end\"),d.end()})),p.pipe(d).pipe(i,{end:!1})}else p.pipe(i);else c&&p.on(\"data\",(function(e){e&&e.length&&(u+=e.length)})),p.on(\"data\",(function(e){i.emit(\"data\",e)})),p.on(\"end\",l);p.on(\"error\",(function(e){c=!1,i.emit(\"error\",e)}))}})),i},emitEvent:function(e,t,r){\"function\"==typeof t&&(r=t,t=null),r||(r=function(){}),t||(t=this.eventParameters(e,this.response)),n.SequentialExecutor.prototype.emit.call(this,e,t,(function(e){e&&(this.response.error=e),r.call(this,e)}))},eventParameters:function(e){switch(e){case\"restart\":case\"validate\":case\"sign\":case\"build\":case\"afterValidate\":case\"afterBuild\":return[this];case\"error\":return[this.response.error,this.response];default:return[this.response]}},presign:function(e,t){return t||\"function\"!=typeof e||(t=e,e=null),(new n.Signers.Presign).sign(this.toGet(),e,t)},isPresigned:function(){return Object.prototype.hasOwnProperty.call(this.httpRequest.headers,\"presigned-expires\")},toUnauthenticated:function(){return this._unAuthenticated=!0,this.removeListener(\"validate\",n.EventListeners.Core.VALIDATE_CREDENTIALS),this.removeListener(\"sign\",n.EventListeners.Core.SIGN),this},toGet:function(){return\"query\"!==this.service.api.protocol&&\"ec2\"!==this.service.api.protocol||(this.removeListener(\"build\",this.buildAsGet),this.addListener(\"build\",this.buildAsGet)),this},buildAsGet:function(e){e.httpRequest.method=\"GET\",e.httpRequest.path=e.service.endpoint.path+\"?\"+e.httpRequest.body,e.httpRequest.body=\"\",delete e.httpRequest.headers[\"Content-Length\"],delete e.httpRequest.headers[\"Content-Type\"]},haltHandlersOnError:function(){this._haltHandlersOnError=!0}}),n.Request.addPromisesToClass=function(e){this.prototype.promise=function(){var t=this;return this.httpRequest.appendToUserAgent(\"promise\"),new e((function(e,n){t.on(\"complete\",(function(t){t.error?n(t.error):e(Object.defineProperty(t.data||{},\"$response\",{value:t}))})),t.runTo()}))}},n.Request.deletePromisesFromClass=function(){delete this.prototype.promise},n.util.addPromises(n.Request),n.util.mixin(n.Request,n.SequentialExecutor)}).call(this)}).call(this,e(\"_process\"))},{\"./core\":20,\"./state_machine\":72,_process:87,jmespath:86}],58:[function(e,t,n){function r(e){var t=e.request._waiter,n=t.config.acceptors,r=!1,i=\"retry\";n.forEach((function(n){if(!r){var o=t.matchers[n.matcher];o&&o(e,n.expected,n.argument)&&(r=!0,i=n.state)}})),!r&&e.error&&(i=\"failure\"),\"success\"===i?t.setSuccess(e):t.setError(e,\"retry\"===i)}var i=e(\"./core\"),o=i.util.inherit,s=e(\"jmespath\");i.ResourceWaiter=o({constructor:function(e,t){this.service=e,this.state=t,this.loadWaiterConfig(this.state)},service:null,state:null,config:null,matchers:{path:function(e,t,n){try{var r=s.search(e.data,n)}catch(e){return!1}return s.strictDeepEqual(r,t)},pathAll:function(e,t,n){try{var r=s.search(e.data,n)}catch(e){return!1}Array.isArray(r)||(r=[r]);var i=r.length;if(!i)return!1;for(var o=0;o<i;o++)if(!s.strictDeepEqual(r[o],t))return!1;return!0},pathAny:function(e,t,n){try{var r=s.search(e.data,n)}catch(e){return!1}Array.isArray(r)||(r=[r]);for(var i=r.length,o=0;o<i;o++)if(s.strictDeepEqual(r[o],t))return!0;return!1},status:function(e,t){var n=e.httpResponse.statusCode;return\"number\"==typeof n&&n===t},error:function(e,t){return\"string\"==typeof t&&e.error?t===e.error.code:t===!!e.error}},listeners:(new i.SequentialExecutor).addNamedListeners((function(e){e(\"RETRY_CHECK\",\"retry\",(function(e){var t=e.request._waiter;e.error&&\"ResourceNotReady\"===e.error.code&&(e.error.retryDelay=1e3*(t.config.delay||0))})),e(\"CHECK_OUTPUT\",\"extractData\",r),e(\"CHECK_ERROR\",\"extractError\",r)})),wait:function(e,t){\"function\"==typeof e&&(t=e,e=void 0),e&&e.$waiter&&(\"number\"==typeof(e=i.util.copy(e)).$waiter.delay&&(this.config.delay=e.$waiter.delay),\"number\"==typeof e.$waiter.maxAttempts&&(this.config.maxAttempts=e.$waiter.maxAttempts),delete e.$waiter);var n=this.service.makeRequest(this.config.operation,e);return n._waiter=this,n.response.maxRetries=this.config.maxAttempts,n.addListeners(this.listeners),t&&n.send(t),n},setSuccess:function(e){e.error=null,e.data=e.data||{},e.request.removeAllListeners(\"extractData\")},setError:function(e,t){e.data=null,e.error=i.util.error(e.error||new Error,{code:\"ResourceNotReady\",message:\"Resource is not in the state \"+this.state,retryable:t})},loadWaiterConfig:function(e){if(!this.service.api.waiters[e])throw new i.util.error(new Error,{code:\"StateNotFoundError\",message:\"State \"+e+\" not found.\"});this.config=i.util.copy(this.service.api.waiters[e])}})},{\"./core\":20,jmespath:86}],59:[function(e,t,n){var r=e(\"./core\"),i=r.util.inherit,o=e(\"jmespath\");r.Response=i({constructor:function(e){this.request=e,this.data=null,this.error=null,this.retryCount=0,this.redirectCount=0,this.httpResponse=new r.HttpResponse,e&&(this.maxRetries=e.service.numRetries(),this.maxRedirects=e.service.config.maxRedirects)},nextPage:function(e){var t,n=this.request.service,i=this.request.operation;try{t=n.paginationConfig(i,!0)}catch(e){this.error=e}if(!this.hasNextPage()){if(e)e(this.error,null);else if(this.error)throw this.error;return null}var o=r.util.copy(this.request.params);if(this.nextPageTokens){var s=t.inputToken;\"string\"==typeof s&&(s=[s]);for(var a=0;a<s.length;a++)o[s[a]]=this.nextPageTokens[a];return n.makeRequest(this.request.operation,o,e)}return e?e(null,null):null},hasNextPage:function(){return this.cacheNextPageTokens(),!!this.nextPageTokens||void 0===this.nextPageTokens&&void 0},cacheNextPageTokens:function(){if(Object.prototype.hasOwnProperty.call(this,\"nextPageTokens\"))return this.nextPageTokens;this.nextPageTokens=void 0;var e=this.request.service.paginationConfig(this.request.operation);if(!e)return this.nextPageTokens;if(this.nextPageTokens=null,e.moreResults&&!o.search(this.data,e.moreResults))return this.nextPageTokens;var t=e.outputToken;return\"string\"==typeof t&&(t=[t]),r.util.arrayEach.call(this,t,(function(e){var t=o.search(this.data,e);t&&(this.nextPageTokens=this.nextPageTokens||[],this.nextPageTokens.push(t))})),this.nextPageTokens}})},{\"./core\":20,jmespath:86}],60:[function(e,t,n){var r=e(\"./core\");r.SequentialExecutor=r.util.inherit({constructor:function(){this._events={}},listeners:function(e){return this._events[e]?this._events[e].slice(0):[]},on:function(e,t,n){return this._events[e]?n?this._events[e].unshift(t):this._events[e].push(t):this._events[e]=[t],this},onAsync:function(e,t,n){return t._isAsync=!0,this.on(e,t,n)},removeListener:function(e,t){var n=this._events[e];if(n){for(var r=n.length,i=-1,o=0;o<r;++o)n[o]===t&&(i=o);i>-1&&n.splice(i,1)}return this},removeAllListeners:function(e){return e?delete this._events[e]:this._events={},this},emit:function(e,t,n){n||(n=function(){});var r=this.listeners(e),i=r.length;return this.callListeners(r,t,n),i>0},callListeners:function(e,t,n,i){function o(i){if(i&&(a=r.util.error(a||new Error,i),s._haltHandlersOnError))return n.call(s,a);s.callListeners(e,t,n,a)}for(var s=this,a=i||null;e.length>0;){var c=e.shift();if(c._isAsync)return void c.apply(s,t.concat([o]));try{c.apply(s,t)}catch(e){a=r.util.error(a||new Error,e)}if(a&&s._haltHandlersOnError)return void n.call(s,a)}n.call(s,a)},addListeners:function(e){var t=this;return e._events&&(e=e._events),r.util.each(e,(function(e,n){\"function\"==typeof n&&(n=[n]),r.util.arrayEach(n,(function(n){t.on(e,n)}))})),t},addNamedListener:function(e,t,n,r){return this[e]=n,this.addListener(t,n,r),this},addNamedAsyncListener:function(e,t,n,r){return n._isAsync=!0,this.addNamedListener(e,t,n,r)},addNamedListeners:function(e){var t=this;return e((function(){t.addNamedListener.apply(t,arguments)}),(function(){t.addNamedAsyncListener.apply(t,arguments)})),this}}),r.SequentialExecutor.prototype.addListener=r.SequentialExecutor.prototype.on,t.exports=r.SequentialExecutor},{\"./core\":20}],61:[function(e,t,n){(function(n){(function(){var r=e(\"./core\"),i=e(\"./model/api\"),o=e(\"./region_config\"),s=r.util.inherit,a=0;r.Service=s({constructor:function(e){if(!this.loadServiceClass)throw r.util.error(new Error,\"Service must be constructed with `new' operator\");var t=this.loadServiceClass(e||{});if(t){var n=r.util.copy(e),i=new t(e);return Object.defineProperty(i,\"_originalConfig\",{get:function(){return n},enumerable:!1,configurable:!0}),i._clientId=++a,i}this.initialize(e)},initialize:function(e){var t=r.config[this.serviceIdentifier];if(this.config=new r.Config(r.config),t&&this.config.update(t,!0),e&&this.config.update(e,!0),this.validateService(),this.config.endpoint||o.configureEndpoint(this),this.config.endpoint=this.endpointFromTemplate(this.config.endpoint),this.setEndpoint(this.config.endpoint),r.SequentialExecutor.call(this),r.Service.addDefaultMonitoringListeners(this),(this.config.clientSideMonitoring||r.Service._clientSideMonitoring)&&this.publisher){var i=this.publisher;this.addNamedListener(\"PUBLISH_API_CALL\",\"apiCall\",(function(e){n.nextTick((function(){i.eventHandler(e)}))})),this.addNamedListener(\"PUBLISH_API_ATTEMPT\",\"apiCallAttempt\",(function(e){n.nextTick((function(){i.eventHandler(e)}))}))}},validateService:function(){},loadServiceClass:function(e){var t=e;if(r.util.isEmpty(this.api)){if(t.apiConfig)return r.Service.defineServiceApi(this.constructor,t.apiConfig);if(this.constructor.services){(t=new r.Config(r.config)).update(e,!0);var n=t.apiVersions[this.constructor.serviceIdentifier];return n=n||t.apiVersion,this.getLatestServiceClass(n)}return null}return null},getLatestServiceClass:function(e){return e=this.getLatestServiceVersion(e),null===this.constructor.services[e]&&r.Service.defineServiceApi(this.constructor,e),this.constructor.services[e]},getLatestServiceVersion:function(e){if(!this.constructor.services||0===this.constructor.services.length)throw new Error(\"No services defined on \"+this.constructor.serviceIdentifier);if(e?r.util.isType(e,Date)&&(e=r.util.date.iso8601(e).split(\"T\")[0]):e=\"latest\",Object.hasOwnProperty(this.constructor.services,e))return e;for(var t=Object.keys(this.constructor.services).sort(),n=null,i=t.length-1;i>=0;i--)if(\"*\"!==t[i][t[i].length-1]&&(n=t[i]),t[i].substr(0,10)<=e)return n;throw new Error(\"Could not find \"+this.constructor.serviceIdentifier+\" API to satisfy version constraint `\"+e+\"'\")},api:{},defaultRetryCount:3,customizeRequests:function(e){if(e){if(\"function\"!=typeof e)throw new Error(\"Invalid callback type '\"+typeof e+\"' provided in customizeRequests\");this.customRequestHandler=e}else this.customRequestHandler=null},makeRequest:function(e,t,n){if(\"function\"==typeof t&&(n=t,t=null),t=t||{},this.config.params){var i=this.api.operations[e];i&&(t=r.util.copy(t),r.util.each(this.config.params,(function(e,n){i.input.members[e]&&(void 0!==t[e]&&null!==t[e]||(t[e]=n))})))}var o=new r.Request(this,e,t);return this.addAllRequestListeners(o),this.attachMonitoringEmitter(o),n&&o.send(n),o},makeUnauthenticatedRequest:function(e,t,n){\"function\"==typeof t&&(n=t,t={});var r=this.makeRequest(e,t).toUnauthenticated();return n?r.send(n):r},waitFor:function(e,t,n){return new r.ResourceWaiter(this,e).wait(t,n)},addAllRequestListeners:function(e){for(var t=[r.events,r.EventListeners.Core,this.serviceInterface(),r.EventListeners.CorePost],n=0;n<t.length;n++)t[n]&&e.addListeners(t[n]);this.config.paramValidation||e.removeListener(\"validate\",r.EventListeners.Core.VALIDATE_PARAMETERS),this.config.logger&&e.addListeners(r.EventListeners.Logger),this.setupRequestListeners(e),\"function\"==typeof this.constructor.prototype.customRequestHandler&&this.constructor.prototype.customRequestHandler(e),Object.prototype.hasOwnProperty.call(this,\"customRequestHandler\")&&\"function\"==typeof this.customRequestHandler&&this.customRequestHandler(e)},apiCallEvent:function(e){var t=e.service.api.operations[e.operation],n={Type:\"ApiCall\",Api:t?t.name:e.operation,Version:1,Service:e.service.api.serviceId||e.service.api.endpointPrefix,Region:e.httpRequest.region,MaxRetriesExceeded:0,UserAgent:e.httpRequest.getUserAgent()},r=e.response;if(r.httpResponse.statusCode&&(n.FinalHttpStatusCode=r.httpResponse.statusCode),r.error){var i=r.error;r.httpResponse.statusCode>299?(i.code&&(n.FinalAwsException=i.code),i.message&&(n.FinalAwsExceptionMessage=i.message)):((i.code||i.name)&&(n.FinalSdkException=i.code||i.name),i.message&&(n.FinalSdkExceptionMessage=i.message))}return n},apiAttemptEvent:function(e){var t=e.service.api.operations[e.operation],n={Type:\"ApiCallAttempt\",Api:t?t.name:e.operation,Version:1,Service:e.service.api.serviceId||e.service.api.endpointPrefix,Fqdn:e.httpRequest.endpoint.hostname,UserAgent:e.httpRequest.getUserAgent()},r=e.response;return r.httpResponse.statusCode&&(n.HttpStatusCode=r.httpResponse.statusCode),!e._unAuthenticated&&e.service.config.credentials&&e.service.config.credentials.accessKeyId&&(n.AccessKey=e.service.config.credentials.accessKeyId),r.httpResponse.headers?(e.httpRequest.headers[\"x-amz-security-token\"]&&(n.SessionToken=e.httpRequest.headers[\"x-amz-security-token\"]),r.httpResponse.headers[\"x-amzn-requestid\"]&&(n.XAmznRequestId=r.httpResponse.headers[\"x-amzn-requestid\"]),r.httpResponse.headers[\"x-amz-request-id\"]&&(n.XAmzRequestId=r.httpResponse.headers[\"x-amz-request-id\"]),r.httpResponse.headers[\"x-amz-id-2\"]&&(n.XAmzId2=r.httpResponse.headers[\"x-amz-id-2\"]),n):n},attemptFailEvent:function(e){var t=this.apiAttemptEvent(e),n=e.response,r=n.error;return n.httpResponse.statusCode>299?(r.code&&(t.AwsException=r.code),r.message&&(t.AwsExceptionMessage=r.message)):((r.code||r.name)&&(t.SdkException=r.code||r.name),r.message&&(t.SdkExceptionMessage=r.message)),t},attachMonitoringEmitter:function(e){var t,n,i,o,s,a,c=0,u=this;e.on(\"validate\",(function(){o=r.util.realClock.now(),a=Date.now()}),!0),e.on(\"sign\",(function(){n=r.util.realClock.now(),t=Date.now(),s=e.httpRequest.region,c++}),!0),e.on(\"validateResponse\",(function(){i=Math.round(r.util.realClock.now()-n)})),e.addNamedListener(\"API_CALL_ATTEMPT\",\"success\",(function(){var n=u.apiAttemptEvent(e);n.Timestamp=t,n.AttemptLatency=i>=0?i:0,n.Region=s,u.emit(\"apiCallAttempt\",[n])})),e.addNamedListener(\"API_CALL_ATTEMPT_RETRY\",\"retry\",(function(){var o=u.attemptFailEvent(e);o.Timestamp=t,i=i||Math.round(r.util.realClock.now()-n),o.AttemptLatency=i>=0?i:0,o.Region=s,u.emit(\"apiCallAttempt\",[o])})),e.addNamedListener(\"API_CALL\",\"complete\",(function(){var t=u.apiCallEvent(e);if(t.AttemptCount=c,!(t.AttemptCount<=0)){t.Timestamp=a;var n=Math.round(r.util.realClock.now()-o);t.Latency=n>=0?n:0;var i=e.response;i.error&&i.error.retryable&&\"number\"==typeof i.retryCount&&\"number\"==typeof i.maxRetries&&i.retryCount>=i.maxRetries&&(t.MaxRetriesExceeded=1),u.emit(\"apiCall\",[t])}}))},setupRequestListeners:function(e){},getSigningName:function(){return this.api.signingName||this.api.endpointPrefix},getSignerClass:function(e){var t,n=null,i=\"\";return e&&(i=(n=(e.service.api.operations||{})[e.operation]||null)?n.authtype:\"\"),t=this.config.signatureVersion?this.config.signatureVersion:\"v4\"===i||\"v4-unsigned-body\"===i?\"v4\":this.api.signatureVersion,r.Signers.RequestSigner.getVersion(t)},serviceInterface:function(){switch(this.api.protocol){case\"ec2\":case\"query\":return r.EventListeners.Query;case\"json\":return r.EventListeners.Json;case\"rest-json\":return r.EventListeners.RestJson;case\"rest-xml\":return r.EventListeners.RestXml}if(this.api.protocol)throw new Error(\"Invalid service `protocol' \"+this.api.protocol+\" in API config\")},successfulResponse:function(e){return e.httpResponse.statusCode<300},numRetries:function(){return void 0!==this.config.maxRetries?this.config.maxRetries:this.defaultRetryCount},retryDelays:function(e,t){return r.util.calculateRetryDelay(e,this.config.retryDelayOptions,t)},retryableError:function(e){return!!this.timeoutError(e)||!!this.networkingError(e)||!!this.expiredCredentialsError(e)||!!this.throttledError(e)||e.statusCode>=500},networkingError:function(e){return\"NetworkingError\"===e.code},timeoutError:function(e){return\"TimeoutError\"===e.code},expiredCredentialsError:function(e){return\"ExpiredTokenException\"===e.code},clockSkewError:function(e){switch(e.code){case\"RequestTimeTooSkewed\":case\"RequestExpired\":case\"InvalidSignatureException\":case\"SignatureDoesNotMatch\":case\"AuthFailure\":case\"RequestInTheFuture\":return!0;default:return!1}},getSkewCorrectedDate:function(){return new Date(Date.now()+this.config.systemClockOffset)},applyClockOffset:function(e){e&&(this.config.systemClockOffset=e-Date.now())},isClockSkewed:function(e){if(e)return Math.abs(this.getSkewCorrectedDate().getTime()-e)>=3e5},throttledError:function(e){if(429===e.statusCode)return!0;switch(e.code){case\"ProvisionedThroughputExceededException\":case\"Throttling\":case\"ThrottlingException\":case\"RequestLimitExceeded\":case\"RequestThrottled\":case\"RequestThrottledException\":case\"TooManyRequestsException\":case\"TransactionInProgressException\":case\"EC2ThrottledException\":return!0;default:return!1}},endpointFromTemplate:function(e){if(\"string\"!=typeof e)return e;return e.replace(/\\{service\\}/g,this.api.endpointPrefix).replace(/\\{region\\}/g,this.config.region).replace(/\\{scheme\\}/g,this.config.sslEnabled?\"https\":\"http\")},setEndpoint:function(e){this.endpoint=new r.Endpoint(e,this.config)},paginationConfig:function(e,t){var n=this.api.operations[e].paginator;if(!n){if(t){var i=new Error;throw r.util.error(i,\"No pagination configuration for \"+e)}return null}return n}}),r.util.update(r.Service,{defineMethods:function(e){r.util.each(e.prototype.api.operations,(function(t){e.prototype[t]||(\"none\"===e.prototype.api.operations[t].authtype?e.prototype[t]=function(e,n){return this.makeUnauthenticatedRequest(t,e,n)}:e.prototype[t]=function(e,n){return this.makeRequest(t,e,n)})}))},defineService:function(e,t,n){r.Service._serviceMap[e]=!0,Array.isArray(t)||(n=t,t=[]);var i=s(r.Service,n||{});if(\"string\"==typeof e){r.Service.addVersions(i,t);var o=i.serviceIdentifier||e;i.serviceIdentifier=o}else i.prototype.api=e,r.Service.defineMethods(i);if(r.SequentialExecutor.call(this.prototype),!this.prototype.publisher&&r.util.clientSideMonitoring){var a=r.util.clientSideMonitoring.Publisher,c=(0,r.util.clientSideMonitoring.configProvider)();this.prototype.publisher=new a(c),c.enabled&&(r.Service._clientSideMonitoring=!0)}return r.SequentialExecutor.call(i.prototype),r.Service.addDefaultMonitoringListeners(i.prototype),i},addVersions:function(e,t){Array.isArray(t)||(t=[t]),e.services=e.services||{};for(var n=0;n<t.length;n++)void 0===e.services[t[n]]&&(e.services[t[n]]=null);e.apiVersions=Object.keys(e.services).sort()},defineServiceApi:function(e,t,n){function o(t){t.isApi?a.prototype.api=t:a.prototype.api=new i(t,{serviceIdentifier:e.serviceIdentifier})}var a=s(e,{serviceIdentifier:e.serviceIdentifier});if(\"string\"==typeof t){if(n)o(n);else try{o(r.apiLoader(e.serviceIdentifier,t))}catch(n){throw r.util.error(n,{message:\"Could not find API configuration \"+e.serviceIdentifier+\"-\"+t})}Object.prototype.hasOwnProperty.call(e.services,t)||(e.apiVersions=e.apiVersions.concat(t).sort()),e.services[t]=a}else o(t);return r.Service.defineMethods(a),a},hasService:function(e){return Object.prototype.hasOwnProperty.call(r.Service._serviceMap,e)},addDefaultMonitoringListeners:function(e){e.addNamedListener(\"MONITOR_EVENTS_BUBBLE\",\"apiCallAttempt\",(function(t){var n=Object.getPrototypeOf(e);n._events&&n.emit(\"apiCallAttempt\",[t])})),e.addNamedListener(\"CALL_EVENTS_BUBBLE\",\"apiCall\",(function(t){var n=Object.getPrototypeOf(e);n._events&&n.emit(\"apiCall\",[t])}))},_serviceMap:{}}),r.util.mixin(r.Service,r.SequentialExecutor),t.exports=r.Service}).call(this)}).call(this,e(\"_process\"))},{\"./core\":20,\"./model/api\":40,\"./region_config\":55,_process:87}],62:[function(e,t,n){var r=e(\"../core\");r.util.update(r.CognitoIdentity.prototype,{getOpenIdToken:function(e,t){return this.makeUnauthenticatedRequest(\"getOpenIdToken\",e,t)},getId:function(e,t){return this.makeUnauthenticatedRequest(\"getId\",e,t)},getCredentialsForIdentity:function(e,t){return this.makeUnauthenticatedRequest(\"getCredentialsForIdentity\",e,t)}})},{\"../core\":20}],63:[function(e,t,n){var r=e(\"../core\"),i=e(\"../config_regional_endpoint\");r.util.update(r.STS.prototype,{credentialsFrom:function(e,t){return e?(t||(t=new r.TemporaryCredentials),t.expired=!1,t.accessKeyId=e.Credentials.AccessKeyId,t.secretAccessKey=e.Credentials.SecretAccessKey,t.sessionToken=e.Credentials.SessionToken,t.expireTime=e.Credentials.Expiration,t):null},assumeRoleWithWebIdentity:function(e,t){return this.makeUnauthenticatedRequest(\"assumeRoleWithWebIdentity\",e,t)},assumeRoleWithSAML:function(e,t){return this.makeUnauthenticatedRequest(\"assumeRoleWithSAML\",e,t)},setupRequestListeners:function(e){e.addListener(\"validate\",this.optInRegionalEndpoint,!0)},optInRegionalEndpoint:function(e){var t=e.service,n=t.config;if(n.stsRegionalEndpoints=i(t._originalConfig,{env:\"AWS_STS_REGIONAL_ENDPOINTS\",sharedConfig:\"sts_regional_endpoints\",clientConfig:\"stsRegionalEndpoints\"}),\"regional\"===n.stsRegionalEndpoints&&t.isGlobalEndpoint){if(!n.region)throw r.util.error(new Error,{code:\"ConfigError\",message:\"Missing region in config\"});var o=n.endpoint.indexOf(\".amazonaws.com\"),s=n.endpoint.substring(0,o)+\".\"+n.region+n.endpoint.substring(o);e.httpRequest.updateEndpoint(s),e.httpRequest.region=n.region}}})},{\"../config_regional_endpoint\":19,\"../core\":20}],64:[function(e,t,n){function r(e){var t=e.httpRequest.headers[a],n=e.service.getSignerClass(e);if(delete e.httpRequest.headers[\"User-Agent\"],delete e.httpRequest.headers[\"X-Amz-User-Agent\"],n===o.Signers.V4){if(t>604800)throw o.util.error(new Error,{code:\"InvalidExpiryTime\",message:\"Presigning does not support expiry time greater than a week with SigV4 signing.\",retryable:!1});e.httpRequest.headers[a]=t}else{if(n!==o.Signers.S3)throw o.util.error(new Error,{message:\"Presigning only supports S3 or SigV4 signing.\",code:\"UnsupportedSigner\",retryable:!1});var r=e.service?e.service.getSkewCorrectedDate():o.util.date.getDate();e.httpRequest.headers[a]=parseInt(o.util.date.unixTimestamp(r)+t,10).toString()}}function i(e){var t=e.httpRequest.endpoint,n=o.util.urlParse(e.httpRequest.path),r={};n.search&&(r=o.util.queryStringParse(n.search.substr(1)));var i=e.httpRequest.headers.Authorization.split(\" \");if(\"AWS\"===i[0])i=i[1].split(\":\"),r.Signature=i.pop(),r.AWSAccessKeyId=i.join(\":\"),o.util.each(e.httpRequest.headers,(function(e,t){e===a&&(e=\"Expires\"),0===e.indexOf(\"x-amz-meta-\")&&(delete r[e],e=e.toLowerCase()),r[e]=t})),delete e.httpRequest.headers[a],delete r.Authorization,delete r.Host;else if(\"AWS4-HMAC-SHA256\"===i[0]){i.shift();var s=i.join(\" \").match(/Signature=(.*?)(?:,|\\s|\\r?\\n|$)/)[1];r[\"X-Amz-Signature\"]=s,delete r.Expires}t.pathname=n.pathname,t.search=o.util.queryParamsToString(r)}var o=e(\"../core\"),s=o.util.inherit,a=\"presigned-expires\";o.Signers.Presign=s({sign:function(e,t,n){if(e.httpRequest.headers[a]=t||3600,e.on(\"build\",r),e.on(\"sign\",i),e.removeListener(\"afterBuild\",o.EventListeners.Core.SET_CONTENT_LENGTH),e.removeListener(\"afterBuild\",o.EventListeners.Core.COMPUTE_SHA256),e.emit(\"beforePresign\",[e]),!n){if(e.build(),e.response.error)throw e.response.error;return o.util.urlFormat(e.httpRequest.endpoint)}e.build((function(){this.response.error?n(this.response.error):n(null,o.util.urlFormat(e.httpRequest.endpoint))}))}}),t.exports=o.Signers.Presign},{\"../core\":20}],65:[function(e,t,n){var r=e(\"../core\"),i=r.util.inherit;r.Signers.RequestSigner=i({constructor:function(e){this.request=e},setServiceClientId:function(e){this.serviceClientId=e},getServiceClientId:function(){return this.serviceClientId}}),r.Signers.RequestSigner.getVersion=function(e){switch(e){case\"v2\":return r.Signers.V2;case\"v3\":return r.Signers.V3;case\"s3v4\":case\"v4\":return r.Signers.V4;case\"s3\":return r.Signers.S3;case\"v3https\":return r.Signers.V3Https}throw new Error(\"Unknown signing version \"+e)},e(\"./v2\"),e(\"./v3\"),e(\"./v3https\"),e(\"./v4\"),e(\"./s3\"),e(\"./presign\")},{\"../core\":20,\"./presign\":64,\"./s3\":66,\"./v2\":67,\"./v3\":68,\"./v3https\":69,\"./v4\":70}],66:[function(e,t,n){var r=e(\"../core\"),i=r.util.inherit;r.Signers.S3=i(r.Signers.RequestSigner,{subResources:{acl:1,accelerate:1,analytics:1,cors:1,lifecycle:1,delete:1,inventory:1,location:1,logging:1,metrics:1,notification:1,partNumber:1,policy:1,requestPayment:1,replication:1,restore:1,tagging:1,torrent:1,uploadId:1,uploads:1,versionId:1,versioning:1,versions:1,website:1},responseHeaders:{\"response-content-type\":1,\"response-content-language\":1,\"response-expires\":1,\"response-cache-control\":1,\"response-content-disposition\":1,\"response-content-encoding\":1},addAuthorization:function(e,t){this.request.headers[\"presigned-expires\"]||(this.request.headers[\"X-Amz-Date\"]=r.util.date.rfc822(t)),e.sessionToken&&(this.request.headers[\"x-amz-security-token\"]=e.sessionToken);var n=this.sign(e.secretAccessKey,this.stringToSign()),i=\"AWS \"+e.accessKeyId+\":\"+n;this.request.headers.Authorization=i},stringToSign:function(){var e=this.request,t=[];t.push(e.method),t.push(e.headers[\"Content-MD5\"]||\"\"),t.push(e.headers[\"Content-Type\"]||\"\"),t.push(e.headers[\"presigned-expires\"]||\"\");var n=this.canonicalizedAmzHeaders();return n&&t.push(n),t.push(this.canonicalizedResource()),t.join(\"\\n\")},canonicalizedAmzHeaders:function(){var e=[];r.util.each(this.request.headers,(function(t){t.match(/^x-amz-/i)&&e.push(t)})),e.sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:1}));var t=[];return r.util.arrayEach.call(this,e,(function(e){t.push(e.toLowerCase()+\":\"+String(this.request.headers[e]))})),t.join(\"\\n\")},canonicalizedResource:function(){var e=this.request,t=e.path.split(\"?\"),n=t[0],i=t[1],o=\"\";if(e.virtualHostedBucket&&(o+=\"/\"+e.virtualHostedBucket),o+=n,i){var s=[];r.util.arrayEach.call(this,i.split(\"&\"),(function(e){var t=e.split(\"=\")[0],n=e.split(\"=\")[1];if(this.subResources[t]||this.responseHeaders[t]){var r={name:t};void 0!==n&&(this.subResources[t]?r.value=n:r.value=decodeURIComponent(n)),s.push(r)}})),s.sort((function(e,t){return e.name<t.name?-1:1})),s.length&&(i=[],r.util.arrayEach(s,(function(e){void 0===e.value?i.push(e.name):i.push(e.name+\"=\"+e.value)})),o+=\"?\"+i.join(\"&\"))}return o},sign:function(e,t){return r.util.crypto.hmac(e,t,\"base64\",\"sha1\")}}),t.exports=r.Signers.S3},{\"../core\":20}],67:[function(e,t,n){var r=e(\"../core\"),i=r.util.inherit;r.Signers.V2=i(r.Signers.RequestSigner,{addAuthorization:function(e,t){t||(t=r.util.date.getDate());var n=this.request;n.params.Timestamp=r.util.date.iso8601(t),n.params.SignatureVersion=\"2\",n.params.SignatureMethod=\"HmacSHA256\",n.params.AWSAccessKeyId=e.accessKeyId,e.sessionToken&&(n.params.SecurityToken=e.sessionToken),delete n.params.Signature,n.params.Signature=this.signature(e),n.body=r.util.queryParamsToString(n.params),n.headers[\"Content-Length\"]=n.body.length},signature:function(e){return r.util.crypto.hmac(e.secretAccessKey,this.stringToSign(),\"base64\")},stringToSign:function(){var e=[];return e.push(this.request.method),e.push(this.request.endpoint.host.toLowerCase()),e.push(this.request.pathname()),e.push(r.util.queryParamsToString(this.request.params)),e.join(\"\\n\")}}),t.exports=r.Signers.V2},{\"../core\":20}],68:[function(e,t,n){var r=e(\"../core\"),i=r.util.inherit;r.Signers.V3=i(r.Signers.RequestSigner,{addAuthorization:function(e,t){var n=r.util.date.rfc822(t);this.request.headers[\"X-Amz-Date\"]=n,e.sessionToken&&(this.request.headers[\"x-amz-security-token\"]=e.sessionToken),this.request.headers[\"X-Amzn-Authorization\"]=this.authorization(e,n)},authorization:function(e){return\"AWS3 AWSAccessKeyId=\"+e.accessKeyId+\",Algorithm=HmacSHA256,SignedHeaders=\"+this.signedHeaders()+\",Signature=\"+this.signature(e)},signedHeaders:function(){var e=[];return r.util.arrayEach(this.headersToSign(),(function(t){e.push(t.toLowerCase())})),e.sort().join(\";\")},canonicalHeaders:function(){var e=this.request.headers,t=[];return r.util.arrayEach(this.headersToSign(),(function(n){t.push(n.toLowerCase().trim()+\":\"+String(e[n]).trim())})),t.sort().join(\"\\n\")+\"\\n\"},headersToSign:function(){var e=[];return r.util.each(this.request.headers,(function(t){(\"Host\"===t||\"Content-Encoding\"===t||t.match(/^X-Amz/i))&&e.push(t)})),e},signature:function(e){return r.util.crypto.hmac(e.secretAccessKey,this.stringToSign(),\"base64\")},stringToSign:function(){var e=[];return e.push(this.request.method),e.push(\"/\"),e.push(\"\"),e.push(this.canonicalHeaders()),e.push(this.request.body),r.util.crypto.sha256(e.join(\"\\n\"))}}),t.exports=r.Signers.V3},{\"../core\":20}],69:[function(e,t,n){var r=e(\"../core\"),i=r.util.inherit;e(\"./v3\"),r.Signers.V3Https=i(r.Signers.V3,{authorization:function(e){return\"AWS3-HTTPS AWSAccessKeyId=\"+e.accessKeyId+\",Algorithm=HmacSHA256,Signature=\"+this.signature(e)},stringToSign:function(){return this.request.headers[\"X-Amz-Date\"]}}),t.exports=r.Signers.V3Https},{\"../core\":20,\"./v3\":68}],70:[function(e,t,n){var r=e(\"../core\"),i=e(\"./v4_credentials\"),o=r.util.inherit;r.Signers.V4=o(r.Signers.RequestSigner,{constructor:function(e,t,n){r.Signers.RequestSigner.call(this,e),this.serviceName=t,n=n||{},this.signatureCache=\"boolean\"!=typeof n.signatureCache||n.signatureCache,this.operation=n.operation,this.signatureVersion=n.signatureVersion},algorithm:\"AWS4-HMAC-SHA256\",addAuthorization:function(e,t){var n=r.util.date.iso8601(t).replace(/[:\\-]|\\.\\d{3}/g,\"\");this.isPresigned()?this.updateForPresigned(e,n):this.addHeaders(e,n),this.request.headers.Authorization=this.authorization(e,n)},addHeaders:function(e,t){this.request.headers[\"X-Amz-Date\"]=t,e.sessionToken&&(this.request.headers[\"x-amz-security-token\"]=e.sessionToken)},updateForPresigned:function(e,t){var n=this.credentialString(t),i={\"X-Amz-Date\":t,\"X-Amz-Algorithm\":this.algorithm,\"X-Amz-Credential\":e.accessKeyId+\"/\"+n,\"X-Amz-Expires\":this.request.headers[\"presigned-expires\"],\"X-Amz-SignedHeaders\":this.signedHeaders()};e.sessionToken&&(i[\"X-Amz-Security-Token\"]=e.sessionToken),this.request.headers[\"Content-Type\"]&&(i[\"Content-Type\"]=this.request.headers[\"Content-Type\"]),this.request.headers[\"Content-MD5\"]&&(i[\"Content-MD5\"]=this.request.headers[\"Content-MD5\"]),this.request.headers[\"Cache-Control\"]&&(i[\"Cache-Control\"]=this.request.headers[\"Cache-Control\"]),r.util.each.call(this,this.request.headers,(function(e,t){if(\"presigned-expires\"!==e&&this.isSignableHeader(e)){var n=e.toLowerCase();0===n.indexOf(\"x-amz-meta-\")?i[n]=t:0===n.indexOf(\"x-amz-\")&&(i[e]=t)}}));var o=this.request.path.indexOf(\"?\")>=0?\"&\":\"?\";this.request.path+=o+r.util.queryParamsToString(i)},authorization:function(e,t){var n=[],r=this.credentialString(t);return n.push(this.algorithm+\" Credential=\"+e.accessKeyId+\"/\"+r),n.push(\"SignedHeaders=\"+this.signedHeaders()),n.push(\"Signature=\"+this.signature(e,t)),n.join(\", \")},signature:function(e,t){var n=i.getSigningKey(e,t.substr(0,8),this.request.region,this.serviceName,this.signatureCache);return r.util.crypto.hmac(n,this.stringToSign(t),\"hex\")},stringToSign:function(e){var t=[];return t.push(\"AWS4-HMAC-SHA256\"),t.push(e),t.push(this.credentialString(e)),t.push(this.hexEncodedHash(this.canonicalString())),t.join(\"\\n\")},canonicalString:function(){var e=[],t=this.request.pathname();return\"s3\"!==this.serviceName&&\"s3v4\"!==this.signatureVersion&&(t=r.util.uriEscapePath(t)),e.push(this.request.method),e.push(t),e.push(this.request.search()),e.push(this.canonicalHeaders()+\"\\n\"),e.push(this.signedHeaders()),e.push(this.hexEncodedBodyHash()),e.join(\"\\n\")},canonicalHeaders:function(){var e=[];r.util.each.call(this,this.request.headers,(function(t,n){e.push([t,n])})),e.sort((function(e,t){return e[0].toLowerCase()<t[0].toLowerCase()?-1:1}));var t=[];return r.util.arrayEach.call(this,e,(function(e){var n=e[0].toLowerCase();if(this.isSignableHeader(n)){var i=e[1];if(null==i||\"function\"!=typeof i.toString)throw r.util.error(new Error(\"Header \"+n+\" contains invalid value\"),{code:\"InvalidHeader\"});t.push(n+\":\"+this.canonicalHeaderValues(i.toString()))}})),t.join(\"\\n\")},canonicalHeaderValues:function(e){return e.replace(/\\s+/g,\" \").replace(/^\\s+|\\s+$/g,\"\")},signedHeaders:function(){var e=[];return r.util.each.call(this,this.request.headers,(function(t){t=t.toLowerCase(),this.isSignableHeader(t)&&e.push(t)})),e.sort().join(\";\")},credentialString:function(e){return i.createScope(e.substr(0,8),this.request.region,this.serviceName)},hexEncodedHash:function(e){return r.util.crypto.sha256(e,\"hex\")},hexEncodedBodyHash:function(){var e=this.request;return this.isPresigned()&&\"s3\"===this.serviceName&&!e.body?\"UNSIGNED-PAYLOAD\":e.headers[\"X-Amz-Content-Sha256\"]?e.headers[\"X-Amz-Content-Sha256\"]:this.hexEncodedHash(this.request.body||\"\")},unsignableHeaders:[\"authorization\",\"content-type\",\"content-length\",\"user-agent\",\"presigned-expires\",\"expect\",\"x-amzn-trace-id\"],isSignableHeader:function(e){return 0===e.toLowerCase().indexOf(\"x-amz-\")||this.unsignableHeaders.indexOf(e)<0},isPresigned:function(){return!!this.request.headers[\"presigned-expires\"]}}),t.exports=r.Signers.V4},{\"../core\":20,\"./v4_credentials\":71}],71:[function(e,t,n){var r=e(\"../core\"),i={},o=[];t.exports={createScope:function(e,t,n){return[e.substr(0,8),t,n,\"aws4_request\"].join(\"/\")},getSigningKey:function(e,t,n,s,a){var c=[r.util.crypto.hmac(e.secretAccessKey,e.accessKeyId,\"base64\"),t,n,s].join(\"_\");if((a=!1!==a)&&c in i)return i[c];var u=r.util.crypto.hmac(\"AWS4\"+e.secretAccessKey,t,\"buffer\"),l=r.util.crypto.hmac(u,n,\"buffer\"),p=r.util.crypto.hmac(l,s,\"buffer\"),d=r.util.crypto.hmac(p,\"aws4_request\",\"buffer\");return a&&(i[c]=d,o.push(c),o.length>50&&delete i[o.shift()]),d},emptyCache:function(){i={},o=[]}}},{\"../core\":20}],72:[function(e,t,n){function r(e,t){this.currentState=t||null,this.states=e||{}}r.prototype.runTo=function(e,t,n,r){\"function\"==typeof e&&(r=n,n=t,t=e,e=null);var i=this,o=i.states[i.currentState];o.fn.call(n||i,r,(function(r){if(r){if(!o.fail)return t?t.call(n,r):null;i.currentState=o.fail}else{if(!o.accept)return t?t.call(n):null;i.currentState=o.accept}if(i.currentState===e)return t?t.call(n,r):null;i.runTo(e,t,n,r)}))},r.prototype.addState=function(e,t,n,r){return\"function\"==typeof t?(r=t,t=null,n=null):\"function\"==typeof n&&(r=n,n=null),this.currentState||(this.currentState=e),this.states[e]={accept:t,fail:n,fn:r},this},t.exports=r},{}],73:[function(e,t,n){(function(n,r){(function(){var i,o={environment:\"nodejs\",engine:function(){if(o.isBrowser()&&\"undefined\"!=typeof navigator)return navigator.userAgent;var e=n.platform+\"/\"+n.version;return n.env.AWS_EXECUTION_ENV&&(e+=\" exec-env/\"+n.env.AWS_EXECUTION_ENV),e},userAgent:function(){var t=o.environment,n=\"aws-sdk-\"+t+\"/\"+e(\"./core\").VERSION;return\"nodejs\"===t&&(n+=\" \"+o.engine()),n},uriEscape:function(e){var t=encodeURIComponent(e);return(t=t.replace(/[^A-Za-z0-9_.~\\-%]+/g,escape)).replace(/[*]/g,(function(e){return\"%\"+e.charCodeAt(0).toString(16).toUpperCase()}))},uriEscapePath:function(e){var t=[];return o.arrayEach(e.split(\"/\"),(function(e){t.push(o.uriEscape(e))})),t.join(\"/\")},urlParse:function(e){return o.url.parse(e)},urlFormat:function(e){return o.url.format(e)},queryStringParse:function(e){return o.querystring.parse(e)},queryParamsToString:function(e){var t=[],n=o.uriEscape,r=Object.keys(e).sort();return o.arrayEach(r,(function(r){var i=e[r],s=n(r),a=s+\"=\";if(Array.isArray(i)){var c=[];o.arrayEach(i,(function(e){c.push(n(e))})),a=s+\"=\"+c.sort().join(\"&\"+s+\"=\")}else null!=i&&(a=s+\"=\"+n(i));t.push(a)})),t.join(\"&\")},readFileSync:function(t){return o.isBrowser()?null:e(\"fs\").readFileSync(t,\"utf-8\")},base64:{encode:function(e){if(\"number\"==typeof e)throw o.error(new Error(\"Cannot base64 encode number \"+e));return null==e?e:o.buffer.toBuffer(e).toString(\"base64\")},decode:function(e){if(\"number\"==typeof e)throw o.error(new Error(\"Cannot base64 decode number \"+e));return null==e?e:o.buffer.toBuffer(e,\"base64\")}},buffer:{toBuffer:function(e,t){return\"function\"==typeof o.Buffer.from&&o.Buffer.from!==Uint8Array.from?o.Buffer.from(e,t):new o.Buffer(e,t)},alloc:function(e,t,n){if(\"number\"!=typeof e)throw new Error(\"size passed to alloc must be a number.\");if(\"function\"==typeof o.Buffer.alloc)return o.Buffer.alloc(e,t,n);var r=new o.Buffer(e);return void 0!==t&&\"function\"==typeof r.fill&&r.fill(t,void 0,void 0,n),r},toStream:function(e){o.Buffer.isBuffer(e)||(e=o.buffer.toBuffer(e));var t=new o.stream.Readable,n=0;return t._read=function(r){if(n>=e.length)return t.push(null);var i=n+r;i>e.length&&(i=e.length),t.push(e.slice(n,i)),n=i},t},concat:function(e){var t,n,r=0,i=0;for(t=0;t<e.length;t++)r+=e[t].length;for(n=o.buffer.alloc(r),t=0;t<e.length;t++)e[t].copy(n,i),i+=e[t].length;return n}},string:{byteLength:function(t){if(null==t)return 0;if(\"string\"==typeof t&&(t=o.buffer.toBuffer(t)),\"number\"==typeof t.byteLength)return t.byteLength;if(\"number\"==typeof t.length)return t.length;if(\"number\"==typeof t.size)return t.size;if(\"string\"==typeof t.path)return e(\"fs\").lstatSync(t.path).size;throw o.error(new Error(\"Cannot determine length of \"+t),{object:t})},upperFirst:function(e){return e[0].toUpperCase()+e.substr(1)},lowerFirst:function(e){return e[0].toLowerCase()+e.substr(1)}},ini:{parse:function(e){var t,n={};return o.arrayEach(e.split(/\\r?\\n/),(function(e){var r=(e=e.split(/(^|\\s)[;#]/)[0]).match(/^\\s*\\[([^\\[\\]]+)\\]\\s*$/);if(r)t=r[1];else if(t){var i=e.match(/^\\s*(.+?)\\s*=\\s*(.+?)\\s*$/);i&&(n[t]=n[t]||{},n[t][i[1]]=i[2])}})),n}},fn:{noop:function(){},callback:function(e){if(e)throw e},makeAsync:function(e,t){return t&&t<=e.length?e:function(){var t=Array.prototype.slice.call(arguments,0);t.pop()(e.apply(null,t))}}},date:{getDate:function(){return i||(i=e(\"./core\")),i.config.systemClockOffset?new Date((new Date).getTime()+i.config.systemClockOffset):new Date},iso8601:function(e){return void 0===e&&(e=o.date.getDate()),e.toISOString().replace(/\\.\\d{3}Z$/,\"Z\")},rfc822:function(e){return void 0===e&&(e=o.date.getDate()),e.toUTCString()},unixTimestamp:function(e){return void 0===e&&(e=o.date.getDate()),e.getTime()/1e3},from:function(e){return\"number\"==typeof e?new Date(1e3*e):new Date(e)},format:function(e,t){return t||(t=\"iso8601\"),o.date[t](o.date.from(e))},parseTimestamp:function(e){if(\"number\"==typeof e)return new Date(1e3*e);if(e.match(/^\\d+$/))return new Date(1e3*e);if(e.match(/^\\d{4}/))return new Date(e);if(e.match(/^\\w{3},/))return new Date(e);throw o.error(new Error(\"unhandled timestamp format: \"+e),{code:\"TimestampParserError\"})}},crypto:{crc32Table:[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],crc32:function(e){var t=o.crypto.crc32Table,n=-1;\"string\"==typeof e&&(e=o.buffer.toBuffer(e));for(var r=0;r<e.length;r++)n=n>>>8^t[255&(n^e.readUInt8(r))];return(-1^n)>>>0},hmac:function(e,t,n,r){return n||(n=\"binary\"),\"buffer\"===n&&(n=void 0),r||(r=\"sha256\"),\"string\"==typeof t&&(t=o.buffer.toBuffer(t)),o.crypto.lib.createHmac(r,e).update(t).digest(n)},md5:function(e,t,n){return o.crypto.hash(\"md5\",e,t,n)},sha256:function(e,t,n){return o.crypto.hash(\"sha256\",e,t,n)},hash:function(e,t,n,r){var i=o.crypto.createHash(e);n||(n=\"binary\"),\"buffer\"===n&&(n=void 0),\"string\"==typeof t&&(t=o.buffer.toBuffer(t));var s=o.arraySliceFn(t),a=o.Buffer.isBuffer(t);if(o.isBrowser()&&\"undefined\"!=typeof ArrayBuffer&&t&&t.buffer instanceof ArrayBuffer&&(a=!0),r&&\"object\"==typeof t&&\"function\"==typeof t.on&&!a)t.on(\"data\",(function(e){i.update(e)})),t.on(\"error\",(function(e){r(e)})),t.on(\"end\",(function(){r(null,i.digest(n))}));else{if(!r||!s||a||\"undefined\"==typeof FileReader){o.isBrowser()&&\"object\"==typeof t&&!a&&(t=new o.Buffer(new Uint8Array(t)));var c=i.update(t).digest(n);return r&&r(null,c),c}var u=0,l=new FileReader;l.onerror=function(){r(new Error(\"Failed to read data.\"))},l.onload=function(){var e=new o.Buffer(new Uint8Array(l.result));i.update(e),u+=e.length,l._continueReading()},l._continueReading=function(){if(u>=t.size)r(null,i.digest(n));else{var e=u+524288;e>t.size&&(e=t.size),l.readAsArrayBuffer(s.call(t,u,e))}},l._continueReading()}},toHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((\"0\"+e.charCodeAt(n).toString(16)).substr(-2,2));return t.join(\"\")},createHash:function(e){return o.crypto.lib.createHash(e)}},abort:{},each:function(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t.call(this,n,e[n])===o.abort)break},arrayEach:function(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t.call(this,e[n],parseInt(n,10))===o.abort)break},update:function(e,t){return o.each(t,(function(t,n){e[t]=n})),e},merge:function(e,t){return o.update(o.copy(e),t)},copy:function(e){if(null==e)return e;var t={};for(var n in e)t[n]=e[n];return t},isEmpty:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},arraySliceFn:function(e){var t=e.slice||e.webkitSlice||e.mozSlice;return\"function\"==typeof t?t:null},isType:function(e,t){return\"function\"==typeof t&&(t=o.typeName(t)),Object.prototype.toString.call(e)===\"[object \"+t+\"]\"},typeName:function(e){if(Object.prototype.hasOwnProperty.call(e,\"name\"))return e.name;var t=e.toString(),n=t.match(/^\\s*function (.+)\\(/);return n?n[1]:t},error:function(e,t){var n=null;return\"string\"==typeof e.message&&\"\"!==e.message&&(\"string\"==typeof t||t&&t.message)&&((n=o.copy(e)).message=e.message),e.message=e.message||null,\"string\"==typeof t?e.message=t:\"object\"==typeof t&&null!==t&&(o.update(e,t),t.message&&(e.message=t.message),(t.code||t.name)&&(e.code=t.code||t.name),t.stack&&(e.stack=t.stack)),\"function\"==typeof Object.defineProperty&&(Object.defineProperty(e,\"name\",{writable:!0,enumerable:!1}),Object.defineProperty(e,\"message\",{enumerable:!0})),e.name=String(t&&t.name||e.name||e.code||\"Error\"),e.time=new Date,n&&(e.originalError=n),e},inherit:function(e,t){var n=null;if(void 0===t)t=e,e=Object,n={};else{var r=function(){};r.prototype=e.prototype,n=new r}return t.constructor===Object&&(t.constructor=function(){if(e!==Object)return e.apply(this,arguments)}),t.constructor.prototype=n,o.update(t.constructor.prototype,t),t.constructor.__super__=e,t.constructor},mixin:function(){for(var e=arguments[0],t=1;t<arguments.length;t++)for(var n in arguments[t].prototype){var r=arguments[t].prototype[n];\"constructor\"!==n&&(e.prototype[n]=r)}return e},hideProperties:function(e,t){\"function\"==typeof Object.defineProperty&&o.arrayEach(t,(function(t){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0})}))},property:function(e,t,n,r,i){var o={configurable:!0,enumerable:void 0===r||r};\"function\"!=typeof n||i?(o.value=n,o.writable=!0):o.get=n,Object.defineProperty(e,t,o)},memoizedProperty:function(e,t,n,r){var i=null;o.property(e,t,(function(){return null===i&&(i=n()),i}),r)},hoistPayloadMember:function(e){var t=e.request,n=t.operation,r=t.service.api.operations[n],i=r.output;if(i.payload&&!r.hasEventOutput){var s=i.members[i.payload],a=e.data[i.payload];\"structure\"===s.type&&o.each(a,(function(t,n){o.property(e.data,t,n,!1)}))}},computeSha256:function(t,n){if(o.isNode()){var r=o.stream.Stream,i=e(\"fs\");if(\"function\"==typeof r&&t instanceof r){if(\"string\"!=typeof t.path)return n(new Error(\"Non-file stream objects are not supported with SigV4\"));var s={};\"number\"==typeof t.start&&(s.start=t.start),\"number\"==typeof t.end&&(s.end=t.end),t=i.createReadStream(t.path,s)}}o.crypto.sha256(t,\"hex\",(function(e,t){e?n(e):n(null,t)}))},isClockSkewed:function(e){if(e)return o.property(i.config,\"isClockSkewed\",Math.abs((new Date).getTime()-e)>=3e5,!1),i.config.isClockSkewed},applyClockOffset:function(e){e&&(i.config.systemClockOffset=e-(new Date).getTime())},extractRequestId:function(e){var t=e.httpResponse.headers[\"x-amz-request-id\"]||e.httpResponse.headers[\"x-amzn-requestid\"];!t&&e.data&&e.data.ResponseMetadata&&(t=e.data.ResponseMetadata.RequestId),t&&(e.requestId=t),e.error&&(e.error.requestId=t)},addPromises:function(e,t){var n=!1;void 0===t&&i&&i.config&&(t=i.config.getPromisesDependency()),void 0===t&&\"undefined\"!=typeof Promise&&(t=Promise),\"function\"!=typeof t&&(n=!0),Array.isArray(e)||(e=[e]);for(var r=0;r<e.length;r++){var o=e[r];n?o.deletePromisesFromClass&&o.deletePromisesFromClass():o.addPromisesToClass&&o.addPromisesToClass(t)}},promisifyMethod:function(e,t){return function(){var n=this,r=Array.prototype.slice.call(arguments);return new t((function(t,i){r.push((function(e,n){e?i(e):t(n)})),n[e].apply(n,r)}))}},isDualstackAvailable:function(t){if(!t)return!1;var n=e(\"../apis/metadata.json\");return\"string\"!=typeof t&&(t=t.serviceIdentifier),!(\"string\"!=typeof t||!n.hasOwnProperty(t)||!n[t].dualstackAvailable)},calculateRetryDelay:function(e,t,n){t||(t={});var r=t.customBackoff||null;if(\"function\"==typeof r)return r(e,n);var i=\"number\"==typeof t.base?t.base:100;return Math.random()*(Math.pow(2,e)*i)},handleRequestWithRetries:function(e,t,n){t||(t={});var r=i.HttpClient.getInstance(),s=t.httpOptions||{},a=0,c=function(e){var r=t.maxRetries||0;if(e&&\"TimeoutError\"===e.code&&(e.retryable=!0),e&&e.retryable&&a<r){var i=o.calculateRetryDelay(a,t.retryDelayOptions,e);if(i>=0)return a++,void setTimeout(u,i+(e.retryAfter||0))}n(e)},u=function(){var t=\"\";r.handleRequest(e,s,(function(e){e.on(\"data\",(function(e){t+=e.toString()})),e.on(\"end\",(function(){var r=e.statusCode;if(r<300)n(null,t);else{var i=1e3*parseInt(e.headers[\"retry-after\"],10)||0,s=o.error(new Error,{statusCode:r,retryable:r>=500||429===r});i&&s.retryable&&(s.retryAfter=i),c(s)}}))}),c)};i.util.defer(u)},uuid:{v4:function(){return e(\"uuid\").v4()}},convertPayloadToString:function(e){var t=e.request,n=t.operation,r=t.service.api.operations[n].output||{};r.payload&&e.data[r.payload]&&(e.data[r.payload]=e.data[r.payload].toString())},defer:function(e){\"object\"==typeof n&&\"function\"==typeof n.nextTick?n.nextTick(e):\"function\"==typeof r?r(e):setTimeout(e,0)},getRequestPayloadShape:function(e){var t=e.service.api.operations;if(t){var n=(t||{})[e.operation];if(n&&n.input&&n.input.payload)return n.input.members[n.input.payload]}},getProfilesFromSharedConfig:function(e,t){function r(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++)e[r[n]]=t[r[n]];return e}var i={},s={};n.env[o.configOptInEnv]&&(s=e.loadFrom({isConfig:!0,filename:n.env[o.sharedConfigFileEnv]}));for(var a=e.loadFrom({filename:t||n.env[o.configOptInEnv]&&n.env[o.sharedCredentialsFileEnv]}),c=0,u=Object.keys(s);c<u.length;c++)i[u[c]]=r(i[u[c]]||{},s[u[c]]);for(c=0,u=Object.keys(a);c<u.length;c++)i[u[c]]=r(i[u[c]]||{},a[u[c]]);return i},ARN:{validate:function(e){return e&&0===e.indexOf(\"arn:\")&&e.split(\":\").length>=6},parse:function(e){var t=e.split(\":\");return{partition:t[1],service:t[2],region:t[3],accountId:t[4],resource:t.slice(5).join(\":\")}},build:function(e){if(void 0===e.service||void 0===e.region||void 0===e.accountId||void 0===e.resource)throw o.error(new Error(\"Input ARN object is invalid\"));return\"arn:\"+(e.partition||\"aws\")+\":\"+e.service+\":\"+e.region+\":\"+e.accountId+\":\"+e.resource}},defaultProfile:\"default\",configOptInEnv:\"AWS_SDK_LOAD_CONFIG\",sharedCredentialsFileEnv:\"AWS_SHARED_CREDENTIALS_FILE\",sharedConfigFileEnv:\"AWS_CONFIG_FILE\",imdsDisabledEnv:\"AWS_EC2_METADATA_DISABLED\"};t.exports=o}).call(this)}).call(this,e(\"_process\"),e(\"timers\").setImmediate)},{\"../apis/metadata.json\":5,\"./core\":20,_process:87,fs:81,timers:95,uuid:100}],74:[function(e,t,n){function r(){}function i(e,t){for(var n=e.getElementsByTagName(t),r=0,i=n.length;r<i;r++)if(n[r].parentNode===e)return n[r]}function o(e,t){switch(t||(t={}),t.type){case\"structure\":return s(e,t);case\"map\":return function(e,t){for(var n={},r=t.key.name||\"key\",s=t.value.name||\"value\",a=t.flattened?t.name:\"entry\",c=e.firstElementChild;c;){if(c.nodeName===a){var u=i(c,r).textContent,l=i(c,s);n[u]=o(l,t.value)}c=c.nextElementSibling}return n}(e,t);case\"list\":return function(e,t){for(var n=[],r=t.flattened?t.name:t.member.name||\"member\",i=e.firstElementChild;i;)i.nodeName===r&&n.push(o(i,t.member)),i=i.nextElementSibling;return n}(e,t);case void 0:case null:return function(e){if(null==e)return\"\";if(!e.firstElementChild)return null===e.parentNode.parentNode?{}:0===e.childNodes.length?\"\":e.textContent;for(var t={type:\"structure\",members:{}},n=e.firstElementChild;n;){var r=n.nodeName;Object.prototype.hasOwnProperty.call(t.members,r)?t.members[r].type=\"list\":t.members[r]={name:r},n=n.nextElementSibling}return s(e,t)}(e);default:return function(e,t){if(e.getAttribute){var n=e.getAttribute(\"encoding\");\"base64\"===n&&(t=new c.create({type:n}))}var r=e.textContent;return\"\"===r&&(r=null),\"function\"==typeof t.toType?t.toType(r):r}(e,t)}}function s(e,t){var n={};return null===e||a.each(t.members,(function(r,s){if(s.isXmlAttribute){if(Object.prototype.hasOwnProperty.call(e.attributes,s.name)){var a=e.attributes[s.name].value;n[r]=o({textContent:a},s)}}else{var c=s.flattened?e:i(e,s.name);c?n[r]=o(c,s):s.flattened||\"list\"!==s.type||t.api.xmlNoDefaultLists||(n[r]=s.defaultValue)}})),n}var a=e(\"../util\"),c=e(\"../model/shape\");r.prototype.parse=function(e,t){if(\"\"===e.replace(/^\\s+/,\"\"))return{};var n,r;try{if(window.DOMParser){try{n=(new DOMParser).parseFromString(e,\"text/xml\")}catch(e){throw a.error(new Error(\"Parse error in document\"),{originalError:e,code:\"XMLParserError\",retryable:!0})}if(null===n.documentElement)throw a.error(new Error(\"Cannot parse empty document.\"),{code:\"XMLParserError\",retryable:!0});var s=n.getElementsByTagName(\"parsererror\")[0];if(s&&(s.parentNode===n||\"body\"===s.parentNode.nodeName||s.parentNode.parentNode===n||\"body\"===s.parentNode.parentNode.nodeName)){var c=s.getElementsByTagName(\"div\")[0]||s;throw a.error(new Error(c.textContent||\"Parser error in document\"),{code:\"XMLParserError\",retryable:!0})}}else{if(!window.ActiveXObject)throw new Error(\"Cannot load XML parser\");if((n=new window.ActiveXObject(\"Microsoft.XMLDOM\")).async=!1,!n.loadXML(e))throw a.error(new Error(\"Parse error in document\"),{code:\"XMLParserError\",retryable:!0})}}catch(e){r=e}if(n&&n.documentElement&&!r){var u=o(n.documentElement,t),l=i(n.documentElement,\"ResponseMetadata\");return l&&(u.ResponseMetadata=o(l,{})),u}if(r)throw a.error(r||new Error,{code:\"XMLParserError\",retryable:!0});return{}},t.exports=r},{\"../model/shape\":45,\"../util\":73}],75:[function(e,t,n){function r(){}function i(e,t,n){switch(n.type){case\"structure\":return function(e,t,n){s.arrayEach(n.memberNames,(function(r){var s=n.members[r];if(\"body\"===s.location){var c=t[r],u=s.name;if(null!=c)if(s.isXmlAttribute)e.addAttribute(u,c);else if(s.flattened)i(e,c,s);else{var l=new a(u);e.addChildNode(l),o(l,s),i(l,c,s)}}}))}(e,t,n);case\"map\":return function(e,t,n){var r=n.key.name||\"key\",o=n.value.name||\"value\";s.each(t,(function(t,s){var c=new a(n.flattened?n.name:\"entry\");e.addChildNode(c);var u=new a(r),l=new a(o);c.addChildNode(u),c.addChildNode(l),i(u,t,n.key),i(l,s,n.value)}))}(e,t,n);case\"list\":return function(e,t,n){n.flattened?s.arrayEach(t,(function(t){var r=n.member.name||n.name,o=new a(r);e.addChildNode(o),i(o,t,n.member)})):s.arrayEach(t,(function(t){var r=n.member.name||\"member\",o=new a(r);e.addChildNode(o),i(o,t,n.member)}))}(e,t,n);default:return function(e,t,n){e.addChildNode(new c(n.toWireFormat(t)))}(e,t,n)}}function o(e,t,n){var r,i=\"xmlns\";t.xmlNamespaceUri?(r=t.xmlNamespaceUri,t.xmlNamespacePrefix&&(i+=\":\"+t.xmlNamespacePrefix)):n&&t.api.xmlNamespaceUri&&(r=t.api.xmlNamespaceUri),r&&e.addAttribute(i,r)}var s=e(\"../util\"),a=e(\"./xml-node\").XmlNode,c=e(\"./xml-text\").XmlText;r.prototype.toXML=function(e,t,n,r){var s=new a(n);return o(s,t,!0),i(s,e,t),s.children.length>0||r?s.toString():\"\"},t.exports=r},{\"../util\":73,\"./xml-node\":78,\"./xml-text\":79}],76:[function(e,t,n){t.exports={escapeAttribute:function(e){return e.replace(/&/g,\"&amp;\").replace(/'/g,\"&apos;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\")}}},{}],77:[function(e,t,n){t.exports={escapeElement:function(e){return e.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\")}}},{}],78:[function(e,t,n){function r(e,t){void 0===t&&(t=[]),this.name=e,this.children=t,this.attributes={}}var i=e(\"./escape-attribute\").escapeAttribute;r.prototype.addAttribute=function(e,t){return this.attributes[e]=t,this},r.prototype.addChildNode=function(e){return this.children.push(e),this},r.prototype.removeAttribute=function(e){return delete this.attributes[e],this},r.prototype.toString=function(){for(var e=Boolean(this.children.length),t=\"<\"+this.name,n=this.attributes,r=0,o=Object.keys(n);r<o.length;r++){var s=o[r],a=n[s];null!=a&&(t+=\" \"+s+'=\"'+i(\"\"+a)+'\"')}return t+(e?\">\"+this.children.map((function(e){return e.toString()})).join(\"\")+\"</\"+this.name+\">\":\"/>\")},t.exports={XmlNode:r}},{\"./escape-attribute\":76}],79:[function(e,t,n){function r(e){this.value=e}var i=e(\"./escape-element\").escapeElement;r.prototype.toString=function(){return i(\"\"+this.value)},t.exports={XmlText:r}},{\"./escape-element\":77}],80:[function(e,t,n){\"use strict\";function r(e){var t=e.length;if(t%4>0)throw new Error(\"Invalid string. Length must be a multiple of 4\");var n=e.indexOf(\"=\");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function i(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}function o(e,t,n){for(var r,o=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(i(r));return o.join(\"\")}n.byteLength=function(e){var t=r(e),n=t[0],i=t[1];return 3*(n+i)/4-i},n.toByteArray=function(e){var t,n,i=r(e),o=i[0],s=i[1],u=new c(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),l=0,p=s>0?o-4:o;for(n=0;n<p;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;return 2===s&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,u[l++]=255&t),1===s&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t),u},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,i=[],a=0,c=n-r;a<c;a+=16383)i.push(o(e,a,a+16383>c?c:a+16383));return 1===r?(t=e[n-1],i.push(s[t>>2]+s[t<<4&63]+\"==\")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+\"=\")),i.join(\"\")};for(var s=[],a=[],c=\"undefined\"!=typeof Uint8Array?Uint8Array:Array,u=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",l=0,p=u.length;l<p;++l)s[l]=u[l],a[u.charCodeAt(l)]=l;a[\"-\".charCodeAt(0)]=62,a[\"_\".charCodeAt(0)]=63},{}],81:[function(e,t,n){},{}],82:[function(e,t,r){(function(t,n){(function(){\"use strict\";function n(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(n()<t)throw new RangeError(\"Invalid typed array length\");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=o.prototype:(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,n){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,n);if(\"number\"==typeof e){if(\"string\"==typeof t)throw new Error(\"If encoding is specified then the first argument must be a string\");return c(this,e)}return s(this,e,t,n)}function s(e,t,n,r){if(\"number\"==typeof t)throw new TypeError('\"value\" argument must not be a number');return\"undefined\"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError(\"'offset' is out of bounds\");if(t.byteLength<n+(r||0))throw new RangeError(\"'length' is out of bounds\");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),o.TYPED_ARRAY_SUPPORT?(e=t).__proto__=o.prototype:e=u(e,t),e}(e,t,n,r):\"string\"==typeof t?function(e,t,n){if(\"string\"==typeof n&&\"\"!==n||(n=\"utf8\"),!o.isEncoding(n))throw new TypeError('\"encoding\" must be a valid string encoding');var r=0|p(t,n),s=(e=i(e,r)).write(t,n);return s!==r&&(e=e.slice(0,s)),e}(e,t,n):function(e,t){if(o.isBuffer(t)){var n=0|l(t.length);return 0===(e=i(e,n)).length||t.copy(e,0,0,n),e}if(t){if(\"undefined\"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||\"length\"in t)return\"number\"!=typeof t.length||function(e){return e!=e}(t.length)?i(e,0):u(e,t);if(\"Buffer\"===t.type&&F(t.data))return u(e,t.data)}throw new TypeError(\"First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.\")}(e,t)}function a(e){if(\"number\"!=typeof e)throw new TypeError('\"size\" argument must be a number');if(e<0)throw new RangeError('\"size\" argument must not be negative')}function c(e,t){if(a(t),e=i(e,t<0?0:0|l(t)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function u(e,t){var n=t.length<0?0:0|l(t.length);e=i(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function l(e){if(e>=n())throw new RangeError(\"Attempt to allocate Buffer larger than maximum size: 0x\"+n().toString(16)+\" bytes\");return 0|e}function p(e,t){if(o.isBuffer(e))return e.length;if(\"undefined\"!=typeof ArrayBuffer&&\"function\"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;\"string\"!=typeof e&&(e=\"\"+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case\"ascii\":case\"latin1\":case\"binary\":return n;case\"utf8\":case\"utf-8\":case void 0:return D(e).length;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return 2*n;case\"hex\":return n>>>1;case\"base64\":return U(e).length;default:if(r)return D(e).length;t=(\"\"+t).toLowerCase(),r=!0}}function d(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return\"\";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return\"\";if((n>>>=0)<=(t>>>=0))return\"\";for(e||(e=\"utf8\");;)switch(e){case\"hex\":return I(this,t,n);case\"utf8\":case\"utf-8\":return C(this,t,n);case\"ascii\":return T(this,t,n);case\"latin1\":case\"binary\":return k(this,t,n);case\"base64\":return E(this,t,n);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return _(this,t,n);default:if(r)throw new TypeError(\"Unknown encoding: \"+e);e=(e+\"\").toLowerCase(),r=!0}}function h(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function f(e,t,n,r,i){if(0===e.length)return-1;if(\"string\"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if(\"string\"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,i);if(\"number\"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&\"function\"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,i);throw new TypeError(\"val must be string, number or Buffer\")}function m(e,t,n,r,i){function o(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var s,a=1,c=e.length,u=t.length;if(void 0!==r&&(\"ucs2\"===(r=String(r).toLowerCase())||\"ucs-2\"===r||\"utf16le\"===r||\"utf-16le\"===r)){if(e.length<2||t.length<2)return-1;a=2,c/=2,u/=2,n/=2}if(i){var l=-1;for(s=n;s<c;s++)if(o(e,s)===o(t,-1===l?0:s-l)){if(-1===l&&(l=s),s-l+1===u)return l*a}else-1!==l&&(s-=s-l),l=-1}else for(n+u>c&&(n=c-u),s=n;s>=0;s--){for(var p=!0,d=0;d<u;d++)if(o(e,s+d)!==o(t,d)){p=!1;break}if(p)return s}return-1}function g(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError(\"Invalid hex string\");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function v(e,t,n,r){return q(D(t,e.length-n),e,n,r)}function y(e,t,n,r){return q(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function b(e,t,n,r){return y(e,t,n,r)}function w(e,t,n,r){return q(U(t),e,n,r)}function S(e,t,n,r){return q(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=(n=e.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function E(e,t,n){return 0===t&&n===e.length?j.fromByteArray(e):j.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,c,u=e[i],l=null,p=u>239?4:u>223?3:u>191?2:1;if(i+p<=n)switch(p){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,p=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=p}return function(e){var t=e.length;if(t<=B)return String.fromCharCode.apply(String,e);for(var n=\"\",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=B));return n}(r)}function T(e,t,n){var r=\"\";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function k(e,t,n){var r=\"\";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function I(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i=\"\",o=t;o<n;++o)i+=P(e[o]);return i}function _(e,t,n){for(var r=e.slice(t,n),i=\"\",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function x(e,t,n){if(e%1!=0||e<0)throw new RangeError(\"offset is not uint\");if(e+t>n)throw new RangeError(\"Trying to access beyond buffer length\")}function A(e,t,n,r,i,s){if(!o.isBuffer(e))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('\"value\" argument is out of bounds');if(n+r>e.length)throw new RangeError(\"Index out of range\")}function R(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function L(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function O(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError(\"Index out of range\");if(n<0)throw new RangeError(\"Index out of range\")}function N(e,t,n,r,i){return i||O(e,0,n,4),W.write(e,t,n,r,23,4),n+4}function M(e,t,n,r,i){return i||O(e,0,n,8),W.write(e,t,n,r,52,8),n+8}function P(e){return e<16?\"0\"+e.toString(16):e.toString(16)}function D(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error(\"Invalid code point\");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function U(e){return j.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\\s+|\\s+$/g,\"\")}(e).replace(z,\"\")).length<2)return\"\";for(;e.length%4!=0;)e+=\"=\";return e}(e))}function q(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}var j=e(\"base64-js\"),W=e(\"ieee754\"),F=e(\"isarray\");r.Buffer=o,r.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},r.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&\"function\"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),r.kMaxLength=n(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,n){return s(null,e,t,n)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,\"undefined\"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,n){return function(e,t,n,r){return a(t),t<=0?i(e,t):void 0!==n?\"string\"==typeof r?i(e,t).fill(n,r):i(e,t).fill(n):i(e,t)}(null,e,t,n)},o.allocUnsafe=function(e){return c(null,e)},o.allocUnsafeSlow=function(e){return c(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError(\"Arguments must be Buffers\");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},o.concat=function(e,t){if(!F(e))throw new TypeError('\"list\" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=o.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!o.isBuffer(s))throw new TypeError('\"list\" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},o.byteLength=p,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError(\"Buffer size must be a multiple of 16-bits\");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError(\"Buffer size must be a multiple of 32-bits\");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError(\"Buffer size must be a multiple of 64-bits\");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?\"\":0===arguments.length?C(this,0,e):d.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e=\"\",t=r.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString(\"hex\",0,t).match(/.{2}/g).join(\" \"),this.length>t&&(e+=\" ... \")),\"<Buffer \"+e+\">\"},o.prototype.compare=function(e,t,n,r,i){if(!o.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError(\"out of range index\");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var s=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),c=Math.min(s,a),u=this.slice(r,i),l=e.slice(t,n),p=0;p<c;++p)if(u[p]!==l[p]){s=u[p],a=l[p];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return f(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return f(this,e,t,n,!1)},o.prototype.write=function(e,t,n,r){if(void 0===t)r=\"utf8\",n=this.length,t=0;else if(void 0===n&&\"string\"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error(\"Buffer.write(string, encoding, offset[, length]) is no longer supported\");t|=0,isFinite(n)?(n|=0,void 0===r&&(r=\"utf8\")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError(\"Attempt to write outside buffer bounds\");r||(r=\"utf8\");for(var o=!1;;)switch(r){case\"hex\":return g(this,e,t,n);case\"utf8\":case\"utf-8\":return v(this,e,t,n);case\"ascii\":return y(this,e,t,n);case\"latin1\":case\"binary\":return b(this,e,t,n);case\"base64\":return w(this,e,t,n);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return S(this,e,t,n);default:if(o)throw new TypeError(\"Unknown encoding: \"+r);r=(\"\"+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}};var B=4096;o.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),o.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=o.prototype;else{var i=t-e;n=new o(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+e]}return n},o.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},o.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},o.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),W.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),W.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),W.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),W.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||A(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||A(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);A(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},o.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);A(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return M(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return M(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError(\"targetStart out of bounds\");if(n<0||n>=this.length)throw new RangeError(\"sourceStart out of bounds\");if(r<0)throw new RangeError(\"sourceEnd out of bounds\");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,s=r-n;if(this===e&&n<t&&t<r)for(i=s-1;i>=0;--i)e[i+t]=this[i+n];else if(s<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),t);return s},o.prototype.fill=function(e,t,n,r){if(\"string\"==typeof e){if(\"string\"==typeof t?(r=t,t=0,n=this.length):\"string\"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&\"string\"!=typeof r)throw new TypeError(\"encoding must be a string\");if(\"string\"==typeof r&&!o.isEncoding(r))throw new TypeError(\"Unknown encoding: \"+r)}else\"number\"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError(\"Out of range index\");if(n<=t)return this;var s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),\"number\"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var a=o.isBuffer(e)?e:D(new o(e,r).toString()),c=a.length;for(s=0;s<n-t;++s)this[s+t]=a[s%c]}return this};var z=/[^+\\/0-9A-Za-z-_]/g}).call(this)}).call(this,void 0!==n.g?n.g:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer)},{\"base64-js\":80,buffer:82,ieee754:84,isarray:85}],83:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return\"function\"==typeof e}function o(e){return\"object\"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!function(e){return\"number\"==typeof e}(e)||e<0||isNaN(e))throw TypeError(\"n must be a positive number\");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,a,c,u;if(this._events||(this._events={}),\"error\"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified \"error\" event. ('+t+\")\");throw l.context=t,l}if(s(n=this._events[e]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(o(n))for(a=Array.prototype.slice.call(arguments,1),r=(u=n.slice()).length,c=0;c<r;c++)u[c].apply(this,a);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError(\"listener must be a function\");return this._events||(this._events={}),this._events.newListener&&this.emit(\"newListener\",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error(\"(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.\",this._events[e].length),\"function\"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError(\"listener must be a function\");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,s,a;if(!i(t))throw TypeError(\"listener must be a function\");if(!this._events||!this._events[e])return this;if(s=(n=this._events[e]).length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit(\"removeListener\",e,t);else if(o(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit(\"removeListener\",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)\"removeListener\"!==t&&this.removeAllListeners(t);return this.removeAllListeners(\"removeListener\"),this._events={},this}if(i(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],84:[function(e,t,n){n.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,p=n?i-1:0,d=n?-1:1,h=e[t+p];for(p+=d,o=h&(1<<-l)-1,h>>=-l,l+=a;l>0;o=256*o+e[t+p],p+=d,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+p],p+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,r),o-=u}return(h?-1:1)*s*Math.pow(2,o-r)},n.write=function(e,t,n,r,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,p=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+p>=1?d/c:d*Math.pow(2,1-p))*c>=2&&(s++,c/=2),s+p>=l?(a=0,s=l):s+p>=1?(a=(t*c-1)*Math.pow(2,i),s+=p):(a=t*Math.pow(2,p-1)*Math.pow(2,i),s=0));i>=8;e[n+h]=255&a,h+=f,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+h]=255&s,h+=f,s/=256,u-=8);e[n+h-f]|=128*m}},{}],85:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return\"[object Array]\"==r.call(e)}},{}],86:[function(e,t,n){!function(e){\"use strict\";function t(e){return null!==e&&\"[object Array]\"===Object.prototype.toString.call(e)}function n(e){return null!==e&&\"[object Object]\"===Object.prototype.toString.call(e)}function r(e,i){if(e===i)return!0;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(i))return!1;if(!0===t(e)){if(e.length!==i.length)return!1;for(var o=0;o<e.length;o++)if(!1===r(e[o],i[o]))return!1;return!0}if(!0===n(e)){var s={};for(var a in e)if(hasOwnProperty.call(e,a)){if(!1===r(e[a],i[a]))return!1;s[a]=!0}for(var c in i)if(hasOwnProperty.call(i,c)&&!0!==s[c])return!1;return!0}return!1}function i(e){if(\"\"===e||!1===e||null===e)return!0;if(t(e)&&0===e.length)return!0;if(n(e)){for(var r in e)if(e.hasOwnProperty(r))return!1;return!0}return!1}function o(e){return e>=\"a\"&&e<=\"z\"||e>=\"A\"&&e<=\"Z\"||\"_\"===e}function s(e){return e>=\"0\"&&e<=\"9\"||\"-\"===e}function a(e){return e>=\"a\"&&e<=\"z\"||e>=\"A\"&&e<=\"Z\"||e>=\"0\"&&e<=\"9\"||\"_\"===e}function c(){}function u(){}function l(e){this.runtime=e}function p(e){this._interpreter=e,this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[h]}]},avg:{_func:this._functionAvg,_signature:[{types:[b]}]},ceil:{_func:this._functionCeil,_signature:[{types:[h]}]},contains:{_func:this._functionContains,_signature:[{types:[m,g]},{types:[f]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[m]},{types:[m]}]},floor:{_func:this._functionFloor,_signature:[{types:[h]}]},length:{_func:this._functionLength,_signature:[{types:[m,g,v]}]},map:{_func:this._functionMap,_signature:[{types:[y]},{types:[g]}]},max:{_func:this._functionMax,_signature:[{types:[b,w]}]},merge:{_func:this._functionMerge,_signature:[{types:[v],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[g]},{types:[y]}]},sum:{_func:this._functionSum,_signature:[{types:[b]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[m]},{types:[m]}]},min:{_func:this._functionMin,_signature:[{types:[b,w]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[g]},{types:[y]}]},type:{_func:this._functionType,_signature:[{types:[f]}]},keys:{_func:this._functionKeys,_signature:[{types:[v]}]},values:{_func:this._functionValues,_signature:[{types:[v]}]},sort:{_func:this._functionSort,_signature:[{types:[w,b]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[g]},{types:[y]}]},join:{_func:this._functionJoin,_signature:[{types:[m]},{types:[w]}]},reverse:{_func:this._functionReverse,_signature:[{types:[m,g]}]},to_array:{_func:this._functionToArray,_signature:[{types:[f]}]},to_string:{_func:this._functionToString,_signature:[{types:[f]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[f]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[f],variadic:!0}]}}}var d;d=\"function\"==typeof String.prototype.trimLeft?function(e){return e.trimLeft()}:function(e){return e.match(/^\\s*(.*)/)[1]};var h=0,f=1,m=2,g=3,v=4,y=6,b=8,w=9,S={\".\":\"Dot\",\"*\":\"Star\",\",\":\"Comma\",\":\":\"Colon\",\"{\":\"Lbrace\",\"}\":\"Rbrace\",\"]\":\"Rbracket\",\"(\":\"Lparen\",\")\":\"Rparen\",\"@\":\"Current\"},E={\"<\":!0,\">\":!0,\"=\":!0,\"!\":!0},C={\" \":!0,\"\\t\":!0,\"\\n\":!0};c.prototype={tokenize:function(e){var t,n,r,i=[];for(this._current=0;this._current<e.length;)if(o(e[this._current]))t=this._current,n=this._consumeUnquotedIdentifier(e),i.push({type:\"UnquotedIdentifier\",value:n,start:t});else if(void 0!==S[e[this._current]])i.push({type:S[e[this._current]],value:e[this._current],start:this._current}),this._current++;else if(s(e[this._current]))r=this._consumeNumber(e),i.push(r);else if(\"[\"===e[this._current])r=this._consumeLBracket(e),i.push(r);else if('\"'===e[this._current])t=this._current,n=this._consumeQuotedIdentifier(e),i.push({type:\"QuotedIdentifier\",value:n,start:t});else if(\"'\"===e[this._current])t=this._current,n=this._consumeRawStringLiteral(e),i.push({type:\"Literal\",value:n,start:t});else if(\"`\"===e[this._current]){t=this._current;var a=this._consumeLiteral(e);i.push({type:\"Literal\",value:a,start:t})}else if(void 0!==E[e[this._current]])i.push(this._consumeOperator(e));else if(void 0!==C[e[this._current]])this._current++;else if(\"&\"===e[this._current])t=this._current,this._current++,\"&\"===e[this._current]?(this._current++,i.push({type:\"And\",value:\"&&\",start:t})):i.push({type:\"Expref\",value:\"&\",start:t});else{if(\"|\"!==e[this._current]){var c=new Error(\"Unknown character:\"+e[this._current]);throw c.name=\"LexerError\",c}t=this._current,this._current++,\"|\"===e[this._current]?(this._current++,i.push({type:\"Or\",value:\"||\",start:t})):i.push({type:\"Pipe\",value:\"|\",start:t})}return i},_consumeUnquotedIdentifier:function(e){var t=this._current;for(this._current++;this._current<e.length&&a(e[this._current]);)this._current++;return e.slice(t,this._current)},_consumeQuotedIdentifier:function(e){var t=this._current;this._current++;for(var n=e.length;'\"'!==e[this._current]&&this._current<n;){var r=this._current;\"\\\\\"!==e[r]||\"\\\\\"!==e[r+1]&&'\"'!==e[r+1]?r++:r+=2,this._current=r}return this._current++,JSON.parse(e.slice(t,this._current))},_consumeRawStringLiteral:function(e){var t=this._current;this._current++;for(var n=e.length;\"'\"!==e[this._current]&&this._current<n;){var r=this._current;\"\\\\\"!==e[r]||\"\\\\\"!==e[r+1]&&\"'\"!==e[r+1]?r++:r+=2,this._current=r}return this._current++,e.slice(t+1,this._current-1).replace(\"\\\\'\",\"'\")},_consumeNumber:function(e){var t=this._current;this._current++;for(var n=e.length;s(e[this._current])&&this._current<n;)this._current++;return{type:\"Number\",value:parseInt(e.slice(t,this._current)),start:t}},_consumeLBracket:function(e){var t=this._current;return this._current++,\"?\"===e[this._current]?(this._current++,{type:\"Filter\",value:\"[?\",start:t}):\"]\"===e[this._current]?(this._current++,{type:\"Flatten\",value:\"[]\",start:t}):{type:\"Lbracket\",value:\"[\",start:t}},_consumeOperator:function(e){var t=this._current,n=e[t];return this._current++,\"!\"===n?\"=\"===e[this._current]?(this._current++,{type:\"NE\",value:\"!=\",start:t}):{type:\"Not\",value:\"!\",start:t}:\"<\"===n?\"=\"===e[this._current]?(this._current++,{type:\"LTE\",value:\"<=\",start:t}):{type:\"LT\",value:\"<\",start:t}:\">\"===n?\"=\"===e[this._current]?(this._current++,{type:\"GTE\",value:\">=\",start:t}):{type:\"GT\",value:\">\",start:t}:\"=\"===n&&\"=\"===e[this._current]?(this._current++,{type:\"EQ\",value:\"==\",start:t}):void 0},_consumeLiteral:function(e){this._current++;for(var t,n=this._current,r=e.length;\"`\"!==e[this._current]&&this._current<r;){var i=this._current;\"\\\\\"!==e[i]||\"\\\\\"!==e[i+1]&&\"`\"!==e[i+1]?i++:i+=2,this._current=i}var o=d(e.slice(n,this._current));return o=o.replace(\"\\\\`\",\"`\"),t=this._looksLikeJSON(o)?JSON.parse(o):JSON.parse('\"'+o+'\"'),this._current++,t},_looksLikeJSON:function(e){if(\"\"===e)return!1;if('[{\"'.indexOf(e[0])>=0)return!0;if([\"true\",\"false\",\"null\"].indexOf(e)>=0)return!0;if(!(\"-0123456789\".indexOf(e[0])>=0))return!1;try{return JSON.parse(e),!0}catch(e){return!1}}};var T={EOF:0,UnquotedIdentifier:0,QuotedIdentifier:0,Rbracket:0,Rparen:0,Comma:0,Rbrace:0,Number:0,Current:0,Expref:0,Pipe:1,Or:2,And:3,EQ:5,GT:5,LT:5,GTE:5,LTE:5,NE:5,Flatten:9,Star:20,Filter:21,Dot:40,Not:45,Lbrace:50,Lbracket:55,Lparen:60};u.prototype={parse:function(e){this._loadTokens(e),this.index=0;var t=this.expression(0);if(\"EOF\"!==this._lookahead(0)){var n=this._lookaheadToken(0),r=new Error(\"Unexpected token type: \"+n.type+\", value: \"+n.value);throw r.name=\"ParserError\",r}return t},_loadTokens:function(e){var t=(new c).tokenize(e);t.push({type:\"EOF\",value:\"\",start:e.length}),this.tokens=t},expression:function(e){var t=this._lookaheadToken(0);this._advance();for(var n=this.nud(t),r=this._lookahead(0);e<T[r];)this._advance(),n=this.led(r,n),r=this._lookahead(0);return n},_lookahead:function(e){return this.tokens[this.index+e].type},_lookaheadToken:function(e){return this.tokens[this.index+e]},_advance:function(){this.index++},nud:function(e){var t,n;switch(e.type){case\"Literal\":return{type:\"Literal\",value:e.value};case\"UnquotedIdentifier\":return{type:\"Field\",name:e.value};case\"QuotedIdentifier\":var r={type:\"Field\",name:e.value};if(\"Lparen\"===this._lookahead(0))throw new Error(\"Quoted identifier not allowed for function names.\");return r;case\"Not\":return{type:\"NotExpression\",children:[t=this.expression(T.Not)]};case\"Star\":return t=null,{type:\"ValueProjection\",children:[{type:\"Identity\"},t=\"Rbracket\"===this._lookahead(0)?{type:\"Identity\"}:this._parseProjectionRHS(T.Star)]};case\"Filter\":return this.led(e.type,{type:\"Identity\"});case\"Lbrace\":return this._parseMultiselectHash();case\"Flatten\":return{type:\"Projection\",children:[{type:\"Flatten\",children:[{type:\"Identity\"}]},t=this._parseProjectionRHS(T.Flatten)]};case\"Lbracket\":return\"Number\"===this._lookahead(0)||\"Colon\"===this._lookahead(0)?(t=this._parseIndexExpression(),this._projectIfSlice({type:\"Identity\"},t)):\"Star\"===this._lookahead(0)&&\"Rbracket\"===this._lookahead(1)?(this._advance(),this._advance(),{type:\"Projection\",children:[{type:\"Identity\"},t=this._parseProjectionRHS(T.Star)]}):this._parseMultiselectList();case\"Current\":return{type:\"Current\"};case\"Expref\":return{type:\"ExpressionReference\",children:[n=this.expression(T.Expref)]};case\"Lparen\":for(var i=[];\"Rparen\"!==this._lookahead(0);)\"Current\"===this._lookahead(0)?(n={type:\"Current\"},this._advance()):n=this.expression(0),i.push(n);return this._match(\"Rparen\"),i[0];default:this._errorToken(e)}},led:function(e,t){var n;switch(e){case\"Dot\":var r=T.Dot;return\"Star\"!==this._lookahead(0)?{type:\"Subexpression\",children:[t,n=this._parseDotRHS(r)]}:(this._advance(),{type:\"ValueProjection\",children:[t,n=this._parseProjectionRHS(r)]});case\"Pipe\":return{type:\"Pipe\",children:[t,n=this.expression(T.Pipe)]};case\"Or\":return{type:\"OrExpression\",children:[t,n=this.expression(T.Or)]};case\"And\":return{type:\"AndExpression\",children:[t,n=this.expression(T.And)]};case\"Lparen\":for(var i,o=t.name,s=[];\"Rparen\"!==this._lookahead(0);)\"Current\"===this._lookahead(0)?(i={type:\"Current\"},this._advance()):i=this.expression(0),\"Comma\"===this._lookahead(0)&&this._match(\"Comma\"),s.push(i);return this._match(\"Rparen\"),{type:\"Function\",name:o,children:s};case\"Filter\":var a=this.expression(0);return this._match(\"Rbracket\"),{type:\"FilterProjection\",children:[t,n=\"Flatten\"===this._lookahead(0)?{type:\"Identity\"}:this._parseProjectionRHS(T.Filter),a]};case\"Flatten\":return{type:\"Projection\",children:[{type:\"Flatten\",children:[t]},this._parseProjectionRHS(T.Flatten)]};case\"EQ\":case\"NE\":case\"GT\":case\"GTE\":case\"LT\":case\"LTE\":return this._parseComparator(t,e);case\"Lbracket\":var c=this._lookaheadToken(0);return\"Number\"===c.type||\"Colon\"===c.type?(n=this._parseIndexExpression(),this._projectIfSlice(t,n)):(this._match(\"Star\"),this._match(\"Rbracket\"),{type:\"Projection\",children:[t,n=this._parseProjectionRHS(T.Star)]});default:this._errorToken(this._lookaheadToken(0))}},_match:function(e){if(this._lookahead(0)!==e){var t=this._lookaheadToken(0),n=new Error(\"Expected \"+e+\", got: \"+t.type);throw n.name=\"ParserError\",n}this._advance()},_errorToken:function(e){var t=new Error(\"Invalid token (\"+e.type+'): \"'+e.value+'\"');throw t.name=\"ParserError\",t},_parseIndexExpression:function(){if(\"Colon\"===this._lookahead(0)||\"Colon\"===this._lookahead(1))return this._parseSliceExpression();var e={type:\"Index\",value:this._lookaheadToken(0).value};return this._advance(),this._match(\"Rbracket\"),e},_projectIfSlice:function(e,t){var n={type:\"IndexExpression\",children:[e,t]};return\"Slice\"===t.type?{type:\"Projection\",children:[n,this._parseProjectionRHS(T.Star)]}:n},_parseSliceExpression:function(){for(var e=[null,null,null],t=0,n=this._lookahead(0);\"Rbracket\"!==n&&t<3;){if(\"Colon\"===n)t++,this._advance();else{if(\"Number\"!==n){var r=this._lookahead(0),i=new Error(\"Syntax error, unexpected token: \"+r.value+\"(\"+r.type+\")\");throw i.name=\"Parsererror\",i}e[t]=this._lookaheadToken(0).value,this._advance()}n=this._lookahead(0)}return this._match(\"Rbracket\"),{type:\"Slice\",children:e}},_parseComparator:function(e,t){return{type:\"Comparator\",name:t,children:[e,this.expression(T[t])]}},_parseDotRHS:function(e){var t=this._lookahead(0);return[\"UnquotedIdentifier\",\"QuotedIdentifier\",\"Star\"].indexOf(t)>=0?this.expression(e):\"Lbracket\"===t?(this._match(\"Lbracket\"),this._parseMultiselectList()):\"Lbrace\"===t?(this._match(\"Lbrace\"),this._parseMultiselectHash()):void 0},_parseProjectionRHS:function(e){var t;if(T[this._lookahead(0)]<10)t={type:\"Identity\"};else if(\"Lbracket\"===this._lookahead(0))t=this.expression(e);else if(\"Filter\"===this._lookahead(0))t=this.expression(e);else{if(\"Dot\"!==this._lookahead(0)){var n=this._lookaheadToken(0),r=new Error(\"Sytanx error, unexpected token: \"+n.value+\"(\"+n.type+\")\");throw r.name=\"ParserError\",r}this._match(\"Dot\"),t=this._parseDotRHS(e)}return t},_parseMultiselectList:function(){for(var e=[];\"Rbracket\"!==this._lookahead(0);){var t=this.expression(0);if(e.push(t),\"Comma\"===this._lookahead(0)&&(this._match(\"Comma\"),\"Rbracket\"===this._lookahead(0)))throw new Error(\"Unexpected token Rbracket\")}return this._match(\"Rbracket\"),{type:\"MultiSelectList\",children:e}},_parseMultiselectHash:function(){for(var e,t,n,r=[],i=[\"UnquotedIdentifier\",\"QuotedIdentifier\"];;){if(e=this._lookaheadToken(0),i.indexOf(e.type)<0)throw new Error(\"Expecting an identifier token, got: \"+e.type);if(t=e.value,this._advance(),this._match(\"Colon\"),n={type:\"KeyValuePair\",name:t,value:this.expression(0)},r.push(n),\"Comma\"===this._lookahead(0))this._match(\"Comma\");else if(\"Rbrace\"===this._lookahead(0)){this._match(\"Rbrace\");break}}return{type:\"MultiSelectHash\",children:r}}},l.prototype={search:function(e,t){return this.visit(e,t)},visit:function(e,o){var s,a,c,u,l,p,d,h,f;switch(e.type){case\"Field\":return null===o?null:n(o)?void 0===(p=o[e.name])?null:p:null;case\"Subexpression\":for(c=this.visit(e.children[0],o),f=1;f<e.children.length;f++)if(null===(c=this.visit(e.children[1],c)))return null;return c;case\"IndexExpression\":case\"Pipe\":return d=this.visit(e.children[0],o),this.visit(e.children[1],d);case\"Index\":if(!t(o))return null;var m=e.value;return m<0&&(m=o.length+m),void 0===(c=o[m])&&(c=null),c;case\"Slice\":if(!t(o))return null;var g=e.children.slice(0),v=this.computeSliceParams(o.length,g),y=v[0],b=v[1],w=v[2];if(c=[],w>0)for(f=y;f<b;f+=w)c.push(o[f]);else for(f=y;f>b;f+=w)c.push(o[f]);return c;case\"Projection\":var S=this.visit(e.children[0],o);if(!t(S))return null;for(h=[],f=0;f<S.length;f++)null!==(a=this.visit(e.children[1],S[f]))&&h.push(a);return h;case\"ValueProjection\":if(!n(S=this.visit(e.children[0],o)))return null;h=[];var E=function(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;r++)n.push(e[t[r]]);return n}(S);for(f=0;f<E.length;f++)null!==(a=this.visit(e.children[1],E[f]))&&h.push(a);return h;case\"FilterProjection\":if(!t(S=this.visit(e.children[0],o)))return null;var C=[],T=[];for(f=0;f<S.length;f++)i(s=this.visit(e.children[2],S[f]))||C.push(S[f]);for(var k=0;k<C.length;k++)null!==(a=this.visit(e.children[1],C[k]))&&T.push(a);return T;case\"Comparator\":switch(u=this.visit(e.children[0],o),l=this.visit(e.children[1],o),e.name){case\"EQ\":c=r(u,l);break;case\"NE\":c=!r(u,l);break;case\"GT\":c=u>l;break;case\"GTE\":c=u>=l;break;case\"LT\":c=u<l;break;case\"LTE\":c=u<=l;break;default:throw new Error(\"Unknown comparator: \"+e.name)}return c;case\"Flatten\":var I=this.visit(e.children[0],o);if(!t(I))return null;var _=[];for(f=0;f<I.length;f++)t(a=I[f])?_.push.apply(_,a):_.push(a);return _;case\"Identity\":case\"Current\":return o;case\"MultiSelectList\":if(null===o)return null;for(h=[],f=0;f<e.children.length;f++)h.push(this.visit(e.children[f],o));return h;case\"MultiSelectHash\":if(null===o)return null;var x;for(h={},f=0;f<e.children.length;f++)h[(x=e.children[f]).name]=this.visit(x.value,o);return h;case\"OrExpression\":return i(s=this.visit(e.children[0],o))&&(s=this.visit(e.children[1],o)),s;case\"AndExpression\":return!0===i(u=this.visit(e.children[0],o))?u:this.visit(e.children[1],o);case\"NotExpression\":return i(u=this.visit(e.children[0],o));case\"Literal\":return e.value;case\"Function\":var A=[];for(f=0;f<e.children.length;f++)A.push(this.visit(e.children[f],o));return this.runtime.callFunction(e.name,A);case\"ExpressionReference\":var R=e.children[0];return R.jmespathType=\"Expref\",R;default:throw new Error(\"Unknown node type: \"+e.type)}},computeSliceParams:function(e,t){var n=t[0],r=t[1],i=t[2],o=[null,null,null];if(null===i)i=1;else if(0===i){var s=new Error(\"Invalid slice, step cannot be 0\");throw s.name=\"RuntimeError\",s}var a=i<0;return n=null===n?a?e-1:0:this.capSliceRange(e,n,i),r=null===r?a?-1:e:this.capSliceRange(e,r,i),o[0]=n,o[1]=r,o[2]=i,o},capSliceRange:function(e,t,n){return t<0?(t+=e)<0&&(t=n<0?-1:0):t>=e&&(t=n<0?e-1:e),t}},p.prototype={callFunction:function(e,t){var n=this.functionTable[e];if(void 0===n)throw new Error(\"Unknown function: \"+e+\"()\");return this._validateArgs(e,t,n._signature),n._func.call(this,t)},_validateArgs:function(e,t,n){var r;if(n[n.length-1].variadic){if(t.length<n.length)throw r=1===n.length?\" argument\":\" arguments\",new Error(\"ArgumentError: \"+e+\"() takes at least\"+n.length+r+\" but received \"+t.length)}else if(t.length!==n.length)throw r=1===n.length?\" argument\":\" arguments\",new Error(\"ArgumentError: \"+e+\"() takes \"+n.length+r+\" but received \"+t.length);for(var i,o,s,a=0;a<n.length;a++){s=!1,i=n[a].types,o=this._getTypeName(t[a]);for(var c=0;c<i.length;c++)if(this._typeMatches(o,i[c],t[a])){s=!0;break}if(!s)throw new Error(\"TypeError: \"+e+\"() expected argument \"+(a+1)+\" to be type \"+i+\" but received type \"+o+\" instead.\")}},_typeMatches:function(e,t,n){if(t===f)return!0;if(t!==w&&t!==b&&t!==g)return e===t;if(t===g)return e===g;if(e===g){var r;t===b?r=h:t===w&&(r=m);for(var i=0;i<n.length;i++)if(!this._typeMatches(this._getTypeName(n[i]),r,n[i]))return!1;return!0}},_getTypeName:function(e){switch(Object.prototype.toString.call(e)){case\"[object String]\":return m;case\"[object Number]\":return h;case\"[object Array]\":return g;case\"[object Boolean]\":return 5;case\"[object Null]\":return 7;case\"[object Object]\":return\"Expref\"===e.jmespathType?y:v}},_functionStartsWith:function(e){return 0===e[0].lastIndexOf(e[1])},_functionEndsWith:function(e){var t=e[0],n=e[1];return-1!==t.indexOf(n,t.length-n.length)},_functionReverse:function(e){if(this._getTypeName(e[0])===m){for(var t=e[0],n=\"\",r=t.length-1;r>=0;r--)n+=t[r];return n}var i=e[0].slice(0);return i.reverse(),i},_functionAbs:function(e){return Math.abs(e[0])},_functionCeil:function(e){return Math.ceil(e[0])},_functionAvg:function(e){for(var t=0,n=e[0],r=0;r<n.length;r++)t+=n[r];return t/n.length},_functionContains:function(e){return e[0].indexOf(e[1])>=0},_functionFloor:function(e){return Math.floor(e[0])},_functionLength:function(e){return n(e[0])?Object.keys(e[0]).length:e[0].length},_functionMap:function(e){for(var t=[],n=this._interpreter,r=e[0],i=e[1],o=0;o<i.length;o++)t.push(n.visit(r,i[o]));return t},_functionMerge:function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];for(var i in r)t[i]=r[i]}return t},_functionMax:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===h)return Math.max.apply(Math,e[0]);for(var t=e[0],n=t[0],r=1;r<t.length;r++)n.localeCompare(t[r])<0&&(n=t[r]);return n}return null},_functionMin:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===h)return Math.min.apply(Math,e[0]);for(var t=e[0],n=t[0],r=1;r<t.length;r++)t[r].localeCompare(n)<0&&(n=t[r]);return n}return null},_functionSum:function(e){for(var t=0,n=e[0],r=0;r<n.length;r++)t+=n[r];return t},_functionType:function(e){switch(this._getTypeName(e[0])){case h:return\"number\";case m:return\"string\";case g:return\"array\";case v:return\"object\";case 5:return\"boolean\";case y:return\"expref\";case 7:return\"null\"}},_functionKeys:function(e){return Object.keys(e[0])},_functionValues:function(e){for(var t=e[0],n=Object.keys(t),r=[],i=0;i<n.length;i++)r.push(t[n[i]]);return r},_functionJoin:function(e){var t=e[0];return e[1].join(t)},_functionToArray:function(e){return this._getTypeName(e[0])===g?e[0]:[e[0]]},_functionToString:function(e){return this._getTypeName(e[0])===m?e[0]:JSON.stringify(e[0])},_functionToNumber:function(e){var t,n=this._getTypeName(e[0]);return n===h?e[0]:n!==m||(t=+e[0],isNaN(t))?null:t},_functionNotNull:function(e){for(var t=0;t<e.length;t++)if(7!==this._getTypeName(e[t]))return e[t];return null},_functionSort:function(e){var t=e[0].slice(0);return t.sort(),t},_functionSortBy:function(e){var t=e[0].slice(0);if(0===t.length)return t;var n=this._interpreter,r=e[1],i=this._getTypeName(n.visit(r,t[0]));if([h,m].indexOf(i)<0)throw new Error(\"TypeError\");for(var o=this,s=[],a=0;a<t.length;a++)s.push([a,t[a]]);s.sort((function(e,t){var s=n.visit(r,e[1]),a=n.visit(r,t[1]);if(o._getTypeName(s)!==i)throw new Error(\"TypeError: expected \"+i+\", received \"+o._getTypeName(s));if(o._getTypeName(a)!==i)throw new Error(\"TypeError: expected \"+i+\", received \"+o._getTypeName(a));return s>a?1:s<a?-1:e[0]-t[0]}));for(var c=0;c<s.length;c++)t[c]=s[c][1];return t},_functionMaxBy:function(e){for(var t,n,r=e[1],i=e[0],o=this.createKeyFunction(r,[h,m]),s=-1/0,a=0;a<i.length;a++)(n=o(i[a]))>s&&(s=n,t=i[a]);return t},_functionMinBy:function(e){for(var t,n,r=e[1],i=e[0],o=this.createKeyFunction(r,[h,m]),s=1/0,a=0;a<i.length;a++)(n=o(i[a]))<s&&(s=n,t=i[a]);return t},createKeyFunction:function(e,t){var n=this,r=this._interpreter;return function(i){var o=r.visit(e,i);if(t.indexOf(n._getTypeName(o))<0){var s=\"TypeError: expected one of \"+t+\", received \"+n._getTypeName(o);throw new Error(s)}return o}}},e.tokenize=function(e){return(new c).tokenize(e)},e.compile=function(e){return(new u).parse(e)},e.search=function(e,t){var n=new u,r=new p,i=new l(r);r._interpreter=i;var o=n.parse(t);return i.search(o,e)},e.strictDeepEqual=r}(void 0===n?this.jmespath={}:n)},{}],87:[function(e,t,n){function r(){throw new Error(\"setTimeout has not been defined\")}function i(){throw new Error(\"clearTimeout has not been defined\")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function s(){m&&h&&(m=!1,h.length?f=h.concat(f):g=-1,f.length&&a())}function a(){if(!m){var e=o(s);m=!0;for(var t=f.length;t;){for(h=f,f=[];++g<t;)h&&h[g].run();g=-1,t=f.length}h=null,m=!1,function(e){if(p===clearTimeout)return clearTimeout(e);if((p===i||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var l,p,d=t.exports={};!function(){try{l=\"function\"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{p=\"function\"==typeof clearTimeout?clearTimeout:i}catch(e){p=i}}();var h,f=[],m=!1,g=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new c(e,t)),1!==f.length||m||o(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},d.title=\"browser\",d.browser=!0,d.env={},d.argv=[],d.version=\"\",d.versions={},d.on=u,d.addListener=u,d.once=u,d.off=u,d.removeListener=u,d.removeAllListeners=u,d.emit=u,d.prependListener=u,d.prependOnceListener=u,d.listeners=function(e){return[]},d.binding=function(e){throw new Error(\"process.binding is not supported\")},d.cwd=function(){return\"/\"},d.chdir=function(e){throw new Error(\"process.chdir is not supported\")},d.umask=function(){return 0}},{}],88:[function(i,o,s){(function(i){(function(){!function(a){function c(e){throw RangeError(P[e])}function u(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function l(e,t){var n=e.split(\"@\"),r=\"\";return n.length>1&&(r=n[0]+\"@\",e=n[1]),r+u((e=e.replace(M,\".\")).split(\".\"),t).join(\".\")}function p(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function d(e){return u(e,(function(e){var t=\"\";return e>65535&&(t+=q((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+q(e)})).join(\"\")}function h(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:T}function f(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function m(e,t,n){var r=0;for(e=n?U(e/x):e>>1,e+=U(e/t);e>D*I>>1;r+=T)e=U(e/D);return U(r+(D+1)*e/(e+_))}function g(e){var t,n,r,i,o,s,a,u,l,p,f=[],g=e.length,v=0,y=R,b=A;for((n=e.lastIndexOf(L))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&c(\"not-basic\"),f.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<g;){for(o=v,s=1,a=T;i>=g&&c(\"invalid-input\"),((u=h(e.charCodeAt(i++)))>=T||u>U((C-v)/s))&&c(\"overflow\"),v+=u*s,!(u<(l=a<=b?k:a>=b+I?I:a-b));a+=T)s>U(C/(p=T-l))&&c(\"overflow\"),s*=p;b=m(v-o,t=f.length+1,0==o),U(v/t)>C-y&&c(\"overflow\"),y+=U(v/t),v%=t,f.splice(v++,0,y)}return d(f)}function v(e){var t,n,r,i,o,s,a,u,l,d,h,g,v,y,b,w=[];for(g=(e=p(e)).length,t=R,n=0,o=A,s=0;s<g;++s)(h=e[s])<128&&w.push(q(h));for(r=i=w.length,i&&w.push(L);r<g;){for(a=C,s=0;s<g;++s)(h=e[s])>=t&&h<a&&(a=h);for(a-t>U((C-n)/(v=r+1))&&c(\"overflow\"),n+=(a-t)*v,t=a,s=0;s<g;++s)if((h=e[s])<t&&++n>C&&c(\"overflow\"),h==t){for(u=n,l=T;!(u<(d=l<=o?k:l>=o+I?I:l-o));l+=T)b=u-d,y=T-d,w.push(q(f(d+b%y,0))),u=U(b/y);w.push(q(f(u,0))),o=m(n,v,r==i),n=0,++r}++n,++t}return w.join(\"\")}var y=\"object\"==typeof s&&s&&!s.nodeType&&s,b=\"object\"==typeof o&&o&&!o.nodeType&&o,w=\"object\"==typeof i&&i;w.global!==w&&w.window!==w&&w.self!==w||(a=w);var S,E,C=2147483647,T=36,k=1,I=26,_=38,x=700,A=72,R=128,L=\"-\",O=/^xn--/,N=/[^\\x20-\\x7E]/,M=/[\\x2E\\u3002\\uFF0E\\uFF61]/g,P={overflow:\"Overflow: input needs wider integers to process\",\"not-basic\":\"Illegal input >= 0x80 (not a basic code point)\",\"invalid-input\":\"Invalid input\"},D=T-k,U=Math.floor,q=String.fromCharCode;if(S={version:\"1.3.2\",ucs2:{decode:p,encode:d},decode:g,encode:v,toASCII:function(e){return l(e,(function(e){return N.test(e)?\"xn--\"+v(e):e}))},toUnicode:function(e){return l(e,(function(e){return O.test(e)?g(e.slice(4).toLowerCase()):e}))}},n.amdO)void 0===(r=function(){return S}.call(t,n,t,e))||(e.exports=r);else if(y&&b)if(o.exports==y)b.exports=S;else for(E in S)S.hasOwnProperty(E)&&(y[E]=S[E]);else a.punycode=S}(this)}).call(this)}).call(this,void 0!==n.g?n.g:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],89:[function(e,t,n){\"use strict\";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,o){t=t||\"&\",n=n||\"=\";var s={};if(\"string\"!=typeof e||0===e.length)return s;var a=/\\+/g;e=e.split(t);var c=1e3;o&&\"number\"==typeof o.maxKeys&&(c=o.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var l=0;l<u;++l){var p,d,h,f,m=e[l].replace(a,\"%20\"),g=m.indexOf(n);g>=0?(p=m.substr(0,g),d=m.substr(g+1)):(p=m,d=\"\"),h=decodeURIComponent(p),f=decodeURIComponent(d),r(s,h)?i(s[h])?s[h].push(f):s[h]=[s[h],f]:s[h]=f}return s};var i=Array.isArray||function(e){return\"[object Array]\"===Object.prototype.toString.call(e)}},{}],90:[function(e,t,n){\"use strict\";function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var i=function(e){switch(typeof e){case\"string\":return e;case\"boolean\":return e?\"true\":\"false\";case\"number\":return isFinite(e)?e:\"\";default:return\"\"}};t.exports=function(e,t,n,a){return t=t||\"&\",n=n||\"=\",null===e&&(e=void 0),\"object\"==typeof e?r(s(e),(function(s){var a=encodeURIComponent(i(s))+n;return o(e[s])?r(e[s],(function(e){return a+encodeURIComponent(i(e))})).join(t):a+encodeURIComponent(i(e[s]))})).join(t):a?encodeURIComponent(i(a))+n+encodeURIComponent(i(e)):\"\"};var o=Array.isArray||function(e){return\"[object Array]\"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],91:[function(e,t,n){\"use strict\";n.decode=n.parse=e(\"./decode\"),n.encode=n.stringify=e(\"./encode\")},{\"./decode\":89,\"./encode\":90}],92:[function(e,t,n){\"use strict\";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,i){t=t||\"&\",n=n||\"=\";var o={};if(\"string\"!=typeof e||0===e.length)return o;var s=/\\+/g;e=e.split(t);var a=1e3;i&&\"number\"==typeof i.maxKeys&&(a=i.maxKeys);var c=e.length;a>0&&c>a&&(c=a);for(var u=0;u<c;++u){var l,p,d,h,f=e[u].replace(s,\"%20\"),m=f.indexOf(n);m>=0?(l=f.substr(0,m),p=f.substr(m+1)):(l=f,p=\"\"),d=decodeURIComponent(l),h=decodeURIComponent(p),r(o,d)?Array.isArray(o[d])?o[d].push(h):o[d]=[o[d],h]:o[d]=h}return o}},{}],93:[function(e,t,n){\"use strict\";var r=function(e){switch(typeof e){case\"string\":return e;case\"boolean\":return e?\"true\":\"false\";case\"number\":return isFinite(e)?e:\"\";default:return\"\"}};t.exports=function(e,t,n,i){return t=t||\"&\",n=n||\"=\",null===e&&(e=void 0),\"object\"==typeof e?Object.keys(e).map((function(i){var o=encodeURIComponent(r(i))+n;return Array.isArray(e[i])?e[i].map((function(e){return o+encodeURIComponent(r(e))})).join(t):o+encodeURIComponent(r(e[i]))})).join(t):i?encodeURIComponent(r(i))+n+encodeURIComponent(r(e)):\"\"}},{}],94:[function(e,t,n){arguments[4][91][0].apply(n,arguments)},{\"./decode\":92,\"./encode\":93,dup:91}],95:[function(e,t,n){(function(t,r){(function(){function i(e,t){this._id=e,this._clearFn=t}var o=e(\"process/browser.js\").nextTick,s=Function.prototype.apply,a=Array.prototype.slice,c={},u=0;n.setTimeout=function(){return new i(s.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new i(s.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n.setImmediate=\"function\"==typeof t?t:function(e){var t=u++,r=!(arguments.length<2)&&a.call(arguments,1);return c[t]=!0,o((function(){c[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))})),t},n.clearImmediate=\"function\"==typeof r?r:function(e){delete c[e]}}).call(this)}).call(this,e(\"timers\").setImmediate,e(\"timers\").clearImmediate)},{\"process/browser.js\":87,timers:95}],96:[function(e,t,n){function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,n){if(e&&s(e)&&e instanceof r)return e;var i=new r;return i.parse(e,t,n),i}function o(e){return\"string\"==typeof e}function s(e){return\"object\"==typeof e&&null!==e}function a(e){return null===e}var c=e(\"punycode\");n.parse=i,n.resolve=function(e,t){return i(e,!1,!0).resolve(t)},n.resolveObject=function(e,t){return e?i(e,!1,!0).resolveObject(t):t},n.format=function(e){return o(e)&&(e=i(e)),e instanceof r?e.format():r.prototype.format.call(e)},n.Url=r;var u=/^([a-z0-9.+-]+:)/i,l=/:[0-9]*$/,p=[\"{\",\"}\",\"|\",\"\\\\\",\"^\",\"`\"].concat([\"<\",\">\",'\"',\"`\",\" \",\"\\r\",\"\\n\",\"\\t\"]),d=[\"'\"].concat(p),h=[\"%\",\"/\",\"?\",\";\",\"#\"].concat(d),f=[\"/\",\"?\",\"#\"],m=/^[a-z0-9A-Z_-]{0,63}$/,g=/^([a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,\"javascript:\":!0},y={javascript:!0,\"javascript:\":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,\"http:\":!0,\"https:\":!0,\"ftp:\":!0,\"gopher:\":!0,\"file:\":!0},w=e(\"querystring\");r.prototype.parse=function(e,t,n){if(!o(e))throw new TypeError(\"Parameter 'url' must be a string, not \"+typeof e);var r=e;r=r.trim();var i=u.exec(r);if(i){var s=(i=i[0]).toLowerCase();this.protocol=s,r=r.substr(i.length)}if(n||i||r.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)){var a=\"//\"===r.substr(0,2);!a||i&&y[i]||(r=r.substr(2),this.slashes=!0)}if(!y[i]&&(a||i&&!b[i])){for(var l=-1,p=0;p<f.length;p++)-1!==(C=r.indexOf(f[p]))&&(-1===l||C<l)&&(l=C);var S,E;for(-1!==(E=-1===l?r.lastIndexOf(\"@\"):r.lastIndexOf(\"@\",l))&&(S=r.slice(0,E),r=r.slice(E+1),this.auth=decodeURIComponent(S)),l=-1,p=0;p<h.length;p++){var C;-1!==(C=r.indexOf(h[p]))&&(-1===l||C<l)&&(l=C)}-1===l&&(l=r.length),this.host=r.slice(0,l),r=r.slice(l),this.parseHost(),this.hostname=this.hostname||\"\";var T=\"[\"===this.hostname[0]&&\"]\"===this.hostname[this.hostname.length-1];if(!T)for(var k=this.hostname.split(/\\./),I=(p=0,k.length);p<I;p++){var _=k[p];if(_&&!_.match(m)){for(var x=\"\",A=0,R=_.length;A<R;A++)_.charCodeAt(A)>127?x+=\"x\":x+=_[A];if(!x.match(m)){var L=k.slice(0,p),O=k.slice(p+1),N=_.match(g);N&&(L.push(N[1]),O.unshift(N[2])),O.length&&(r=\"/\"+O.join(\".\")+r),this.hostname=L.join(\".\");break}}}if(this.hostname.length>255?this.hostname=\"\":this.hostname=this.hostname.toLowerCase(),!T){var M=this.hostname.split(\".\"),P=[];for(p=0;p<M.length;++p){var D=M[p];P.push(D.match(/[^A-Za-z0-9_-]/)?\"xn--\"+c.encode(D):D)}this.hostname=P.join(\".\")}var U=this.port?\":\"+this.port:\"\",q=this.hostname||\"\";this.host=q+U,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),\"/\"!==r[0]&&(r=\"/\"+r))}if(!v[s])for(p=0,I=d.length;p<I;p++){var j=d[p],W=encodeURIComponent(j);W===j&&(W=escape(j)),r=r.split(j).join(W)}var F=r.indexOf(\"#\");-1!==F&&(this.hash=r.substr(F),r=r.slice(0,F));var B=r.indexOf(\"?\");return-1!==B?(this.search=r.substr(B),this.query=r.substr(B+1),t&&(this.query=w.parse(this.query)),r=r.slice(0,B)):t&&(this.search=\"\",this.query={}),r&&(this.pathname=r),b[s]&&this.hostname&&!this.pathname&&(this.pathname=\"/\"),(this.pathname||this.search)&&(U=this.pathname||\"\",D=this.search||\"\",this.path=U+D),this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||\"\";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,\":\"),e+=\"@\");var t=this.protocol||\"\",n=this.pathname||\"\",r=this.hash||\"\",i=!1,o=\"\";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(\":\")?this.hostname:\"[\"+this.hostname+\"]\"),this.port&&(i+=\":\"+this.port)),this.query&&s(this.query)&&Object.keys(this.query).length&&(o=w.stringify(this.query));var a=this.search||o&&\"?\"+o||\"\";return t&&\":\"!==t.substr(-1)&&(t+=\":\"),this.slashes||(!t||b[t])&&!1!==i?(i=\"//\"+(i||\"\"),n&&\"/\"!==n.charAt(0)&&(n=\"/\"+n)):i||(i=\"\"),r&&\"#\"!==r.charAt(0)&&(r=\"#\"+r),a&&\"?\"!==a.charAt(0)&&(a=\"?\"+a),n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})),t+i+n+(a=a.replace(\"#\",\"%23\"))+r},r.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(o(e)){var t=new r;t.parse(e,!1,!0),e=t}var n=new r;if(Object.keys(this).forEach((function(e){n[e]=this[e]}),this),n.hash=e.hash,\"\"===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol)return Object.keys(e).forEach((function(t){\"protocol\"!==t&&(n[t]=e[t])})),b[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname=\"/\"),n.href=n.format(),n;if(e.protocol&&e.protocol!==n.protocol){if(!b[e.protocol])return Object.keys(e).forEach((function(t){n[t]=e[t]})),n.href=n.format(),n;if(n.protocol=e.protocol,e.host||y[e.protocol])n.pathname=e.pathname;else{for(var i=(e.pathname||\"\").split(\"/\");i.length&&!(e.host=i.shift()););e.host||(e.host=\"\"),e.hostname||(e.hostname=\"\"),\"\"!==i[0]&&i.unshift(\"\"),i.length<2&&i.unshift(\"\"),n.pathname=i.join(\"/\")}if(n.search=e.search,n.query=e.query,n.host=e.host||\"\",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var s=n.pathname||\"\",c=n.search||\"\";n.path=s+c}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var u=n.pathname&&\"/\"===n.pathname.charAt(0),l=e.host||e.pathname&&\"/\"===e.pathname.charAt(0),p=l||u||n.host&&e.pathname,d=p,h=n.pathname&&n.pathname.split(\"/\")||[],f=(i=e.pathname&&e.pathname.split(\"/\")||[],n.protocol&&!b[n.protocol]);if(f&&(n.hostname=\"\",n.port=null,n.host&&(\"\"===h[0]?h[0]=n.host:h.unshift(n.host)),n.host=\"\",e.protocol&&(e.hostname=null,e.port=null,e.host&&(\"\"===i[0]?i[0]=e.host:i.unshift(e.host)),e.host=null),p=p&&(\"\"===i[0]||\"\"===h[0])),l)n.host=e.host||\"\"===e.host?e.host:n.host,n.hostname=e.hostname||\"\"===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,h=i;else if(i.length)h||(h=[]),h.pop(),h=h.concat(i),n.search=e.search,n.query=e.query;else if(!function(e){return null==e}(e.search))return f&&(n.hostname=n.host=h.shift(),(S=!!(n.host&&n.host.indexOf(\"@\")>0)&&n.host.split(\"@\"))&&(n.auth=S.shift(),n.host=n.hostname=S.shift())),n.search=e.search,n.query=e.query,a(n.pathname)&&a(n.search)||(n.path=(n.pathname?n.pathname:\"\")+(n.search?n.search:\"\")),n.href=n.format(),n;if(!h.length)return n.pathname=null,n.search?n.path=\"/\"+n.search:n.path=null,n.href=n.format(),n;for(var m=h.slice(-1)[0],g=(n.host||e.host)&&(\".\"===m||\"..\"===m)||\"\"===m,v=0,w=h.length;w>=0;w--)\".\"==(m=h[w])?h.splice(w,1):\"..\"===m?(h.splice(w,1),v++):v&&(h.splice(w,1),v--);if(!p&&!d)for(;v--;v)h.unshift(\"..\");!p||\"\"===h[0]||h[0]&&\"/\"===h[0].charAt(0)||h.unshift(\"\"),g&&\"/\"!==h.join(\"/\").substr(-1)&&h.push(\"\");var S,E=\"\"===h[0]||h[0]&&\"/\"===h[0].charAt(0);return f&&(n.hostname=n.host=E?\"\":h.length?h.shift():\"\",(S=!!(n.host&&n.host.indexOf(\"@\")>0)&&n.host.split(\"@\"))&&(n.auth=S.shift(),n.host=n.hostname=S.shift())),(p=p||n.host&&h.length)&&!E&&h.unshift(\"\"),h.length?n.pathname=h.join(\"/\"):(n.pathname=null,n.path=null),a(n.pathname)&&a(n.search)||(n.path=(n.pathname?n.pathname:\"\")+(n.search?n.search:\"\")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=l.exec(e);t&&(\":\"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:88,querystring:91}],97:[function(e,t,n){\"function\"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],98:[function(e,t,n){t.exports=function(e){return e&&\"object\"==typeof e&&\"function\"==typeof e.copy&&\"function\"==typeof e.fill&&\"function\"==typeof e.readUInt8}},{}],99:[function(e,t,r){(function(t,n){(function(){function i(e,t){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(t)?n.showHidden=t:t&&r._extend(n,t),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),a(n,e,n.depth)}function o(e,t){var n=i.styles[t];return n?\"\u001B[\"+i.colors[n][0]+\"m\"+e+\"\u001B[\"+i.colors[n][1]+\"m\":e}function s(e,t){return e}function a(e,t,n){if(e.customInspect&&t&&S(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return m(i)||(i=a(e,i,n)),i}var o=c(e,t);if(o)return o;var s=Object.keys(t),d=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),w(t)&&(s.indexOf(\"message\")>=0||s.indexOf(\"description\")>=0))return u(t);if(0===s.length){if(S(t)){var h=t.name?\": \"+t.name:\"\";return e.stylize(\"[Function\"+h+\"]\",\"special\")}if(v(t))return e.stylize(RegExp.prototype.toString.call(t),\"regexp\");if(b(t))return e.stylize(Date.prototype.toString.call(t),\"date\");if(w(t))return u(t)}var f,g=\"\",y=!1,E=[\"{\",\"}\"];return p(t)&&(y=!0,E=[\"[\",\"]\"]),S(t)&&(g=\" [Function\"+(t.name?\": \"+t.name:\"\")+\"]\"),v(t)&&(g=\" \"+RegExp.prototype.toString.call(t)),b(t)&&(g=\" \"+Date.prototype.toUTCString.call(t)),w(t)&&(g=\" \"+u(t)),0!==s.length||y&&0!=t.length?n<0?v(t)?e.stylize(RegExp.prototype.toString.call(t),\"regexp\"):e.stylize(\"[Object]\",\"special\"):(e.seen.push(t),f=y?function(e,t,n,r,i){for(var o=[],s=0,a=t.length;s<a;++s)k(t,String(s))?o.push(l(e,t,n,r,String(s),!0)):o.push(\"\");return i.forEach((function(i){i.match(/^\\d+$/)||o.push(l(e,t,n,r,i,!0))})),o}(e,t,n,d,s):s.map((function(r){return l(e,t,n,d,r,y)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf(\"\\n\"),e+t.replace(/\\u001b\\[\\d\\d?m/g,\"\").length+1}),0)>60?n[0]+(\"\"===t?\"\":t+\"\\n \")+\" \"+e.join(\",\\n  \")+\" \"+n[1]:n[0]+t+\" \"+e.join(\", \")+\" \"+n[1]}(f,g,E)):E[0]+g+E[1]}function c(e,t){if(g(t))return e.stylize(\"undefined\",\"undefined\");if(m(t)){var n=\"'\"+JSON.stringify(t).replace(/^\"|\"$/g,\"\").replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"')+\"'\";return e.stylize(n,\"string\")}return f(t)?e.stylize(\"\"+t,\"number\"):d(t)?e.stylize(\"\"+t,\"boolean\"):h(t)?e.stylize(\"null\",\"null\"):void 0}function u(e){return\"[\"+Error.prototype.toString.call(e)+\"]\"}function l(e,t,n,r,i,o){var s,c,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?c=u.set?e.stylize(\"[Getter/Setter]\",\"special\"):e.stylize(\"[Getter]\",\"special\"):u.set&&(c=e.stylize(\"[Setter]\",\"special\")),k(r,i)||(s=\"[\"+i+\"]\"),c||(e.seen.indexOf(u.value)<0?(c=h(n)?a(e,u.value,null):a(e,u.value,n-1)).indexOf(\"\\n\")>-1&&(c=o?c.split(\"\\n\").map((function(e){return\"  \"+e})).join(\"\\n\").substr(2):\"\\n\"+c.split(\"\\n\").map((function(e){return\"   \"+e})).join(\"\\n\")):c=e.stylize(\"[Circular]\",\"special\")),g(s)){if(o&&i.match(/^\\d+$/))return c;(s=JSON.stringify(\"\"+i)).match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,\"name\")):(s=s.replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"').replace(/(^\"|\"$)/g,\"'\"),s=e.stylize(s,\"string\"))}return s+\": \"+c}function p(e){return Array.isArray(e)}function d(e){return\"boolean\"==typeof e}function h(e){return null===e}function f(e){return\"number\"==typeof e}function m(e){return\"string\"==typeof e}function g(e){return void 0===e}function v(e){return y(e)&&\"[object RegExp]\"===E(e)}function y(e){return\"object\"==typeof e&&null!==e}function b(e){return y(e)&&\"[object Date]\"===E(e)}function w(e){return y(e)&&(\"[object Error]\"===E(e)||e instanceof Error)}function S(e){return\"function\"==typeof e}function E(e){return Object.prototype.toString.call(e)}function C(e){return e<10?\"0\"+e.toString(10):e.toString(10)}function T(){var e=new Date,t=[C(e.getHours()),C(e.getMinutes()),C(e.getSeconds())].join(\":\");return[e.getDate(),A[e.getMonth()],t].join(\" \")}function k(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var I=/%[sdj%]/g;r.format=function(e){if(!m(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(\" \")}n=1;for(var r=arguments,o=r.length,s=String(e).replace(I,(function(e){if(\"%%\"===e)return\"%\";if(n>=o)return e;switch(e){case\"%s\":return String(r[n++]);case\"%d\":return Number(r[n++]);case\"%j\":try{return JSON.stringify(r[n++])}catch(e){return\"[Circular]\"}default:return e}})),a=r[n];n<o;a=r[++n])h(a)||!y(a)?s+=\" \"+a:s+=\" \"+i(a);return s},r.deprecate=function(e,i){if(g(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var _,x={};r.debuglog=function(e){if(g(_)&&(_=t.env.NODE_DEBUG||\"\"),e=e.toUpperCase(),!x[e])if(new RegExp(\"\\\\b\"+e+\"\\\\b\",\"i\").test(_)){var n=t.pid;x[e]=function(){var t=r.format.apply(r,arguments);console.error(\"%s %d: %s\",e,n,t)}}else x[e]=function(){};return x[e]},r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:\"cyan\",number:\"yellow\",boolean:\"yellow\",undefined:\"grey\",null:\"bold\",string:\"green\",date:\"magenta\",regexp:\"red\"},r.isArray=p,r.isBoolean=d,r.isNull=h,r.isNullOrUndefined=function(e){return null==e},r.isNumber=f,r.isString=m,r.isSymbol=function(e){return\"symbol\"==typeof e},r.isUndefined=g,r.isRegExp=v,r.isObject=y,r.isDate=b,r.isError=w,r.isFunction=S,r.isPrimitive=function(e){return null===e||\"boolean\"==typeof e||\"number\"==typeof e||\"string\"==typeof e||\"symbol\"==typeof e||void 0===e},r.isBuffer=e(\"./support/isBuffer\");var A=[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];r.log=function(){console.log(\"%s - %s\",T(),r.format.apply(r,arguments))},r.inherits=e(\"inherits\"),r._extend=function(e,t){if(!t||!y(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this)}).call(this,e(\"_process\"),void 0!==n.g?n.g:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./support/isBuffer\":98,_process:87,inherits:97}],100:[function(e,t,n){var r=e(\"./v1\"),i=e(\"./v4\"),o=i;o.v1=r,o.v4=i,t.exports=o},{\"./v1\":103,\"./v4\":104}],101:[function(e,t,n){for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var n=t||0,i=r;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],\"-\",i[e[n++]],i[e[n++]],\"-\",i[e[n++]],i[e[n++]],\"-\",i[e[n++]],i[e[n++]],\"-\",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join(\"\")}},{}],102:[function(e,t,n){var r=\"undefined\"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||\"undefined\"!=typeof msCrypto&&\"function\"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var i=new Uint8Array(16);t.exports=function(){return r(i),i}}else{var o=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},{}],103:[function(e,t,n){var r,i,o=e(\"./lib/rng\"),s=e(\"./lib/bytesToUuid\"),a=0,c=0;t.exports=function(e,t,n){var u=t&&n||0,l=t||[],p=(e=e||{}).node||r,d=void 0!==e.clockseq?e.clockseq:i;if(null==p||null==d){var h=o();null==p&&(p=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==d&&(d=i=16383&(h[6]<<8|h[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,g=f-a+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(d=d+1&16383),(g<0||f>a)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");a=f,c=m,i=d;var v=(1e4*(268435455&(f+=122192928e5))+m)%4294967296;l[u++]=v>>>24&255,l[u++]=v>>>16&255,l[u++]=v>>>8&255,l[u++]=255&v;var y=f/4294967296*1e4&268435455;l[u++]=y>>>8&255,l[u++]=255&y,l[u++]=y>>>24&15|16,l[u++]=y>>>16&255,l[u++]=d>>>8|128,l[u++]=255&d;for(var b=0;b<6;++b)l[u+b]=p[b];return t||s(l)}},{\"./lib/bytesToUuid\":101,\"./lib/rng\":102}],104:[function(e,t,n){var r=e(\"./lib/rng\"),i=e(\"./lib/bytesToUuid\");t.exports=function(e,t,n){var o=t&&n||0;\"string\"==typeof e&&(t=\"binary\"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},{\"./lib/bytesToUuid\":101,\"./lib/rng\":102}],105:[function(e,t,n){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0});var r=e(\"./utils/LRU\"),i=function(){function e(e){void 0===e&&(e=1e3),this.maxSize=e,this.cache=new r.LRUCache(e)}return Object.defineProperty(e.prototype,\"size\",{get:function(){return this.cache.length},enumerable:!0,configurable:!0}),e.prototype.put=function(t,n){var r=\"string\"!=typeof t?e.getKeyString(t):t,i=this.populateValue(n);this.cache.put(r,i)},e.prototype.get=function(t){var n=\"string\"!=typeof t?e.getKeyString(t):t,r=Date.now(),i=this.cache.get(n);if(i)for(var o=0;o<i.length;o++)if(i[o].Expire<r)return void this.cache.remove(n);return i},e.getKeyString=function(e){for(var t=[],n=Object.keys(e).sort(),r=0;r<n.length;r++){var i=n[r];void 0!==e[i]&&t.push(e[i])}return t.join(\" \")},e.prototype.populateValue=function(e){var t=Date.now();return e.map((function(e){return{Address:e.Address||\"\",Expire:t+60*(e.CachePeriodInMinutes||1)*1e3}}))},e.prototype.empty=function(){this.cache.empty()},e.prototype.remove=function(t){var n=\"string\"!=typeof t?e.getKeyString(t):t;this.cache.remove(n)},e}();n.EndpointCache=i},{\"./utils/LRU\":106}],106:[function(e,t,n){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0});var r=function(e,t){this.key=e,this.value=t},i=function(){function e(e){if(this.nodeMap={},this.size=0,\"number\"!=typeof e||e<1)throw new Error(\"Cache size can only be positive number\");this.sizeLimit=e}return Object.defineProperty(e.prototype,\"length\",{get:function(){return this.size},enumerable:!0,configurable:!0}),e.prototype.prependToList=function(e){this.headerNode?(this.headerNode.prev=e,e.next=this.headerNode):this.tailNode=e,this.headerNode=e,this.size++},e.prototype.removeFromTail=function(){if(this.tailNode){var e=this.tailNode,t=e.prev;return t&&(t.next=void 0),e.prev=void 0,this.tailNode=t,this.size--,e}},e.prototype.detachFromList=function(e){this.headerNode===e&&(this.headerNode=e.next),this.tailNode===e&&(this.tailNode=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.next=void 0,e.prev=void 0,this.size--},e.prototype.get=function(e){if(this.nodeMap[e]){var t=this.nodeMap[e];return this.detachFromList(t),this.prependToList(t),t.value}},e.prototype.remove=function(e){if(this.nodeMap[e]){var t=this.nodeMap[e];this.detachFromList(t),delete this.nodeMap[e]}},e.prototype.put=function(e,t){if(this.nodeMap[e])this.remove(e);else if(this.size===this.sizeLimit){var n=this.removeFromTail().key;delete this.nodeMap[n]}var i=new r(e,t);this.nodeMap[e]=i,this.prependToList(i)},e.prototype.empty=function(){for(var e=Object.keys(this.nodeMap),t=0;t<e.length;t++){var n=e[t],r=this.nodeMap[n];this.detachFromList(r),delete this.nodeMap[n]}},e}();n.LRUCache=i},{}],107:[function(e,t,n){e(\"./browser_loader\");var r=e(\"./core\");\"undefined\"!=typeof window&&(window.AWS=r),void 0!==t&&(t.exports=r),\"undefined\"!=typeof self&&(self.AWS=r),Object.prototype.hasOwnProperty.call(r,\"ConnectParticipant\")||(r.apiLoader.services.connectparticipant={},r.ConnectParticipant=r.Service.defineService(\"connectparticipant\",[\"2018-09-07\"])),r.apiLoader.services.connectparticipant[\"2018-09-07\"]=e(\"../apis/connectparticipant-2018-09-07.min\"),r.apiLoader.services.connectparticipant[\"2018-09-07\"].paginators=e(\"../apis/connectparticipant-2018-09-07.paginators\").pagination,Object.prototype.hasOwnProperty.call(r,\"STS\")||(r.apiLoader.services.sts={},r.STS=r.Service.defineService(\"sts\",[\"2011-06-15\"]),e(\"./services/sts\"))},{\"../apis/connectparticipant-2018-09-07.min\":3,\"../apis/connectparticipant-2018-09-07.paginators\":4,\"../apis/sts-2011-06-15.min\":6,\"./browser_loader\":17,\"./core\":20,\"./services/sts\":63}]},{},[107])},975:(e,t,n)=>{var r;!function(){\"use strict\";var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\\x25]+/,modulo:/^\\x25{2}/,placeholder:/^\\x25(?:([1-9]\\d*)\\$|\\(([^)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\\d]*)/i,key_access:/^\\.([a-z_][a-z_\\d]*)/i,index_access:/^\\[(\\d+)\\]/,sign:/^[+-]/};function o(e){return a(u(e),arguments)}function s(e,t){return o.apply(null,[e].concat(t||[]))}function a(e,t){var n,r,s,a,c,u,l,p,d,h=1,f=e.length,m=\"\";for(r=0;r<f;r++)if(\"string\"==typeof e[r])m+=e[r];else if(\"object\"==typeof e[r]){if((a=e[r]).keys)for(n=t[h],s=0;s<a.keys.length;s++){if(null==n)throw new Error(o('[sprintf] Cannot access property \"%s\" of undefined value \"%s\"',a.keys[s],a.keys[s-1]));n=n[a.keys[s]]}else n=a.param_no?t[a.param_no]:t[h++];if(i.not_type.test(a.type)&&i.not_primitive.test(a.type)&&n instanceof Function&&(n=n()),i.numeric_arg.test(a.type)&&\"number\"!=typeof n&&isNaN(n))throw new TypeError(o(\"[sprintf] expecting number but found %T\",n));switch(i.number.test(a.type)&&(p=n>=0),a.type){case\"b\":n=parseInt(n,10).toString(2);break;case\"c\":n=String.fromCharCode(parseInt(n,10));break;case\"d\":case\"i\":n=parseInt(n,10);break;case\"j\":n=JSON.stringify(n,null,a.width?parseInt(a.width):0);break;case\"e\":n=a.precision?parseFloat(n).toExponential(a.precision):parseFloat(n).toExponential();break;case\"f\":n=a.precision?parseFloat(n).toFixed(a.precision):parseFloat(n);break;case\"g\":n=a.precision?String(Number(n.toPrecision(a.precision))):parseFloat(n);break;case\"o\":n=(parseInt(n,10)>>>0).toString(8);break;case\"s\":n=String(n),n=a.precision?n.substring(0,a.precision):n;break;case\"t\":n=String(!!n),n=a.precision?n.substring(0,a.precision):n;break;case\"T\":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=a.precision?n.substring(0,a.precision):n;break;case\"u\":n=parseInt(n,10)>>>0;break;case\"v\":n=n.valueOf(),n=a.precision?n.substring(0,a.precision):n;break;case\"x\":n=(parseInt(n,10)>>>0).toString(16);break;case\"X\":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}i.json.test(a.type)?m+=n:(!i.number.test(a.type)||p&&!a.sign?d=\"\":(d=p?\"+\":\"-\",n=n.toString().replace(i.sign,\"\")),u=a.pad_char?\"0\"===a.pad_char?\"0\":a.pad_char.charAt(1):\" \",l=a.width-(d+n).length,c=a.width&&l>0?u.repeat(l):\"\",m+=a.align?d+n+c:\"0\"===u?d+c+n:c+d+n)}return m}var c=Object.create(null);function u(e){if(c[e])return c[e];for(var t,n=e,r=[],o=0;n;){if(null!==(t=i.text.exec(n)))r.push(t[0]);else if(null!==(t=i.modulo.exec(n)))r.push(\"%\");else{if(null===(t=i.placeholder.exec(n)))throw new SyntaxError(\"[sprintf] unexpected placeholder\");if(t[2]){o|=1;var s=[],a=t[2],u=[];if(null===(u=i.key.exec(a)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");for(s.push(u[1]);\"\"!==(a=a.substring(u[0].length));)if(null!==(u=i.key_access.exec(a)))s.push(u[1]);else{if(null===(u=i.index_access.exec(a)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");s.push(u[1])}t[2]=s}else o|=2;if(3===o)throw new Error(\"[sprintf] mixing positional and named placeholders is not (yet) supported\");r.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return c[e]=r}t.sprintf=o,t.vsprintf=s,\"undefined\"!=typeof window&&(window.sprintf=o,window.vsprintf=s,void 0===(r=function(){return{sprintf:o,vsprintf:s}}.call(t,n,t,e))||(e.exports=r))}()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.amdO={},n.g=function(){if(\"object\"==typeof globalThis)return globalThis;try{return this||new Function(\"return this\")()}catch(e){if(\"object\"==typeof window)return window}}(),(()=>{\"use strict\";class e extends Error{constructor(e){super(e),this.name=\"ValueError\"}}class t extends Error{constructor(e){super(e),this.name=\"UnImplementedMethod\"}}class r extends Error{constructor(e,t){super(e),this.name=\"IllegalArgument\",this.argument=t}}Error,Error;var i=new class{update(e){var t=e||{};this.stage=t.stage||this.stage||\"prod\",this.region=t.region||this.region||\"us-west-2\",this.endpointOverride=t.endpoint||this.endpointOverride,this.reconnect=!1!==t.reconnect}getRegion(){return this.region}getEndpointOverride(){return this.endpointOverride}updateStageRegion(e){e&&(this.stage=e.stage||this.stage,this.region=e.region||this.region)}getStage(){return this.stage}},o={AGENT:\"AGENT\",CUSTOMER:\"CUSTOMER\"},s=\"API\",a=\"SendMessage\",c=\"SendAttachment\",u=\"DownloadAttachment\",l=\"SendEvent\",p=\"GetTranscript\",d=\"DisconnectParticipant\",h=\"CreateParticipantConnection\",f=\"InitWebsocket\",m=\"INCOMING_MESSAGE\",g=\"INCOMING_TYPING\",v=\"CONNECTION_ESTABLISHED\",y=\"CONNECTION_BROKEN\",b=\"CHAT_ENDED\",w={textPlain:\"text/plain\",textMarkdown:\"text/markdown\",textCsv:\"text/csv\",applicationDoc:\"application/msword\",applicationDocx:\"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",applicationPdf:\"application/pdf\",applicationPpt:\"application/vnd.ms-powerpoint\",applicationPptx:\"application/vnd.openxmlformats-officedocument.presentationml.presentation\",applicationXls:\"application/vnd.ms-excel\",applicationXlsx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",imageJpg:\"image/jpeg\",imagePng:\"image/png\",audioWav:\"audio/wav\",audioXWav:\"audio/x-wav\",audioVndWave:\"audio/vnd.wave\",connectionAcknowledged:\"application/vnd.amazonaws.connect.event.connection.acknowledged\",typing:\"application/vnd.amazonaws.connect.event.typing\",participantJoined:\"application/vnd.amazonaws.connect.event.participant.joined\",participantLeft:\"application/vnd.amazonaws.connect.event.participant.left\",participantActive:\"application/vnd.amazonaws.connect.event.participant.active\",participantInactive:\"application/vnd.amazonaws.connect.event.participant.inactive\",transferSucceeded:\"application/vnd.amazonaws.connect.event.transfer.succeeded\",transferFailed:\"application/vnd.amazonaws.connect.event.transfer.failed\",chatEnded:\"application/vnd.amazonaws.connect.event.chat.ended\",interactiveMessage:\"application/vnd.amazonaws.connect.message.interactive\"},S=3540,E=n(975),C={assertTrue:function(t,n){if(!t)throw new e(n)},assertNotNull:function(e,t){return C.assertTrue(null!==e&&void 0!==typeof e,(0,E.sprintf)(\"%s must be provided\",t||\"A value\")),e},now:function(){return(new Date).getTime()},isString:function(e){return\"string\"==typeof e},randomId:function(){return(0,E.sprintf)(\"%s-%s\",C.now(),Math.random().toString(36).slice(2))},assertIsNonEmptyString:function(e,t){if(!e||\"string\"!=typeof e)throw new r(t+\" is not a non-empty string!\")},assertIsList:function(e,t){if(!Array.isArray(e))throw new r(t+\" is not an array\")},assertIsEnum:function(e,t,n){var i;for(i=0;i<t.length;i++)if(t[i]===e)return;throw new r(n+\" passed (\"+e+\") is not valid. Allowed values are: \"+t)},makeEnum:function(e){var t={};return e.forEach((function(e){var n=e.replace(/\\.?([a-z]+)_?/g,(function(e,t){return t.toUpperCase()+\"_\"})).replace(/_$/,\"\");t[n]=e})),t},contains:function(e,t){return e instanceof Array?null!==C.find(e,(function(e){return e===t})):t in e},find:function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n];return null},containsValue:function(e,t){return e instanceof Array?null!==C.find(e,(function(e){return e===t})):null!==C.find(C.values(e),(function(e){return e===t}))},isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},values:function(e){var t=[];for(var n in C.assertNotNull(e,\"map\"),e)t.push(e[n]);return t},isObject:function(e){return!(\"object\"!=typeof e||null===e)},assertIsObject:function(e,t){if(!C.isObject(e))throw new r(t+\" is not an object!\")},delay:e=>new Promise((t=>setTimeout(t,e))),asyncWhileInterval:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=new Date;return t(r)?e(r).catch((i=>{var s=Math.max(0,n-(new Date).valueOf()+o.valueOf());return C.delay(s).then((()=>C.asyncWhileInterval(e,t,n,r+1,i)))})):Promise.reject(i||new Error(\"async while aborted\"))},isAttachmentContentType:function(e){return e===w.applicationPdf||e===w.imageJpg||e===w.imagePng||e===w.applicationDoc||e===w.applicationXls||e===w.applicationPpt||e===w.textCsv||e===w.audioWav}};const T=C;var k={DEBUG:10,INFO:20,WARN:30,ERROR:40,ADVANCED_LOG:50},I=new class{constructor(){this.updateLoggerConfig()}writeToClientLogger(e,t,n){if(this.hasClientLogger()){var r=function(e){switch(e){case 10:return\"DEBUG\";case 20:return\"INFO\";case 30:return\"WARN\";case 40:return\"ERROR\";case 50:return\"ADVANCED_LOG\"}}(e);switch(e){case k.DEBUG:return this._clientLogger.debug(r,t,n)||t;case k.INFO:return this._clientLogger.info(r,t,n)||t;case k.WARN:return this._clientLogger.warn(r,t,n)||t;case k.ERROR:return this._clientLogger.error(r,t,n)||t;case k.ADVANCED_LOG:return this._advancedLogWriter&&this._clientLogger[this._advancedLogWriter]&&this._clientLogger[this._advancedLogWriter](r,t,n)||t}}}isLevelEnabled(e){return e>=this._level}hasClientLogger(){return null!==this._clientLogger}getLogger(){return new x(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}updateLoggerConfig(e){var t=e||{};this._level=t.level||k.INFO,this._advancedLogWriter=\"warn\",function(e,t){var n=t&&Object.keys(t);if(n&&-1===n.indexOf(e))return console.error(\"customizedLogger: incorrect value for loggerConfig:advancedLogWriter; use valid values from list \".concat(n,\" but used \").concat(e)),!1;var r=[\"warn\",\"info\",\"debug\",\"log\"];return!e||-1!==r.indexOf(e)||(console.error(\"incorrect value for loggerConfig:advancedLogWriter; use valid values from list \".concat(r,\" but used \").concat(e)),!1)}(t.advancedLogWriter,t.customizedLogger)&&(this._advancedLogWriter=t.advancedLogWriter),t.customizedLogger&&\"object\"==typeof t.customizedLogger&&(this.useClientLogger=!0),this._clientLogger=this.selectLogger(t)}selectLogger(e){return e.customizedLogger&&\"object\"==typeof e.customizedLogger?e.customizedLogger:e.useDefaultLogger?A():null}};class _{debug(){}info(){}warn(){}error(){}}class x extends _{constructor(e){super(),this.options=e||{}}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(k.DEBUG,t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(k.INFO,t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(k.WARN,t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(k.ERROR,t)}advancedLog(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(k.ADVANCED_LOG,t)}_shouldLog(e){return I.hasClientLogger()&&I.isLevelEnabled(e)}_writeToClientLogger(e,t){return I.writeToClientLogger(e,t,this.options.logMetaData)}_log(e,t){if(this._shouldLog(e)){var n=I.useClientLogger?t:this._convertToSingleStatement(t);return this._writeToClientLogger(e,n)}}_convertToSingleStatement(e){var t=new Date(Date.now()).toISOString(),n=\"[\".concat(t,\"]\");this.options&&(this.options.prefix?n+=\" \"+this.options.prefix+\":\":n+=\"\");for(var r=0;r<e.length;r++){var i=e[r];n+=\" \"+this._convertToString(i)}return n}_convertToString(e){try{if(!e)return\"\";if(T.isString(e))return e;if(T.isObject(e)&&T.isFunction(e.toString)){var t=e.toString();if(\"[object Object]\"!==t)return t}return JSON.stringify(e)}catch(t){return console.error(\"Error while converting argument to string\",e,t),\"\"}}}var A=()=>{var e=new _;return e.debug=console.debug.bind(window.console),e.info=console.info.bind(window.console),e.warn=console.warn.bind(window.console),e.error=console.error.bind(window.console),e};function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(228);class N extends class{sendMessage(e,n,r){throw new t(\"sendTextMessage in ChatClient\")}sendAttachment(e,n,r){throw new t(\"sendAttachment in ChatClient\")}downloadAttachment(e,n){throw new t(\"downloadAttachment in ChatClient\")}disconnectParticipant(e){throw new t(\"disconnectParticipant in ChatClient\")}sendEvent(e,n,r){throw new t(\"sendEvent in ChatClient\")}createParticipantConnection(e,n){throw new t(\"createParticipantConnection in ChatClient\")}}{constructor(e){super();var t=new AWS.Credentials(\"\",\"\"),n=new AWS.Config({region:e.region,endpoint:e.endpoint,credentials:t});this.chatClient=new AWS.ConnectParticipant(n),this.invokeUrl=e.endpoint,this.logger=I.getLogger({prefix:\"Amazon-Connect-ChatJS-ChatClient\",logMetaData:e.logMetaData})}createParticipantConnection(e,t){var n=this,r={Type:t,ParticipantToken:e},i=n.chatClient.createParticipantConnection(r);return n._sendRequest(i).then((e=>{var t,r;return null===(t=n.logger.info(\"Successfully create connection request\"))||void 0===t||null===(r=t.sendInternalLogToServer)||void 0===r||r.call(t),e})).catch((e=>{var t,r;return null===(t=n.logger.error(\"Error when creating connection request \",e))||void 0===t||null===(r=t.sendInternalLogToServer)||void 0===r||r.call(t),Promise.reject(e)}))}disconnectParticipant(e){var t=this,n={ConnectionToken:e},r=t.chatClient.disconnectParticipant(n);return t._sendRequest(r).then((e=>{var n,r;return null===(n=t.logger.info(\"Successfully disconnect participant\"))||void 0===n||null===(r=n.sendInternalLogToServer)||void 0===r||r.call(n),e})).catch((e=>{var n,r;return null===(n=t.logger.error(\"Error when disconnecting participant \",e))||void 0===n||null===(r=n.sendInternalLogToServer)||void 0===r||r.call(n),Promise.reject(e)}))}getTranscript(e,t){var n={MaxResults:t.maxResults,NextToken:t.nextToken,ScanDirection:t.scanDirection,SortOrder:t.sortOrder,StartPosition:{Id:t.startPosition.id,AbsoluteTime:t.startPosition.absoluteTime,MostRecent:t.startPosition.mostRecent},ConnectionToken:e};t.contactId&&(n.ContactId=t.contactId);var r=this.chatClient.getTranscript(n);return this._sendRequest(r).then((e=>(this.logger.info(\"Successfully get transcript\"),e))).catch((e=>(this.logger.error(\"Get transcript error\",e),Promise.reject(e))))}sendMessage(e,t,n){var r={Content:t,ContentType:n,ConnectionToken:e},i=this.chatClient.sendMessage(r);return this._sendRequest(i).then((e=>{var t,n={id:null===(t=e.data)||void 0===t?void 0:t.Id,contentType:r.ContentType};return this.logger.debug(\"Successfully send message\",n),e})).catch((e=>(this.logger.error(\"Send message error\",e,{contentType:r.ContentType}),Promise.reject(e))))}sendAttachment(e,t,n){var r=this,i={ContentType:t.type,AttachmentName:t.name,AttachmentSizeInBytes:t.size,ConnectionToken:e},o=r.chatClient.startAttachmentUpload(i),s={contentType:t.type,size:t.size};return r._sendRequest(o).then((n=>r._uploadToS3(t,n.data.UploadMetadata).then((()=>{var t,i={AttachmentIds:[n.data.AttachmentId],ConnectionToken:e};this.logger.debug(\"Successfully upload attachment\",L(L({},s),{},{attachmentId:null===(t=n.data)||void 0===t?void 0:t.AttachmentId}));var o=r.chatClient.completeAttachmentUpload(i);return r._sendRequest(o)})))).catch((e=>(this.logger.error(\"Upload attachment error\",e,s),Promise.reject(e))))}_uploadToS3(e,t){return fetch(t.Url,{method:\"PUT\",headers:t.HeadersToInclude,body:e})}downloadAttachment(e,t){var n=this,r={AttachmentId:t,ConnectionToken:e},i={attachmentId:t},o=n.chatClient.getAttachment(r);return n._sendRequest(o).then((e=>(this.logger.debug(\"Successfully download attachment\",i),n._downloadUrl(e.data.Url)))).catch((e=>(this.logger.error(\"Download attachment error\",e,i),Promise.reject(e))))}_downloadUrl(e){return fetch(e).then((e=>e.blob())).catch((e=>Promise.reject(e)))}sendEvent(e,t,n){var r={ConnectionToken:e,ContentType:t,Content:n},i=this.chatClient.sendEvent(r),o={contentType:t};return this._sendRequest(i).then((e=>{var t;return this.logger.debug(\"Successfully send event\",L(L({},o),{},{id:null===(t=e.data)||void 0===t?void 0:t.Id})),e})).catch((e=>(this.logger.error(\"Send event error\",e,o),Promise.reject(e))))}_sendRequest(e){return new Promise(((t,n)=>{e.on(\"success\",(function(e){t(e)})).on(\"error\",(function(e){var t={type:e.code,message:e.message,stack:e.stack?e.stack.split(\"\\n\"):[]};n(t)})).send()}))}}var M=new class{constructor(){this.clientCache={}}getCachedClient(e,t){var n=Object.assign({},e),r=e.region||i.getRegion()||\"us-west-2\";if(n.region=r,t.region=r,this.clientCache[r])return this.clientCache[r];var o=this._createAwsClient(n,t);return this.clientCache[r]=o,o}_createAwsClient(e,t){var n=e.region,r=i.getEndpointOverride(),o=\"https://participant.connect.\".concat(n,\".amazonaws.com\");return r&&(o=r),new N({endpoint:o,region:n,logMetaData:t})}};class P extends class{validateNewControllerDetails(e){return!0}validateSendMessage(e){if(!T.isString(e.message))throw new r(e.message+\"is not a valid message\");this.validateContentType(e.contentType)}validateContentType(e){T.assertIsEnum(e,Object.values(w),\"contentType\")}validateConnectChat(e){return!0}validateLogger(e){T.assertIsObject(e,\"logger\"),[\"debug\",\"info\",\"warn\",\"error\"].forEach((t=>{if(!T.isFunction(e[t]))throw new r(t+\" should be a valid function on the passed logger object!\")}))}validateSendEvent(e){this.validateContentType(e.contentType)}validateGetMessages(e){return!0}}{validateChatDetails(e,t){if(T.assertIsObject(e,\"chatDetails\"),t===o.AGENT&&!T.isFunction(e.getConnectionToken))throw new r(\"getConnectionToken was not a function\",e.getConnectionToken);if(T.assertIsNonEmptyString(e.contactId,\"chatDetails.contactId\"),T.assertIsNonEmptyString(e.participantId,\"chatDetails.participantId\"),t===o.CUSTOMER){if(!e.participantToken)throw new r(\"participantToken was not provided for a customer session type\",e.participantToken);T.assertIsNonEmptyString(e.participantToken,\"chatDetails.participantToken\")}}validateInitiateChatResponse(){return!0}normalizeChatDetails(e){var t={};return t.contactId=e.ContactId||e.contactId,t.participantId=e.ParticipantId||e.participantId,t.initialContactId=e.InitialContactId||e.initialContactId||t.contactId||t.ContactId,t.getConnectionToken=e.getConnectionToken||e.GetConnectionToken,(e.participantToken||e.ParticipantToken)&&(t.participantToken=e.ParticipantToken||e.participantToken),this.validateChatDetails(t),t}}var D=\"NeverStarted\",U=\"Starting\",q=\"Connected\",j=\"ConnectionLost\",W=\"Ended\",F=\"ConnectionLost\",B=\"ConnectionGained\",z=\"Ended\",H=\"IncomingMessage\",V=\"<<all>>\",G=function(e,t,n){this.subMap=e,this.id=T.randomId(),this.eventName=t,this.f=n};G.prototype.unsubscribe=function(){this.subMap.unsubscribe(this.eventName,this.id)};var K=function(){this.subIdMap={},this.subEventNameMap={}};K.prototype.subscribe=function(e,t){var n=new G(this,e,t);this.subIdMap[n.id]=n;var r=this.subEventNameMap[e]||[];return r.push(n),this.subEventNameMap[e]=r,()=>n.unsubscribe()},K.prototype.unsubscribe=function(e,t){T.contains(this.subEventNameMap,e)&&(this.subEventNameMap[e]=this.subEventNameMap[e].filter((function(e){return e.id!==t})),this.subEventNameMap[e].length<1&&delete this.subEventNameMap[e]),T.contains(this.subIdMap,t)&&delete this.subIdMap[t]},K.prototype.getAllSubscriptions=function(){return T.values(this.subEventNameMap).reduce((function(e,t){return e.concat(t)}),[])},K.prototype.getSubscriptions=function(e){return this.subEventNameMap[e]||[]};var X=function(e){var t=e||{};this.subMap=new K,this.logEvents=t.logEvents||!1};X.prototype.subscribe=function(e,t){return T.assertNotNull(e,\"eventName\"),T.assertNotNull(t,\"f\"),T.assertTrue(T.isFunction(t),\"f must be a function\"),this.subMap.subscribe(e,t)},X.prototype.subscribeAll=function(e){return T.assertNotNull(e,\"f\"),T.assertTrue(T.isFunction(e),\"f must be a function\"),this.subMap.subscribe(V,e)},X.prototype.getSubscriptions=function(e){return this.subMap.getSubscriptions(e)},X.prototype.trigger=function(e,t){T.assertNotNull(e,\"eventName\");var n=this,r=this.subMap.getSubscriptions(V),i=this.subMap.getSubscriptions(e);r.concat(i).forEach((function(r){try{r.f(t||null,e,n)}catch(e){}}))},X.prototype.triggerAsync=function(e,t){setTimeout((()=>this.trigger(e,t)),0)},X.prototype.bridge=function(){var e=this;return function(t,n){e.trigger(n,t)}},X.prototype.unsubscribeAll=function(){this.subMap.getAllSubscriptions().forEach((function(e){e.unsubscribe()}))};var J=\"Category\",Y=new class{constructor(){this.widgetType=\"CustomChatWidget\",this.logger=I.getLogger({prefix:\"ChatJS-csmService\"}),this.csmInitialized=!1,this.metricsToBePublished=[],this.loadCsmScriptAndExecute()}loadCsmScriptAndExecute(){try{var e=document.createElement(\"script\");e.type=\"text/javascript\",e.innerHTML=\"(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  csm.EVENT_TYPE = {\\n    LOG: 'LOG',\\n    METRIC: 'METRIC',\\n    CONFIG: 'CONFIG',\\n    WORKFLOW_EVENT: 'WORKFLOW_EVENT',\\n    CUSTOM: 'CUSTOM',\\n    CLOSE: 'CLOSE',\\n    SET_AUTH: 'SET_AUTH',\\n    SET_CONFIG: 'SET_CONFIG',\\n  };\\n\\n  csm.UNIT = {\\n    COUNT: 'Count',\\n    SECONDS: 'Seconds',\\n    MILLISECONDS: 'Milliseconds',\\n    MICROSECONDS: 'Microseconds',\\n  };\\n})();\\n\\n(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  const MAX_METRIC_DIMENSIONS = 10;\\n\\n  /** ********* Dimension Classes ***********/\\n\\n  const Dimension = function(name, value) {\\n    csm.Util.assertExist(name, 'name');\\n    csm.Util.assertExist(value, 'value');\\n\\n    this.name = name;\\n    this.value = value == null ? 'null' : (value === '' ? ' ' : value.toString());\\n  };\\n\\n\\n  /** ********* Metric Classes ***********/\\n\\n  const Metric = function(metricName, unit, value, dedupeOptions) {\\n    csm.Util.assertExist(metricName, 'metricName');\\n    csm.Util.assertExist(value, 'value');\\n    csm.Util.assertExist(unit, 'unit');\\n    csm.Util.assertTrue(csm.Util.isValidUnit(unit));\\n    if (dedupeOptions) {\\n      csm.Util.assertInObject(dedupeOptions, 'dedupeOptions', 'dedupeIntervalMs');\\n    }\\n\\n    this.metricName = metricName;\\n    this.unit = unit;\\n    this.value = value;\\n    this.timestamp = new Date();\\n    this.dimensions = csm.globalDimensions ? csm.Util.deepCopy(csm.globalDimensions): [];\\n    this.namespace = csm.configuration.namespace;\\n    this.dedupeOptions = dedupeOptions; // optional. { dedupeIntervalMs: (int; required), context: (string; optional) }\\n\\n    // Currently, CloudWatch can't aggregate metrics by a subset of dimensions.\\n    // To bypass this limitation, we introduce the optional dimensions concept to CSM.\\n    // The CSM metric publisher will publish a default metric without optional dimension\\n    // For each optional dimension, the CSM metric publisher publishes an extra metric with that dimension.\\n    this.optionalDimensions = csm.globalOptionalDimensions ? csm.Util.deepCopy(csm.globalOptionalDimensions): [];\\n  };\\n\\n  Metric.prototype.addDimension = function(name, value) {\\n    this._addDimensionHelper(this.dimensions, name, value);\\n  };\\n\\n  Metric.prototype.addOptionalDimension = function(name, value) {\\n    this._addDimensionHelper(this.optionalDimensions, name, value);\\n  };\\n\\n  Metric.prototype._addDimensionHelper = function(targetDimensions, name, value) {\\n    // CloudWatch metric allows maximum 10 dimensions\\n    // http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/CloudWatch.html#putMetricData-property\\n    if ((this.dimensions.length + this.optionalDimensions.length) >= MAX_METRIC_DIMENSIONS) {\\n      throw new csm.ExceedDimensionLimitException(name);\\n    }\\n\\n    const existing = targetDimensions.find(function(dimension) {\\n      return dimension.name === name;\\n    });\\n\\n    if (existing) {\\n      existing.value = value == null ? 'null' : (value === '' ? ' ' : value.toString());\\n    } else {\\n      targetDimensions.push(new Dimension(name, value));\\n    }\\n  };\\n\\n\\n  /** ********* Telemetry Classes ***********/\\n\\n  const WorkflowEvent = function(params) {\\n    this.timestamp = params.timestamp || new Date().getTime();\\n    this.workflowType = params.workflow.type;\\n    this.instanceId = params.workflow.instanceId;\\n    this.userId = params.userId;\\n    this.organizationId = params.organizationId;\\n    this.accountId = params.accountId;\\n    this.event = params.event;\\n    this.appName = params.appName;\\n    this.data = [];\\n\\n    // Convert 'data' map into the KeyValuePairList structure expected by the Lambda API\\n    for (const key in params.data) {\\n      if (Object.prototype.hasOwnProperty.call(params.data, key)) {\\n        this.data.push({'key': key, 'value': params.data[key]});\\n      }\\n    }\\n  };\\n\\n  /** ********* Exceptions ***********/\\n\\n  const NullOrUndefinedException = function(paramName) {\\n    this.name = 'NullOrUndefinedException';\\n    this.message = paramName + ' is null or undefined. ';\\n  };\\n  NullOrUndefinedException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const AssertTrueException = function() {\\n    this.name = 'AssertTrueException';\\n    this.message = 'Assertion failed. ';\\n  };\\n  AssertTrueException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const ExceedDimensionLimitException = function(dimensionName) {\\n    this.name = 'ExceedDimensionLimitException';\\n    this.message = 'Could not add dimension \\\\'' + dimensionName + '\\\\'. Metric has maximum 10 dimensions. ';\\n  };\\n  ExceedDimensionLimitException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const InitializationException = function() {\\n    this.name = 'InitializationException';\\n    this.message = 'Initialization failed. ';\\n  };\\n  InitializationException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n\\n  csm.Dimension = Dimension;\\n  csm.Metric = Metric;\\n  csm.WorkflowEvent = WorkflowEvent;\\n  csm.NullOrUndefinedException = NullOrUndefinedException;\\n  csm.AssertTrueException = AssertTrueException;\\n  csm.InitializationException = InitializationException;\\n  csm.ExceedDimensionLimitException = ExceedDimensionLimitException;\\n})();\\n\\n(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  const validTimeUnits = [csm.UNIT.SECONDS, csm.UNIT.MILLISECONDS, csm.UNIT.MICROSECONDS];\\n  const validUnits = validTimeUnits.concat(csm.UNIT.COUNT);\\n\\n  const Util = {\\n    assertExist: function(value, paramName) {\\n      if (value === null || value === undefined) {\\n        throw new csm.NullOrUndefinedException(paramName);\\n      }\\n    },\\n    assertTrue: function(value) {\\n      if (!value) {\\n        throw new csm.AssertTrueException();\\n      }\\n    },\\n    assertInObject: function(obj, objName, key) {\\n      if (obj === null || obj === undefined || typeof obj !== 'object') {\\n        throw new csm.NullOrUndefinedException(objName);\\n      }\\n      if (key === null || key === undefined || !obj[key]) {\\n        throw new csm.NullOrUndefinedException(`${objName}[${key}]`);\\n      }\\n    },\\n    isValidUnit: function(unit) {\\n      return validUnits.includes(unit);\\n    },\\n    isValidTimeUnit: function(unit) {\\n      return validTimeUnits.includes(unit);\\n    },\\n    isEmpty: function(value) {\\n      if (value !== null && typeof val === 'object') {\\n        return Objects.keys(value).length === 0;\\n      }\\n      return !value;\\n    },\\n    deepCopy: function(obj) {\\n      // NOTE: this will fail if obj has a circular reference\\n      return JSON.parse(JSON.stringify(obj));\\n    },\\n\\n    /**\\n     * This function is used before setting the page location for default metrics and logs,\\n     * and the APIs that set page location\\n     * Can be overridden by calling csm.API.setPageLocationTransformer(function(){})\\n     * @param {string}        pathname path for page location\\n     * @return {string}       pathname provided\\n     */\\n    pageLocationTransformer: function(pathname) {\\n      return pathname;\\n    },\\n\\n    /**\\n     * As of now, our service public claims only support for Firefox and Chrome\\n     * Reference https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent\\n     *\\n     * This function will only return firefox, chrome and others\\n     *\\n     * Best practice as indicated in MDN, \\\"Avoiding user agent detection\\\"\\n     */\\n    getBrowserDetails: function() {\\n      const userAgent = window.navigator.userAgent;\\n      const details = {};\\n      if (userAgent.includes('Firefox') && !userAgent.includes('Seamonkey')) {\\n        details.name = 'Firefox';\\n        details.version = getBrowserVersion('Firefox');\\n      } else if (userAgent.includes('Chrome') && !userAgent.includes('Chromium')) {\\n        details.name = 'Chrome';\\n        details.version = getBrowserVersion('Chrome');\\n      }\\n    },\\n\\n    randomId: function() {\\n      return new Date().getTime() + '-' + Math.random().toString(36).slice(2);\\n    },\\n\\n    getOrigin: function() {\\n      return document.location.origin;\\n    },\\n\\n    getReferrerUrl: function() {\\n      const referrer = document.referrer || '';\\n      return this.getURLOrigin(referrer);\\n    },\\n\\n    getWindowParent: function() {\\n      let parentLocation = '';\\n      try {\\n        parentLocation = window.parent.location.href;\\n      } catch (e) {\\n        parentLocation = '';\\n      }\\n      return parentLocation;\\n    },\\n\\n    getURLOrigin: function(urlValue) {\\n      let origin = '';\\n      const originArray = urlValue.split( '/' );\\n      if (originArray.length >= 3) {\\n        const protocol = originArray[0];\\n        const host = originArray[2];\\n        origin = protocol + '//' + host;\\n      }\\n      return origin;\\n    },\\n\\n  };\\n\\n  const getBrowserVersion = function(browserName) {\\n    const userAgent = window.navigator.userAgent;\\n    const browserNameIndex = userAgent.indexOf(browserName);\\n    const nextSpaceIndex = userAgent.indexOf(' ', browserNameIndex);\\n    if (nextSpaceIndex === -1) {\\n      return userAgent.substring(browserNameIndex + browserName.length + 1, userAgent.length);\\n    } else {\\n      return userAgent.substring(browserNameIndex + browserName.length + 1, nextSpaceIndex);\\n    }\\n  };\\n\\n  csm.Util = Util;\\n})();\\n\\n(function() {\\n  const global = window;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  csm.globalDimensions = []; // These dimensions are added to all captured metrics.\\n  csm.globalOptionalDimensions = [];\\n  csm.initFailureDimensions = [];\\n\\n  const API = {\\n    getWorkflow: function(workflowType, instanceId, data) {\\n      return csm.workflow(workflowType, instanceId, data);\\n    },\\n\\n    addMetric: function(metric) {\\n      csm.Util.assertExist(metric, 'metric');\\n      csm.putMetric(metric);\\n    },\\n\\n    addMetricWithDedupe: function(metric, dedupeIntervalMs, context) {\\n      csm.Util.assertExist(metric, 'metric');\\n      csm.Util.assertExist(metric, 'dedupeIntervalMs');\\n      // context is optional; if present it will only dedupe on metrics with the same context. ex.) tabId\\n      metric.dedupeOptions = {dedupeIntervalMs, context: context || 'global'};\\n      csm.putMetric(metric);\\n    },\\n\\n    addCount: function(metricName, count) {\\n      csm.Util.assertExist(metricName, 'metricName');\\n      csm.Util.assertExist(count, 'count');\\n\\n      const metric = new csm.Metric(metricName, csm.UNIT.COUNT, count);\\n      csm.putMetric(metric);\\n    },\\n\\n    addCountWithPageLocation: function(metricName) {\\n      csm.Util.assertExist(metricName, 'metricName');\\n\\n      const metric = new csm.Metric(metricName, csm.UNIT.COUNT, 1.0);\\n      metric.addDimension('WindowLocation', csm.Util.pageLocationTransformer(window.location.pathname));\\n      csm.putMetric(metric);\\n    },\\n\\n    addError: function(metricName, count) {\\n      csm.Util.assertExist(metricName, 'metricName');\\n\\n      if (count === undefined || count == null) {\\n        count = 1.0;\\n      }\\n      const metric = new csm.Metric(metricName, csm.UNIT.COUNT, count);\\n      metric.addDimension('Metric', 'Error');\\n      csm.putMetric(metric);\\n    },\\n\\n    addSuccess: function(metricName) {\\n      API.addError(metricName, 0);\\n    },\\n\\n    addTime: function(metricName, time, unit) {\\n      csm.Util.assertExist(metricName, 'metricName');\\n      csm.Util.assertExist(time, 'time');\\n\\n      let timeUnit = csm.UNIT.MILLISECONDS;\\n      if (unit && csm.Util.isValidTimeUnit(unit)) {\\n        timeUnit = unit;\\n      }\\n      const metric = new csm.Metric(metricName, timeUnit, time);\\n      metric.addDimension('Metric', 'Time');\\n      csm.putMetric(metric);\\n    },\\n\\n    addTimeWithPageLocation: function(metricName, time, unit) {\\n      csm.Util.assertExist(metricName, 'metricName');\\n      csm.Util.assertExist(time, 'time');\\n\\n      let timeUnit = csm.UNIT.MILLISECONDS;\\n      if (unit && csm.Util.isValidTimeUnit(unit)) {\\n        timeUnit = unit;\\n      }\\n      const metric = new csm.Metric(metricName, timeUnit, time);\\n      metric.addDimension('WindowLocation', csm.Util.pageLocationTransformer(window.location.pathname));\\n      csm.putMetric(metric);\\n    },\\n\\n    pageReady: function() {\\n      if (window.performance && window.performance.now) {\\n        const pageLoadTime = window.performance.now();\\n        const metric = new csm.Metric('PageReadyLatency', csm.UNIT.MILLISECONDS, pageLoadTime);\\n        metric.addDimension('WindowLocation', csm.Util.pageLocationTransformer(window.location.pathname));\\n        csm.putMetric(metric);\\n      }\\n    },\\n\\n    setPageLocationTransformer: function(transformFunc) {\\n      csm.Util.assertExist(transformFunc, 'transformFunc');\\n      csm.Util.assertTrue((typeof transformFunc) === 'function');\\n      csm.Util.pageLocationTransformer = transformFunc;\\n    },\\n\\n    setGlobalDimensions: function(dimensions) {\\n      csm.Util.assertExist(dimensions, 'dimensions');\\n      csm.globalDimensions = dimensions;\\n    },\\n\\n    setGlobalOptionalDimensions: function(dimensions) {\\n      csm.Util.assertExist(dimensions, 'dimensions');\\n      csm.globalOptionalDimensions = dimensions;\\n    },\\n\\n    setInitFailureDimensions: function(dimensions) {\\n      csm.Util.assertExist(dimensions, 'dimensions');\\n      csm.initFailureDimensions = dimensions;\\n    },\\n\\n    putCustom: function(endpoint, headers, data) {\\n      csm.Util.assertExist(data, 'data');\\n      csm.Util.assertExist(endpoint, 'endpoint');\\n      csm.Util.assertExist(headers, 'headers');\\n      csm.putCustom(endpoint, headers, data);\\n    },\\n\\n    setAuthParams: function(authParams) {\\n      csm.setAuthParams(authParams);\\n    },\\n\\n    setConfig: function(key, value) {\\n      csm.Util.assertExist(key, 'key');\\n      csm.Util.assertExist(value, 'value');\\n      if (!csm.configuration[key]) {\\n        csm.setConfig(key, value); // set configuration variables such as accountId, instanceId, userId\\n      }\\n    },\\n  };\\n\\n  csm.API = API;\\n})();\\n\\n(function() {\\n  const global = window;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  const WORKFLOW_KEY_PREFIX = 'csm.workflow';\\n\\n  /**\\n   * Calculates the local storage key used to store a workflow of the specified type.\\n   * @param {string} type of workflow\\n   * @return {string} storage key\\n   */\\n  const getWorkflowKeyForType = function(type) {\\n    return [\\n      WORKFLOW_KEY_PREFIX,\\n      type,\\n    ].join('.');\\n  };\\n\\n  /**\\n   * Constructor for new Workflow objects.\\n   *\\n   * If you need to be able to share a workflow across tabs, it is recommended\\n   * to use \\\"csm.workflow\\\" to create/hydrate your workflows instead.\\n   * @param {string} type of workflow\\n   * @param {string} instanceId of workflow\\n   * @param {JSON} data blob associated with workflow\\n   */\\n  const Workflow = function(type, instanceId, data) {\\n    this.type = type;\\n    this.instanceId = instanceId || csm.Util.randomId();\\n    this.instanceSpecified = instanceId || false;\\n    this.eventMap = {};\\n    this.data = data || {};\\n\\n    // Merge global dimensions into the data map.\\n    const dimensionData = {};\\n    csm.globalDimensions.forEach(function(dimension) {\\n      dimensionData[dimension.name] = dimension.value;\\n    });\\n    csm.globalOptionalDimensions.forEach(function(dimension) {\\n      dimensionData[dimension.name] = dimension.value;\\n    });\\n    this.data = this._mergeData(dimensionData);\\n  };\\n\\n  /**\\n   * Create a new workflow or rehydrate an existing shared workflow.\\n   *\\n   * @param {string} type The type of workflow to be created.\\n   * @param {string} instanceId The instanceId of the workflow.  If not provided, it will be\\n   *      assigned a random ID and will not be automatically saved to local storage.\\n   *      If provided, we will attempt to load an existing workflow of the same type\\n   *      from local storage and rehydrate it.\\n   * @param {JSON} data An optional map of key/value pairs to be added as data to every\\n   *      workflow event created with this workflow.\\n   * @return {Workflow} workflow event\\n   * NOTE: Only one workflow of each type can be stored at the same time, to avoid\\n   *       overloading localStorage with unused workflow records.\\n   */\\n  csm.workflow = function(type, instanceId, data) {\\n    let workflow = new Workflow(type, instanceId, data);\\n\\n    if (instanceId) {\\n      const savedWorkflow = csm._loadWorkflow(type);\\n      if (savedWorkflow && savedWorkflow.instanceId === instanceId) {\\n        workflow = savedWorkflow;\\n        workflow.addData(data || {});\\n      }\\n    }\\n\\n    return workflow;\\n  };\\n\\n  csm._loadWorkflow = function(type) {\\n    let workflow = null;\\n    const workflowJson = localStorage.getItem(getWorkflowKeyForType(type));\\n    const workflowStruct = workflowJson ? JSON.parse(workflowJson) : null;\\n    if (workflowStruct) {\\n      workflow = new Workflow(type, workflowStruct.instanceId);\\n      workflow.eventMap = workflowStruct.eventMap;\\n    }\\n    return workflow;\\n  };\\n\\n  /**\\n   * Creates a new workflow event and returns it.  Then this workflow event is sent upstream\\n   * to the CSMSharedWorker where it is provided to the backend.\\n   *\\n   * If an instanceId was specified when the workflow was created, this will also save the workflow\\n   * and all of its events to localStorage.\\n   *\\n   * @param {string} event The name of the event that occurred.\\n   * @param {JSON} data An optional free-form key attribute pair of metadata items that will be stored\\n   *      and reported backstream with the workflow event.\\n   * @return {WorkflowEvent} workflowEvent\\n   */\\n  Workflow.prototype.event = function(event, data) {\\n    const mergedData = this._mergeData(data || {});\\n    const workflowEvent = new csm.WorkflowEvent({\\n      workflow: this,\\n      event: event,\\n      data: mergedData,\\n      userId: csm.configuration.userId || '',\\n      organizationId: csm.configuration.organizationId || '',\\n      accountId: csm.configuration.accountId || '',\\n      appName: csm.configuration.namespace || '',\\n    });\\n    csm.putWorkflowEvent(workflowEvent);\\n    this.eventMap[event] = workflowEvent;\\n    if (this.instanceSpecified) {\\n      this.save();\\n    }\\n    return workflowEvent;\\n  };\\n\\n  /**\\n   * Creates a new workflow event and returns it, if the same event is not happened in ths past\\n   * dedupeIntervalMs milliseconds.\\n   * @param {string} event The name of the event that occurred.\\n   * @param {JSON} data An optional free-form key attribute pair of metadata items that will be stored\\n   * and reported backstream with the workflow event.\\n   * @param {int} dedupeIntervalMs defaults to 200 MS\\n   * @return {WorkflowEvent} workflowEvent\\n   */\\n  Workflow.prototype.eventWithDedupe = function(event, data, dedupeIntervalMs) {\\n    const pastEvent = this.getPastEvent(event);\\n    const now = new Date().getTime();\\n    const interval = dedupeIntervalMs || 200;\\n\\n    // Crafting the expected workflow event data result\\n    const mergedData = this._mergeData(data);\\n    const expectedData = [];\\n    for (const key in mergedData) {\\n      if (Object.prototype.hasOwnProperty.call(mergedData, key)) {\\n        expectedData.push({'key': key, 'value': mergedData[key]});\\n      }\\n    }\\n\\n    // Deduplicate same events that happened within interval\\n    if (!pastEvent || (pastEvent && JSON.stringify(pastEvent.data) !== JSON.stringify(expectedData)) ||\\n        (pastEvent && (now - pastEvent.timestamp > interval))) {\\n      return this.event(event, data);\\n    }\\n    return null;\\n  };\\n\\n  /**\\n   * Get a past event if it exists in this workflow, otherwise returns null.\\n   * This can be helpful to emit metrics in real time based on the differences\\n   * between workflow event timestamps, especially for workflows shared across tabs.\\n   * @param {string} event key to see if workflow exists for this event\\n   * @return {WorkflowEvent} workflow event retrieved\\n   */\\n  Workflow.prototype.getPastEvent = function(event) {\\n    return event in this.eventMap ? this.eventMap[event] : null;\\n  };\\n\\n  /**\\n   * Save the workflow to local storage. This only happens automatically when an\\n   * instanceId is specified on workflow creation, however if this method is called\\n   * explicitly by the client, the randomly generated workflow instance id can be\\n   * used to retrieve the workflow later and automatic save on events will be enabled.\\n   */\\n  Workflow.prototype.save = function() {\\n    this.instanceSpecified = true;\\n    localStorage.setItem(getWorkflowKeyForType(this.type), JSON.stringify(this));\\n  };\\n\\n  /**\\n   * Remove this workflow if it is the saved instance for this workflow type in localStorage.\\n   */\\n  Workflow.prototype.close = function() {\\n    const storedWorkflow = csm._loadWorkflow(this.type);\\n    if (storedWorkflow && storedWorkflow.instanceId === this.instanceId) {\\n      localStorage.removeItem(getWorkflowKeyForType(this.type));\\n    }\\n  };\\n\\n  Workflow.prototype.addData = function(data) {\\n    for (const key in data) {\\n      if (Object.prototype.hasOwnProperty.call(data, key)) {\\n        this.data[key] = data[key];\\n      }\\n    }\\n  };\\n\\n  Workflow.prototype._mergeData = function(data) {\\n    const mergedData = {};\\n    let key = null;\\n    for (key in this.data) {\\n      if (Object.prototype.hasOwnProperty.call(this.data, key)) {\\n        mergedData[key] = this.data[key] == null ? 'null' : (this.data[key] === '' ? ' ' : this.data[key].toString());\\n      }\\n    }\\n    for (key in data) {\\n      if (Object.prototype.hasOwnProperty.call(data, key)) {\\n        mergedData[key] = data[key] == null ? 'null' : (data[key] === '' ? ' ' : data[key].toString());\\n      }\\n    }\\n    return mergedData;\\n  };\\n})();\\n\\n(function() {\\n  const global = window;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  let worker = null;\\n  let portId = null;\\n\\n  const MAX_INIT_MILLISECONDS = 5000;\\n  const preInitTaskQueue = [];\\n  csm.configuration = {};\\n\\n  /**\\n   * Initialize CSM variables\\n   * @param {object} params for CSM\\n   * @params.namespace Define your metric namespace used in CloudWatch metrics\\n   * @params.sharedWorkerUrl Specify the relative url to the connect-csm-worker.js file in your service\\n   * @params.endpoint Specify an LDAS endpoint to use.\\n   * @params.dryRunMode When CSM is initialized with dry run mode, it won't actually publish metrics.\\n   * @params.defaultMetrics Enable default metrics. Default to false.\\n   */\\n  csm.initCSM = function(params) {\\n    csm.Util.assertExist(params.namespace, 'namespace');\\n    csm.Util.assertExist(params.sharedWorkerUrl, 'sharedWorkerUrl');\\n    csm.Util.assertExist(params.endpoint, 'endpoint');\\n\\n    try {\\n      console.log('Starting csm shared worker with', params.sharedWorkerUrl);\\n      worker = new SharedWorker(params.sharedWorkerUrl, 'CSM_SharedWorker');\\n      worker.port.start();\\n    } catch (e) {\\n      console.log('Failed to initialize csm shared worker with', params.sharedWorkerUrl);\\n      console.log(e.message);\\n    }\\n\\n    /**\\n     * Configure shared worker\\n     */\\n    csm.configuration = {\\n      namespace: params.namespace,\\n      userId: params.userId || '',\\n      accountId: params.accountId || '',\\n      organizationId: params.organizationId || '',\\n      endpointUrl: params.endpoint || null,\\n      batchSettings: params.batchSettings || null,\\n      addPageVisibilityDimension: params.addPageVisibilityDimension || false,\\n      addUrlDataDimensions: params.addUrlDataDimensions || false,\\n      dryRunMode: params.dryRunMode || false, // When csm is in dryRunMode it won't actually publish metrics to CSM\\n    };\\n\\n    postEventToWorker(csm.EVENT_TYPE.CONFIG, csm.configuration);\\n\\n    /**\\n     * Receive message from shared worker\\n     * @param {MessageEvent} messageEvent from shared worker\\n     */\\n    worker.port.onmessage = function(messageEvent) {\\n      const messageType = messageEvent.data.type;\\n      onMessageFromWorker(messageType, messageEvent.data);\\n    };\\n\\n    /**\\n     * Inform shared worker window closed\\n     */\\n    global.onbeforeunload = function() {\\n      worker.port.postMessage(\\n          {\\n            type: csm.EVENT_TYPE.CLOSE,\\n            portId: portId,\\n          },\\n      );\\n    };\\n\\n    /**\\n     * Check if initialization success\\n     */\\n    global.setTimeout(function() {\\n      if (!isCSMInitialized()) {\\n        console.log('[FATAL] CSM initialization failed! Please make sure the sharedWorkerUrl is reachable.');\\n      }\\n    }, MAX_INIT_MILLISECONDS);\\n\\n    // Emit out of the box metrics\\n    if (params.defaultMetrics) {\\n      emitDefaultMetrics();\\n    }\\n  };\\n  // Final processing before sending to SharedWorker\\n  const processMetric = function(metric) {\\n    if (csm.configuration.addPageVisibilityDimension && document.visibilityState) {\\n      metric.addOptionalDimension('VisibilityState', document.visibilityState);\\n    }\\n  };\\n\\n  const processWorkflowEvent = function(event) {\\n    if (csm.configuration.addUrlDataDimensions) {\\n      event.data.push({'key': 'ReferrerUrl', 'value': csm.Util.getReferrerUrl()});\\n      event.data.push({'key': 'Origin', 'value': csm.Util.getOrigin()});\\n      event.data.push({'key': 'WindowParent', 'value': csm.Util.getWindowParent()});\\n    }\\n    if (['initFailure', 'initializationLatencyInfo'].includes(event.event)) {\\n      csm.initFailureDimensions.forEach((dimension) => {\\n        Object.keys(dimension).forEach((key) => {\\n          event.data.push({'key': key, 'value': dimension[key]});\\n        });\\n      });\\n    }\\n    return event;\\n  };\\n\\n  csm.putMetric = function(metric) {\\n    processMetric(metric);\\n    postEventToWorker(csm.EVENT_TYPE.METRIC, metric);\\n  };\\n\\n  csm.putLog = function(log) {\\n    postEventToWorker(csm.EVENT_TYPE.LOG, log);\\n  };\\n\\n  csm.putWorkflowEvent = function(event) {\\n    const processedEvent = processWorkflowEvent(event);\\n    postEventToWorker(csm.EVENT_TYPE.WORKFLOW_EVENT, processedEvent);\\n  };\\n\\n  csm.putCustom = function(endpoint, headers, data) {\\n    postEventToWorker(csm.EVENT_TYPE.CUSTOM, data, endpoint, headers);\\n  };\\n\\n  csm.setAuthParams = function(authParams) {\\n    postEventToWorker(csm.EVENT_TYPE.SET_AUTH, authParams);\\n  };\\n\\n  csm.setConfig = function(key, value) {\\n    csm.configuration[key] = value;\\n    postEventToWorker(csm.EVENT_TYPE.SET_CONFIG, {key, value});\\n  };\\n  /** **********************  PRIVATE METHODS  ************************/\\n\\n  const onMessageFromWorker = function(messageType, data) {\\n    if (messageType === csm.EVENT_TYPE.CONFIG) {\\n      portId = data.portId;\\n      onCSMInitialized();\\n    }\\n  };\\n\\n  const onCSMInitialized = function() {\\n    // Purge the preInitTaskQueue\\n    preInitTaskQueue.forEach(function(task) {\\n      postEventToWorker(task.type, task.message, task.endpoint, task.headers);\\n    });\\n\\n    // TODO:  Capture on errors and publish log to shared worker\\n    /**\\n            window.onerror = function(message, fileName, lineNumber, columnNumber, errorstack) {\\n                var log = new csm.Log(message, fileName, lineNumber, columnNumber, errorstack.stack);\\n                csm.putLog(log);\\n            };\\n        */\\n  };\\n\\n  /**\\n   * Emit out of the box metrics automatically\\n   *\\n   * TODO allow configuration\\n   */\\n  const emitDefaultMetrics = function() {\\n    window.addEventListener('load', function() {\\n      // loadEventEnd is avaliable after the onload function finished\\n      // https://www.w3.org/TR/navigation-timing-2/#processing-model\\n      // https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming\\n      global.setTimeout(function() {\\n        try {\\n          const perfData = window.performance.getEntriesByType('navigation')[0];\\n          const pageLoadTime = perfData.loadEventEnd - perfData.startTime;\\n          const connectTime = perfData.responseEnd - perfData.requestStart;\\n          const domRenderTime = perfData.domComplete - perfData.domInteractive;\\n          csm.API.addCountWithPageLocation('PageLoad');\\n          csm.API.addTimeWithPageLocation('PageLoadTime', pageLoadTime);\\n          csm.API.addTimeWithPageLocation('ConnectTime', connectTime);\\n          csm.API.addTimeWithPageLocation('DomRenderTime', domRenderTime);\\n        } catch (err) {\\n          console.log('Error emitting default metrics', err);\\n        }\\n      }, 0);\\n    });\\n  };\\n\\n  /**\\n   * Try posting message to shared worker\\n   * If shared worker hasn't been initialized, put the task to queue to be clean up once initialized\\n   * @param {csm.EVENT_TYPE} eventType for CSM\\n   * @param {object} message event following type of eventType\\n   * @param {string} [endpoint] optional parameter for putCustom function (put any data to specified endpoint)\\n   * @param {object} [headers] optional parameter for putCustom function\\n   */\\n  const postEventToWorker = function(eventType, message, endpoint, headers) {\\n    if (eventType === csm.EVENT_TYPE.CONFIG || isCSMInitialized()) {\\n      worker.port.postMessage(\\n          {\\n            type: eventType,\\n            portId: portId,\\n            message: message,\\n            endpoint: endpoint,\\n            headers: headers,\\n          },\\n      );\\n    } else {\\n      preInitTaskQueue.push({\\n        type: eventType,\\n        message: message,\\n        endpoint: endpoint,\\n        headers: headers,\\n      });\\n    }\\n  };\\n\\n  const isCSMInitialized = function() {\\n    return portId !== null;\\n  };\\n})()\",document.head.appendChild(e)}catch(e){this.logger.error(\"Load csm script error: \",e)}}initializeCSM(){if(!this.csmInitialized){var e=i.getRegion(),t=\"(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  csm.EVENT_TYPE = {\\n    LOG: 'LOG',\\n    METRIC: 'METRIC',\\n    CONFIG: 'CONFIG',\\n    WORKFLOW_EVENT: 'WORKFLOW_EVENT',\\n    CUSTOM: 'CUSTOM',\\n    CLOSE: 'CLOSE',\\n    SET_AUTH: 'SET_AUTH',\\n    SET_CONFIG: 'SET_CONFIG',\\n  };\\n\\n  csm.UNIT = {\\n    COUNT: 'Count',\\n    SECONDS: 'Seconds',\\n    MILLISECONDS: 'Milliseconds',\\n    MICROSECONDS: 'Microseconds',\\n  };\\n})();\\n\\n(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  const MAX_METRIC_DIMENSIONS = 10;\\n\\n  /** ********* Dimension Classes ***********/\\n\\n  const Dimension = function(name, value) {\\n    csm.Util.assertExist(name, 'name');\\n    csm.Util.assertExist(value, 'value');\\n\\n    this.name = name;\\n    this.value = value == null ? 'null' : (value === '' ? ' ' : value.toString());\\n  };\\n\\n\\n  /** ********* Metric Classes ***********/\\n\\n  const Metric = function(metricName, unit, value, dedupeOptions) {\\n    csm.Util.assertExist(metricName, 'metricName');\\n    csm.Util.assertExist(value, 'value');\\n    csm.Util.assertExist(unit, 'unit');\\n    csm.Util.assertTrue(csm.Util.isValidUnit(unit));\\n    if (dedupeOptions) {\\n      csm.Util.assertInObject(dedupeOptions, 'dedupeOptions', 'dedupeIntervalMs');\\n    }\\n\\n    this.metricName = metricName;\\n    this.unit = unit;\\n    this.value = value;\\n    this.timestamp = new Date();\\n    this.dimensions = csm.globalDimensions ? csm.Util.deepCopy(csm.globalDimensions): [];\\n    this.namespace = csm.configuration.namespace;\\n    this.dedupeOptions = dedupeOptions; // optional. { dedupeIntervalMs: (int; required), context: (string; optional) }\\n\\n    // Currently, CloudWatch can't aggregate metrics by a subset of dimensions.\\n    // To bypass this limitation, we introduce the optional dimensions concept to CSM.\\n    // The CSM metric publisher will publish a default metric without optional dimension\\n    // For each optional dimension, the CSM metric publisher publishes an extra metric with that dimension.\\n    this.optionalDimensions = csm.globalOptionalDimensions ? csm.Util.deepCopy(csm.globalOptionalDimensions): [];\\n  };\\n\\n  Metric.prototype.addDimension = function(name, value) {\\n    this._addDimensionHelper(this.dimensions, name, value);\\n  };\\n\\n  Metric.prototype.addOptionalDimension = function(name, value) {\\n    this._addDimensionHelper(this.optionalDimensions, name, value);\\n  };\\n\\n  Metric.prototype._addDimensionHelper = function(targetDimensions, name, value) {\\n    // CloudWatch metric allows maximum 10 dimensions\\n    // http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/CloudWatch.html#putMetricData-property\\n    if ((this.dimensions.length + this.optionalDimensions.length) >= MAX_METRIC_DIMENSIONS) {\\n      throw new csm.ExceedDimensionLimitException(name);\\n    }\\n\\n    const existing = targetDimensions.find(function(dimension) {\\n      return dimension.name === name;\\n    });\\n\\n    if (existing) {\\n      existing.value = value == null ? 'null' : (value === '' ? ' ' : value.toString());\\n    } else {\\n      targetDimensions.push(new Dimension(name, value));\\n    }\\n  };\\n\\n\\n  /** ********* Telemetry Classes ***********/\\n\\n  const WorkflowEvent = function(params) {\\n    this.timestamp = params.timestamp || new Date().getTime();\\n    this.workflowType = params.workflow.type;\\n    this.instanceId = params.workflow.instanceId;\\n    this.userId = params.userId;\\n    this.organizationId = params.organizationId;\\n    this.accountId = params.accountId;\\n    this.event = params.event;\\n    this.appName = params.appName;\\n    this.data = [];\\n\\n    // Convert 'data' map into the KeyValuePairList structure expected by the Lambda API\\n    for (const key in params.data) {\\n      if (Object.prototype.hasOwnProperty.call(params.data, key)) {\\n        this.data.push({'key': key, 'value': params.data[key]});\\n      }\\n    }\\n  };\\n\\n  /** ********* Exceptions ***********/\\n\\n  const NullOrUndefinedException = function(paramName) {\\n    this.name = 'NullOrUndefinedException';\\n    this.message = paramName + ' is null or undefined. ';\\n  };\\n  NullOrUndefinedException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const AssertTrueException = function() {\\n    this.name = 'AssertTrueException';\\n    this.message = 'Assertion failed. ';\\n  };\\n  AssertTrueException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const ExceedDimensionLimitException = function(dimensionName) {\\n    this.name = 'ExceedDimensionLimitException';\\n    this.message = 'Could not add dimension ' + dimensionName + ' . Metric has maximum 10 dimensions. ';\\n  };\\n  ExceedDimensionLimitException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n  const InitializationException = function() {\\n    this.name = 'InitializationException';\\n    this.message = 'Initialization failed. ';\\n  };\\n  InitializationException.prototype.toString = function() {\\n    return this.name + ': ' + this.message;\\n  };\\n\\n\\n  csm.Dimension = Dimension;\\n  csm.Metric = Metric;\\n  csm.WorkflowEvent = WorkflowEvent;\\n  csm.NullOrUndefinedException = NullOrUndefinedException;\\n  csm.AssertTrueException = AssertTrueException;\\n  csm.InitializationException = InitializationException;\\n  csm.ExceedDimensionLimitException = ExceedDimensionLimitException;\\n})();\\n\\n(function() {\\n  const global = self;\\n  const csm = global.csm || {};\\n  global.csm = csm;\\n\\n  const validTimeUnits = [csm.UNIT.SECONDS, csm.UNIT.MILLISECONDS, csm.UNIT.MICROSECONDS];\\n  const validUnits = validTimeUnits.concat(csm.UNIT.COUNT);\\n\\n  const Util = {\\n    assertExist: function(value, paramName) {\\n      if (value === null || value === undefined) {\\n        throw new csm.NullOrUndefinedException(paramName);\\n      }\\n    },\\n    assertTrue: function(value) {\\n      if (!value) {\\n        throw new csm.AssertTrueException();\\n      }\\n    },\\n    assertInObject: function(obj, objName, key) {\\n      if (obj === null || obj === undefined || typeof obj !== 'object') {\\n        throw new csm.NullOrUndefinedException(objName);\\n      }\\n      if (key === null || key === undefined || !obj[key]) {\\n        throw new csm.NullOrUndefinedException(`${objName}[${key}]`);\\n      }\\n    },\\n    isValidUnit: function(unit) {\\n      return validUnits.includes(unit);\\n    },\\n    isValidTimeUnit: function(unit) {\\n      return validTimeUnits.includes(unit);\\n    },\\n    isEmpty: function(value) {\\n      if (value !== null && typeof val === 'object') {\\n        return Objects.keys(value).length === 0;\\n      }\\n      return !value;\\n    },\\n    deepCopy: function(obj) {\\n      // NOTE: this will fail if obj has a circular reference\\n      return JSON.parse(JSON.stringify(obj));\\n    },\\n\\n    /**\\n     * This function is used before setting the page location for default metrics and logs,\\n     * and the APIs that set page location\\n     * Can be overridden by calling csm.API.setPageLocationTransformer(function(){})\\n     * @param {string}        pathname path for page location\\n     * @return {string}       pathname provided\\n     */\\n    pageLocationTransformer: function(pathname) {\\n      return pathname;\\n    },\\n\\n    /**\\n     * As of now, our service public claims only support for Firefox and Chrome\\n     * Reference https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent\\n     *\\n     * This function will only return firefox, chrome and others\\n     *\\n     * Best practice as indicated in MDN, \\\"Avoiding user agent detection\\\"\\n     */\\n    getBrowserDetails: function() {\\n      const userAgent = window.navigator.userAgent;\\n      const details = {};\\n      if (userAgent.includes('Firefox') && !userAgent.includes('Seamonkey')) {\\n        details.name = 'Firefox';\\n        details.version = getBrowserVersion('Firefox');\\n      } else if (userAgent.includes('Chrome') && !userAgent.includes('Chromium')) {\\n        details.name = 'Chrome';\\n        details.version = getBrowserVersion('Chrome');\\n      }\\n    },\\n\\n    randomId: function() {\\n      return new Date().getTime() + '-' + Math.random().toString(36).slice(2);\\n    },\\n\\n    getOrigin: function() {\\n      return document.location.origin;\\n    },\\n\\n    getReferrerUrl: function() {\\n      const referrer = document.referrer || '';\\n      return this.getURLOrigin(referrer);\\n    },\\n\\n    getWindowParent: function() {\\n      let parentLocation = '';\\n      try {\\n        parentLocation = window.parent.location.href;\\n      } catch (e) {\\n        parentLocation = '';\\n      }\\n      return parentLocation;\\n    },\\n\\n    getURLOrigin: function(urlValue) {\\n      let origin = '';\\n      const originArray = urlValue.split( '/' );\\n      if (originArray.length >= 3) {\\n        const protocol = originArray[0];\\n        const host = originArray[2];\\n        origin = protocol + '//' + host;\\n      }\\n      return origin;\\n    },\\n\\n  };\\n\\n  const getBrowserVersion = function(browserName) {\\n    const userAgent = window.navigator.userAgent;\\n    const browserNameIndex = userAgent.indexOf(browserName);\\n    const nextSpaceIndex = userAgent.indexOf(' ', browserNameIndex);\\n    if (nextSpaceIndex === -1) {\\n      return userAgent.substring(browserNameIndex + browserName.length + 1, userAgent.length);\\n    } else {\\n      return userAgent.substring(browserNameIndex + browserName.length + 1, nextSpaceIndex);\\n    }\\n  };\\n\\n  csm.Util = Util;\\n})();\\n\\n(function() {\\n  const XHR_DONE_READY_STATE = 4; // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState\\n\\n  const global = self;\\n  const configuration = {};\\n  const batchSettings = {\\n    maxMetricsSize: 30,\\n    maxWorkflowEventsSize: 30,\\n    putMetricsIntervalMs: 30000,\\n    putWorkflowEventsIntervalMs: 2000,\\n  };\\n  const metricLists = {}; // metricList per CloudWatch Namespace\\n  const metricMap = {};\\n  const ports = {};\\n  let workflowEvents = {workflowEventList: []};\\n\\n  // SharedWorker wiki:  https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker\\n  onconnect = function(connectEvent) {\\n    const port = connectEvent.ports[0];\\n\\n    port.onmessage = function(event) {\\n      const data = event.data;\\n      const messageType = data.type;\\n      const message = data.message;\\n      const endpoint = data.endpoint;\\n      const headers = data.headers;\\n\\n      if (data.portId && !(data.portId in ports)) {\\n        // This could happen when a user tries to close a tab which has a pop up alert to confirm closing,\\n        // and the user decides to cancel closing\\n        // This triggers before unload event while the tab or window is not closed actually\\n        ports[data.portId] = port;\\n      }\\n\\n      const {METRIC, WORKFLOW_EVENT, CUSTOM, CONFIG, SET_AUTH, SET_CONFIG, CLOSE} = csm.EVENT_TYPE;\\n      switch (messageType) {\\n        case METRIC: {\\n          csm.Util.assertInObject(message, 'message', 'namespace');\\n          const namespace = message.namespace;\\n          if (shouldDedupe(message)) break;\\n          addMetricEventToMap(message);\\n          if (metricLists[namespace]) {\\n            metricLists[namespace].push(message);\\n          } else {\\n            metricLists[namespace] = [message];\\n          }\\n          if (metricLists[namespace].length >= batchSettings.maxMetricsSize) {\\n            putMetricsForNamespace(namespace);\\n          }\\n          break;\\n        }\\n        case WORKFLOW_EVENT: {\\n          workflowEvents.workflowEventList.push(message);\\n          if (workflowEvents.length >= batchSettings.maxWorkflowEventsSize) {\\n            putWorkflowEvents();\\n          }\\n          break;\\n        }\\n        case CUSTOM: {\\n          putCustom(endpoint, headers, message);\\n          break;\\n        }\\n        case CONFIG: {\\n          const portId = Object.keys(ports).length + 1; // portId starts from 1\\n          ports[portId] = port;\\n          for (const setting of Object.keys(message)) {\\n            if (!csm.Util.isEmpty(message[setting])) {\\n              configuration[setting] = message[setting];\\n            }\\n          }\\n\\n          // set optional batch settings\\n          if (configuration.batchSettings) {\\n            for (const setting of Object.keys(configuration.batchSettings)) {\\n              batchSettings[setting] = configuration.batchSettings[setting];\\n            }\\n          }\\n          // send metrics and workflow events at set intervals\\n          putMetrics();\\n          putWorkflowEvents();\\n          global.setInterval(putMetrics, batchSettings.putMetricsIntervalMs);\\n          global.setInterval(putWorkflowEvents, batchSettings.putWorkflowEventsIntervalMs);\\n\\n          port.postMessage(\\n              {\\n                type: csm.EVENT_TYPE.CONFIG,\\n                portId: portId,\\n              },\\n          );\\n          break;\\n        }\\n        case SET_AUTH: {\\n          configuration.authParams = message;\\n          authenticate();\\n          break;\\n        }\\n        case SET_CONFIG: {\\n          configuration[message.key] = message.value;\\n          break;\\n        }\\n        case CLOSE: {\\n          delete ports[data.portId];\\n          if (Object.keys(ports).length === 0) {\\n            putMetrics();\\n            putWorkflowEvents();\\n          }\\n          break;\\n        }\\n        default:\\n          break;\\n      }\\n    };\\n  };\\n\\n  const shouldDedupe = function(metric) {\\n    try {\\n      const pastMetric = getPastMetricEvent(metric);\\n      return pastMetric && metric.dedupeOptions &&\\n        (metric.timestamp - pastMetric.timestamp < metric.dedupeOptions.dedupeIntervalMs);\\n    } catch (err) {\\n      console.error('Error in shouldDedupe', err);\\n      return false;\\n    }\\n  };\\n\\n  const getPastMetricEvent = function(metric) {\\n    try {\\n      return metricMap[getMetricEventKey(metric)];\\n    } catch (err) {\\n      // ignore err - no previous metrics found\\n      return null;\\n    }\\n  };\\n\\n  const addMetricEventToMap = function(metric) {\\n    try {\\n      metricMap[getMetricEventKey(metric)] = metric;\\n    } catch (err) {\\n      console.error('Failed to add event to metricMap', err);\\n    }\\n    csm.metricMap = metricMap;\\n  };\\n\\n  const getMetricEventKey = function(metric) {\\n    const {namespace, metricName, unit, dedupeOptions} = metric;\\n    let context = 'global';\\n    if (dedupeOptions && dedupeOptions.context) {\\n      context = dedupeOptions.context;\\n    }\\n    return `${namespace}-${metricName}-${unit}-${context}`;\\n  };\\n\\n  const authenticate = function() {\\n    postRequest(configuration.endpointUrl + '/auth', {authParams: configuration.authParams},\\n        {\\n          success: function(response) {\\n            if (response && response.jwtToken) {\\n              configuration.authParams.jwtToken = response.jwtToken;\\n            }\\n          },\\n          failure: function(response) {\\n            broadcastMessage('[ERROR] csm auth failed!');\\n            broadcastMessage('Response : ' + response);\\n          },\\n        }, {'x-api-key': 'auth-method-level-key'});\\n  };\\n\\n  /**\\n   * Put metrics to service when:\\n   * a) metricList size is at maxMetricsSize\\n   * b) every putMetricsIntervalMs time if the metricList is not empty\\n   * c) worker is closed\\n   *\\n   * Timer is reset, and metricList emptied after each putMetrics call\\n   */\\n  const putMetrics = function() {\\n    for (const namespace of Object.keys(metricLists)) {\\n      putMetricsForNamespace(namespace);\\n    }\\n  };\\n\\n  const putMetricsForNamespace = function(namespace) {\\n    csm.Util.assertInObject(metricLists, 'metricLists', namespace);\\n    const metricList = metricLists[namespace];\\n\\n    if (metricList.length > 0 && !configuration.dryRunMode && configuration.endpointUrl) {\\n      postRequest(configuration.endpointUrl + '/put-metrics', {\\n        metricNamespace: namespace,\\n        metricList: metricList,\\n        authParams: configuration.authParams,\\n        accountId: configuration.accountId,\\n        organizationId: configuration.organizationId,\\n        agentResourceId: configuration.userId,\\n      }, {\\n        success: function(response) {\\n          if (response) {\\n            broadcastMessage('PutMetrics response : ' + response);\\n            if (response.unsetToken) {\\n              delete configuration.authParams.jwtToken;\\n              authenticate();\\n            }\\n          }\\n        },\\n        failure: function(response) {\\n          broadcastMessage('[ERROR] Put metrics to service failed! ');\\n        },\\n      });\\n    }\\n    metricLists[namespace] = [];\\n  };\\n\\n  /**\\n   * Put metrics to service every two seconds if there are events to be put.\\n   */\\n  const putWorkflowEvents = function() {\\n    if (workflowEvents.workflowEventList.length > 0 && !configuration.dryRunMode && configuration.endpointUrl) {\\n      workflowEvents.authParams = configuration.authParams;\\n      postRequest(configuration.endpointUrl + '/put-workflow-events', workflowEvents,\\n          {\\n            success: function(response) {\\n              if (response) {\\n                if (response.workflowEventList && response.workflowEventList.length > 0) {\\n                  broadcastMessage('[WARN] There are ' + response.length + ' workflow events that failed to publish');\\n                  broadcastMessage('Response : ' + response);\\n                }\\n                if (response.unsetToken) {\\n                  delete configuration.authParams.jwtToken;\\n                  authenticate();\\n                }\\n              }\\n            },\\n            failure: function(response) {\\n              broadcastMessage('[ERROR] Put workflow events to service failed! ');\\n            },\\n          });\\n    }\\n\\n    workflowEvents = {workflowEventList: []};\\n  };\\n\\n  /**\\n   * Put data to custom endpoint on demand\\n   * @param {string} endpoint\\n   * @param {object} headers\\n   * @param {object} data to send to endpoint\\n   */\\n  const putCustom = function(endpoint, headers, data) {\\n    if (!configuration.dryRunMode && endpoint && data) {\\n      postRequest(endpoint, data, {\\n        success: function(response) {\\n          if (response) {\\n            broadcastMessage('Response : ' + response);\\n          }\\n        },\\n        failure: function(response) {\\n          broadcastMessage('[ERROR] Failed to put custom data! ');\\n        },\\n      }, headers);\\n    }\\n  };\\n\\n  /**\\n   * Broadcast message to all tabs\\n   * @param {string} message to post to all the tabs\\n   */\\n  const broadcastMessage = function(message) {\\n    for (const portId in ports) {\\n      if (Object.prototype.hasOwnProperty.call(ports, portId)) {\\n        ports[portId].postMessage(message);\\n      }\\n    }\\n  };\\n\\n  const postRequest = function(url, data, callbacks, headers) {\\n    csm.Util.assertExist(url, 'url');\\n    csm.Util.assertExist(data, 'data');\\n\\n    callbacks = callbacks || {};\\n    callbacks.success = callbacks.success || function() {};\\n    callbacks.failure = callbacks.failure || function() {};\\n\\n    const request = new XMLHttpRequest(); // new HttpRequest instance\\n    request.onreadystatechange = function() {\\n      const errorList = request.response ? JSON.parse(request.response): [];\\n      if (request.readyState === XHR_DONE_READY_STATE) { // request finished and response is ready\\n        if (request.status === 200) {\\n          callbacks.success(errorList);\\n        } else {\\n          broadcastMessage('AJAX request failed with status: ' + request.status);\\n          callbacks.failure(errorList);\\n        }\\n      }\\n    };\\n\\n    request.open('POST', url);\\n    if (headers && typeof headers === 'object') {\\n      Object.keys(headers).forEach((header) => request.setRequestHeader(header, headers[header]));\\n    } else {\\n      request.setRequestHeader('Content-Type', 'application/json');\\n    }\\n    request.send(JSON.stringify(data));\\n  };\\n})()\".replace(/\\\\/g,\"\"),n=URL.createObjectURL(new Blob([t],{type:\"text/javascript\"})),r=(e=>\"https://ieluqbvv.telemetry.connect.\".concat(e,\".amazonaws.com/prod\"))(e),o={endpoint:r,namespace:\"chat-widget\",sharedWorkerUrl:n};csm.initCSM(o),this.logger.info(\"CSMService is initialized in \".concat(e)),this.csmInitialized=!0,this.metricsToBePublished&&(this.metricsToBePublished.forEach((e=>{csm.API.addMetric(e)})),this.metricsToBePublished=null)}}updateCsmConfig(e){this.widgetType=e.widgetType||this.widgetType}getDefaultDimensions(){return[{name:\"WidgetType\",value:this.widgetType}]}addMetric(e){this.csmInitialized?csm.API.addMetric(e):this.metricsToBePublished&&(this.metricsToBePublished.push(e),this.logger.info(\"CSMService is not initialized yet. Adding metrics to queue to be published once CSMService is initialized\"))}setDimensions(e,t){t.forEach((t=>{e.addDimension(t.name,t.value)}))}addLatencyMetric(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=new csm.Metric(e,csm.UNIT.MILLISECONDS,t),o=[...this.getDefaultDimensions(),{name:\"Metric\",value:\"Latency\"},{name:J,value:n},...r];this.setDimensions(i,o),this.addMetric(i),this.logger.debug(\"Successfully published latency API metrics for method \".concat(e))}addLatencyMetricWithStartTime(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=(new Date).getTime()-t;this.addLatencyMetric(e,i,n,r),this.logger.debug(\"Successfully published latency API metrics for method \".concat(e))}addCountAndErrorMetric(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=[...this.getDefaultDimensions(),{name:J,value:t},...r],o=new csm.Metric(e,csm.UNIT.COUNT,1);this.setDimensions(o,[...i,{name:\"Metric\",value:\"Count\"}]);var s=n?1:0,a=new csm.Metric(e,csm.UNIT.COUNT,s);this.setDimensions(a,[...i,{name:\"Metric\",value:\"Error\"}]),this.addMetric(o),this.addMetric(a),this.logger.debug(\"Successfully published count and error metrics for method \".concat(e))}addCountMetric(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[...this.getDefaultDimensions(),{name:J,value:t},{name:\"Metric\",value:\"Count\"},...n],i=new csm.Metric(e,csm.UNIT.COUNT,1);this.setDimensions(i,r),this.addMetric(i),this.logger.debug(\"Successfully published count metrics for method \".concat(e))}};class ${constructor(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.chatClient=t,this.participantToken=e||null,this.connectionDetails=null,this.connectionToken=null,this.connectionTokenExpiry=null,this.sessionType=n,this.getConnectionToken=r}getFetchedConnectionToken(){return this.connectionToken}getConnectionTokenExpiry(){return this.connectionTokenExpiry}getConnectionDetails(){return this.connectionDetails}fetchConnectionDetails(){return this._fetchConnectionDetails().then((()=>this.connectionDetails))}fetchConnectionToken(){return this._fetchConnectionDetails().then((()=>this.connectionToken))}_handleCreateParticipantConnectionResponse(e){this.connectionDetails={url:e.Websocket.Url,expiry:e.Websocket.ConnectionExpiry,transportLifeTimeInSeconds:S},this.connectionToken=e.ConnectionCredentials.ConnectionToken,this.connectionTokenExpiry=e.ConnectionCredentials.Expiry}_handleGetConnectionTokenResponse(e){this.connectionDetails={url:null,expiry:null},this.connectionToken=e.participantToken,this.connectionTokenExpiry=e.expiry}_callCreateParticipantConnection(){var e=(new Date).getTime();return this.chatClient.createParticipantConnection(this.participantToken,[\"WEBSOCKET\",\"CONNECTION_CREDENTIALS\"]).then((t=>{this._handleCreateParticipantConnectionResponse(t.data),Y.addLatencyMetricWithStartTime(h,e,s),Y.addCountAndErrorMetric(h,s,!1)})).catch((t=>(Y.addLatencyMetricWithStartTime(h,e,s),Y.addCountAndErrorMetric(h,s,!0),Promise.reject({reason:\"Failed to fetch connectionDetails with createParticipantConnection\",_debug:t}))))}_fetchConnectionDetails(){return this.sessionType===o.CUSTOMER?this._callCreateParticipantConnection():this.sessionType===o.AGENT?this.getConnectionToken().then((e=>this._handleGetConnectionTokenResponse(e.chatTokenTransport))).catch((()=>this._callCreateParticipantConnection())):Promise.reject({reason:\"Failed to fetch connectionDetails.\",_debug:new r(\"Failed to fetch connectionDetails.\")})}}n.g.connect=n.g.connect||{};var Q=connect.WebSocketManager;!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=9)}([function(e,t){function n(t){return e.exports=n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,\"prototype\",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){n.d(t,\"a\",(function(){return ne}));var r=n(0),i=n.n(r),o=n(5),s=\"AMZ_WEB_SOCKET_MANAGER:\",a=\"Network offline\",c=\"Network online, connecting to WebSocket server\",u=\"Network offline, ignoring this getWebSocketConnConfig request\",l=\"Heartbeat response not received\",p=\"Failed to send heartbeat since WebSocket is not open\",d=\"WebSocket connection established!\",h=\"WebSocket connection is closed\",f=\"WebSocketManager Error, error_event: \",m=\"Scheduling WebSocket reinitialization, after delay \",g=\"WebSocket URL cannot be used to establish connection\",v=\"WebSocket Initialization failed - Terminating and cleaning subscriptions\",y=\"Fetching new WebSocket connection configuration\",b=\"Successfully fetched webSocket connection configuration\",w=\"Failed to fetch webSocket connection configuration\",S=\"Retrying fetching new WebSocket connection configuration\",E=\"Initializing Websocket Manager\",C=\"WebSocketManager Message Error\",T=\"Message received for topic \",k=\"Invalid incoming message\",I=\"aws/subscribe\",_=\"aws/heartbeat\",x=\"disconnected\",A={assertTrue:function(e,t){if(!e)throw new Error(t)},assertNotNull:function(e,t){return A.assertTrue(null!==e&&void 0!==i()(e),Object(o.sprintf)(\"%s must be provided\",t||\"A value\")),e},isNonEmptyString:function(e){return\"string\"==typeof e&&e.length>0},assertIsList:function(e,t){if(!Array.isArray(e))throw new Error(t+\" is not an array\")},isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},isObject:function(e){return!(\"object\"!==i()(e)||null===e)},isString:function(e){return\"string\"==typeof e},isNumber:function(e){return\"number\"==typeof e}},R=new RegExp(\"^(wss://)\\\\w*\");A.validWSUrl=function(e){return R.test(e)},A.getSubscriptionResponse=function(e,t,n){return{topic:e,content:{status:t?\"success\":\"failure\",topics:n}}},A.assertIsObject=function(e,t){if(!A.isObject(e))throw new Error(t+\" is not an object!\")},A.addJitter=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t=Math.min(t,1);var n=Math.random()>.5?1:-1;return Math.floor(e+n*e*Math.random()*t)},A.isNetworkOnline=function(){return navigator.onLine},A.isNetworkFailure=function(e){return!(!e._debug||!e._debug.type)&&\"NetworkingError\"===e._debug.type};var L=A,O=n(6),N=n.n(O),M=n(7),P=n.n(M),D=n(3),U=n.n(D),q=n(8),j=n.n(q),W=n(1),F=n.n(W),B=n(2),z=n.n(B);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){j()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=function(){function e(){F()(this,e)}return z()(e,[{key:\"debug\",value:function(e){}},{key:\"info\",value:function(e){}},{key:\"warn\",value:function(e){}},{key:\"error\",value:function(e){}},{key:\"advancedLog\",value:function(e){}}]),e}(),K=s,X={DEBUG:10,INFO:20,WARN:30,ERROR:40,ADVANCED_LOG:50},J=function(){function e(t){F()(this,e),this.logMetaData=t,this.updateLoggerConfig()}return z()(e,[{key:\"hasLogMetaData\",value:function(){return!!this.logMetaData}},{key:\"writeToClientLogger\",value:function(e,t){if(this.hasClientLogger()){var n=function(e){switch(e){case 10:return\"DEBUG\";case 20:return\"INFO\";case 30:return\"WARN\";case 40:return\"ERROR\";case 50:return\"ADVANCED_LOG\"}}(e);switch(e){case X.DEBUG:return this._clientLogger.debug(n,t,this.logMetaData)||t;case X.INFO:return this._clientLogger.info(n,t,this.logMetaData)||t;case X.WARN:return this._clientLogger.warn(n,t,this.logMetaData)||t;case X.ERROR:return this._clientLogger.error(n,t,this.logMetaData)||t;case X.ADVANCED_LOG:return this._advancedLogWriter?this._clientLogger[this._advancedLogWriter](n,t,this.logMetaData)||t:\"\"}}}},{key:\"isLevelEnabled\",value:function(e){return e>=this._level}},{key:\"hasClientLogger\",value:function(){return null!==this._clientLogger}},{key:\"getLogger\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.prefix||K;return e.logMetaData&&this.setLogMetaData(e.logMetaData),this.logMetaData||console.info(\"*********Missing required option: WebSocketManager:logMetaData**********\"),new $(this,V({prefix:t,logMetaData:this.logMetaData},e))}},{key:\"setLogMetaData\",value:function(e){this.logMetaData=e}},{key:\"updateLoggerConfig\",value:function(e){var t=e||{};this._level=t.level||X.INFO,this._advancedLogWriter=\"warn\",t.advancedLogWriter&&(this._advancedLogWriter=t.advancedLogWriter),t.customizedLogger&&\"object\"===i()(t.customizedLogger)&&(this.useClientLogger=!0),this._clientLogger=t.logger||this.selectLogger(t),this._logsDestination=\"NULL\",t.debug&&(this._logsDestination=\"DEBUG\"),t.logger&&(this._logsDestination=\"CLIENT_LOGGER\")}},{key:\"selectLogger\",value:function(e){return e.customizedLogger&&\"object\"===i()(e.customizedLogger)?e.customizedLogger:e.useDefaultLogger?Q():null}}]),e}(),Y=function(){function e(){F()(this,e)}return z()(e,[{key:\"debug\",value:function(){}},{key:\"info\",value:function(){}},{key:\"warn\",value:function(){}},{key:\"error\",value:function(){}},{key:\"advancedLog\",value:function(){}}]),e}(),$=function(e){N()(n,e);var t=function(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var i=U()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P()(this,n)}}(n);function n(e,r){var i;return F()(this,n),(i=t.call(this)).options=r||{},i.prefix=r.prefix||K,i.logManager=e,i}return z()(n,[{key:\"debug\",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(X.DEBUG,t)}},{key:\"info\",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(X.INFO,t)}},{key:\"warn\",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(X.WARN,t)}},{key:\"error\",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(X.ERROR,t)}},{key:\"advancedLog\",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._log(X.ADVANCED_LOG,t)}},{key:\"_shouldLog\",value:function(e){return this.logManager.hasClientLogger()&&this.logManager.isLevelEnabled(e)}},{key:\"_writeToClientLogger\",value:function(e,t){return this.logManager.writeToClientLogger(e,t)}},{key:\"_log\",value:function(e,t){if(this._shouldLog(e)){var n=this.logManager.useClientLogger?t:this._convertToSingleStatement(t);return this._writeToClientLogger(e,n)}}},{key:\"_convertToSingleStatement\",value:function(e){var t=new Date(Date.now()).toISOString(),n=\"[\".concat(t,\"]\");this.prefix&&(n+=this.prefix+\" \"),this.options&&(this.options.prefix?n+=\" \"+this.options.prefix+\":\":n+=\"\");for(var r=0;r<e.length;r++){var i=e[r];n+=this._convertToString(i)+\" \"}return n}},{key:\"_convertToString\",value:function(e){try{if(!e)return\"\";if(L.isString(e))return e;if(L.isObject(e)&&L.isFunction(e.toString)){var t=e.toString();if(\"[object Object]\"!==t)return t}return JSON.stringify(e)}catch(t){return console.error(\"Error while converting argument to string\",e,t),\"\"}}}]),n}(Y),Q=function(){var e=new Y;return e.debug=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.debug.apply(window.console,[].concat(t))},e.info=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.info.apply(window.console,[].concat(t))},e.warn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.warn.apply(window.console,[].concat(t))},e.error=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error.apply(window.console,[].concat(t))},e},Z=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;F()(this,e),this.numAttempts=0,this.executor=t,this.hasActiveReconnection=!1,this.defaultRetry=n}return z()(e,[{key:\"retry\",value:function(){var e=this;this.hasActiveReconnection||(this.hasActiveReconnection=!0,setTimeout((function(){e._execute()}),this._getDelay()))}},{key:\"_execute\",value:function(){this.hasActiveReconnection=!1,this.executor(),this.numAttempts++}},{key:\"connected\",value:function(){this.numAttempts=0}},{key:\"_getDelay\",value:function(){var e=Math.pow(2,this.numAttempts)*this.defaultRetry;return e<=3e4?e:3e4}},{key:\"getIsConnected\",value:function(){return!this.numAttempts}}]),e}(),ee=null,te=function(){var e=ee.getLogger({prefix:s}),t=L.isNetworkOnline(),n={primary:null,secondary:null},r={reconnectWebSocket:!0,websocketInitFailed:!1,exponentialBackOffTime:1e3,exponentialTimeoutHandle:null,lifeTimeTimeoutHandle:null,webSocketInitCheckerTimeoutId:null,connState:null},i={connectWebSocketRetryCount:0,connectionAttemptStartTime:null,noOpenConnectionsTimestamp:null},o={pendingResponse:!1,intervalHandle:null},A={initFailure:new Set,getWebSocketTransport:null,subscriptionUpdate:new Set,subscriptionFailure:new Set,topic:new Map,allMessage:new Set,connectionGain:new Set,connectionLost:new Set,connectionOpen:new Set,connectionClose:new Set},R={connConfig:null,promiseHandle:null,promiseCompleted:!0},O={subscribed:new Set,pending:new Set,subscriptionHistory:new Set},N={responseCheckIntervalId:null,requestCompleted:!0,reSubscribeIntervalId:null,consecutiveFailedSubscribeAttempts:0,consecutiveNoResponseRequest:0},M=new Z((function(){se()})),P=new Set([I,\"aws/unsubscribe\",_]),D=setInterval((function(){if(t!==L.isNetworkOnline()){if(!(t=L.isNetworkOnline()))return e.advancedLog(a),void ue(e.info(a));var n=z();t&&(!n||W(n,WebSocket.CLOSING)||W(n,WebSocket.CLOSED))&&(e.advancedLog(c),ue(e.info(c)),se())}}),250),U=function(t,n){t.forEach((function(t){try{t(n)}catch(t){ue(e.error(\"Error executing callback\",t))}}))},q=function(e){if(null===e)return\"NULL\";switch(e.readyState){case WebSocket.CONNECTING:return\"CONNECTING\";case WebSocket.OPEN:return\"OPEN\";case WebSocket.CLOSING:return\"CLOSING\";case WebSocket.CLOSED:return\"CLOSED\";default:return\"UNDEFINED\"}},j=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\";ue(e.debug(\"[\"+t+\"] Primary WebSocket: \"+q(n.primary)+\" | Secondary WebSocket: \"+q(n.secondary)))},W=function(e,t){return e&&e.readyState===t},F=function(e){return W(e,WebSocket.OPEN)},B=function(e){return null===e||void 0===e.readyState||W(e,WebSocket.CLOSED)},z=function(){return null!==n.secondary?n.secondary:n.primary},H=function(){return F(z())},V=function(){if(o.pendingResponse)return e.advancedLog(l),ue(e.warn(l)),clearInterval(o.intervalHandle),o.pendingResponse=!1,void se();H()?(ue(e.debug(\"Sending heartbeat\")),z().send(ie(_)),o.pendingResponse=!0):(e.advancedLog(p),ue(e.warn(p)),j(\"sendHeartBeat\"),se())},G=function(){e.advancedLog(\"Reset Websocket state\"),r.exponentialBackOffTime=1e3,o.pendingResponse=!1,r.reconnectWebSocket=!0,clearTimeout(r.lifeTimeTimeoutHandle),clearInterval(o.intervalHandle),clearTimeout(r.exponentialTimeoutHandle),clearTimeout(r.webSocketInitCheckerTimeoutId)},K=function(){N.consecutiveFailedSubscribeAttempts=0,N.consecutiveNoResponseRequest=0,clearInterval(N.responseCheckIntervalId),clearInterval(N.reSubscribeIntervalId)},X=function(){i.connectWebSocketRetryCount=0,i.connectionAttemptStartTime=null,i.noOpenConnectionsTimestamp=null},J=function(){M.connected();try{e.advancedLog(d),ue(e.info(d)),j(\"webSocketOnOpen\"),null!==r.connState&&r.connState!==x||U(A.connectionGain),r.connState=\"connected\";var t=Date.now();U(A.connectionOpen,{connectWebSocketRetryCount:i.connectWebSocketRetryCount,connectionAttemptStartTime:i.connectionAttemptStartTime,noOpenConnectionsTimestamp:i.noOpenConnectionsTimestamp,connectionEstablishedTime:t,timeToConnect:t-i.connectionAttemptStartTime,timeWithoutConnection:i.noOpenConnectionsTimestamp?t-i.noOpenConnectionsTimestamp:null}),X(),G(),z().openTimestamp=Date.now(),0===O.subscribed.size&&F(n.secondary)&&te(n.primary,\"[Primary WebSocket] Closing WebSocket\"),(O.subscribed.size>0||O.pending.size>0)&&(F(n.secondary)&&ue(e.info(\"Subscribing secondary websocket to topics of primary websocket\")),O.subscribed.forEach((function(e){O.subscriptionHistory.add(e),O.pending.add(e)})),O.subscribed.clear(),Q()),V(),o.intervalHandle=setInterval(V,1e4);var s=1e3*R.connConfig.webSocketTransport.transportLifeTimeInSeconds;ue(e.debug(\"Scheduling WebSocket manager reconnection, after delay \"+s+\" ms\")),r.lifeTimeTimeoutHandle=setTimeout((function(){ue(e.debug(\"Starting scheduled WebSocket manager reconnection\")),se()}),s)}catch(t){ue(e.error(\"Error after establishing WebSocket connection\",t))}},Y=function(t){j(\"webSocketOnError\"),e.advancedLog(f,JSON.stringify(t)),ue(e.error(f,JSON.stringify(t))),M.getIsConnected()?se():M.retry()},$=function(t){var r=JSON.parse(t.data);switch(r.topic){case I:if(ue(e.debug(\"Subscription Message received from webSocket server\",t.data)),N.requestCompleted=!0,N.consecutiveNoResponseRequest=0,\"success\"===r.content.status)N.consecutiveFailedSubscribeAttempts=0,r.content.topics.forEach((function(e){O.subscriptionHistory.delete(e),O.pending.delete(e),O.subscribed.add(e)})),0===O.subscriptionHistory.size?F(n.secondary)&&(ue(e.info(\"Successfully subscribed secondary websocket to all topics of primary websocket\")),te(n.primary,\"[Primary WebSocket] Closing WebSocket\")):Q(),U(A.subscriptionUpdate,r);else{if(clearInterval(N.reSubscribeIntervalId),++N.consecutiveFailedSubscribeAttempts,5===N.consecutiveFailedSubscribeAttempts)return U(A.subscriptionFailure,r),void(N.consecutiveFailedSubscribeAttempts=0);N.reSubscribeIntervalId=setInterval((function(){Q()}),500)}break;case _:ue(e.debug(\"Heartbeat response received\")),o.pendingResponse=!1;break;default:if(r.topic){if(e.advancedLog(T,r.topic),ue(e.debug(T+r.topic)),F(n.primary)&&F(n.secondary)&&0===O.subscriptionHistory.size&&this===n.primary)return void ue(e.warn(\"Ignoring Message for Topic \"+r.topic+\", to avoid duplicates\"));if(0===A.allMessage.size&&0===A.topic.size)return void ue(e.warn(\"No registered callback listener for Topic\",r.topic));e.advancedLog(\"WebsocketManager invoke callbacks for topic success \",r.topic),U(A.allMessage,r),A.topic.has(r.topic)&&U(A.topic.get(r.topic),r)}else r.message?(e.advancedLog(C,r),ue(e.warn(C,r))):(e.advancedLog(k,r),ue(e.warn(k,r)))}},Q=function t(){if(N.consecutiveNoResponseRequest>3)return ue(e.warn(\"Ignoring subscribePendingTopics since we have exhausted max subscription retries with no response\")),void U(A.subscriptionFailure,L.getSubscriptionResponse(I,!1,Array.from(O.pending)));H()?0!==Array.from(O.pending).length&&(clearInterval(N.responseCheckIntervalId),z().send(ie(I,{topics:Array.from(O.pending)})),N.requestCompleted=!1,N.responseCheckIntervalId=setInterval((function(){N.requestCompleted||(++N.consecutiveNoResponseRequest,t())}),1e3)):ue(e.warn(\"Ignoring subscribePendingTopics call since Default WebSocket is not open\"))},te=function(t,n){W(t,WebSocket.CONNECTING)||W(t,WebSocket.OPEN)?t.close(1e3,n):ue(e.warn(\"Ignoring WebSocket Close request, WebSocket State: \"+q(t)))},ne=function(e){te(n.primary,\"[Primary] WebSocket \"+e),te(n.secondary,\"[Secondary] WebSocket \"+e)},re=function(t){G(),K(),e.advancedLog(v,t),ue(e.error(v)),r.websocketInitFailed=!0,ne(\"Terminating WebSocket Manager\"),clearInterval(D),U(A.initFailure,{connectWebSocketRetryCount:i.connectWebSocketRetryCount,connectionAttemptStartTime:i.connectionAttemptStartTime,reason:t}),X()},ie=function(e,t){return JSON.stringify({topic:e,content:t})},oe=function(t){return!!(L.isObject(t)&&L.isObject(t.webSocketTransport)&&L.isNonEmptyString(t.webSocketTransport.url)&&L.validWSUrl(t.webSocketTransport.url)&&1e3*t.webSocketTransport.transportLifeTimeInSeconds>=3e5)||(ue(e.error(\"Invalid WebSocket Connection Configuration\",t)),!1)},se=function(){if(!L.isNetworkOnline())return e.advancedLog(u),void ue(e.info(u));if(r.websocketInitFailed)ue(e.debug(\"WebSocket Init had failed, ignoring this getWebSocketConnConfig request\"));else{if(R.promiseCompleted)return G(),e.advancedLog(y),ue(e.info(y)),i.connectionAttemptStartTime=i.connectionAttemptStartTime||Date.now(),R.promiseCompleted=!1,R.promiseHandle=A.getWebSocketTransport(),R.promiseHandle.then((function(t){return R.promiseCompleted=!0,e.advancedLog(b),ue(e.debug(b,t)),oe(t)?(R.connConfig=t,R.connConfig.urlConnValidTime=Date.now()+85e3,ae()):(re(\"Invalid WebSocket connection configuration: \"+t),{webSocketConnectionFailed:!0})}),(function(t){return R.promiseCompleted=!0,e.advancedLog(w),ue(e.error(w,t)),L.isNetworkFailure(t)?(e.advancedLog(S+JSON.stringify(t)),ue(e.info(S+JSON.stringify(t))),M.retry()):re(\"Failed to fetch webSocket connection configuration: \"+JSON.stringify(t)),{webSocketConnectionFailed:!0}}));ue(e.debug(\"There is an ongoing getWebSocketConnConfig request, this request will be ignored\"))}},ae=function(){if(r.websocketInitFailed)return ue(e.info(\"web-socket initializing had failed, aborting re-init\")),{webSocketConnectionFailed:!0};if(!L.isNetworkOnline())return ue(e.warn(\"System is offline aborting web-socket init\")),{webSocketConnectionFailed:!0};e.advancedLog(E),ue(e.info(E)),j(\"initWebSocket\");try{if(oe(R.connConfig)){var t=null;return F(n.primary)?(ue(e.debug(\"Primary Socket connection is already open\")),W(n.secondary,WebSocket.CONNECTING)||(ue(e.debug(\"Establishing a secondary web-socket connection\")),M.numAttempts=0,n.secondary=ce()),t=n.secondary):(W(n.primary,WebSocket.CONNECTING)||(ue(e.debug(\"Establishing a primary web-socket connection\")),n.primary=ce()),t=n.primary),r.webSocketInitCheckerTimeoutId=setTimeout((function(){F(t)||function(){i.connectWebSocketRetryCount++;var t=L.addJitter(r.exponentialBackOffTime,.3);Date.now()+t<=R.connConfig.urlConnValidTime?(e.advancedLog(m),ue(e.debug(m+t+\" ms\")),r.exponentialTimeoutHandle=setTimeout((function(){return ae()}),t),r.exponentialBackOffTime*=2):(e.advancedLog(g),ue(e.warn(g)),se())}()}),1e3),{webSocketConnectionFailed:!1}}}catch(t){return ue(e.error(\"Error Initializing web-socket-manager\",t)),re(\"Failed to initialize new WebSocket: \"+t.message),{webSocketConnectionFailed:!0}}},ce=function(){var t=new WebSocket(R.connConfig.webSocketTransport.url);return t.addEventListener(\"open\",J),t.addEventListener(\"message\",$),t.addEventListener(\"error\",Y),t.addEventListener(\"close\",(function(o){return function(t,o){e.advancedLog(h,JSON.stringify(t)),ue(e.info(h,JSON.stringify(t))),j(\"webSocketOnClose before-cleanup\"),U(A.connectionClose,{openTimestamp:o.openTimestamp,closeTimestamp:Date.now(),connectionDuration:Date.now()-o.openTimestamp,code:t.code,reason:t.reason}),B(n.primary)&&(n.primary=null),B(n.secondary)&&(n.secondary=null),r.reconnectWebSocket&&(F(n.primary)||F(n.secondary)?B(n.primary)&&F(n.secondary)&&(ue(e.info(\"[Primary] WebSocket Cleanly Closed\")),n.primary=n.secondary,n.secondary=null):(ue(e.warn(\"Neither primary websocket and nor secondary websocket have open connections, attempting to re-establish connection\")),r.connState===x?ue(e.info(\"Ignoring connectionLost callback invocation\")):(U(A.connectionLost,{openTimestamp:o.openTimestamp,closeTimestamp:Date.now(),connectionDuration:Date.now()-o.openTimestamp,code:t.code,reason:t.reason}),i.noOpenConnectionsTimestamp=Date.now()),r.connState=x,se()),j(\"webSocketOnClose after-cleanup\"))}(o,t)})),t},ue=function(e){return e&&\"function\"==typeof e.sendInternalLogToServer&&e.sendInternalLogToServer(),e};this.init=function(t){if(L.assertTrue(L.isFunction(t),\"transportHandle must be a function\"),null===A.getWebSocketTransport)return A.getWebSocketTransport=t,se();ue(e.warn(\"Web Socket Manager was already initialized\"))},this.onInitFailure=function(t){return e.advancedLog(\"Initializing Websocket Manager Failure callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.initFailure.add(t),r.websocketInitFailed&&t(),function(){return A.initFailure.delete(t)}},this.onConnectionOpen=function(t){return e.advancedLog(\"Websocket connection open callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.connectionOpen.add(t),function(){return A.connectionOpen.delete(t)}},this.onConnectionClose=function(t){return e.advancedLog(\"Websocket connection close callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.connectionClose.add(t),function(){return A.connectionClose.delete(t)}},this.onConnectionGain=function(t){return e.advancedLog(\"Websocket connection gain callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.connectionGain.add(t),H()&&t(),function(){return A.connectionGain.delete(t)}},this.onConnectionLost=function(t){return e.advancedLog(\"Websocket connection lost callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.connectionLost.add(t),r.connState===x&&t(),function(){return A.connectionLost.delete(t)}},this.onSubscriptionUpdate=function(e){return L.assertTrue(L.isFunction(e),\"cb must be a function\"),A.subscriptionUpdate.add(e),function(){return A.subscriptionUpdate.delete(e)}},this.onSubscriptionFailure=function(t){return e.advancedLog(\"Websocket subscription failure callback registered\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.subscriptionFailure.add(t),function(){return A.subscriptionFailure.delete(t)}},this.onMessage=function(e,t){return L.assertNotNull(e,\"topicName\"),L.assertTrue(L.isFunction(t),\"cb must be a function\"),A.topic.has(e)?A.topic.get(e).add(t):A.topic.set(e,new Set([t])),function(){return A.topic.get(e).delete(t)}},this.onAllMessage=function(e){return L.assertTrue(L.isFunction(e),\"cb must be a function\"),A.allMessage.add(e),function(){return A.allMessage.delete(e)}},this.subscribeTopics=function(e){L.assertNotNull(e,\"topics\"),L.assertIsList(e),e.forEach((function(e){O.subscribed.has(e)||O.pending.add(e)})),N.consecutiveNoResponseRequest=0,Q()},this.sendMessage=function(t){if(L.assertIsObject(t,\"payload\"),void 0===t.topic||P.has(t.topic))ue(e.warn(\"Cannot send message, Invalid topic\",t));else{try{t=JSON.stringify(t)}catch(n){return void ue(e.warn(\"Error stringify message\",t))}H()?z().send(t):ue(e.warn(\"Cannot send message, web socket connection is not open\"))}},this.closeWebSocket=function(){G(),K(),r.reconnectWebSocket=!1,clearInterval(D),ne(\"User request to close WebSocket\")},this.terminateWebSocketManager=re},ne={create:function(e){return ee||(ee=new J(e)),ee.hasLogMetaData()||ee.setLogMetaData(e),e||console.info(\"********Missing metaData for logs from websocketManager: initialize websocketManager using create(metaData)*******\"),new te},setGlobalConfig:function(e){var t=e&&e.loggerConfig;ee||(ee=new J),ee.updateLoggerConfig(t)},LogLevel:X,Logger:G}},function(e,t,n){var r;!function(){var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\\x25]+/,modulo:/^\\x25{2}/,placeholder:/^\\x25(?:([1-9]\\d*)\\$|\\(([^)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\\d]*)/i,key_access:/^\\.([a-z_][a-z_\\d]*)/i,index_access:/^\\[(\\d+)\\]/,sign:/^[+-]/};function o(e){return a(u(e),arguments)}function s(e,t){return o.apply(null,[e].concat(t||[]))}function a(e,t){var n,r,s,a,c,u,l,p,d,h=1,f=e.length,m=\"\";for(r=0;r<f;r++)if(\"string\"==typeof e[r])m+=e[r];else if(\"object\"==typeof e[r]){if((a=e[r]).keys)for(n=t[h],s=0;s<a.keys.length;s++){if(null==n)throw new Error(o('[sprintf] Cannot access property \"%s\" of undefined value \"%s\"',a.keys[s],a.keys[s-1]));n=n[a.keys[s]]}else n=a.param_no?t[a.param_no]:t[h++];if(i.not_type.test(a.type)&&i.not_primitive.test(a.type)&&n instanceof Function&&(n=n()),i.numeric_arg.test(a.type)&&\"number\"!=typeof n&&isNaN(n))throw new TypeError(o(\"[sprintf] expecting number but found %T\",n));switch(i.number.test(a.type)&&(p=n>=0),a.type){case\"b\":n=parseInt(n,10).toString(2);break;case\"c\":n=String.fromCharCode(parseInt(n,10));break;case\"d\":case\"i\":n=parseInt(n,10);break;case\"j\":n=JSON.stringify(n,null,a.width?parseInt(a.width):0);break;case\"e\":n=a.precision?parseFloat(n).toExponential(a.precision):parseFloat(n).toExponential();break;case\"f\":n=a.precision?parseFloat(n).toFixed(a.precision):parseFloat(n);break;case\"g\":n=a.precision?String(Number(n.toPrecision(a.precision))):parseFloat(n);break;case\"o\":n=(parseInt(n,10)>>>0).toString(8);break;case\"s\":n=String(n),n=a.precision?n.substring(0,a.precision):n;break;case\"t\":n=String(!!n),n=a.precision?n.substring(0,a.precision):n;break;case\"T\":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=a.precision?n.substring(0,a.precision):n;break;case\"u\":n=parseInt(n,10)>>>0;break;case\"v\":n=n.valueOf(),n=a.precision?n.substring(0,a.precision):n;break;case\"x\":n=(parseInt(n,10)>>>0).toString(16);break;case\"X\":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}i.json.test(a.type)?m+=n:(!i.number.test(a.type)||p&&!a.sign?d=\"\":(d=p?\"+\":\"-\",n=n.toString().replace(i.sign,\"\")),u=a.pad_char?\"0\"===a.pad_char?\"0\":a.pad_char.charAt(1):\" \",l=a.width-(d+n).length,c=a.width&&l>0?u.repeat(l):\"\",m+=a.align?d+n+c:\"0\"===u?d+c+n:c+d+n)}return m}var c=Object.create(null);function u(e){if(c[e])return c[e];for(var t,n=e,r=[],o=0;n;){if(null!==(t=i.text.exec(n)))r.push(t[0]);else if(null!==(t=i.modulo.exec(n)))r.push(\"%\");else{if(null===(t=i.placeholder.exec(n)))throw new SyntaxError(\"[sprintf] unexpected placeholder\");if(t[2]){o|=1;var s=[],a=t[2],u=[];if(null===(u=i.key.exec(a)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");for(s.push(u[1]);\"\"!==(a=a.substring(u[0].length));)if(null!==(u=i.key_access.exec(a)))s.push(u[1]);else{if(null===(u=i.index_access.exec(a)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");s.push(u[1])}t[2]=s}else o|=2;if(3===o)throw new Error(\"[sprintf] mixing positional and named placeholders is not (yet) supported\");r.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return c[e]=r}t.sprintf=o,t.vsprintf=s,\"undefined\"!=typeof window&&(window.sprintf=o,window.vsprintf=s,void 0===(r=function(){return{sprintf:o,vsprintf:s}}.call(t,n,t,e))||(e.exports=r))}()},function(e,t,n){var r=n(11);e.exports=function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(0).default,i=n(12);e.exports=function(e,t){if(t&&(\"object\"===r(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){n.r(t),function(e){n.d(t,\"WebSocketManager\",(function(){return i}));var r=n(4);e.connect=e.connect||{},connect.WebSocketManager=r.a;var i=r.a}.call(this,n(10))},function(e,t){var n;n=function(){return this}();try{n=n||new Function(\"return this\")()}catch(e){\"object\"==typeof window&&(n=window)}e.exports=n},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t,r)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e},e.exports.__esModule=!0,e.exports.default=e.exports}]);var Z=connect.WebSocketManager;connect.WebSocketManager=Q||Z;const ee=Z;class te extends class{constructor(e,t){this.connectionDetailsProvider=e,this.isStarted=!1,this.logger=I.getLogger({prefix:\"ChatJS-BaseConnectionHelper\",logMetaData:t})}startConnectionTokenPolling(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:432e5;arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(this.logger.info(\"First time polling connection token.\"),this.timeout=setTimeout(this.startConnectionTokenPolling.bind(this),e)):this.connectionDetailsProvider.fetchConnectionToken().then((()=>{this.logger.info(\"Connection token polling succeeded.\"),e=this.getTimeToConnectionTokenExpiry(),this.timeout=setTimeout(this.startConnectionTokenPolling.bind(this),e)})).catch((t=>{this.logger.error(\"An error occurred when attempting to fetch the connection token during Connection Token Polling\",t),this.timeout=setTimeout(this.startConnectionTokenPolling.bind(this),e)}))}start(){this.isStarted||(this.isStarted=!0,this.startConnectionTokenPolling(!0,this.getTimeToConnectionTokenExpiry()))}end(){clearTimeout(this.timeout)}getConnectionToken(){return this.connectionDetailsProvider.getFetchedConnectionToken()}getConnectionTokenExpiry(){return this.connectionDetailsProvider.getConnectionTokenExpiry()}getTimeToConnectionTokenExpiry(){return new Date(this.getConnectionTokenExpiry()).getTime()-(new Date).getTime()-6e4}}{constructor(e,t,n,r,i){super(n,i),this.customerConnection=!r,this.customerConnection?(te.customerBaseInstances[e]||(te.customerBaseInstances[e]=new ne(n,void 0,i)),this.baseInstance=te.customerBaseInstances[e]):(te.agentBaseInstance&&te.agentBaseInstance.getWebsocketManager()!==r&&(te.agentBaseInstance.end(),te.agentBaseInstance=null),te.agentBaseInstance||(te.agentBaseInstance=new ne(void 0,r,i)),this.baseInstance=te.agentBaseInstance),this.contactId=e,this.initialContactId=t,this.status=null,this.eventBus=new X,this.subscriptions=[this.baseInstance.onEnded(this.handleEnded.bind(this)),this.baseInstance.onConnectionGain(this.handleConnectionGain.bind(this)),this.baseInstance.onConnectionLost(this.handleConnectionLost.bind(this)),this.baseInstance.onMessage(this.handleMessage.bind(this))]}start(){return super.start(),this.baseInstance.start()}end(){super.end(),this.eventBus.unsubscribeAll(),this.subscriptions.forEach((e=>e())),this.status=W,this.tryCleanup()}tryCleanup(){this.customerConnection&&!this.baseInstance.hasMessageSubscribers()&&(this.baseInstance.end(),delete te.customerBaseInstances[this.contactId])}getStatus(){return this.status||this.baseInstance.getStatus()}onEnded(e){return this.eventBus.subscribe(z,e)}handleEnded(){this.eventBus.trigger(z,{})}onConnectionGain(e){return this.eventBus.subscribe(B,e)}handleConnectionGain(){this.eventBus.trigger(B,{})}onConnectionLost(e){return this.eventBus.subscribe(F,e)}handleConnectionLost(){this.eventBus.trigger(F,{})}onMessage(e){return this.eventBus.subscribe(H,e)}handleMessage(e){e.InitialContactId!==this.initialContactId&&e.ContactId!==this.contactId||this.eventBus.trigger(H,e)}}te.customerBaseInstances={},te.agentBaseInstance=null;class ne{constructor(e,t,n){this.status=D,this.eventBus=new X,this.logger=I.getLogger({prefix:\"ChatJS-LPCConnectionHelperBase\",logMetaData:n}),this.initWebsocketManager(t,e,n)}initWebsocketManager(e,t,n){if(this.websocketManager=e||ee.create(n),this.websocketManager.subscribeTopics([\"aws/chat\"]),this.subscriptions=[this.websocketManager.onMessage(\"aws/chat\",this.handleMessage.bind(this)),this.websocketManager.onConnectionGain(this.handleConnectionGain.bind(this)),this.websocketManager.onConnectionLost(this.handleConnectionLost.bind(this)),this.websocketManager.onInitFailure(this.handleEnded.bind(this))],this.logger.info(\"Initializing websocket manager.\"),!e){var r=(new Date).getTime();this.websocketManager.init((()=>t.fetchConnectionDetails().then((e=>{var t={webSocketTransport:{url:e.url,expiry:e.expiry,transportLifeTimeInSeconds:S}},n={expiry:e.expiry,transportLifeTimeInSeconds:S};return this.logger.debug(\"Websocket manager initialized. Connection details:\",n),Y.addLatencyMetricWithStartTime(f,r,s),Y.addCountAndErrorMetric(f,s,!1),t})).catch((e=>{throw this.logger.error(\"Initializing Websocket Manager failed:\",e),Y.addLatencyMetricWithStartTime(f,r,s),Y.addCountAndErrorMetric(f,s,!0),e}))))}}end(){this.websocketManager.closeWebSocket&&this.websocketManager.closeWebSocket(),this.eventBus.unsubscribeAll(),this.subscriptions.forEach((e=>e())),this.logger.info(\"Websocket closed. All event subscriptions are cleared.\")}start(){return this.status===D&&(this.status=U),Promise.resolve()}onEnded(e){return this.eventBus.subscribe(z,e)}handleEnded(){this.status=W,this.eventBus.trigger(z,{}),this.logger.info(\"Websocket connection ended.\"),Y.addCountMetric(\"WebsocketEnded\",s)}onConnectionGain(e){return this.eventBus.subscribe(B,e)}handleConnectionGain(){this.status=q,this.eventBus.trigger(B,{}),this.logger.info(\"Websocket connection gained.\"),Y.addCountMetric(\"WebsocketConnectionGained\",s)}onConnectionLost(e){return this.eventBus.subscribe(F,e)}handleConnectionLost(){this.status=j,this.eventBus.trigger(F,{}),this.logger.info(\"Websocket connection lost.\"),Y.addCountMetric(\"WebsocketConnectionLost\",s)}onMessage(e){return this.eventBus.subscribe(H,e)}handleMessage(e){var t;try{t=JSON.parse(e.content),this.eventBus.trigger(H,t),this.logger.info(\"Websocket incoming message\",{messageId:t.Id,contentType:t.ContentType}),Y.addCountMetric(\"WebsocketIncomingMessage\",s)}catch(e){this._sendInternalLogToServer(this.logger.error(\"Wrong message format\"))}}getStatus(){return this.status}getWebsocketManager(){return this.websocketManager}hasMessageSubscribers(){return this.eventBus.getSubscriptions(H).length>0}_sendInternalLogToServer(e){return e&&\"function\"==typeof e.sendInternalLogToServer&&e.sendInternalLogToServer(),e}}const re=te;class ie{constructor(e){this.argsValidator=new P,this.pubsub=new X,this.sessionType=e.sessionType,this.getConnectionToken=e.chatDetails.getConnectionToken,this.connectionDetails=e.chatDetails.connectionDetails,this.initialContactId=e.chatDetails.initialContactId,this.contactId=e.chatDetails.contactId,this.participantId=e.chatDetails.participantId,this.chatClient=e.chatClient,this.participantToken=e.chatDetails.participantToken,this.websocketManager=e.websocketManager,this._participantDisconnected=!1,this.sessionMetadata={},this.logger=I.getLogger({prefix:\"ChatJS-ChatController\",logMetaData:e.logMetaData}),this.logMetaData=e.logMetaData,this.logger.info(\"Browser info:\",window.navigator.userAgent)}subscribe(e,t){this.pubsub.subscribe(e,t),this._sendInternalLogToServer(this.logger.info(\"Subscribed successfully to event:\",e))}handleRequestSuccess(e,t,n,r){return i=>this.handleResponse(e,t,n,r,i,!1)}handleRequestFailure(e,t,n,r){return i=>this.handleResponse(e,t,n,r,i,!0)}handleResponse(e,t,n,r,i,o){var a=r?[{name:\"ContentType\",value:r}]:[];return Y.addLatencyMetricWithStartTime(t,n,s,a),Y.addCountAndErrorMetric(t,s,o,a),i.metadata=e,o?Promise.reject(i):i}sendMessage(e){var t=(new Date).getTime(),n=e.metadata||null;this.argsValidator.validateSendMessage(e);var r=this.connectionHelper.getConnectionToken();return this.chatClient.sendMessage(r,e.message,e.contentType).then(this.handleRequestSuccess(n,a,t,e.contentType)).catch(this.handleRequestFailure(n,a,t,e.contentType))}sendAttachment(e){var t=(new Date).getTime(),n=e.metadata||null,r=this.connectionHelper.getConnectionToken();return this.chatClient.sendAttachment(r,e.attachment,e.metadata).then(this.handleRequestSuccess(n,c,t,e.attachment.type)).catch(this.handleRequestFailure(n,c,t,e.attachment.type))}downloadAttachment(e){var t=(new Date).getTime(),n=e.metadata||null,r=this.connectionHelper.getConnectionToken();return this.chatClient.downloadAttachment(r,e.attachmentId).then(this.handleRequestSuccess(n,u,t)).catch(this.handleRequestFailure(n,u,t))}sendEvent(e){var t=(new Date).getTime(),n=e.metadata||null;this.argsValidator.validateSendEvent(e);var r=this.connectionHelper.getConnectionToken(),i=e.content||null;return this.chatClient.sendEvent(r,e.contentType,i).then(this.handleRequestSuccess(n,l,t,e.contentType)).catch(this.handleRequestFailure(n,l,t,e.contentType))}getTranscript(e){var t=(new Date).getTime(),n=e.metadata||null,r={startPosition:e.startPosition||{},scanDirection:e.scanDirection||\"BACKWARD\",sortOrder:e.sortOrder||\"ASCENDING\",maxResults:e.maxResults||15};e.nextToken&&(r.nextToken=e.nextToken),e.contactId&&(r.contactId=e.contactId);var i=this.connectionHelper.getConnectionToken();return this.chatClient.getTranscript(i,r).then(this.handleRequestSuccess(n,p,t)).catch(this.handleRequestFailure(n,p,t))}connect(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionMetadata=e.metadata||null,this.argsValidator.validateConnectChat(e);var t=this._getConnectionDetailsProvider();return t.fetchConnectionToken().then(this._initConnectionHelper.bind(this,t)).then(this._onConnectSuccess.bind(this),this._onConnectFailure.bind(this))}_initConnectionHelper(e){return this.connectionHelper=new re(this.contactId,this.initialContactId,e,this.websocketManager,this.logMetaData),this.connectionHelper.onEnded(this._handleEndedConnection.bind(this)),this.connectionHelper.onConnectionLost(this._handleLostConnection.bind(this)),this.connectionHelper.onConnectionGain(this._handleGainedConnection.bind(this)),this.connectionHelper.onMessage(this._handleIncomingMessage.bind(this)),this.connectionHelper.start()}_getConnectionDetailsProvider(){return new $(this.participantToken,this.chatClient,this.sessionType,this.getConnectionToken)}_handleEndedConnection(e){this._forwardChatEvent(y,{data:e,chatDetails:this.getChatDetails()}),this.breakConnection()}_handleLostConnection(e){this._forwardChatEvent(\"CONNECTION_LOST\",{data:e,chatDetails:this.getChatDetails()})}_handleGainedConnection(e){this._forwardChatEvent(v,{data:e,chatDetails:this.getChatDetails()})}_handleIncomingMessage(e){try{var t=e.ContentType===w.typing?g:m;this._forwardChatEvent(t,{data:e,chatDetails:this.getChatDetails()}),e.ContentType===w.chatEnded&&(this._forwardChatEvent(b,{data:null,chatDetails:this.getChatDetails()}),this.breakConnection())}catch(t){this._sendInternalLogToServer(this.logger.error(\"Error occured while handling message from Connection. eventData:\",e,\" Causing exception:\",t))}}_forwardChatEvent(e,t){this.pubsub.triggerAsync(e,t)}_onConnectSuccess(e){this._sendInternalLogToServer(this.logger.info(\"Connect successful!\"));var t={_debug:e,connectSuccess:!0,connectCalled:!0,metadata:this.sessionMetadata},n=Object.assign({chatDetails:this.getChatDetails()},t);return this.pubsub.triggerAsync(v,n),this._shouldAcknowledgeContact()&&this.sendEvent({contentType:w.connectionAcknowledged}),t}_onConnectFailure(e){var t={_debug:e,connectSuccess:!1,connectCalled:!0,metadata:this.sessionMetadata};return this._sendInternalLogToServer(this.logger.error(\"Connect Failed. Error: \",t)),Promise.reject(t)}_shouldAcknowledgeContact(){return this.sessionType===o.AGENT}breakConnection(){return this.connectionHelper?this.connectionHelper.end():Promise.resolve()}cleanUpOnParticipantDisconnect(){this.pubsub.unsubscribeAll()}disconnectParticipant(){var e=(new Date).getTime(),t=this.connectionHelper.getConnectionToken();return this.chatClient.disconnectParticipant(t).then((t=>(this._sendInternalLogToServer(this.logger.info(\"Disconnect participant successfully\")),this._participantDisconnected=!0,this.cleanUpOnParticipantDisconnect(),this.breakConnection(),Y.addLatencyMetricWithStartTime(d,e,s),Y.addCountAndErrorMetric(d,s,!1),t)),(t=>(Y.addLatencyMetricWithStartTime(d,e,s),Y.addCountAndErrorMetric(d,s,!0),this._sendInternalLogToServer(this.logger.error(\"Disconnect participant failed. Error:\",t)),Promise.reject(t))))}getChatDetails(){return{initialContactId:this.initialContactId,contactId:this.contactId,participantId:this.participantId,participantToken:this.participantToken,connectionDetails:this.connectionDetails}}_convertConnectionHelperStatus(e){switch(e){case D:return\"NeverEstablished\";case U:return\"Establishing\";case W:case j:return\"Broken\";case q:return\"Established\"}this._sendInternalLogToServer(this.logger.error(\"Reached invalid state. Unknown connectionHelperStatus: \",e))}getConnectionStatus(){return this._convertConnectionHelperStatus(this.connectionHelper.getStatus())}_sendInternalLogToServer(e){return e&&\"function\"==typeof e.sendInternalLogToServer&&e.sendInternalLogToServer(),e}}class oe{constructor(e){this.controller=e,Y.addCountMetric(\"StartChatSession\",\"UI\")}onMessage(e){this.controller.subscribe(m,e)}onTyping(e){this.controller.subscribe(g,e)}onConnectionBroken(e){this.controller.subscribe(y,e)}onConnectionEstablished(e){this.controller.subscribe(v,e)}onEnded(e){this.controller.subscribe(b,e)}sendMessage(e){return this.controller.sendMessage(e)}sendAttachment(e){return this.controller.sendAttachment(e)}downloadAttachment(e){return this.controller.downloadAttachment(e)}connect(e){return this.controller.connect(e)}sendEvent(e){return this.controller.sendEvent(e)}getTranscript(e){return this.controller.getTranscript(e)}getChatDetails(){return this.controller.getChatDetails()}}class se extends oe{constructor(e){super(e)}cleanUpOnParticipantDisconnect(){return this.controller.cleanUpOnParticipantDisconnect()}}class ae extends oe{constructor(e){super(e)}disconnectParticipant(){return this.controller.disconnectParticipant()}}var ce=new class extends class{createAgentChatController(e,n){throw new t(\"createAgentChatController in ChatControllerFactory.\")}createCustomerChatController(e,n){throw new t(\"createCustomerChatController in ChatControllerFactory.\")}}{constructor(){super(),this.argsValidator=new P}createChatSession(e,t,n,i){var s=this._createChatController(e,t,n,i);if(e===o.AGENT)return new se(s);if(e===o.CUSTOMER)return new ae(s);throw new r(\"Unkown value for session type, Allowed values are: \"+Object.values(o),e)}_createChatController(e,t,n,r){var i=this.argsValidator.normalizeChatDetails(t),o={contactId:i.contactId,participantId:i.participantId,sessionType:e},s=M.getCachedClient(n,o);return new ie({sessionType:e,chatDetails:i,chatClient:s,websocketManager:r,logMetaData:o})}},ue={create:e=>{var t=e.options||{},n=e.type||o.AGENT;return i.updateStageRegion(t),e.disableCSM||n!==o.CUSTOMER||Y.initializeCSM(),ce.createChatSession(n,e.chatDetails,t,e.websocketManager)},setGlobalConfig:e=>{var t=e.loggerConfig,n=e.csmConfig;ee.setGlobalConfig(e),i.update(e),I.updateLoggerConfig(t),n&&Y.updateCsmConfig(n)},LogLevel:k,Logger:class{debug(e){}info(e){}warn(e){}error(e){}advancedLog(e){}},SessionTypes:o,csmService:Y};n.g.connect=n.g.connect||{},connect.ChatSession=ue,connect.LogManager=I,connect.LogLevel=k,connect.csmService=ue.csmService})()})();\n//# sourceMappingURL=amazon-connect-chat.js.map"
            }
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "17f5b2ec49610500:1",
        "primaryLocationStartColumnFingerprint" : "228083"
      }
    } ],
    "newlineSequences" : [ "\r\n", "\n", "", "" ],
    "columnKind" : "utf16CodeUnits",
    "properties" : {
      "metricResults" : [ {
        "rule" : {
          "id" : "js/summary/lines-of-code",
          "index" : 83,
          "toolComponent" : {
            "index" : 4
          }
        },
        "ruleId" : "js/summary/lines-of-code",
        "value" : 5299
      }, {
        "rule" : {
          "id" : "js/summary/lines-of-user-code",
          "index" : 84,
          "toolComponent" : {
            "index" : 4
          }
        },
        "ruleId" : "js/summary/lines-of-user-code",
        "value" : 5284,
        "baseline" : 4926
      } ],
      "semmle.formatSpecifier" : "sarif-latest"
    }
  } ]
}