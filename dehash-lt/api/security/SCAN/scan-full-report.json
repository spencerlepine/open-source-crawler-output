{"tool": {"driver": {"name": "PHP Security Audit", "rules": [{"id": "UnusedForeachValue", "help": {"text": "$databaseData is never referenced or the value is not used.", "markdown": "$databaseData is never referenced or the value is not used."}, "name": "$databaseData is never referenced or the value is not used", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "warning"}, "fullDescription": {"text": "$databaseData is never referenced or the value is not used."}, "helpUri": "https://psalm.dev/275", "shortDescription": {"text": "$databaseData is never referenced or the value is not used."}}, {"id": "ForbiddenCode", "help": {"text": "Unsafe var_dump.", "markdown": "Unsafe var_dump."}, "name": "Unsafe var dump", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "warning"}, "fullDescription": {"text": "Unsafe var_dump."}, "helpUri": "https://psalm.dev/002", "shortDescription": {"text": "Unsafe var_dump."}}], "version": "1.0.0-scan", "fullName": "PHP Security Audit"}}, "conversion": {"tool": {"driver": {"name": "@ShiftLeft/sast-scan"}}, "invocation": {"arguments": ["psalm", "--report-show-info=false", "--show-snippet=true", "--find-dead-code=always", "--find-unused-code=always", "-m", "--no-progress", "--no-file-cache", "--no-suggestions", "--no-cache", "--root=/github/workspace", "--report=/github/workspace/reports/audit-php-report.json"], "executionSuccessful": true, "commandLine": "psalm --report-show-info=false --show-snippet=true --find-dead-code=always --find-unused-code=always -m --no-progress --no-file-cache --no-suggestions --no-cache --root=/github/workspace --report=/github/workspace/reports/audit-php-report.json", "endTimeUtc": "2023-01-17T08:30:28Z", "workingDirectory": {"uri": "https://github.com/dehash-lt/api"}}}, "invocations": [{"executionSuccessful": true, "endTimeUtc": "2023-01-17T08:30:28Z", "workingDirectory": {"uri": "https://github.com/dehash-lt/api"}}], "properties": {"metrics": {"total": 2, "critical": 0, "high": 0, "medium": 2, "low": 0}}, "results": [{"message": {"markdown": "", "text": "$databaseData is never referenced or the value is not used."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\tforeach($res->databases as $databaseData){\n"}, "startLine": 17}, "artifactLocation": {"uri": "https://github.com/dehash-lt/api/api.php"}, "contextRegion": {"snippet": {"text": "\t\n\tforeach($res->databases as $databaseData){\n\t\t//$dbName = $databaseData->name;\n\t\t$dbName = \"SHA1\";\n"}, "endLine": 19, "startLine": 16}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "5491027aef289bde", "scanFileHash": "b3c4a9ae06509159"}, "ruleId": "UnusedForeachValue", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Unsafe var_dump."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\techo var_dump($res) . \"<br>\";\n"}, "startLine": 24}, "artifactLocation": {"uri": "https://github.com/dehash-lt/api/api.php"}, "contextRegion": {"snippet": {"text": "\t\t$res = current($result->toArray());\n\t\techo var_dump($res) . \"<br>\";\n\t\n\t\t//foreach($res as $collectionData){\n"}, "endLine": 26, "startLine": 23}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "23daad849729f104", "scanFileHash": "b3c4a9ae06509159"}, "ruleId": "ForbiddenCode", "ruleIndex": 1}], "automationDetails": {"description": {"text": "Static Analysis Security Test results using @ShiftLeft/sast-scan"}, "guid": "bd5b62db-25d8-4912-82d0-0b3818a6e95e"}, "versionControlProvenance": [{"branch": "main", "repositoryUri": "https://github.com/spencerlepine/open-source-crawler", "revisionId": "735748ce709a4271f6944b183a2c0a8c2573b40f"}]}
{"tool": {"driver": {"name": "Python Source Analyzer", "version": "1.0.0-scan", "fullName": "Python Source Analyzer"}}, "conversion": {"tool": {"driver": {"name": "@ShiftLeft/sast-scan"}}, "invocation": {"arguments": ["-r", "-a", "vuln", "-n", "3", "-s", "B101,B102,B105,B307,B308,B310,B322,B404,B601,B602,B603,B604,B605,B701,B702,B703", "-iii", "-ll", "-o", "/github/workspace/reports/source-python-report.json", "-f", "json", "-x", ".git,.svn,.mvn,.idea,.github,.hg,dist,obj,backup,docs,tests,test,test-packages,tmp,report,reports,node_modules,.terraform,.serverless,venv,.virtualenv,vendor,bower_components,.vscode,e2e,.pytest_cache,__pycache__,.storybook,.venv,.tox,examples,tutorials,samples,migrations,db_migrations,unittests,unittests_legacy,stubs,cypress,mock,mocks", "/github/workspace"], "executionSuccessful": true, "commandLine": "-r -a vuln -n 3 -s B101,B102,B105,B307,B308,B310,B322,B404,B601,B602,B603,B604,B605,B701,B702,B703 -iii -ll -o /github/workspace/reports/source-python-report.json -f json -x .git,.svn,.mvn,.idea,.github,.hg,dist,obj,backup,docs,tests,test,test-packages,tmp,report,reports,node_modules,.terraform,.serverless,venv,.virtualenv,vendor,bower_components,.vscode,e2e,.pytest_cache,__pycache__,.storybook,.venv,.tox,examples,tutorials,samples,migrations,db_migrations,unittests,unittests_legacy,stubs,cypress,mock,mocks /github/workspace", "endTimeUtc": "2023-01-17T08:30:27Z", "workingDirectory": {"uri": "https://github.com/dehash-lt/api"}}}, "invocations": [{"executionSuccessful": true, "endTimeUtc": "2023-01-17T08:30:27Z", "workingDirectory": {"uri": "https://github.com/dehash-lt/api"}}], "properties": {"metrics": {"total": 0, "critical": 0, "high": 0, "medium": 0, "low": 0}}, "results": [], "automationDetails": {"description": {"text": "Static Analysis Security Test results using @ShiftLeft/sast-scan"}, "guid": "9e02c6c4-24b7-455f-80ca-155a4ff4d97b"}, "versionControlProvenance": [{"branch": "main", "repositoryUri": "https://github.com/spencerlepine/open-source-crawler", "revisionId": "735748ce709a4271f6944b183a2c0a8c2573b40f"}]}
{"tool": {"driver": {"name": "Python Security Analysis", "rules": [{"id": "pymongo-misconfiguration-insecure", "help": {"text": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.\nWhen a resource is given a permissions setting that provides access to a wider range of actors than required, it could lead to the exposure of sensitive information, or the modification of that resource by unintended parties. This is especially dangerous when the resource is related to program configuration, execution or sensitive user data.", "markdown": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.\nWhen a resource is given a permissions setting that provides access to a wider range of actors than required, it could lead to the exposure of sensitive information, or the modification of that resource by unintended parties. This is especially dangerous when the resource is related to program configuration, execution or sensitive user data."}, "name": "Security Misconfiguration", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "note"}, "fullDescription": {"text": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors."}, "helpUri": "https://cwe.mitre.org/data/definitions/732.html", "shortDescription": {"text": "Incorrect Permission Assignment for Critical Resource."}}], "version": "1.0.0-scan", "fullName": "Python Security Analysis"}}, "conversion": {"tool": {"driver": {"name": "@ShiftLeft/sast-scan"}}, "invocation": {"arguments": ["-j", "-a", "e", "-o", "/github/workspace/reports/taint-python-report.json"], "executionSuccessful": true, "commandLine": "-j -a e -o /github/workspace/reports/taint-python-report.json", "endTimeUtc": "2023-01-17T08:30:27Z", "workingDirectory": {"uri": "https://github.com/dehash-lt/api"}}}, "invocations": [{"executionSuccessful": true, "endTimeUtc": "2023-01-17T08:30:27Z", "workingDirectory": {"uri": "https://github.com/dehash-lt/api"}}], "properties": {"metrics": {"total": 2, "critical": 0, "high": 0, "medium": 0, "low": 2}}, "results": [{"message": {"markdown": "", "text": "Client-side Field Level Encryption allows an application to encrypt specific data fields based on the compliance needs."}, "level": "note", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "myclient = pymongo.MongoClient(\"mongodb://localhost:27017/\")\n"}, "startLine": 10}, "artifactLocation": {"uri": "https://github.com/dehash-lt/api/tools/sanitizer.py"}, "contextRegion": {"snippet": {"text": "\nmyclient = pymongo.MongoClient(\"mongodb://localhost:27017/\")\n\n\n"}, "endLine": 12, "startLine": 9}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "LOW", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "13fc52ad31fe165d", "scanFileHash": "26e76fdf553b5b13"}, "ruleId": "pymongo-misconfiguration-insecure", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Client-side Field Level Encryption allows an application to encrypt specific data fields based on the compliance needs."}, "level": "note", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "myclient = pymongo.MongoClient(\"mongodb://localhost:27017/\")\n"}, "startLine": 9}, "artifactLocation": {"uri": "https://github.com/dehash-lt/api/tools/fromWordlist.py"}, "contextRegion": {"snippet": {"text": "# ssh -L 27017:localhost:27017 user@remoteServer\nmyclient = pymongo.MongoClient(\"mongodb://localhost:27017/\")\n\n\n"}, "endLine": 11, "startLine": 8}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "LOW", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "13fc52ad31fe165d", "scanFileHash": "e37b1e188c7033b2"}, "ruleId": "pymongo-misconfiguration-insecure", "ruleIndex": 0}], "automationDetails": {"description": {"text": "Static Analysis Security Test results using @ShiftLeft/sast-scan"}, "guid": "b8b820fc-9181-4588-9a4b-53929b96912f"}, "versionControlProvenance": [{"branch": "main", "repositoryUri": "https://github.com/spencerlepine/open-source-crawler", "revisionId": "735748ce709a4271f6944b183a2c0a8c2573b40f"}]}
{"tool": {"driver": {"name": "PHP Security Analysis", "rules": [{"id": "255", "help": {"text": "Detected tainted file handling: $_GET['search']\\n$queryText\\ncall to search\\nsearch#2\\n$data\\ncall to preg_split\\npreg_split#2\\narrayvalue-fetch\\n$line\\ncall to strtolower\\nstrtolower#1\\n$line\\n$_ids\\ncall to queryOutsource\\nqueryOutsource#2\\n$itemsArray\\narrayvalue-fetch\\n$item\\nconcat\\n$url\\ncall to file_get_contents.", "markdown": "Detected tainted file handling: $_GET['search']\\n$queryText\\ncall to search\\nsearch#2\\n$data\\ncall to preg_split\\npreg_split#2\\narrayvalue-fetch\\n$line\\ncall to strtolower\\nstrtolower#1\\n$line\\n$_ids\\ncall to queryOutsource\\nqueryOutsource#2\\n$itemsArray\\narrayvalue-fetch\\n$item\\nconcat\\n$url\\ncall to file_get_contents."}, "name": "TaintedFile", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "error"}, "fullDescription": {"text": "Detected tainted file handling: $_GET['search']\\n$queryText\\ncall to search\\nsearch#2\\n$data\\ncall to preg_split\\npreg_split#2\\narrayvalue-fetch\\n$line\\ncall to strtolower\\nstrtolower#1\\n$line\\n$_ids\\ncall to queryOutsource\\nqueryOutsource#2\\n$itemsArray\\narrayvalue-fetch\\n$item\\nconcat\\n$url\\ncall to file_get_contents."}, "helpUri": "https://psalm.dev/255", "shortDescription": {"text": "Detected tainted file handling: $_GET['search']\\n$queryText\\ncall to search\\nsearch#2\\n$data\\ncall to preg_split\\npreg_split#2\\narrayvalue-fetch\\n$line\\ncall to strtolower\\nstrtolower#1\\n$line\\n$_ids\\ncall to queryOutsource\\nqueryOutsource#2\\n$itemsArray\\narrayvalue-fetch\\n$item\\nconcat\\n$url\\ncall to file_get_contents."}}], "version": "1.0.0-scan", "fullName": "PHP Security Analysis"}}, "conversion": {"tool": {"driver": {"name": "@ShiftLeft/sast-scan"}}, "invocation": {"arguments": ["/opt/phpsast/vendor/bin/psalm", "--report-show-info=false", "--show-snippet=true", "--taint-analysis", "-m", "--no-progress", "--no-file-cache", "--no-suggestions", "--no-cache", "--root=/github/workspace", "--report=/github/workspace/reports/taint-php-report.json"], "executionSuccessful": true, "commandLine": "/opt/phpsast/vendor/bin/psalm --report-show-info=false --show-snippet=true --taint-analysis -m --no-progress --no-file-cache --no-suggestions --no-cache --root=/github/workspace --report=/github/workspace/reports/taint-php-report.json", "endTimeUtc": "2023-01-17T08:30:29Z", "workingDirectory": {"uri": "https://github.com/dehash-lt/api"}}}, "invocations": [{"executionSuccessful": true, "endTimeUtc": "2023-01-17T08:30:29Z", "workingDirectory": {"uri": "https://github.com/dehash-lt/api"}}], "properties": {"metrics": {"total": 2, "critical": 2, "high": 0, "medium": 0, "low": 0}}, "results": [{"message": {"markdown": "", "text": "Detected tainted file handling: $_GET['search']\\n$queryText\\ncall to search\\nsearch#2\\n$data\\ncall to preg_split\\npreg_split#2\\narrayvalue-fetch\\n$line\\ncall to strtolower\\nstrtolower#1\\n$line\\n$_ids\\ncall to queryOutsource\\nqueryOutsource#2\\n$itemsArray\\narrayvalue-fetch\\n$item\\nconcat\\n$url\\ncall to file_get_contents."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$queryText = $_GET['search'];\n"}, "startLine": 462}, "artifactLocation": {"uri": "https://github.com/dehash-lt/api/api.php"}, "contextRegion": {"snippet": {"text": "\tif(isset($_GET['search'])){\n\t\t$queryText = $_GET['search'];\n"}, "endLine": 462, "startLine": 461}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "f51fb2faa2f7f86c", "scanFileHash": "b3c4a9ae06509159"}, "ruleId": "255", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Detected tainted file handling: $_GET['search']\\n$queryText\\ncall to search\\nsearch#2\\n$data\\ncall to preg_split\\npreg_split#2\\narrayvalue-fetch\\n$line\\ncall to strtolower\\nstrtolower#1\\n$line\\n$_ids\\ncall to queryOutsource\\nqueryOutsource#2\\n$itemsArray\\narrayvalue-fetch\\n$item\\nconcat\\nconcat\\n$url\\ncall to file_get_contents."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$queryText = $_GET['search'];\n"}, "startLine": 462}, "artifactLocation": {"uri": "https://github.com/dehash-lt/api/api.php"}, "contextRegion": {"snippet": {"text": "\tif(isset($_GET['search'])){\n\t\t$queryText = $_GET['search'];\n"}, "endLine": 462, "startLine": 461}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "f51fb2faa2f7f86c", "scanFileHash": "b3c4a9ae06509159"}, "ruleId": "255", "ruleIndex": 0}], "automationDetails": {"description": {"text": "Static Analysis Security Test results using @ShiftLeft/sast-scan"}, "guid": "fd9672cd-5a5e-48cc-aa19-8f0bef1619e4"}, "versionControlProvenance": [{"branch": "main", "repositoryUri": "https://github.com/spencerlepine/open-source-crawler", "revisionId": "735748ce709a4271f6944b183a2c0a8c2573b40f"}]}
